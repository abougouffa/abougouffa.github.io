<!doctype html><html><head><title>Doom Emacs Configuration</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link rel=stylesheet href=/google-fonts/Mulish/mulish.css><link rel=stylesheet href=/fontawesome/css/all.min.css><link rel=stylesheet href=/css/colortheme/colortheme.css><link rel=icon type=image/png href=/favicon_hu7c842f6b35a8d0374567474454be744c_4177_42x0_resize_box_3.png><meta property="og:title" content="Doom Emacs Configuration"><meta property="og:description" content="This repository How to install Emacs stuff Intro This file Doom configuration files Pseudo early-init Useful functions Fixes Check for external tools Doom modules (init.el) File skeleton Input (:input) General (:config) Completion (:completion) User interface (:ui) Editor (:editor) Emacs builtin stuff (:emacs) Terminals (:term) Checkers (:checkers) Tools (:tools) Operating system (:os) Language support (:lang) Email (:email) Apps (:app) Additional packages (packages.el) General Emacs settings User information Common variables Secrets Better defaults File deletion Window Split defaults Messages buffer Undo and auto-save Auto-save Undo Visual Undo (vundo) Editing Emacs sources Frame Focus created frame Browsers Emacs daemon Initialization Tweaks Save recent files Package configuration User interface Font Theme Doom Modus Modeline Clock Battery Mode line customization Set transparency Dashboard Custom splash image Dashboard Which key Window title SVG tag and svg-lib Focus Scrolling All the icons Tabs Highlight indent guides Editing File templates Scratch buffer Mouse buttons Very large files Evil Aggressive indent YASnippet Completion & IDE Company Tweak company-box Treemacs Projectile Tramp Eros-eval dir-locals."><meta property="og:type" content="article"><meta property="og:url" content="https://abdelhakbougouffa.pro/posts/config/"><meta property="article:section" content="posts"><meta property="article:modified_time" content="2022-09-08T18:32:19+02:00"><meta name=description content="Doom Emacs Configuration"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/favicon_hu7c842f6b35a8d0374567474454be744c_4177_42x0_resize_box_3.png alt=Logo>
Abdelhak's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><div id=theme-initialization style=display:none default-theme=system></div><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20></a><div class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# onclick=enableLightTheme()><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20></a>
<a class="dropdown-item nav-link" href=# onclick=enableDarkTheme()><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20></a>
<a class="dropdown-item nav-link" href=# onclick=useSystemTheme()><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20></a></div></li></ul></div></div><img src=/favicon_hu7c842f6b35a8d0374567474454be744c_4177_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/favicon_hu7c842f6b35a8d0374567474454be744c_4177_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/avatar_hu4ca9978d2de9ec8152cd2ee14d9907f8_291124_120x120_fit_q75_box.jpg alt="Author Image"><h5 class=author-name>Abdelhak Bougouffa</h5><p>Thursday, September 8, 2022</p></div><div class=title><h1>Doom Emacs Configuration</h1></div><div class=post-content id=post-content><ul><li><a href=#this-repository>This repository</a><ul><li><a href=#how-to-install>How to install</a></li><li><a href=#emacs-stuff>Emacs stuff</a></li></ul></li><li><a href=#intro>Intro</a><ul><li><a href=#this-file>This file</a></li></ul></li><li><a href=#doom-configuration-files>Doom configuration files</a><ul><li><a href=#pseudo-early-init>Pseudo early-init</a><ul><li><a href=#useful-functions>Useful functions</a></li><li><a href=#fixes>Fixes</a></li><li><a href=#check-for-external-tools>Check for external tools</a></li></ul></li><li><a href=#doom-modules--init-dot-el>Doom modules (<code>init.el</code>)</a><ul><li><a href=#file-skeleton>File skeleton</a></li><li><a href=#input--input>Input (<code>:input</code>)</a></li><li><a href=#general--config>General (<code>:config</code>)</a></li><li><a href=#completion--completion>Completion (<code>:completion</code>)</a></li><li><a href=#user-interface--ui>User interface (<code>:ui</code>)</a></li><li><a href=#editor--editor>Editor (<code>:editor</code>)</a></li><li><a href=#emacs-builtin-stuff--emacs>Emacs builtin stuff (<code>:emacs</code>)</a></li><li><a href=#terminals--term>Terminals (<code>:term</code>)</a></li><li><a href=#checkers--checkers>Checkers (<code>:checkers</code>)</a></li><li><a href=#tools--tools>Tools (<code>:tools</code>)</a></li><li><a href=#operating-system--os>Operating system (<code>:os</code>)</a></li><li><a href=#language-support--lang>Language support (<code>:lang</code>)</a></li><li><a href=#email--email>Email (<code>:email</code>)</a></li><li><a href=#apps--app>Apps (<code>:app</code>)</a></li></ul></li><li><a href=#additional-packages--packages-dot-el>Additional packages (<code>packages.el</code>)</a></li></ul></li><li><a href=#general-emacs-settings>General Emacs settings</a><ul><li><a href=#user-information>User information</a></li><li><a href=#common-variables>Common variables</a></li><li><a href=#secrets>Secrets</a></li><li><a href=#better-defaults>Better defaults</a><ul><li><a href=#file-deletion>File deletion</a></li><li><a href=#window>Window</a><ul><li><a href=#split-defaults>Split defaults</a></li></ul></li><li><a href=#messages-buffer>Messages buffer</a></li><li><a href=#undo-and-auto-save>Undo and auto-save</a><ul><li><a href=#auto-save>Auto-save</a></li><li><a href=#undo>Undo</a></li><li><a href=#visual-undo--vundo>Visual Undo (<code>vundo</code>)</a></li></ul></li><li><a href=#editing>Editing</a></li><li><a href=#emacs-sources>Emacs sources</a></li><li><a href=#frame>Frame</a><ul><li><a href=#focus-created-frame>Focus created frame</a></li></ul></li><li><a href=#browsers>Browsers</a></li></ul></li></ul></li><li><a href=#emacs-daemon>Emacs daemon</a><ul><li><a href=#initialization>Initialization</a></li><li><a href=#tweaks>Tweaks</a><ul><li><a href=#save-recent-files>Save recent files</a></li></ul></li></ul></li><li><a href=#package-configuration>Package configuration</a><ul><li><a href=#user-interface>User interface</a><ul><li><a href=#font>Font</a></li><li><a href=#theme>Theme</a><ul><li><a href=#doom>Doom</a></li><li><a href=#modus>Modus</a></li></ul></li><li><a href=#modeline>Modeline</a><ul><li><a href=#clock>Clock</a></li><li><a href=#battery>Battery</a></li><li><a href=#mode-line-customization>Mode line customization</a></li></ul></li><li><a href=#set-transparency>Set transparency</a></li><li><a href=#dashboard>Dashboard</a><ul><li><a href=#custom-splash-image>Custom splash image</a></li><li><a href=#dashboard>Dashboard</a></li></ul></li><li><a href=#which-key>Which key</a></li><li><a href=#window-title>Window title</a></li><li><a href=#svg-tag-and-svg-lib>SVG tag and <code>svg-lib</code></a></li><li><a href=#focus>Focus</a></li><li><a href=#scrolling>Scrolling</a></li><li><a href=#all-the-icons>All the icons</a></li><li><a href=#tabs>Tabs</a></li></ul></li><li><a href=#highlight-indent-guides>Highlight indent guides</a></li><li><a href=#editing>Editing</a><ul><li><a href=#file-templates>File templates</a></li><li><a href=#scratch-buffer>Scratch buffer</a></li><li><a href=#mouse-buttons>Mouse buttons</a></li><li><a href=#very-large-files>Very large files</a></li><li><a href=#evil>Evil</a></li><li><a href=#aggressive-indent>Aggressive indent</a></li><li><a href=#yasnippet>YASnippet</a></li></ul></li><li><a href=#completion-and-ide>Completion & IDE</a><ul><li><a href=#company>Company</a><ul><li><a href=#tweak-company-box>Tweak <code>company-box</code></a></li></ul></li><li><a href=#treemacs>Treemacs</a></li><li><a href=#projectile>Projectile</a></li><li><a href=#tramp>Tramp</a></li><li><a href=#eros-eval>Eros-eval</a></li><li><a href=#dir-locals-dot-el><code>dir-locals.el</code></a></li><li><a href=#language-server-protocol>Language Server Protocol</a><ul><li><a href=#eglot>Eglot</a></li><li><a href=#lsp-mode>LSP mode</a><ul><li><a href=#unpin-package>Unpin package</a></li><li><a href=#tweak-ui>Tweak UI</a></li><li><a href=#lsp-mode-with-clangd>LSP mode with <code>clangd</code></a></li><li><a href=#lsp-mode-with-ccls>LSP mode with <code>ccls</code></a></li><li><a href=#enable-lsp-over-tramp>Enable <code>lsp</code> over <code>tramp</code></a></li><li><a href=#vhdl>VHDL</a></li><li><a href=#sonarlint>SonarLint</a></li></ul></li></ul></li><li><a href=#cppcheck>Cppcheck</a></li><li><a href=#project-cmake>Project CMake</a></li><li><a href=#clang-format>Clang-format</a></li><li><a href=#auto-include-c-plus-plus-headers>Auto-include C++ headers</a></li><li><a href=#erefactor>Erefactor</a></li><li><a href=#lorem-ipsum>Lorem ipsum</a></li><li><a href=#coverage-test>Coverage test</a></li></ul></li><li><a href=#debugging>Debugging</a><ul><li><a href=#dap>DAP</a><ul><li><a href=#doom-store>Doom store</a></li></ul></li><li><a href=#realgud>RealGUD</a><ul><li><a href=#additional-commands>Additional commands</a></li><li><a href=#record-and-replay-rr>Record and replay <code>rr</code></a></li><li><a href=#additional-debuggers-for-realgud>Additional debuggers for RealGUD</a></li></ul></li><li><a href=#gdb>GDB</a><ul><li><a href=#emacs-gdb-a-dot-k-dot-a-dot-gdb-mi>Emacs GDB <em>a.k.a.</em> <code>gdb-mi</code></a></li><li><a href=#custom-layout-for-gdb-many-windows>Custom layout for <code>gdb-many-windows</code></a></li><li><a href=#highlight-current-line>Highlight current line</a></li></ul></li><li><a href=#wip-launch-dot-json-support-for-gud-and-realgud>WIP <code>launch.json</code> support for GUD and RealGUD</a></li><li><a href=#valgrind>Valgrind</a></li></ul></li><li><a href=#symbols>Symbols</a><ul><li><a href=#emojify>Emojify</a></li><li><a href=#ligatures>Ligatures</a></li></ul></li><li><a href=#checkers--spell-and-grammar>Checkers (spell & grammar)</a><ul><li><a href=#spell-fu>Spell-Fu</a></li><li><a href=#grammarly>Grammarly</a><ul><li><a href=#eglot>Eglot</a></li><li><a href=#lsp-mode>LSP Mode</a></li></ul></li><li><a href=#grammalecte>Grammalecte</a></li><li><a href=#ltex-languagetool>LTeX/LanguageTool</a></li><li><a href=#go-translate--google-bing-and-deepl>Go Translate (Google, Bing and DeepL)</a></li></ul></li><li><a href=#system-tools>System tools</a><ul><li><a href=#disk-usage>Disk usage</a></li><li><a href=#chezmoi>Chezmoi</a></li><li><a href=#aweshell>Aweshell</a></li><li><a href=#lemon>Lemon</a></li><li><a href=#ecryptfs>eCryptfs</a></li></ul></li><li><a href=#features>Features</a><ul><li><a href=#workspaces>Workspaces</a></li><li><a href=#weather>Weather</a></li><li><a href=#openstreetmap>OpenStreetMap</a></li><li><a href=#islamic-prayer-times>Islamic prayer times</a></li><li><a href=#info-colors>Info colors</a></li><li><a href=#zotero-zotxt>Zotero Zotxt</a></li><li><a href=#crdt>CRDT</a></li><li><a href=#the-silver-searcher>The Silver Searcher</a></li><li><a href=#page-break-lines>Page break lines</a></li><li><a href=#emacs-application-framework>Emacs Application Framework</a></li><li><a href=#bitwarden>Bitwarden</a></li><li><a href=#pdf-tools>PDF tools</a><ul><li><a href=#dark-mode>Dark mode</a></li></ul></li><li><a href=#ltdr>LTDR</a></li><li><a href=#fzf>FZF</a></li><li><a href=#binary-files>Binary files</a></li><li><a href=#objdump-mode>Objdump mode</a></li></ul></li><li><a href=#fun>Fun</a><ul><li><a href=#speed-type>Speed Type</a></li><li><a href=#2048-game>2048 Game</a></li><li><a href=#snow>Snow</a></li><li><a href=#xkcd><code>xkcd</code></a></li></ul></li></ul></li><li><a href=#applications>Applications</a><ul><li><a href=#calendar>Calendar</a></li><li><a href=#e-books--nov>e-Books (<code>nov</code>)</a></li><li><a href=#news-feed--elfeed>News feed (<code>elfeed</code>)</a></li><li><a href=#vpn-configuration>VPN configuration</a><ul><li><a href=#netextender-wrapper>NetExtender wrapper</a></li><li><a href=#emacs-plus-netextender>Emacs + NetExtender</a></li></ul></li><li><a href=#email--mu4e>Email (<code>mu4e</code>)</a><ul><li><a href=#imap--mbsync>IMAP (<code>mbsync</code>)</a></li><li><a href=#smtp--msmtp>SMTP (<code>msmtp</code>)</a></li><li><a href=#mail-client-and-indexer--mu-and-mu4e>Mail client and indexer (<code>mu</code> and <code>mu4e</code>)</a></li><li><a href=#dashboard>Dashboard</a></li><li><a href=#save-all-attachements>Save all attachements</a></li></ul></li><li><a href=#irc>IRC</a></li><li><a href=#multimedia>Multimedia</a><ul><li><a href=#mpd-and-mpc>MPD and MPC</a></li><li><a href=#emms>EMMS</a></li><li><a href=#empv>EMPV</a></li><li><a href=#keybindings>Keybindings</a></li><li><a href=#cycle-song-information-in-mode-line>Cycle song information in mode line</a></li></ul></li><li><a href=#maxima>Maxima</a><ul><li><a href=#maxima>Maxima</a></li><li><a href=#imaxima>IMaxima</a></li></ul></li><li><a href=#fricas>FriCAS</a></li><li><a href=#roam>Roam</a><ul><li><a href=#basic-settings>Basic settings</a></li><li><a href=#mode-line-file-name>Mode line file name</a></li><li><a href=#org-roam-capture-template>Org Roam Capture template</a></li><li><a href=#view-notes-in-deft>View notes in Deft</a></li></ul></li></ul></li><li><a href=#programming>Programming</a><ul><li><a href=#csv-rainbow>CSV rainbow</a></li><li><a href=#vimrc>Vimrc</a></li><li><a href=#ess>ESS</a></li><li><a href=#python-ide>Python IDE</a></li><li><a href=#gnu-octave>GNU Octave</a></li><li><a href=#ros>ROS</a><ul><li><a href=#extensions>Extensions</a></li><li><a href=#ros-bags>ROS bags</a></li><li><a href=#ros-dot-el><code>ros.el</code></a></li></ul></li><li><a href=#scheme>Scheme</a></li><li><a href=#embedded-systems>Embedded systems</a><ul><li><a href=#embed-dot-el>Embed.el</a></li><li><a href=#arduino>Arduino</a></li><li><a href=#bitbake--yocto>Bitbake (Yocto)</a></li></ul></li><li><a href=#git-and-vc>Git & VC</a><ul><li><a href=#magit>Magit</a><ul><li><a href=#granular-diff-highlights-for-all-hunks>Granular diff-highlights for <em>all</em> hunks</a></li><li><a href=#gravatars>Gravatars</a></li><li><a href=#wip-company-for-commit-messages>WIP Company for commit messages</a></li><li><a href=#pretty-graph>Pretty graph</a></li></ul></li><li><a href=#repo>Repo</a></li><li><a href=#blamer>Blamer</a></li></ul></li><li><a href=#assembly>Assembly</a></li><li><a href=#disaster>Disaster</a></li><li><a href=#devdocs>Devdocs</a></li><li><a href=#systemd>Systemd</a></li><li><a href=#pkgbuild>PKGBUILD</a></li><li><a href=#franca-idl>Franca IDL</a></li><li><a href=#latex>LaTeX</a></li><li><a href=#flycheck-plus-projectile>Flycheck + Projectile</a></li><li><a href=#graphviz>Graphviz</a></li><li><a href=#modula-ii>Modula-II</a></li><li><a href=#mermaid>Mermaid</a></li><li><a href=#the-v-programming-language>The V Programming Language</a></li><li><a href=#inspector>Inspector</a></li></ul></li><li><a href=#office>Office</a><ul><li><a href=#org-additional-packages>Org additional packages</a></li><li><a href=#org>Org mode</a><ul><li><a href=#intro>Intro</a></li><li><a href=#behavior>Behavior</a><ul><li><a href=#tweaking-defaults>Tweaking defaults</a><ul><li><a href=#org-basics>Org basics</a></li><li><a href=#babel>Babel</a></li><li><a href=#evil>EVIL</a></li></ul></li><li><a href=#todos>TODOs</a></li><li><a href=#tags>Tags</a></li><li><a href=#agenda>Agenda</a></li><li><a href=#super-agenda>Super agenda</a></li><li><a href=#calendar>Calendar</a><ul><li><a href=#google-calendar--org-gcal>Google calendar (<code>org-gcal</code>)</a></li><li><a href=#caldav>TODO CalDAV</a></li></ul></li><li><a href=#capture>Capture</a></li><li><a href=#snippet-helpers>Snippet Helpers</a></li><li><a href=#translate-capital-keywords-to-lower-case>Translate capital keywords to lower case</a></li><li><a href=#org-notifier>Org notifier</a></li><li><a href=#org-menu>Org menu</a></li><li><a href=#lsp-in-src-blocks>LSP in <code>src</code> blocks</a></li></ul></li><li><a href=#custom-links>Custom links</a><ul><li><a href=#sub-figures>Sub-figures</a></li><li><a href=#latex-inline-markup>LaTeX inline markup</a></li></ul></li><li><a href=#visuals>Visuals</a><ul><li><a href=#font-display>Font display</a><ul><li><a href=#headings>Headings</a></li><li><a href=#deadlines>Deadlines</a></li><li><a href=#font-styling>Font styling</a></li><li><a href=#inline-blocks>Inline blocks</a></li></ul></li><li><a href=#org-modern>Org Modern</a></li><li><a href=#image-previews>Image previews</a></li><li><a href=#list-bullet-sequence>List bullet sequence</a></li><li><a href=#symbols>Symbols</a></li><li><a href=#latex-fragments>LaTeX fragments</a><ul><li><a href=#prettier-highlighting>Prettier highlighting</a></li><li><a href=#prettier-rendering>Prettier rendering</a></li><li><a href=#better-equation-numbering>Better equation numbering</a></li><li><a href=#fragtog>Fragtog</a></li></ul></li><li><a href=#org-plot>Org plot</a></li><li><a href=#large-tables>Large tables</a></li></ul></li><li><a href=#bibliography>Bibliography</a><ul><li><a href=#bibtex>BibTeX</a></li><li><a href=#org-bib>Org-bib</a></li><li><a href=#org-cite>Org-cite</a></li><li><a href=#citar>Citar</a></li></ul></li><li><a href=#exporting>Exporting</a><ul><li><a href=#general-settings>General settings</a></li><li><a href=#latex-export>LaTeX export</a><ul><li><a href=#compiling>Compiling</a></li><li><a href=#org-latex-packages>Org LaTeX packages</a></li><li><a href=#export-pdfs-with-syntax-highlighting>Export PDFs with syntax highlighting</a></li><li><a href=#class-templates>Class templates</a></li><li><a href=#export-multi-files-org-documents>Export multi-files Org documents</a></li></ul></li><li><a href=#hugo>Hugo</a></li></ul></li></ul></li><li><a href=#text-editing>Text editing</a><ul><li><a href=#plain-text>Plain text</a></li><li><a href=#academic-phrases>Academic phrases</a></li><li><a href=#quarto>Quarto</a></li><li><a href=#french-apostrophes>French apostrophes</a></li><li><a href=#yanking-multi-lines-paragraphs>Yanking multi-lines paragraphs</a></li></ul></li></ul></li><li><a href=#system-configuration>System configuration</a><ul><li><a href=#mime-types>Mime types</a><ul><li><a href=#org-mode-files>Org mode files</a></li><li><a href=#registering-org-protocol>Registering <code>org-protocol://</code></a></li><li><a href=#configuring-chrome-brave>Configuring Chrome/Brave</a></li></ul></li><li><a href=#git>Git</a><ul><li><a href=#git-diffs>Git diffs</a></li><li><a href=#apache-tika-app-wrapper>Apache Tika App wrapper</a></li></ul></li><li><a href=#emacs-systemd-daemon>Emacs&rsquo; Systemd daemon</a></li><li><a href=#emacs-client>Emacs client</a><ul><li><a href=#desktop-integration>Desktop integration</a></li><li><a href=#command-line-wrapper>Command-line wrapper</a><ul><li><a href=#useful-aliases>Useful aliases</a></li></ul></li></ul></li><li><a href=#appimage>AppImage</a></li><li><a href=#oh-my-zsh>Oh-my-Zsh</a><ul><li><a href=#path>Path</a></li><li><a href=#themes-and-customization>Themes and customization:</a></li><li><a href=#behavior>Behavior</a></li><li><a href=#plugins>Plugins</a></li><li><a href=#bootstrap-oh-my-zsh>Bootstrap Oh-my-Zsh</a></li><li><a href=#aliases>Aliases</a></li></ul></li><li><a href=#zsh-user-configuration>Zsh user configuration</a><ul><li><a href=#pbcopy-and-pbpaste><code>pbcopy</code> and <code>pbpaste</code></a></li><li><a href=#netpaste><code>netpaste</code></a></li><li><a href=#sudo-gui>Sudo GUI!</a></li><li><a href=#neovim>Neovim</a></li><li><a href=#esp-idf>ESP-IDF</a></li><li><a href=#cli-wttrin-client>CLI wttrin client</a></li><li><a href=#minicom>Minicom</a></li><li><a href=#rust>Rust</a></li><li><a href=#clang-format>Clang-format</a></li><li><a href=#cmake>CMake</a></li><li><a href=#node>Node</a></li><li><a href=#tmux>tmux</a></li><li><a href=#other-stuff>Other stuff</a></li></ul></li><li><a href=#rust-format>Rust format</a></li><li><a href=#ecryptfs>eCryptfs</a><ul><li><a href=#unlock-and-mount-script>Unlock and mount script</a></li><li><a href=#desktop-integration>Desktop integration</a></li></ul></li><li><a href=#gdb>GDB</a><ul><li><a href=#early-init>Early init</a></li><li><a href=#init>Init</a></li></ul></li><li><a href=#gnupg>GnuPG</a></li><li><a href=#ocr-this>OCR This</a></li><li><a href=#arch-linux-packages>Arch Linux packages</a></li><li><a href=#kde-plasma>KDE Plasma</a></li></ul></li></ul><p></p><h2 id=this-repository>This repository</h2><p>This repository (<a href=https://github.com/abougouffa/dotfiles>abougouffa/dotfiles</a>) contains my configuration files for <strong>Zsh</strong>,
<strong>Emacs</strong>, <strong>Vim</strong>, <strong>Alacritty</strong> and other Linux related stuff.</p><p>If you want to reuse some of these configurations, you will need to modify some
directories and add some user specific information (usernames, passwords&mldr;)</p><p>This is the main configuration file <a href=https://github.com/abougouffa/dotfiles/dot_doom.d/config.org>.doom.d/config.org</a>, (available also as a <a href=https://raw.githubusercontent.com/abougouffa/dotfiles/main/dot_doom.d/config.pdf>PDF
file</a>), it contains the literal configuration for <a href=https://github.com/doomemacs/doomemacs>Doom Emacs</a>, and I use it to
generate some other user configuration files (define aliases, environment
variables, user tools, Git configuration&mldr;).</p><figure><img src=/ox-hugo/doom-emacs-gray.svg></figure><h3 id=how-to-install>How to install</h3><p>Since commit <a href=https://github.com/abougouffa/dotfiles/commit/55c928109e6198e48749acca9171cf70372ce806>55c92810</a>, I&rsquo;m using <a href=https://chezmoi.io>chezmoi</a> to manage my Dotfiles.</p><p>Now the Dotfiles can be installed using the following command; however, I don&rsquo;t
recommend installing all of my dotfiles, try instead to adapt them or to copy
some interesting chunks.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo pacman -S chezmoi
</span></span><span style=display:flex><span>chezmoi init --apply abougouffa
</span></span></code></pre></div><h3 id=emacs-stuff>Emacs stuff</h3><p>To use my Doom Emacs configuration, you need first to install <a href=https://github.com/doomemacs/doomemacs>Doom Emacs</a> to
<code>~/.config/emacs</code> or <code>.emacs.d</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git clone https://github.com/doomemacs/doomemacs.git ~/.config/emacs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>~/.config/emacs/bin/doom install
</span></span></code></pre></div><p>Until <a href=https://github.com/abougouffa/dotfiles/commit/12b3d20e19db4586b3a11e7b1ffe3772a0e17d14>12b3d20e</a>, I was using <a href=https://github.com/plexus/chemacs2>Chemacs2</a> to manage multiple Emacs profiles. Since
I&rsquo;m using only Doom Emacs and Doom recently introduced a <a href=https://github.com/doomemacs/doomemacs/commit/5b6b204bcbcf69d541c49ca55a2d5c3604f04dad>new feature to
bootstrap other Emacs configs</a>, so I switched to a plain Doom Emacs config.</p><h2 id=intro>Intro</h2><p>I&rsquo;ve been using Linux exclusively since 2010, <strong>GNU Emacs</strong> was always installed on
my machine, but I didn&rsquo;t discover the <strong>real</strong> Emacs until 2020, in the beginning, I
started my Vanilla Emacs configuration from scratch, but after a while, it
becomes a mess. As a new Emacs user, I didn&rsquo;t understand the in the beginning how
to optimize my configuration and how to do things correctly. I discovered then
<a href=https://github.com/syl20bnr/spacemacs>Spacemacs</a>, which made things much easier, but it was a little slow, and just
after, I found the awesome <a href=https://github.com/doomemacs/doomemacs>Doom Emacs</a>, and since, I didn&rsquo;t quit my Emacs screen!</p><p>In the beginning, I was basically copying chunks of Emacs Lisp code from the
internet, which quickly becomes a mess, specially because I was using a mixture
of vanilla Emacs style configurations and Doom style ones.</p><p>Now I decided to rewrite a cleaner version of my configuration which will be
more Doom friendly, and for that, I found an excellent example in <em><a href=https://github.com/tecosaur>tecosaur</a></em>&rsquo;s
<a href=https://github.com/tecosaur/emacs-config.git>emacs-config</a>, so my current configuration is heavily inspired by <em>tecosaur</em>&rsquo;s one.</p><h3 id=this-file>This file</h3><p>This is my literate configuration file, I use it to generate Doom&rsquo;s config files
(<code>$DOOMDIR/init.el</code>, <code>$DOOMDIR/packages.el</code> and <code>$DOOMDIR/config.el</code>), as well as some
other shell scripts, app installers, app launchers&mldr; etc.</p><p>Make <code>config.el</code> run (slightly) faster with lexical binding (see <a href=https://nullprogram.com/blog/2016/12/22/>this blog post</a>
for more info).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;; config.el -*- coding: utf-8-unix; lexical-binding: t; -*-</span>
</span></span></code></pre></div><p>Add the shebang and the description to the <code>setup.sh</code> file, which will be used to
set system settings and install some missing dependencies.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># This is an automatically generated setup file, it installes some missing</span>
</span></span><span style=display:flex><span><span style=color:#75715e># dependencies, configure system services, set system settings form better</span>
</span></span><span style=display:flex><span><span style=color:#75715e># desktop integration... etc.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Abdelhak BOUGOUFFA (c) 2022</span>
</span></span></code></pre></div><p>Add an initial comment to the <code>~/.zshrc</code> file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># -*- mode: sh; -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># This file is automatically generated from my Org literate configuration.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Abdelhak BOUGOUFFA (c) 2022</span>
</span></span></code></pre></div><h2 id=doom-configuration-files>Doom configuration files</h2><h3 id=pseudo-early-init>Pseudo early-init</h3><p>This file will be loaded before the content of Doom&rsquo;s private <code>init.el</code>, I add
some special stuff which I want to load very early.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;; pseudo-early-init.el -*- coding: utf-8-unix; lexical-binding: t; -*-</span>
</span></span></code></pre></div><h4 id=useful-functions>Useful functions</h4><p>Here we define some useful functions, some of them are available via other
packages like <code>cl-lib</code>, <code>dash.el</code> or <code>s.el</code>, but I don&rsquo;t like to load too much third
party libraries, particulary in early stage, so let&rsquo;s define here.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;; === Primitives ===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (+bool &#34;someval&#34;) ;; ==&gt; t</span>
</span></span><span style=display:flex><span>(defun +bool (val) (not (<span style=color:#a6e22e>null</span> val)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;; === Higher order functions ===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (+foldr (lambda (a b) (message &#34;(%d + %d)&#34; a b) (+ a b)) 0 &#39;(1 2 3 4 5)) ;; ==&gt; 15</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (5 + 0) -&gt; (4 + 5) -&gt; (3 + 9) -&gt; (2 + 12) --&gt; (1 + 14)</span>
</span></span><span style=display:flex><span>(defun +foldr (fun acc seq)
</span></span><span style=display:flex><span>  (if (<span style=color:#a6e22e>null</span> seq) acc
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>funcall</span> fun (<span style=color:#a6e22e>car</span> seq) (+foldr fun acc (<span style=color:#a6e22e>cdr</span> seq)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (+foldl (lambda (a b) (message &#34;(%d + %d)&#34; a b) (+ a b)) 0 &#39;(1 2 3 4 5)) ;; ==&gt; 15</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (0 + 1) -&gt; (1 + 2) -&gt; (3 + 3) -&gt; (6 + 4) -&gt; (10 + 5)</span>
</span></span><span style=display:flex><span>(defun +foldl (fun acc seq)
</span></span><span style=display:flex><span>  (if (<span style=color:#a6e22e>null</span> seq) acc
</span></span><span style=display:flex><span>    (+foldl fun (<span style=color:#a6e22e>funcall</span> fun acc (<span style=color:#a6e22e>car</span> seq)) (<span style=color:#a6e22e>cdr</span> seq))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (+all &#39;(83 88 t &#34;txt&#34;)) ;; ==&gt; t</span>
</span></span><span style=display:flex><span>(defun +all (seq)
</span></span><span style=display:flex><span>  (+foldr (lambda (r l) (and r l)) <span style=color:#66d9ef>t</span> seq))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (+some &#39;(nil nil &#34;text&#34; nil 2)) ;; ==&gt; t</span>
</span></span><span style=display:flex><span>(defun +some (seq)
</span></span><span style=display:flex><span>  (+bool (+foldr (lambda (r l) (or r l)) <span style=color:#66d9ef>nil</span> seq)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (+filter &#39;stringp &#39;(&#34;A&#34; 2 &#34;C&#34; nil 3)) ;; ==&gt; (&#34;A&#34; &#34;C&#34;)</span>
</span></span><span style=display:flex><span>(defun +filter (fun seq)
</span></span><span style=display:flex><span>  (when seq
</span></span><span style=display:flex><span>    (let ((head (<span style=color:#a6e22e>car</span> seq))
</span></span><span style=display:flex><span>          (tail (<span style=color:#a6e22e>cdr</span> seq)))
</span></span><span style=display:flex><span>      (if (<span style=color:#a6e22e>funcall</span> fun head)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>cons</span> head (+filter fun tail))
</span></span><span style=display:flex><span>        (+filter fun tail)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (+zip &#39;(1 2 3 4) &#39;(a b c d) &#39;(&#34;A&#34; &#34;B&#34; &#34;C&#34; &#34;D&#34;)) ;; ==&gt; ((1 a &#34;A&#34;) (2 b &#34;B&#34;) (3 c &#34;C&#34;) (4 d &#34;D&#34;))</span>
</span></span><span style=display:flex><span>(defun +zip (<span style=color:#66d9ef>&amp;rest</span> seqs)
</span></span><span style=display:flex><span>  (if (<span style=color:#a6e22e>null</span> (<span style=color:#a6e22e>car</span> seqs)) <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>cons</span> (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;car</span> seqs)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>apply</span> <span style=color:#a6e22e>#&#39;</span>+zip (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;cdr</span> seqs)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;; === Strings ===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (+str-join &#34;, &#34; &#39;(&#34;foo&#34; &#34;10&#34; &#34;bar&#34;)) ;; ==&gt; &#34;foo, 10, bar&#34;</span>
</span></span><span style=display:flex><span>(defun +str-join (sep seq)
</span></span><span style=display:flex><span>  (+foldl (lambda (l r) (<span style=color:#a6e22e>concat</span> l sep r))
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>car</span> seq) (<span style=color:#a6e22e>cdr</span> seq)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (+str-split &#34;foo, 10, bar&#34; &#34;, &#34;) ;; ==&gt; (&#34;foo&#34; &#34;10&#34; &#34;bar&#34;)</span>
</span></span><span style=display:flex><span>(defun +str-split (str sep)
</span></span><span style=display:flex><span>  (let ((s (string-search sep str)))
</span></span><span style=display:flex><span>    (if s (<span style=color:#a6e22e>cons</span> (<span style=color:#a6e22e>substring</span> str <span style=color:#ae81ff>0</span> s)
</span></span><span style=display:flex><span>                (+str-split (<span style=color:#a6e22e>substring</span> str (<span style=color:#a6e22e>+</span> s (<span style=color:#a6e22e>length</span> sep))) sep))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>list</span> str))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +str-replace (old new s)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Replaces OLD with NEW in S.&#34;</span>
</span></span><span style=display:flex><span>  (replace-regexp-in-string (<span style=color:#a6e22e>regexp-quote</span> old) new s <span style=color:#66d9ef>t</span> <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +str-replace-all (replacements s)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;REPLACEMENTS is a list of cons-cells. Each `car` is replaced with `cdr` in S.&#34;</span>
</span></span><span style=display:flex><span>  (replace-regexp-in-string (regexp-opt (<span style=color:#a6e22e>mapcar</span> <span style=color:#e6db74>&#39;car</span> replacements))
</span></span><span style=display:flex><span>                            (lambda (it) (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc-string</span> it replacements)))
</span></span><span style=display:flex><span>                            s <span style=color:#66d9ef>t</span> <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;; === Files, IO ===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +file-mime-type (file)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Get MIME type for FILE based on magic codes provided by the &#39;file&#39; command.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Return a symbol of the MIME type, ex: </span><span style=color:#e6db74>`text/x-lisp&#39;</span><span style=color:#e6db74>, </span><span style=color:#e6db74>`text/plain&#39;</span><span style=color:#e6db74>,
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#e6db74>`application/x-object&#39;</span><span style=color:#e6db74>, </span><span style=color:#e6db74>`application/octet-stream&#39;</span><span style=color:#e6db74>, etc.&#34;</span>
</span></span><span style=display:flex><span>  (let ((mime-type (shell-command-to-string (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;file --brief --mime-type %s&#34;</span> file))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>intern</span> (string-trim-right mime-type))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +file-name-incremental (filename)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Return an unique file name for FILENAME.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>If \&#34;file.ext\&#34; exists, returns \&#34;file-0.ext\&#34;.&#34;</span>
</span></span><span style=display:flex><span>  (let* ((ext (file-name-extension filename))
</span></span><span style=display:flex><span>         (dir (<span style=color:#a6e22e>file-name-directory</span> filename))
</span></span><span style=display:flex><span>         (file (file-name-base filename))
</span></span><span style=display:flex><span>         (filename-regex (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;^&#34;</span> file <span style=color:#e6db74>&#34;\\(?:-\\(?1:[[:digit:]]+\\)\\)?&#34;</span> (if ext (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;\\.&#34;</span> ext) <span style=color:#e6db74>&#34;&#34;</span>)))
</span></span><span style=display:flex><span>         (last-file (<span style=color:#a6e22e>car</span> (last (<span style=color:#a6e22e>directory-files</span> dir <span style=color:#66d9ef>nil</span> filename-regex))))
</span></span><span style=display:flex><span>         (last-file-num (when (and last-file (<span style=color:#a6e22e>string-match</span> filename-regex last-file) (match-string <span style=color:#ae81ff>1</span> last-file))))
</span></span><span style=display:flex><span>         (num (<span style=color:#a6e22e>1+</span> (<span style=color:#a6e22e>string-to-number</span> (or last-file-num <span style=color:#e6db74>&#34;-1&#34;</span>))))
</span></span><span style=display:flex><span>         (filename (file-name-concat dir (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;%s%s%s&#34;</span> file (if last-file (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;-%d&#34;</span> num) <span style=color:#e6db74>&#34;&#34;</span>) (if ext (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;.&#34;</span> ext) <span style=color:#e6db74>&#34;&#34;</span>)))))
</span></span><span style=display:flex><span>    filename))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +file-read-to-string (filename)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Return a string with the contents of FILENAME.&#34;</span>
</span></span><span style=display:flex><span>  (when (and (<span style=color:#a6e22e>file-exists-p</span> filename) (not (<span style=color:#a6e22e>file-directory-p</span> filename)))
</span></span><span style=display:flex><span>    (with-temp-buffer
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>insert-file-contents</span> filename)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>buffer-string</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;; === Systemd ===</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +systemd-running-p (service)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Check if the systemd SERVICE is running.&#34;</span>
</span></span><span style=display:flex><span>  (zerop (<span style=color:#a6e22e>call-process</span> <span style=color:#e6db74>&#34;systemctl&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#34;--user&#34;</span> <span style=color:#e6db74>&#34;is-active&#34;</span> <span style=color:#e6db74>&#34;--quiet&#34;</span> service <span style=color:#e6db74>&#34;.service&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +systemd-command (service command <span style=color:#66d9ef>&amp;optional</span> pre-fn post-fn)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Call systemd with COMMAND and SERVICE.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (when pre-fn (<span style=color:#a6e22e>funcall</span> pre-fn))
</span></span><span style=display:flex><span>  (let ((success (zerop (<span style=color:#a6e22e>call-process</span> <span style=color:#e6db74>&#34;systemctl&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#34;--user&#34;</span> command service <span style=color:#e6db74>&#34;.service&#34;</span>))))
</span></span><span style=display:flex><span>    (unless success
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;[systemd]: Failed on calling &#39;%s&#39; on service %s.service.&#34;</span> command service))
</span></span><span style=display:flex><span>    (when post-fn (<span style=color:#a6e22e>funcall</span> post-fn success))
</span></span><span style=display:flex><span>    success))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +systemd-start (service <span style=color:#66d9ef>&amp;optional</span> pre-fn post-fn)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Start systemd SERVICE.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (+systemd-command service <span style=color:#e6db74>&#34;start&#34;</span> pre-fn post-fn))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +systemd-stop (service <span style=color:#66d9ef>&amp;optional</span> pre-fn post-fn)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Stops the systemd SERVICE.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (+systemd-command service <span style=color:#e6db74>&#34;stop&#34;</span> pre-fn post-fn))
</span></span></code></pre></div><h4 id=fixes>Fixes</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Fixes to apply early</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(when (<span style=color:#a6e22e>daemonp</span>)
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; When starting Emacs in daemon mode,</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; I need to have a valid passphrase in the gpg-agent.</span>
</span></span><span style=display:flex><span>  (let ((try-again <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>        unlocked)
</span></span><span style=display:flex><span>    (while (not (or unlocked (zerop try-again)))
</span></span><span style=display:flex><span>      (setq unlocked (zerop (shell-command <span style=color:#e6db74>&#34;gpg -q --no-tty --logger-file /dev/null --batch -d ~/.authinfo.gpg &gt; /dev/null&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>            try-again (<span style=color:#a6e22e>1-</span> try-again))
</span></span><span style=display:flex><span>      (unless unlocked
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;GPG: failed to unlock, please try again (%d)&#34;</span> try-again)))
</span></span><span style=display:flex><span>    (unless unlocked <span style=color:#75715e>;; Exit Emacs, systemd will restart it</span>
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>kill-emacs</span> <span style=color:#ae81ff>1</span>))))
</span></span></code></pre></div><h4 id=check-for-external-tools>Check for external tools</h4><p>Some added packages require external tools, I like to check for these tools and
store the result in global constants.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defconst EAF-DIR (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;eaf/eaf-repo&#34;</span> doom-data-dir))
</span></span><span style=display:flex><span>(defconst IS-LUCID (string-search <span style=color:#e6db74>&#34;LUCID&#34;</span> system-configuration-features))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defconst AG-P (executable-find <span style=color:#e6db74>&#34;ag&#34;</span>))
</span></span><span style=display:flex><span>(defconst EAF-P (and (not IS-LUCID) (<span style=color:#a6e22e>file-directory-p</span> EAF-DIR)))
</span></span><span style=display:flex><span>(defconst MPD-P (+all (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;</span>executable-find <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;mpc&#34;</span> <span style=color:#e6db74>&#34;mpd&#34;</span>))))
</span></span><span style=display:flex><span>(defconst MPV-P (executable-find <span style=color:#e6db74>&#34;mpv&#34;</span>))
</span></span><span style=display:flex><span>(defconst REPO-P (executable-find <span style=color:#e6db74>&#34;repo&#34;</span>))
</span></span><span style=display:flex><span>(defconst FRICAS-P (and (executable-find <span style=color:#e6db74>&#34;fricas&#34;</span>) (<span style=color:#a6e22e>file-directory-p</span> <span style=color:#e6db74>&#34;/usr/lib/fricas/emacs&#34;</span>)))
</span></span><span style=display:flex><span>(defconst MAXIMA-P (executable-find <span style=color:#e6db74>&#34;maxima&#34;</span>))
</span></span><span style=display:flex><span>(defconst TUNTOX-P (executable-find <span style=color:#e6db74>&#34;tuntox&#34;</span>))
</span></span><span style=display:flex><span>(defconst QUARTO-P (executable-find <span style=color:#e6db74>&#34;quarto&#34;</span>))
</span></span><span style=display:flex><span>(defconst ROSBAG-P (executable-find <span style=color:#e6db74>&#34;rosbag&#34;</span>))
</span></span><span style=display:flex><span>(defconst ZOTERO-P (executable-find <span style=color:#e6db74>&#34;zotero&#34;</span>))
</span></span><span style=display:flex><span>(defconst CHEZMOI-P (executable-find <span style=color:#e6db74>&#34;chezmoi&#34;</span>))
</span></span><span style=display:flex><span>(defconst OBJDUMP-P (executable-find <span style=color:#e6db74>&#34;objdump&#34;</span>))
</span></span><span style=display:flex><span>(defconst STUNNEL-P (executable-find <span style=color:#e6db74>&#34;stunnel&#34;</span>))
</span></span><span style=display:flex><span>(defconst ECRYPTFS-P (+all (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;</span>executable-find <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;ecryptfs-add-passphrase&#34;</span> <span style=color:#e6db74>&#34;/sbin/mount.ecryptfs_private&#34;</span>))))
</span></span><span style=display:flex><span>(defconst BITWARDEN-P (executable-find <span style=color:#e6db74>&#34;bw&#34;</span>))
</span></span><span style=display:flex><span>(defconst YOUTUBE-DL-P (+some (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;</span>executable-find <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;yt-dlp&#34;</span> <span style=color:#e6db74>&#34;youtube-dl&#34;</span>))))
</span></span><span style=display:flex><span>(defconst NETEXTENDER-P (and (executable-find <span style=color:#e6db74>&#34;netExtender&#34;</span>) (+all (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;file-exists-p</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;~/.local/bin/netextender&#34;</span> <span style=color:#e6db74>&#34;~/.ssh/sslvpn.gpg&#34;</span>)))))
</span></span><span style=display:flex><span>(defconst CLANG-FORMAT-P (executable-find <span style=color:#e6db74>&#34;clang-format&#34;</span>))
</span></span><span style=display:flex><span>(defconst LANGUAGETOOL-P (executable-find <span style=color:#e6db74>&#34;languagetool&#34;</span>))
</span></span></code></pre></div><h3 id=doom-modules--init-dot-el>Doom modules (<code>init.el</code>)</h3><p>Here is the literate configuration which generates the Doom&rsquo;s <code>init.el</code> file, this
file contains all the enabled Doom modules with the appropriate flags.</p><p>This section defines the default source blocks arguments
. All source blocks in this section
inherits these headers, so they will not be tangled unless overwriting in the
block&rsquo;s header.</p><h4 id=file-skeleton>File skeleton</h4><p>This first section defines the template for the subsections, it uses the <code>no-web</code>
syntax to include subsections specified as <code>&lt;&lt;sub-section-name>></code>.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;; init.el -*- coding: utf-8-unix; lexical-binding: t; -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; This file controls what Doom modules are enabled and what order they load in.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Press &#39;K&#39; on a module to view its documentation, and &#39;gd&#39; to browse its directory.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; I add some special stuff wich I want to load very early.</span>
</span></span><span style=display:flex><span>(load! <span style=color:#e6db74>&#34;pseudo-early-init.el&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(doom!
</span></span><span style=display:flex><span>  :input
</span></span><span style=display:flex><span>  &lt;&lt;doom-input&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :completion
</span></span><span style=display:flex><span>  &lt;&lt;doom-completion&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :ui
</span></span><span style=display:flex><span>  &lt;&lt;doom-ui&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :editor
</span></span><span style=display:flex><span>  &lt;&lt;doom-editor&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :emacs
</span></span><span style=display:flex><span>  &lt;&lt;doom-emacs&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :term
</span></span><span style=display:flex><span>  &lt;&lt;doom-term&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :checkers
</span></span><span style=display:flex><span>  &lt;&lt;doom-checkers&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :tools
</span></span><span style=display:flex><span>  &lt;&lt;doom-tools&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :os
</span></span><span style=display:flex><span>  &lt;&lt;doom-os&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :lang
</span></span><span style=display:flex><span>  &lt;&lt;doom-lang&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :email
</span></span><span style=display:flex><span>  &lt;&lt;doom-email&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :app
</span></span><span style=display:flex><span>  &lt;&lt;doom-app&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  &lt;&lt;doom-config&gt;&gt;
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h4 id=input--input>Input (<code>:input</code>)</h4><p>Enable bidirectional languages support (<code>bidi</code>).</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>bidi
</span></span></code></pre></div><h4 id=general--config>General (<code>:config</code>)</h4><p>Enable <code>literate</code> configuration (like this file!), and some defaults.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>literate
</span></span><span style=display:flex><span>(default +bindings +smartparens)
</span></span></code></pre></div><h4 id=completion--completion>Completion (<code>:completion</code>)</h4><p>I&rsquo;m lazy, I like Emacs to complete my writings.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(vertico +icons)
</span></span><span style=display:flex><span>(company +childframe)
</span></span></code></pre></div><h4 id=user-interface--ui>User interface (<code>:ui</code>)</h4><p>Enables some user interface features for better user experience, the beautiful
<code>modeline</code>, the <code>treemacs</code> project tree, better version control integration with
<code>vc-gutter</code>&mldr; and other useful stuff.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>zen
</span></span><span style=display:flex><span>deft
</span></span><span style=display:flex><span>doom
</span></span><span style=display:flex><span>hydra
</span></span><span style=display:flex><span>hl-todo
</span></span><span style=display:flex><span>ophints
</span></span><span style=display:flex><span>modeline
</span></span><span style=display:flex><span>nav-flash
</span></span><span style=display:flex><span>workspaces
</span></span><span style=display:flex><span>indent-guides
</span></span><span style=display:flex><span>doom-dashboard
</span></span><span style=display:flex><span>(treemacs +lsp)
</span></span><span style=display:flex><span>(ligatures +extra)
</span></span><span style=display:flex><span>(popup +all +defaults)
</span></span><span style=display:flex><span>(emoji +ascii +github)
</span></span><span style=display:flex><span>(window-select +numbers)
</span></span><span style=display:flex><span>(vc-gutter +diff-hl +pretty)
</span></span></code></pre></div><h4 id=editor--editor>Editor (<code>:editor</code>)</h4><p>Some editing modules, the most important feature is EVIL to enable Vim style
editing in Emacs. I like also to edit with multiple cursors, enable <code>yasnippet</code>
support, wrap long lines, auto format support.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(evil +everywhere)
</span></span><span style=display:flex><span>file-templates
</span></span><span style=display:flex><span>fold
</span></span><span style=display:flex><span><span style=color:#a6e22e>format</span>
</span></span><span style=display:flex><span>multiple-cursors
</span></span><span style=display:flex><span>parinfer
</span></span><span style=display:flex><span>snippets
</span></span><span style=display:flex><span>word-wrap
</span></span></code></pre></div><h4 id=emacs-builtin-stuff--emacs>Emacs builtin stuff (<code>:emacs</code>)</h4><p>Beautify Emacs builtin packages.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(dired +dirvish +icons)
</span></span><span style=display:flex><span>(ibuffer +icons)
</span></span><span style=display:flex><span>undo
</span></span><span style=display:flex><span>vc
</span></span></code></pre></div><h4 id=terminals--term>Terminals (<code>:term</code>)</h4><p>Run commands in terminal from Emacs. I use mainly <code>vterm</code> on my local machine,
however, I like to have <code>eshell</code>, <code>shell</code> and <code>term</code> installed to use them for remote
file editing (via Tramp).</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>eshell
</span></span><span style=display:flex><span>vterm
</span></span><span style=display:flex><span>shell
</span></span><span style=display:flex><span>term
</span></span></code></pre></div><h4 id=checkers--checkers>Checkers (<code>:checkers</code>)</h4><p>I like to check my documents for errors while I&rsquo;m typing. The <code>grammar</code> module
enables <a href=https://languagetool.org/>LanguageTool</a> support.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(syntax +childframe)
</span></span><span style=display:flex><span>(spell +aspell)
</span></span><span style=display:flex><span>(grammar +lsp)
</span></span></code></pre></div><h4 id=tools--tools>Tools (<code>:tools</code>)</h4><p>I enable some useful tools which facilitate my work flow, I like to enable
Docker support, <a href=https://editorconfig.org>EditorConfig</a> is a good feature to have. I like to enable
<code>lsp-mode</code> and <code>dap-mode</code> for coding and debugging by enabling the <code>lsp</code> and <code>debugger</code>
modules with <code>+lsp</code> support (further customization for <code>lsp</code> and <code>dap</code> below). <code>pdf</code>
adds support through <code>pdf-tools</code>, which are great for viewing PDF files inside
Emacs, I also enable some extra tools, like <code>magit</code>, <code>lookup</code>, <code>tmux</code>&mldr; etc.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>ein
</span></span><span style=display:flex><span>pdf
</span></span><span style=display:flex><span>rgb
</span></span><span style=display:flex><span>gist
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>tmux
</span></span><span style=display:flex><span>direnv
</span></span><span style=display:flex><span>upload
</span></span><span style=display:flex><span>biblio
</span></span><span style=display:flex><span>tree-sitter
</span></span><span style=display:flex><span>editorconfig
</span></span><span style=display:flex><span>(lsp +peek)
</span></span><span style=display:flex><span>(docker +lsp)
</span></span><span style=display:flex><span>(magit +forge)
</span></span><span style=display:flex><span>(debugger +lsp)
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>eval</span> +overlay)
</span></span><span style=display:flex><span>(lookup +docsets +dictionary +offline)
</span></span></code></pre></div><h4 id=operating-system--os>Operating system (<code>:os</code>)</h4><p>I enable <code>tty</code> for better support of terminal editing.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(tty +osc)
</span></span></code></pre></div><h4 id=language-support--lang>Language support (<code>:lang</code>)</h4><p>Most of the projects I&rsquo;m working on are mainly written in C/C++, Python, Rust
and some Lisp stuff, I edit also a lot of configuration and data files in
several formats (<code>csv</code>, <code>yaml</code>, <code>xml</code>, <code>json</code>, <code>shell</code> scripts&mldr;). I use Org-mode to
manage all my papers and notes, so I need to enable as many features as I need,
I do enable <code>plantuml</code> also to quickly plot UML models withing Org documents.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>qt
</span></span><span style=display:flex><span>data
</span></span><span style=display:flex><span>plantuml
</span></span><span style=display:flex><span>emacs-lisp
</span></span><span style=display:flex><span>common-lisp
</span></span><span style=display:flex><span>(ess +lsp)
</span></span><span style=display:flex><span>(yaml +lsp)
</span></span><span style=display:flex><span>(markdown +grip)
</span></span><span style=display:flex><span>(csharp +dotnet)
</span></span><span style=display:flex><span>(racket +lsp +xp)
</span></span><span style=display:flex><span>(lua +lsp +fennel)
</span></span><span style=display:flex><span>(web +tree-sitter)
</span></span><span style=display:flex><span>(cc +lsp +tree-sitter)
</span></span><span style=display:flex><span>(sh +lsp +tree-sitter)
</span></span><span style=display:flex><span>(json +lsp +tree-sitter)
</span></span><span style=display:flex><span>(rust +lsp +tree-sitter)
</span></span><span style=display:flex><span>(julia +lsp +tree-sitter)
</span></span><span style=display:flex><span>(latex +lsp +latexmk)
</span></span><span style=display:flex><span>(python +lsp +pyenv +pyright +tree-sitter)
</span></span><span style=display:flex><span>(scheme +chez +mit +chicken +gauche +guile +chibi)
</span></span><span style=display:flex><span>(org +dragndrop +gnuplot +jupyter +pandoc +noter +journal +hugo +present +pomodoro +roam2)
</span></span></code></pre></div><h4 id=email--email>Email (<code>:email</code>)</h4><p>I like to use <code>mu4e</code> to manage mail mailboxes. The <code>+org</code> flag adds <code>org-msg</code> support
and <code>+gmail</code> adds better management of Gmail accounts.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(:if (executable-find <span style=color:#e6db74>&#34;mu&#34;</span>) (mu4e +org +gmail))
</span></span></code></pre></div><h4 id=apps--app>Apps (<code>:app</code>)</h4><p>Emacs contains a ton of applications, some of them are supported by Doom, I like
to use Emacs manage my calendar, chat on IRC, and receive news. I do use EMMS
sometimes to play music without leaving Emacs, and I like to enable support for
<code>emacs-everywhere</code>.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>calendar
</span></span><span style=display:flex><span>irc
</span></span><span style=display:flex><span>emms
</span></span><span style=display:flex><span>everywhere
</span></span><span style=display:flex><span>rss
</span></span></code></pre></div><h3 id=additional-packages--packages-dot-el>Additional packages (<code>packages.el</code>)</h3><p>This section generates Doom&rsquo;s <code>packages.el</code>, with the associated configurations
(<code>use-package!</code> blocks).</p><p>This file shouldn&rsquo;t be byte compiled.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; -*- coding: utf-8-unix; no-byte-compile: t; -*-</span>
</span></span></code></pre></div><h2 id=general-emacs-settings>General Emacs settings</h2><h3 id=user-information>User information</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq <span style=color:#a6e22e>user-full-name</span> <span style=color:#e6db74>&#34;Abdelhak Bougouffa&#34;</span>
</span></span><span style=display:flex><span>      user-mail-address <span style=color:#e6db74>&#34;abougouffa@fedoraproject.org&#34;</span>)
</span></span></code></pre></div><h3 id=common-variables>Common variables</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar +my/lang-mother-tongue <span style=color:#e6db74>&#34;ar&#34;</span>)
</span></span><span style=display:flex><span>(defvar +my/lang-main          <span style=color:#e6db74>&#34;en&#34;</span>)
</span></span><span style=display:flex><span>(defvar +my/lang-secondary     <span style=color:#e6db74>&#34;fr&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar +my/biblio-libraries-list (<span style=color:#a6e22e>list</span> (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~/Zotero/library.bib&#34;</span>)))
</span></span><span style=display:flex><span>(defvar +my/biblio-storage-list   (<span style=color:#a6e22e>list</span> (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~/Zotero/storage/&#34;</span>)))
</span></span><span style=display:flex><span>(defvar +my/biblio-notes-path     (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~/PhD/bibliography/notes/&#34;</span>))
</span></span><span style=display:flex><span>(defvar +my/biblio-styles-path    (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~/Zotero/styles/&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Set it early, to avoid creating &#34;~/org&#34; at startup</span>
</span></span><span style=display:flex><span>(setq org-directory <span style=color:#e6db74>&#34;~/Dropbox/Org&#34;</span>)
</span></span></code></pre></div><h3 id=secrets>Secrets</h3><p>Set the path to my GPG encrypted secrets. I like to set the cache expiry to <code>nil</code>
instead of the default 2 hours.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq auth-sources <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;~/.authinfo.gpg&#34;</span>)
</span></span><span style=display:flex><span>      auth-source-do-cache <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      auth-source-cache-expiry <span style=color:#ae81ff>86400</span> <span style=color:#75715e>; All day, defaut is 2h (7200)</span>
</span></span><span style=display:flex><span>      password-cache <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      password-cache-expiry <span style=color:#ae81ff>86400</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(after! epa
</span></span><span style=display:flex><span>  (setq-default epa-file-encrypt-to <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;F808A020A3E1AC37&#34;</span>)))
</span></span></code></pre></div><h3 id=better-defaults>Better defaults</h3><h4 id=file-deletion>File deletion</h4><p>Delete files by moving them to trash.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq-default delete-by-moving-to-trash <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>              trash-directory <span style=color:#66d9ef>nil</span>) <span style=color:#75715e>;; Use freedesktop.org trashcan</span>
</span></span></code></pre></div><h4 id=window>Window</h4><p>Take new window space from all other windows (not just current).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq-default window-combination-resize <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h5 id=split-defaults>Split defaults</h5><p>Split horizontally to right, vertically below the current window.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq evil-vsplit-window-right <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      evil-split-window-below <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><p>Show list of buffers when splitting.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defadvice! prompt-for-buffer (<span style=color:#66d9ef>&amp;rest</span> _)
</span></span><span style=display:flex><span>  :after <span style=color:#f92672>&#39;</span>(evil-window-split evil-window-vsplit)
</span></span><span style=display:flex><span>  (consult-buffer))
</span></span></code></pre></div><h4 id=messages-buffer>Messages buffer</h4><p>Stick to buffer tail, useful with <code>*Messages*</code> buffer. Derived from <a href=https://stackoverflow.com/a/6341139/3058915>this answer</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar +messages--auto-tail-enabled <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +messages--auto-tail-a (<span style=color:#66d9ef>&amp;rest</span> arg)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Make *Messages* buffer auto-scroll to the end after each message.&#34;</span>
</span></span><span style=display:flex><span>  (let* ((buf-name (<span style=color:#a6e22e>buffer-name</span> (messages-buffer)))
</span></span><span style=display:flex><span>         <span style=color:#75715e>;; Create *Messages* buffer if it does not exist</span>
</span></span><span style=display:flex><span>         (buf (<span style=color:#a6e22e>get-buffer-create</span> buf-name)))
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Activate this advice only if the point is _not_ in the *Messages* buffer</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; to begin with. This condition is required; otherwise you will not be</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; able to use `isearch&#39; and other stuff within the *Messages* buffer as</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; the point will keep moving to the end of buffer :P</span>
</span></span><span style=display:flex><span>    (when (not (string= buf-name (<span style=color:#a6e22e>buffer-name</span>)))
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; Go to the end of buffer in all *Messages* buffer windows that are</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; *live* (`get-buffer-window-list&#39; returns a list of only live windows).</span>
</span></span><span style=display:flex><span>      (dolist (win (get-buffer-window-list buf-name <span style=color:#66d9ef>nil</span> :all-frames))
</span></span><span style=display:flex><span>        (with-selected-window win
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-max</span>))))
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; Go to the end of the *Messages* buffer even if it is not in one of</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; the live windows.</span>
</span></span><span style=display:flex><span>      (with-current-buffer buf
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-max</span>))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +messages-auto-tail-toggle ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Auto tail the &#39;*Messages*&#39; buffer.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (if +messages--auto-tail-enabled
</span></span><span style=display:flex><span>      (progn
</span></span><span style=display:flex><span>        (advice-remove <span style=color:#e6db74>&#39;message</span> <span style=color:#e6db74>&#39;+messages--auto-tail-a</span>)
</span></span><span style=display:flex><span>        (setq +messages--auto-tail-enabled <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;+messages-auto-tail: Disabled.&#34;</span>))
</span></span><span style=display:flex><span>    (advice-add <span style=color:#e6db74>&#39;message</span> :after <span style=color:#e6db74>&#39;+messages--auto-tail-a</span>)
</span></span><span style=display:flex><span>    (setq +messages--auto-tail-enabled <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;+messages-auto-tail: Enabled.&#34;</span>)))
</span></span></code></pre></div><h4 id=undo-and-auto-save>Undo and auto-save</h4><h5 id=auto-save>Auto-save</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! super-save
</span></span><span style=display:flex><span>  :disable <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! super-save
</span></span><span style=display:flex><span>  :ensure <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq auto-save-default <span style=color:#66d9ef>t</span> <span style=color:#75715e>;; nil to switch off the built-in `auto-save-mode&#39;, maybe leave it t to have a backup!</span>
</span></span><span style=display:flex><span>        super-save-exclude <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;.gpg&#34;</span>)
</span></span><span style=display:flex><span>        super-save-remote-files <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        super-save-auto-save-when-idle <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>  (super-save-mode <span style=color:#ae81ff>+1</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq auto-save-default <span style=color:#66d9ef>t</span>) <span style=color:#75715e>;; enable built-in `auto-save-mode&#39;</span>
</span></span></code></pre></div><h5 id=undo>Undo</h5><p>Tweak <code>undo-fu</code> and other stuff from Doom&rsquo;s <code>:emacs undo</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Increase undo history limits even more</span>
</span></span><span style=display:flex><span>(after! undo-fu
</span></span><span style=display:flex><span>  (setq undo-limit        <span style=color:#ae81ff>10000000</span>     <span style=color:#75715e>;; 1MB   (default is 160kB, Doom&#39;s default is 400kB)</span>
</span></span><span style=display:flex><span>        undo-strong-limit <span style=color:#ae81ff>100000000</span>    <span style=color:#75715e>;; 100MB (default is 240kB, Doom&#39;s default is 3MB)</span>
</span></span><span style=display:flex><span>        undo-outer-limit  <span style=color:#ae81ff>1000000000</span>)) <span style=color:#75715e>;; 1GB   (default is 24MB,  Doom&#39;s default is 48MB)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(after! evil
</span></span><span style=display:flex><span>  (setq evil-want-fine-undo <span style=color:#66d9ef>t</span>)) <span style=color:#75715e>;; By default while in insert all changes are one big blob</span>
</span></span></code></pre></div><h5 id=visual-undo--vundo>Visual Undo (<code>vundo</code>)</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! vundo
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;casouri/vundo&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! vundo
</span></span><span style=display:flex><span>  :defer <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (defconst +vundo-unicode-symbols
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>((selected-node   <span style=color:#f92672>.</span> <span style=color:#e6db74>?●</span>)
</span></span><span style=display:flex><span>     (node            <span style=color:#f92672>.</span> <span style=color:#e6db74>?○</span>)
</span></span><span style=display:flex><span>     (vertical-stem   <span style=color:#f92672>.</span> <span style=color:#e6db74>?│</span>)
</span></span><span style=display:flex><span>     (branch          <span style=color:#f92672>.</span> <span style=color:#e6db74>?├</span>)
</span></span><span style=display:flex><span>     (last-branch     <span style=color:#f92672>.</span> <span style=color:#e6db74>?╰</span>)
</span></span><span style=display:flex><span>     (horizontal-stem <span style=color:#f92672>.</span> <span style=color:#e6db74>?─</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :leader
</span></span><span style=display:flex><span>        (:prefix (<span style=color:#e6db74>&#34;o&#34;</span>)
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;vundo&#34;</span> <span style=color:#e6db74>&#34;v&#34;</span> <span style=color:#a6e22e>#&#39;</span>vundo))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq vundo-glyph-alist +vundo-unicode-symbols
</span></span><span style=display:flex><span>        vundo-compact-display <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        vundo-window-max-height <span style=color:#ae81ff>6</span>))
</span></span></code></pre></div><h4 id=editing>Editing</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Stretch cursor to the glyph width</span>
</span></span><span style=display:flex><span>(setq-default x-stretch-cursor <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Enable relative line numbers</span>
</span></span><span style=display:flex><span>(setq display-line-numbers-type <span style=color:#e6db74>&#39;relative</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Iterate through CamelCase words</span>
</span></span><span style=display:flex><span>(global-subword-mode <span style=color:#ae81ff>1</span>)
</span></span></code></pre></div><h4 id=emacs-sources>Emacs sources</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq source-directory
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~/Softwares/src/emacs&#34;</span>))
</span></span></code></pre></div><h4 id=frame>Frame</h4><h5 id=focus-created-frame>Focus created frame</h5><p>The problem is, every time I launch an Emacs frame (from KDE), Emacs starts
with no focus, I need each time to <code>Alt-TAB</code> to get Emacs under focus, and then
start typing. I tried changing this behavior from Emacs by hooking <code>raise-frame</code>
at startup, but it didn&rsquo;t work.</p><p>Got from <a href=https://emacs.stackexchange.com/a/34740>this comment</a>, not working on my Emacs version.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; NOTE: Not tangled, not working</span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;server-switch-hook</span> <span style=color:#a6e22e>#&#39;raise-frame</span>)
</span></span></code></pre></div><p>After some investigations, I found that this issue is probably KDE specific, the
issue goes away by setting: <strong>Window Management > Window Behavior > Focus > Focus
stealing prevention</strong> to <em>None</em> in the KDE Settings.</p><h4 id=browsers>Browsers</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq browse-url-chrome-program <span style=color:#e6db74>&#34;brave&#34;</span>)
</span></span></code></pre></div><h2 id=emacs-daemon>Emacs daemon</h2><h3 id=initialization>Initialization</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +daemon-startup ()
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; mu4e</span>
</span></span><span style=display:flex><span>  (when (require <span style=color:#e6db74>&#39;mu4e</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Automatically start `mu4e&#39; in background.</span>
</span></span><span style=display:flex><span>    (when (load! <span style=color:#e6db74>&#34;mu-lock.el&#34;</span> (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;email/mu4e/autoload&#34;</span> doom-modules-dir) <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>      (setq +mu4e-lock-greedy <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>            +mu4e-lock-relaxed <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>      (when (+mu4e-lock-available <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; Check each 5m, if `mu4e&#39; if closed, start it in background.</span>
</span></span><span style=display:flex><span>        (run-at-time <span style=color:#66d9ef>nil</span> <span style=color:#75715e>;; Launch now</span>
</span></span><span style=display:flex><span>                     (<span style=color:#a6e22e>*</span> <span style=color:#ae81ff>60</span> <span style=color:#ae81ff>5</span>) <span style=color:#75715e>;; Check each 5 minutes</span>
</span></span><span style=display:flex><span>                     (lambda ()
</span></span><span style=display:flex><span>                       (when (and (not (mu4e-running-p)) (+mu4e-lock-available))
</span></span><span style=display:flex><span>                         (mu4e--start)
</span></span><span style=display:flex><span>                         (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Started </span><span style=color:#e6db74>`mu4e&#39;</span><span style=color:#e6db74> in background.&#34;</span>)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; RSS</span>
</span></span><span style=display:flex><span>  (when (require <span style=color:#e6db74>&#39;elfeed</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (run-at-time <span style=color:#66d9ef>nil</span> (<span style=color:#a6e22e>*</span> <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>60</span> <span style=color:#ae81ff>60</span>) <span style=color:#a6e22e>#&#39;</span>elfeed-update))) <span style=color:#75715e>;; Check every 2h</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(when (<span style=color:#a6e22e>daemonp</span>)
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; At daemon startup</span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;emacs-startup-hook</span> <span style=color:#a6e22e>#&#39;</span>+daemon-startup)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; After creating a new frame (via emacsclient)</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Reload Doom&#39;s theme</span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;server-after-make-frame-hook</span> <span style=color:#a6e22e>#&#39;</span>doom/reload-theme))
</span></span></code></pre></div><h3 id=tweaks>Tweaks</h3><h4 id=save-recent-files>Save recent files</h4><p>When editing files with Emacs client, the files does not get stored by <code>recentf</code>,
making Emacs forgets about recently opened files. A quick fix is to hook the
<code>recentf-save-list</code> command to the <code>delete-frame-functions</code>
and <code>delete-terminal-functions</code> which gets executed each time a
frame/terminal is deleted.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(when (<span style=color:#a6e22e>daemonp</span>)
</span></span><span style=display:flex><span>  (add-hook! <span style=color:#f92672>&#39;</span>(delete-frame-functions delete-terminal-functions)
</span></span><span style=display:flex><span>    (let ((inhibit-message <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>      (recentf-save-list)
</span></span><span style=display:flex><span>      (savehist-save))))
</span></span></code></pre></div><h2 id=package-configuration>Package configuration</h2><h3 id=user-interface>User interface</h3><h4 id=font>Font</h4><p>Doom exposes five (optional) variables for controlling fonts in Doom. Here are
the three important ones: <code>doom-font</code>, <code>doom-unicode-font</code> and
<code>doom-variable-pitch-font</code>. The <code>doom-big-font</code> is used for <code>doom-big-font-mode</code>; use
this for presentations or streaming.</p><p>They all accept either a <code>font-spec</code>, font string (<code>"Input Mono-12"</code>), or xlfd
font string. You generally only need these two:</p><p>Some good fonts:</p><ul><li><code>Iosevka Fixed</code> (THE FONT)</li><li>Nerd fonts<ul><li><code>FantasqueSansMono Nerd Font Mono</code></li><li><code>mononoki Nerd Font Mono</code></li><li><code>CaskaydiaCove Nerd Font Mono</code></li></ul></li><li><code>Cascadia Code</code></li><li><code>Fantasque Sans Mono</code></li><li><code>JuliaMono</code> (good Unicode support)</li><li><code>IBM Plex Mono</code></li><li><code>JetBrains Mono</code></li><li><code>Roboto Mono</code></li><li><code>Source Code Pro</code></li><li><code>Input Mono Narrow</code></li><li><code>Fira Code</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq doom-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;Iosevka Fixed Curly Slab&#34;</span> :size <span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>      doom-big-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;Iosevka Fixed Curly Slab&#34;</span> :size <span style=color:#ae81ff>30</span> :weight <span style=color:#e6db74>&#39;light</span>)
</span></span><span style=display:flex><span>      doom-variable-pitch-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;Iosevka Fixed Curly Slab&#34;</span>)
</span></span><span style=display:flex><span>      doom-unicode-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;JuliaMono&#34;</span>)
</span></span><span style=display:flex><span>      doom-serif-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;Iosevka Fixed Curly Slab&#34;</span> :weight <span style=color:#e6db74>&#39;light</span>))
</span></span></code></pre></div><h4 id=theme>Theme</h4><h5 id=doom>Doom</h5><p>Set Doom&rsquo;s theme, some good choices:</p><ul><li><code>doom-one</code> (Atom like)</li><li><code>doom-vibrant</code> (More vibrant version of <code>doom-one</code>)</li><li><code>doom-one-light</code> (Atom like)</li><li><code>doom-dark+</code> (VS Code like)</li><li><code>doom-xcode</code> (XCode like)</li><li><code>doom-material</code></li><li><code>doom-material-dark</code></li><li><code>doom-palenight</code></li><li><code>doom-ayu-mirage</code></li><li><code>doom-monokai-pro</code></li><li><code>doom-tomorrow-day</code></li><li><code>doom-tomorrow-night</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq doom-theme <span style=color:#e6db74>&#39;doom-one-light</span>)
</span></span><span style=display:flex><span>(remove-hook <span style=color:#e6db74>&#39;window-setup-hook</span> <span style=color:#a6e22e>#&#39;</span>doom-init-theme-h)
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;after-init-hook</span> <span style=color:#a6e22e>#&#39;</span>doom-init-theme-h <span style=color:#e6db74>&#39;append</span>)
</span></span></code></pre></div><h5 id=modus>Modus</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! modus-themes)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! modus-themes
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq modus-themes-hl-line <span style=color:#f92672>&#39;</span>(accented intense)
</span></span><span style=display:flex><span>        modus-themes-subtle-line-numbers <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        modus-themes-region <span style=color:#f92672>&#39;</span>(bg-only no-extend) <span style=color:#75715e>;; accented</span>
</span></span><span style=display:flex><span>        modus-themes-variable-pitch-ui <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        modus-themes-fringes <span style=color:#e6db74>&#39;subtle</span>
</span></span><span style=display:flex><span>        modus-themes-diffs <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        modus-themes-italic-constructs <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        modus-themes-bold-constructs <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        modus-themes-intense-mouseovers <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        modus-themes-paren-match <span style=color:#f92672>&#39;</span>(bold intense)
</span></span><span style=display:flex><span>        modus-themes-syntax <span style=color:#f92672>&#39;</span>(green-strings)
</span></span><span style=display:flex><span>        modus-themes-links <span style=color:#f92672>&#39;</span>(neutral-underline background)
</span></span><span style=display:flex><span>        modus-themes-mode-line <span style=color:#f92672>&#39;</span>(borderless padded)
</span></span><span style=display:flex><span>        modus-themes-tabs-accented <span style=color:#66d9ef>nil</span> <span style=color:#75715e>;; default</span>
</span></span><span style=display:flex><span>        modus-themes-completions
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>((matches <span style=color:#f92672>.</span> (extrabold intense accented))
</span></span><span style=display:flex><span>          (selection <span style=color:#f92672>.</span> (semibold accented intense))
</span></span><span style=display:flex><span>          (popup <span style=color:#f92672>.</span> (accented)))
</span></span><span style=display:flex><span>        modus-themes-headings <span style=color:#f92672>&#39;</span>((<span style=color:#ae81ff>1</span> <span style=color:#f92672>.</span> (rainbow <span style=color:#ae81ff>1.4</span>))
</span></span><span style=display:flex><span>                                (<span style=color:#ae81ff>2</span> <span style=color:#f92672>.</span> (rainbow <span style=color:#ae81ff>1.3</span>))
</span></span><span style=display:flex><span>                                (<span style=color:#ae81ff>3</span> <span style=color:#f92672>.</span> (rainbow <span style=color:#ae81ff>1.2</span>))
</span></span><span style=display:flex><span>                                (<span style=color:#ae81ff>4</span> <span style=color:#f92672>.</span> (rainbow bold <span style=color:#ae81ff>1.1</span>))
</span></span><span style=display:flex><span>                                (<span style=color:#66d9ef>t</span> <span style=color:#f92672>.</span> (rainbow bold)))
</span></span><span style=display:flex><span>        modus-themes-org-blocks <span style=color:#e6db74>&#39;gray-background</span>
</span></span><span style=display:flex><span>        modus-themes-org-agenda
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>((header-block <span style=color:#f92672>.</span> (semibold <span style=color:#ae81ff>1.4</span>))
</span></span><span style=display:flex><span>          (header-date <span style=color:#f92672>.</span> (workaholic bold-today <span style=color:#ae81ff>1.2</span>))
</span></span><span style=display:flex><span>          (event <span style=color:#f92672>.</span> (accented italic varied))
</span></span><span style=display:flex><span>          (scheduled <span style=color:#f92672>.</span> rainbow)
</span></span><span style=display:flex><span>          (habit <span style=color:#f92672>.</span> traffic-light))
</span></span><span style=display:flex><span>        modus-themes-markup <span style=color:#f92672>&#39;</span>(intense background)
</span></span><span style=display:flex><span>        modus-themes-mail-citations <span style=color:#e6db74>&#39;intense</span>
</span></span><span style=display:flex><span>        modus-themes-lang-checkers <span style=color:#f92672>&#39;</span>(background))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +modus-themes-tweak-packages ()
</span></span><span style=display:flex><span>    (modus-themes-with-colors
</span></span><span style=display:flex><span>      (set-face-attribute <span style=color:#e6db74>&#39;cursor</span> <span style=color:#66d9ef>nil</span> :background (modus-themes-color <span style=color:#e6db74>&#39;blue</span>))
</span></span><span style=display:flex><span>      (set-face-attribute <span style=color:#e6db74>&#39;font-lock-type-face</span> <span style=color:#66d9ef>nil</span> :foreground (modus-themes-color <span style=color:#e6db74>&#39;magenta-alt</span>))
</span></span><span style=display:flex><span>      (custom-set-faces
</span></span><span style=display:flex><span>       <span style=color:#75715e>;; Tweak `evil-mc-mode&#39;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(evil-mc-cursor-default-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>magenta-intense-bg)))
</span></span><span style=display:flex><span>       <span style=color:#75715e>;; Tweak `git-gutter-mode&#39;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(git-gutter-fr:added ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>green-fringe-bg)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(git-gutter-fr:deleted ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>red-fringe-bg)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(git-gutter-fr:modified ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>yellow-fringe-bg)))
</span></span><span style=display:flex><span>       <span style=color:#75715e>;; Tweak `doom-modeline&#39;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(doom-modeline-evil-normal-state ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>green-alt-other)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(doom-modeline-evil-insert-state ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>red-alt-other)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(doom-modeline-evil-visual-state ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>magenta-alt)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(doom-modeline-evil-operator-state ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>blue-alt)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(doom-modeline-evil-motion-state ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>blue-alt-other)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(doom-modeline-evil-replace-state ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>yellow-alt)))
</span></span><span style=display:flex><span>       <span style=color:#75715e>;; Tweak `diff-hl-mode&#39;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(diff-hl-insert ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>green-fringe-bg)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(diff-hl-delete ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>red-fringe-bg)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(diff-hl-change ((<span style=color:#f92672>,</span>class :foreground <span style=color:#f92672>,</span>yellow-fringe-bg)))
</span></span><span style=display:flex><span>       <span style=color:#75715e>;; Tweak `solaire-mode&#39;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(solaire-default-face ((<span style=color:#f92672>,</span>class :inherit default :background <span style=color:#f92672>,</span>bg-alt :foreground <span style=color:#f92672>,</span>fg-dim)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(solaire-line-number-face ((<span style=color:#f92672>,</span>class :inherit solaire-default-face :foreground <span style=color:#f92672>,</span>fg-unfocused)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(solaire-hl-line-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>bg-active)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(solaire-org-hide-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>bg-alt :foreground <span style=color:#f92672>,</span>bg-alt)))
</span></span><span style=display:flex><span>       <span style=color:#75715e>;; Tweak `display-fill-column-indicator-mode&#39;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(fill-column-indicator ((<span style=color:#f92672>,</span>class :height <span style=color:#ae81ff>0.3</span> :background <span style=color:#f92672>,</span>bg-inactive :foreground <span style=color:#f92672>,</span>bg-inactive)))
</span></span><span style=display:flex><span>       <span style=color:#75715e>;; Tweak `mmm-mode&#39;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(mmm-cleanup-submode-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>yellow-refine-bg)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(mmm-code-submode-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>bg-active)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(mmm-comment-submode-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>blue-refine-bg)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(mmm-declaration-submode-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>cyan-refine-bg)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(mmm-default-submode-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>bg-alt)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(mmm-init-submode-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>magenta-refine-bg)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(mmm-output-submode-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>red-refine-bg)))
</span></span><span style=display:flex><span>       <span style=color:#f92672>`</span>(mmm-special-submode-face ((<span style=color:#f92672>,</span>class :background <span style=color:#f92672>,</span>green-refine-bg))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;modus-themes-after-load-theme-hook</span> <span style=color:#a6e22e>#&#39;</span>+modus-themes-tweak-packages)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (modus-themes-load-operandi)
</span></span><span style=display:flex><span>  (map! :leader
</span></span><span style=display:flex><span>        :prefix <span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#75715e>;; toggle</span>
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Toggle Modus theme&#34;</span> <span style=color:#e6db74>&#34;m&#34;</span> <span style=color:#a6e22e>#&#39;</span>modus-themes-toggle))
</span></span></code></pre></div><h4 id=modeline>Modeline</h4><h5 id=clock>Clock</h5><p>Display time and set the format to 24h.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! doom-modeline
</span></span><span style=display:flex><span>  (setq display-time-string-forms
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>((<span style=color:#a6e22e>propertize</span> (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34; 🕘 &#34;</span> 24-hours <span style=color:#e6db74>&#34;:&#34;</span> minutes))))
</span></span><span style=display:flex><span>  (display-time-mode <span style=color:#ae81ff>1</span>) <span style=color:#75715e>; Enable time in the mode-line</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Add padding to the right</span>
</span></span><span style=display:flex><span>  (doom-modeline-def-modeline <span style=color:#e6db74>&#39;main</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#39;</span>(bar matches buffer-info remote-host buffer-position parrot selection-info)
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#39;</span>(misc-info minor-modes checker input-method buffer-encoding major-mode process vcs <span style=color:#e6db74>&#34;   &#34;</span>))) <span style=color:#75715e>; &lt;-- added padding here</span>
</span></span></code></pre></div><h5 id=battery>Battery</h5><p>Show battery level unless battery is not present or battery information is unknown.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! doom-modeline
</span></span><span style=display:flex><span>  (let ((battery-str (battery)))
</span></span><span style=display:flex><span>    (unless (or (<span style=color:#a6e22e>equal</span> <span style=color:#e6db74>&#34;Battery status not available&#34;</span> battery-str)
</span></span><span style=display:flex><span>                (string-match-p (<span style=color:#a6e22e>regexp-quote</span> <span style=color:#e6db74>&#34;unknown&#34;</span>) battery-str)
</span></span><span style=display:flex><span>                (string-match-p (<span style=color:#a6e22e>regexp-quote</span> <span style=color:#e6db74>&#34;N/A&#34;</span>) battery-str))
</span></span><span style=display:flex><span>      (display-battery-mode <span style=color:#ae81ff>1</span>))))
</span></span></code></pre></div><h5 id=mode-line-customization>Mode line customization</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! doom-modeline
</span></span><span style=display:flex><span>  (setq doom-modeline-bar-width <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>        doom-modeline-mu4e <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        doom-modeline-major-mode-icon <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        doom-modeline-major-mode-color-icon <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        doom-modeline-buffer-file-name-style <span style=color:#e6db74>&#39;truncate-upto-project</span>))
</span></span></code></pre></div><h4 id=set-transparency>Set transparency</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; NOTE: Not tangled</span>
</span></span><span style=display:flex><span>(set-frame-parameter (<span style=color:#a6e22e>selected-frame</span>) <span style=color:#e6db74>&#39;alpha</span> <span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>85</span> <span style=color:#ae81ff>100</span>))
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;default-frame-alist</span> <span style=color:#f92672>&#39;</span>(alpha <span style=color:#ae81ff>97</span> <span style=color:#ae81ff>100</span>))
</span></span></code></pre></div><h4 id=dashboard>Dashboard</h4><h5 id=custom-splash-image>Custom splash image</h5><p>Change the logo to an image, a set of beautiful images can be found in <code>assets</code>.</p><table><thead><tr><th>File</th></tr></thead><tbody><tr><td><code>emacs-e.svg</code></td></tr><tr><td><code>gnu-emacs-white.svg</code></td></tr><tr><td><code>gnu-emacs-flat.svg</code></td></tr><tr><td><code>blackhole-lines.svg</code></td></tr><tr><td><code>doom-emacs-white.svg</code></td></tr><tr><td><code>doom-emacs-dark.svg</code></td></tr><tr><td><code>doom-emacs-gray.svg</code></td></tr></tbody></table><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq fancy-splash-image (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;assets/doom-emacs-gray.svg&#34;</span> doom-user-dir))
</span></span></code></pre></div><h5 id=dashboard>Dashboard</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(remove-hook <span style=color:#e6db74>&#39;+doom-dashboard-functions</span> <span style=color:#a6e22e>#&#39;</span>doom-dashboard-widget-shortmenu)
</span></span><span style=display:flex><span>(remove-hook <span style=color:#e6db74>&#39;+doom-dashboard-functions</span> <span style=color:#a6e22e>#&#39;</span>doom-dashboard-widget-footer)
</span></span><span style=display:flex><span>(add-hook! <span style=color:#e6db74>&#39;+doom-dashboard-mode-hook</span> (hl-line-mode <span style=color:#ae81ff>-1</span>) (hide-mode-line-mode <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>(setq-hook! <span style=color:#e6db74>&#39;+doom-dashboard-mode-hook</span> evil-normal-state-cursor (<span style=color:#a6e22e>list</span> <span style=color:#66d9ef>nil</span>))
</span></span></code></pre></div><h4 id=which-key>Which key</h4><p>Make <code>which-key</code> popup faster.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq which-key-idle-delay <span style=color:#ae81ff>0.5</span> <span style=color:#75715e>;; Default is 1.0</span>
</span></span><span style=display:flex><span>      which-key-idle-secondary-delay <span style=color:#ae81ff>0.05</span>) <span style=color:#75715e>;; Default is nil</span>
</span></span></code></pre></div><p>I&rsquo;ve stolen this chunk (like many others) from <a href=https://tecosaur.github.io/emacs-config/config.html#interface>tecosaur&rsquo;s config</a>, it helps to
replace the <code>evil-</code> prefix with a unicode symbol, making <code>which-key</code>&rsquo;s candidate
list less verbose.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq which-key-allow-multiple-replacements <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(after! which-key
</span></span><span style=display:flex><span>  (pushnew! which-key-replacement-alist
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\`+?evil[-:]?\\(?:a-\\)?\\(.*\\)&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#66d9ef>nil</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🅔·\\1&#34;</span>))
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;\\`g s&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\`evilem--?motion-\\(.*\\)&#34;</span>) <span style=color:#f92672>.</span> (<span style=color:#66d9ef>nil</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;Ⓔ·\\1&#34;</span>))))
</span></span></code></pre></div><h4 id=window-title>Window title</h4><p>I&rsquo;d like to have just the buffer name, then if applicable the project folder.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq frame-title-format
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        (:eval
</span></span><span style=display:flex><span>         (if (s-contains-p org-roam-directory (or <span style=color:#a6e22e>buffer-file-name</span> <span style=color:#e6db74>&#34;&#34;</span>))
</span></span><span style=display:flex><span>             (replace-regexp-in-string <span style=color:#e6db74>&#34;.*/[0-9]*-?&#34;</span> <span style=color:#e6db74>&#34;☰ &#34;</span>
</span></span><span style=display:flex><span>                                       (subst-char-in-string <span style=color:#e6db74>?_</span> <span style=color:#e6db74>? </span> <span style=color:#a6e22e>buffer-file-name</span>))
</span></span><span style=display:flex><span>           <span style=color:#e6db74>&#34;%b&#34;</span>))
</span></span><span style=display:flex><span>        (:eval
</span></span><span style=display:flex><span>         (let* ((project-name (projectile-project-name))
</span></span><span style=display:flex><span>                (project-name (if (string= <span style=color:#e6db74>&#34;-&#34;</span> project-name)
</span></span><span style=display:flex><span>                                  (ignore-errors (file-name-base (string-trim-right (vc-root-dir))))
</span></span><span style=display:flex><span>                                project-name)))
</span></span><span style=display:flex><span>           (when project-name
</span></span><span style=display:flex><span>             (<span style=color:#a6e22e>format</span> (if (<span style=color:#a6e22e>buffer-modified-p</span>) <span style=color:#e6db74>&#34; ○ %s&#34;</span> <span style=color:#e6db74>&#34; ● %s&#34;</span>) project-name))))))
</span></span></code></pre></div><h4 id=svg-tag-and-svg-lib>SVG tag and <code>svg-lib</code></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! svg-tag-mode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! svg-tag-mode
</span></span><span style=display:flex><span>  :commands svg-tag-mode
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq svg-tag-tags
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;^\\*.* .* \\(:[A-Za-z0-9]+\\)&#34;</span> <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>           ((lambda (tag)
</span></span><span style=display:flex><span>              (svg-tag-make
</span></span><span style=display:flex><span>               tag
</span></span><span style=display:flex><span>               :beg <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>               :font-family <span style=color:#e6db74>&#34;Roboto Mono&#34;</span>
</span></span><span style=display:flex><span>               :font-size <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>               :height <span style=color:#ae81ff>0.8</span>
</span></span><span style=display:flex><span>               :padding <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>               :margin <span style=color:#ae81ff>0</span>))))
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;\\(:[A-Za-z0-9]+:\\)$&#34;</span> <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>           ((lambda (tag)
</span></span><span style=display:flex><span>              (svg-tag-make
</span></span><span style=display:flex><span>               tag
</span></span><span style=display:flex><span>               :beg <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>               :end <span style=color:#ae81ff>-1</span>
</span></span><span style=display:flex><span>               :font-family <span style=color:#e6db74>&#34;Roboto Mono&#34;</span>
</span></span><span style=display:flex><span>               :font-size <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>               :height <span style=color:#ae81ff>0.8</span>
</span></span><span style=display:flex><span>               :padding <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>               :margin <span style=color:#ae81ff>0</span>)))))))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! svg-lib
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Set `svg-lib&#39; cache directory</span>
</span></span><span style=display:flex><span>  (setq svg-lib-icons-dir (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;svg-lib&#34;</span> doom-data-dir)))
</span></span></code></pre></div><h4 id=focus>Focus</h4><p>Dim the font color of text in surrounding paragraphs, focus only on the current line.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! focus)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! focus
</span></span><span style=display:flex><span>  :commands focus-mode)
</span></span></code></pre></div><h4 id=scrolling>Scrolling</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! good-scroll
</span></span><span style=display:flex><span>  :disable EMACS29+)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! good-scroll
</span></span><span style=display:flex><span>  :unless EMACS29+
</span></span><span style=display:flex><span>  :config (good-scroll-mode <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(when EMACS29+
</span></span><span style=display:flex><span>  (pixel-scroll-precision-mode <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq hscroll-step <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>      hscroll-margin <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      scroll-step <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>      scroll-margin <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      scroll-conservatively <span style=color:#ae81ff>101</span>
</span></span><span style=display:flex><span>      scroll-up-aggressively <span style=color:#ae81ff>0.01</span>
</span></span><span style=display:flex><span>      scroll-down-aggressively <span style=color:#ae81ff>0.01</span>
</span></span><span style=display:flex><span>      scroll-preserve-screen-position <span style=color:#e6db74>&#39;always</span>
</span></span><span style=display:flex><span>      auto-window-vscroll <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>      fast-but-imprecise-scrolling <span style=color:#66d9ef>nil</span>)
</span></span></code></pre></div><h4 id=all-the-icons>All the icons</h4><p>Set some custom icons for some file extensions, basically for <code>.m</code> files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! all-the-icons
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>setcdr</span> (<span style=color:#a6e22e>assoc</span> <span style=color:#e6db74>&#34;m&#34;</span> all-the-icons-extension-icon-alist)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> <span style=color:#e6db74>&#34;matlab&#34;</span> all-the-icons-extension-icon-alist))))
</span></span></code></pre></div><h4 id=tabs>Tabs</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! centaur-tabs
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; For some reason, setting `centaur-tabs-set-bar&#39; this to `right&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; instead of Doom&#39;s default `left&#39;, fixes this issue with Emacs daemon:</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; https://github.com/doomemacs/doomemacs/issues/6647#issuecomment-1229365473</span>
</span></span><span style=display:flex><span>  (setq centaur-tabs-set-bar <span style=color:#e6db74>&#39;right</span>
</span></span><span style=display:flex><span>        centaur-tabs-gray-out-icons <span style=color:#e6db74>&#39;buffer</span>
</span></span><span style=display:flex><span>        centaur-tabs-set-modified-marker <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        centaur-tabs-close-button <span style=color:#e6db74>&#34;⨂&#34;</span>
</span></span><span style=display:flex><span>        centaur-tabs-modified-marker <span style=color:#e6db74>&#34;⨀&#34;</span>))
</span></span></code></pre></div><h3 id=highlight-indent-guides>Highlight indent guides</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! highlight-indent-guides
</span></span><span style=display:flex><span>  (setq highlight-indent-guides-character <span style=color:#e6db74>?│</span>
</span></span><span style=display:flex><span>        highlight-indent-guides-responsive <span style=color:#e6db74>&#39;top</span>))
</span></span></code></pre></div><h3 id=editing>Editing</h3><h4 id=file-templates>File templates</h4><p>For some file types, we can overwrite the defaults in the <a href=./snippets>snippets&rsquo;</a> directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(set-file-template! <span style=color:#e6db74>&#34;\\.tex$&#34;</span> :trigger <span style=color:#e6db74>&#34;__&#34;</span> :mode <span style=color:#e6db74>&#39;latex-mode</span>)
</span></span><span style=display:flex><span>(set-file-template! <span style=color:#e6db74>&#34;\\.org$&#34;</span> :trigger <span style=color:#e6db74>&#34;__&#34;</span> :mode <span style=color:#e6db74>&#39;org-mode</span>)
</span></span><span style=display:flex><span>(set-file-template! <span style=color:#e6db74>&#34;/LICEN[CS]E$&#34;</span> :trigger <span style=color:#e6db74>&#39;+file-templates/insert-license</span>)
</span></span></code></pre></div><h4 id=scratch-buffer>Scratch buffer</h4><p>Tell the scratch buffer to start in <code>emacs-lisp-mode</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq doom-scratch-initial-major-mode <span style=color:#e6db74>&#39;emacs-lisp-mode</span>)
</span></span></code></pre></div><h4 id=mouse-buttons>Mouse buttons</h4><p>Map extra mouse buttons to jump between buffers</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :n [mouse-8] <span style=color:#a6e22e>#&#39;</span>better-jumper-jump-backward
</span></span><span style=display:flex><span>      :n [mouse-9] <span style=color:#a6e22e>#&#39;</span>better-jumper-jump-forward)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Enable horizontal scrolling with the second mouse wheel or the touchpad</span>
</span></span><span style=display:flex><span>(setq mouse-wheel-tilt-scroll <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      mouse-wheel-progressive-speed <span style=color:#66d9ef>nil</span>)
</span></span></code></pre></div><h4 id=very-large-files>Very large files</h4><p>The <em>very large files</em> mode loads large files in chunks, allowing one to open
ridiculously large files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! vlf)
</span></span></code></pre></div><p>To make VLF available without delaying startup, we&rsquo;ll just load it in quiet moments.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! vlf-setup
</span></span><span style=display:flex><span>  :defer-incrementally vlf-tune vlf-base vlf-write vlf-search vlf-occur vlf-follow vlf-ediff vlf)
</span></span></code></pre></div><h4 id=evil>Evil</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! evil
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; This fixes https://github.com/doomemacs/doomemacs/issues/6478</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Ref: https://github.com/emacs-evil/evil/issues/1630</span>
</span></span><span style=display:flex><span>  (evil-select-search-module <span style=color:#e6db74>&#39;evil-search-module</span> <span style=color:#e6db74>&#39;isearch</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq evil-kill-on-visual-paste <span style=color:#66d9ef>nil</span>)) <span style=color:#75715e>; Don&#39;t put overwritten text in the kill ring</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! evil-escape :disable <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h4 id=aggressive-indent>Aggressive indent</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! aggressive-indent)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! aggressive-indent
</span></span><span style=display:flex><span>  :commands (aggressive-indent-mode))
</span></span></code></pre></div><h4 id=yasnippet>YASnippet</h4><p>Nested snippets are good, enable that.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq yas-triggers-in-field <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h3 id=completion-and-ide>Completion & IDE</h3><h4 id=company>Company</h4><p>I do not find <code>company</code> useful in Org files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq company-global-modes
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>(not erc-mode
</span></span><span style=display:flex><span>            circe-mode
</span></span><span style=display:flex><span>            message-mode
</span></span><span style=display:flex><span>            help-mode
</span></span><span style=display:flex><span>            gud-mode
</span></span><span style=display:flex><span>            vterm-mode
</span></span><span style=display:flex><span>            org-mode))
</span></span></code></pre></div><h5 id=tweak-company-box>Tweak <code>company-box</code></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! company-box
</span></span><span style=display:flex><span>  (when (<span style=color:#a6e22e>daemonp</span>)
</span></span><span style=display:flex><span>    (defun +company-box--reload-icons-h ()
</span></span><span style=display:flex><span>      (setq company-box-icons-all-the-icons
</span></span><span style=display:flex><span>            (let ((all-the-icons-scale-factor <span style=color:#ae81ff>0.8</span>))
</span></span><span style=display:flex><span>              <span style=color:#f92672>`</span>((Unknown       <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-faicon   <span style=color:#e6db74>&#34;code&#34;</span>                 :face <span style=color:#e6db74>&#39;all-the-icons-purple</span>))
</span></span><span style=display:flex><span>                (Text          <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;text_fields&#34;</span>          :face <span style=color:#e6db74>&#39;all-the-icons-green</span>))
</span></span><span style=display:flex><span>                (Method        <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-faicon   <span style=color:#e6db74>&#34;cube&#34;</span>                 :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Function      <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-faicon   <span style=color:#e6db74>&#34;cube&#34;</span>                 :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Constructor   <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-faicon   <span style=color:#e6db74>&#34;cube&#34;</span>                 :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Field         <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-faicon   <span style=color:#e6db74>&#34;tag&#34;</span>                  :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Variable      <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;adjust&#34;</span>               :face <span style=color:#e6db74>&#39;all-the-icons-blue</span>))
</span></span><span style=display:flex><span>                (Class         <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;class&#34;</span>                :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Interface     <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;tune&#34;</span>                 :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Module        <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-faicon   <span style=color:#e6db74>&#34;cubes&#34;</span>                :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Property      <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-faicon   <span style=color:#e6db74>&#34;wrench&#34;</span>               :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Unit          <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;straighten&#34;</span>           :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Value         <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;filter_1&#34;</span>             :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Enum          <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;plus_one&#34;</span>             :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Keyword       <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;filter_center_focus&#34;</span>  :face <span style=color:#e6db74>&#39;all-the-icons-red-alt</span>))
</span></span><span style=display:flex><span>                (Snippet       <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-faicon   <span style=color:#e6db74>&#34;expand&#34;</span>               :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Color         <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;colorize&#34;</span>             :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (File          <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;insert_drive_file&#34;</span>    :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Reference     <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;collections_bookmark&#34;</span> :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Folder        <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;folder&#34;</span>               :face <span style=color:#e6db74>&#39;all-the-icons-red-alt</span>))
</span></span><span style=display:flex><span>                (EnumMember    <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;people&#34;</span>               :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Constant      <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;pause_circle_filled&#34;</span>  :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Struct        <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;list&#34;</span>                 :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Event         <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;event&#34;</span>                :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Operator      <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;control_point&#34;</span>        :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (TypeParameter <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;class&#34;</span>                :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (Template      <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;settings_ethernet&#34;</span>    :face <span style=color:#e6db74>&#39;all-the-icons-green</span>))
</span></span><span style=display:flex><span>                (ElispFunction <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-faicon   <span style=color:#e6db74>&#34;cube&#34;</span>                 :face <span style=color:#e6db74>&#39;all-the-icons-red</span>))
</span></span><span style=display:flex><span>                (ElispVariable <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;adjust&#34;</span>               :face <span style=color:#e6db74>&#39;all-the-icons-blue</span>))
</span></span><span style=display:flex><span>                (ElispFeature  <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;stars&#34;</span>                :face <span style=color:#e6db74>&#39;all-the-icons-orange</span>))
</span></span><span style=display:flex><span>                (ElispFace     <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(all-the-icons-material <span style=color:#e6db74>&#34;format_paint&#34;</span>         :face <span style=color:#e6db74>&#39;all-the-icons-pink</span>))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Replace Doom defined icons with mine</span>
</span></span><span style=display:flex><span>    (when (<span style=color:#a6e22e>memq</span> <span style=color:#a6e22e>#&#39;</span>+company-box--load-all-the-icons server-after-make-frame-hook)
</span></span><span style=display:flex><span>      (remove-hook <span style=color:#e6db74>&#39;server-after-make-frame-hook</span> <span style=color:#a6e22e>#&#39;</span>+company-box--load-all-the-icons))
</span></span><span style=display:flex><span>    (add-hook <span style=color:#e6db74>&#39;server-after-make-frame-hook</span> <span style=color:#a6e22e>#&#39;</span>+company-box--reload-icons-h)))
</span></span></code></pre></div><h4 id=treemacs>Treemacs</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(unpin! treemacs)
</span></span><span style=display:flex><span>(unpin! lsp-treemacs)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! treemacs
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;dired</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; My custom stuff (from tecosaur&#39;s config)</span>
</span></span><span style=display:flex><span>  (setq +treemacs-file-ignore-extensions
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>(<span style=color:#75715e>;; LaTeX</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;aux&#34;</span> <span style=color:#e6db74>&#34;ptc&#34;</span> <span style=color:#e6db74>&#34;fdb_latexmk&#34;</span> <span style=color:#e6db74>&#34;fls&#34;</span> <span style=color:#e6db74>&#34;synctex.gz&#34;</span> <span style=color:#e6db74>&#34;toc&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>;; LaTeX - bibliography</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;bbl&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>;; LaTeX - glossary</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;glg&#34;</span> <span style=color:#e6db74>&#34;glo&#34;</span> <span style=color:#e6db74>&#34;gls&#34;</span> <span style=color:#e6db74>&#34;glsdefs&#34;</span> <span style=color:#e6db74>&#34;ist&#34;</span> <span style=color:#e6db74>&#34;acn&#34;</span> <span style=color:#e6db74>&#34;acr&#34;</span> <span style=color:#e6db74>&#34;alg&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>;; LaTeX - pgfplots</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;mw&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>;; LaTeX - pdfx</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;pdfa.xmpi&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>;; Python</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;pyc&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq +treemacs-file-ignore-globs
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>(<span style=color:#75715e>;; LaTeX</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;*/_minted-*&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>;; AucTeX</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;*/.auctex-auto&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;*/_region_.log&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;*/_region_.tex&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>;; Python</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;*/__pycache__&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Reload treemacs theme</span>
</span></span><span style=display:flex><span>  (setq doom-themes-treemacs-enable-variable-pitch <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        doom-themes-treemacs-theme <span style=color:#e6db74>&#34;doom-colors&#34;</span>)
</span></span><span style=display:flex><span>  (doom-themes-treemacs-config)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq treemacs-show-hidden-files <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        treemacs-hide-dot-git-directory <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        treemacs-width <span style=color:#ae81ff>30</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defvar +treemacs-file-ignore-extensions <span style=color:#f92672>&#39;</span>()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;File extension which </span><span style=color:#e6db74>`treemacs-ignore-filter&#39;</span><span style=color:#e6db74> will ensure are ignored&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defvar +treemacs-file-ignore-globs <span style=color:#f92672>&#39;</span>()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Globs which will are transformed to </span><span style=color:#e6db74>`+treemacs-file-ignore-regexps&#39;</span><span style=color:#e6db74> which </span><span style=color:#e6db74>`+treemacs-ignore-filter&#39;</span><span style=color:#e6db74> will ensure are ignored&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defvar +treemacs-file-ignore-regexps <span style=color:#f92672>&#39;</span>()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;RegExps to be tested to ignore files, generated from </span><span style=color:#e6db74>`+treeemacs-file-ignore-globs&#39;</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +treemacs-file-ignore-generate-regexps ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Generate </span><span style=color:#e6db74>`+treemacs-file-ignore-regexps&#39;</span><span style=color:#e6db74> from </span><span style=color:#e6db74>`+treemacs-file-ignore-globs&#39;</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    (setq +treemacs-file-ignore-regexps (<span style=color:#a6e22e>mapcar</span> <span style=color:#e6db74>&#39;dired-glob-regexp</span> +treemacs-file-ignore-globs)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (unless (<span style=color:#a6e22e>equal</span> +treemacs-file-ignore-globs <span style=color:#f92672>&#39;</span>())
</span></span><span style=display:flex><span>    (+treemacs-file-ignore-generate-regexps))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +treemacs-ignore-filter (file full-path)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Ignore files specified by </span><span style=color:#e6db74>`+treemacs-file-ignore-extensions&#39;</span><span style=color:#e6db74>, and </span><span style=color:#e6db74>`+treemacs-file-ignore-regexps&#39;</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    (or (<span style=color:#a6e22e>member</span> (file-name-extension file) +treemacs-file-ignore-extensions)
</span></span><span style=display:flex><span>        (let ((ignore-file <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>          (dolist (regexp +treemacs-file-ignore-regexps ignore-file)
</span></span><span style=display:flex><span>            (setq ignore-file (or ignore-file (if (string-match-p regexp full-path) <span style=color:#66d9ef>t</span> <span style=color:#66d9ef>nil</span>)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#e6db74>&#39;treemacs-ignored-file-predicates</span> <span style=color:#a6e22e>#&#39;</span>+treemacs-ignore-filter))
</span></span></code></pre></div><h4 id=projectile>Projectile</h4><p>Doom Emacs defined a function <code>(doom-project-ignored-p path)</code> and uses
it with <code>projectile-ignored-project-function</code>. So we will create a
wrapper function which calls Doom&rsquo;s one, with an extra check.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Run `M-x projectile-discover-projects-in-search-path&#39; to reload paths from this variable</span>
</span></span><span style=display:flex><span>(setq projectile-project-search-path
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;~/PhD/papers&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;~/PhD/workspace&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;~/PhD/workspace-no&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;~/PhD/workspace-no/ez-wheel/swd-starter-kit-repo&#34;</span>
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;~/Projects/foss&#34;</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>2</span>))) <span style=color:#75715e>;; (&#34;dir&#34; . depth)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq projectile-ignored-projects
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;/tmp&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;~/&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;~/.cache&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;~/.doom.d&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;~/.emacs.d/.local/straight/repos/&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq +projectile-ignored-roots
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;~/.cache&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; No need for this one, as `doom-project-ignored-p&#39; checks for files in `doom-local-dir&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;~/.emacs.d/.local/straight/&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +projectile-ignored-project-function (filepath)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Return t if FILEPATH is within any of </span><span style=color:#e6db74>`+projectile-ignored-roots&#39;</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;cl-lib</span>)
</span></span><span style=display:flex><span>  (or (doom-project-ignored-p filepath) <span style=color:#75715e>;; Used by default by doom with `projectile-ignored-project-function&#39;</span>
</span></span><span style=display:flex><span>      (cl-some (lambda (root) (file-in-directory-p (<span style=color:#a6e22e>expand-file-name</span> filepath) (<span style=color:#a6e22e>expand-file-name</span> root)))
</span></span><span style=display:flex><span>          +projectile-ignored-roots)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq projectile-ignored-project-function <span style=color:#a6e22e>#&#39;</span>+projectile-ignored-project-function)
</span></span></code></pre></div><h4 id=tramp>Tramp</h4><p>Let&rsquo;s try to make tramp handle prompts better</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! tramp
</span></span><span style=display:flex><span>  (setenv <span style=color:#e6db74>&#34;SHELL&#34;</span> <span style=color:#e6db74>&#34;/bin/bash&#34;</span>)
</span></span><span style=display:flex><span>  (setq tramp-shell-prompt-pattern <span style=color:#e6db74>&#34;\\(?:^\\|
</span></span></span><span style=display:flex><span><span style=color:#e6db74>\\)[^]#$%&gt;\n]*#?[]#$%&gt;] *\\(\\[[0-9;]*[a-zA-Z] *\\)*&#34;</span>)) <span style=color:#75715e>;; default + </span>
</span></span></code></pre></div><h4 id=eros-eval>Eros-eval</h4><p>This makes the result of evals slightly prettier.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq eros-eval-result-prefix <span style=color:#e6db74>&#34;⟹ &#34;</span>)
</span></span></code></pre></div><h4 id=dir-locals-dot-el><code>dir-locals.el</code></h4><p>Reload <code>dir-locals.el</code> variables after modification. Taken from <a href=https://emacs.stackexchange.com/a/13096>this answer</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +dir-locals-reload-for-current-buffer ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;reload dir locals for the current buffer&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (let ((enable-local-variables :all))
</span></span><span style=display:flex><span>    (hack-dir-local-variables-non-file-buffer)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +dir-locals-reload-for-all-buffers-in-this-directory ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;For every buffer with the same `default-directory` as the
</span></span></span><span style=display:flex><span><span style=color:#e6db74>current buffer&#39;s, reload dir-locals.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (let ((dir default-directory))
</span></span><span style=display:flex><span>    (dolist (buffer (<span style=color:#a6e22e>buffer-list</span>))
</span></span><span style=display:flex><span>      (with-current-buffer buffer
</span></span><span style=display:flex><span>        (when (<span style=color:#a6e22e>equal</span> default-directory dir)
</span></span><span style=display:flex><span>          (+dir-locals-reload-for-current-buffer))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +dir-locals-enable-autoreload ()
</span></span><span style=display:flex><span>  (when (and (<span style=color:#a6e22e>buffer-file-name</span>)
</span></span><span style=display:flex><span>             (<span style=color:#a6e22e>equal</span> dir-locals-file (<span style=color:#a6e22e>file-name-nondirectory</span> (<span style=color:#a6e22e>buffer-file-name</span>))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Dir-locals will be reloaded after saving.&#34;</span>)
</span></span><span style=display:flex><span>    (add-hook <span style=color:#e6db74>&#39;after-save-hook</span> <span style=color:#e6db74>&#39;+dir-locals-reload-for-all-buffers-in-this-directory</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook! <span style=color:#f92672>&#39;</span>(emacs-lisp-mode-hook lisp-data-mode-hook) <span style=color:#a6e22e>#&#39;</span>+dir-locals-enable-autoreload)
</span></span></code></pre></div><h4 id=language-server-protocol>Language Server Protocol</h4><h5 id=eglot>Eglot</h5><p>Eglot uses <code>project.el</code> to detect the project root. This is <a href=https://github.com/joaotavora/eglot/issues/129#issuecomment-444130367>a workaround</a> to make
it work with <code>projectile</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! eglot
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; A hack to make it works with projectile</span>
</span></span><span style=display:flex><span>  (defun projectile-project-find-function (dir)
</span></span><span style=display:flex><span>    (let* ((root (projectile-project-root dir)))
</span></span><span style=display:flex><span>      (and root (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#39;transient</span> root))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (with-eval-after-load <span style=color:#e6db74>&#39;project</span>
</span></span><span style=display:flex><span>    (add-to-list <span style=color:#e6db74>&#39;project-find-functions</span> <span style=color:#e6db74>&#39;projectile-project-find-function</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Use clangd with some options</span>
</span></span><span style=display:flex><span>  (set-eglot-client! <span style=color:#e6db74>&#39;c++-mode</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;clangd&#34;</span> <span style=color:#e6db74>&#34;-j=3&#34;</span> <span style=color:#e6db74>&#34;--clang-tidy&#34;</span>)))
</span></span></code></pre></div><h5 id=lsp-mode>LSP mode</h5><h6 id=unpin-package>Unpin package</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(unpin! lsp-mode)
</span></span></code></pre></div><h6 id=tweak-ui>Tweak UI</h6><p>LSP mode provides a <a href=https://emacs-lsp.github.io/lsp-mode/tutorials/how-to-turn-off/>set of configurable UI stuff</a>. By default, Doom Emacs
disables some UI components; however, I like to enable some less intrusive, more
useful UI stuff.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! lsp-ui
</span></span><span style=display:flex><span>  (setq lsp-ui-sideline-enable <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        lsp-ui-sideline-show-code-actions <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        lsp-ui-sideline-show-diagnostics <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        lsp-ui-sideline-show-hover <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        lsp-log-io <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        lsp-lens-enable <span style=color:#66d9ef>t</span> <span style=color:#75715e>; not working properly with ccls!</span>
</span></span><span style=display:flex><span>        lsp-diagnostics-provider :auto
</span></span><span style=display:flex><span>        lsp-enable-symbol-highlighting <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        lsp-headerline-breadcrumb-enable <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        lsp-headerline-breadcrumb-segments <span style=color:#f92672>&#39;</span>(symbols)))
</span></span></code></pre></div><h6 id=lsp-mode-with-clangd>LSP mode with <code>clangd</code></h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! lsp-clangd
</span></span><span style=display:flex><span>  (setq lsp-clients-clangd-args
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;-j=4&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;--background-index&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;--clang-tidy&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;--completion-style=detailed&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;--header-insertion=never&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;--header-insertion-decorators=0&#34;</span>))
</span></span><span style=display:flex><span>  (set-lsp-priority! <span style=color:#e6db74>&#39;clangd</span> <span style=color:#ae81ff>1</span>))
</span></span></code></pre></div><h6 id=lsp-mode-with-ccls>LSP mode with <code>ccls</code></h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; NOTE: Not tangled, using the default ccls</span>
</span></span><span style=display:flex><span>(after! ccls
</span></span><span style=display:flex><span>  (setq ccls-initialization-options
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>(:index (:comments <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                  :trackDependency <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                  :threads <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>          :completion (:detailedLabel <span style=color:#66d9ef>t</span>)))
</span></span><span style=display:flex><span>  (set-lsp-priority! <span style=color:#e6db74>&#39;ccls</span> <span style=color:#ae81ff>2</span>)) <span style=color:#75715e>; optional as ccls is the default in Doom</span>
</span></span></code></pre></div><h6 id=enable-lsp-over-tramp>Enable <code>lsp</code> over <code>tramp</code></h6><ul><li><p>Python</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! tramp
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;lsp-mode</span>)
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; (require &#39;lsp-pyright)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq lsp-enable-snippet <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        lsp-log-io <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; To bypass the &#34;lsp--document-highlight fails if</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; textDocument/documentHighlight is not supported&#34; error</span>
</span></span><span style=display:flex><span>        lsp-enable-symbol-highlighting <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (lsp-register-client
</span></span><span style=display:flex><span>   (make-lsp-client
</span></span><span style=display:flex><span>    :new-connection (lsp-tramp-connection <span style=color:#e6db74>&#34;pyls&#34;</span>)
</span></span><span style=display:flex><span>    :major-modes <span style=color:#f92672>&#39;</span>(python-mode)
</span></span><span style=display:flex><span>    :remote? <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>    :server-id <span style=color:#e6db74>&#39;pyls-remote</span>)))
</span></span></code></pre></div></li></ul><ul><li><p>C/C++ with <code>ccls</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; NOTE: WIP: Not tangled</span>
</span></span><span style=display:flex><span>(after! tramp
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;lsp-mode</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;ccls</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq lsp-enable-snippet <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        lsp-log-io <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        lsp-enable-symbol-highlighting <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (lsp-register-client
</span></span><span style=display:flex><span>   (make-lsp-client
</span></span><span style=display:flex><span>    :new-connection
</span></span><span style=display:flex><span>    (lsp-tramp-connection
</span></span><span style=display:flex><span>     (lambda ()
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>cons</span> ccls-executable <span style=color:#75715e>; executable name on remote machine &#39;ccls&#39;</span>
</span></span><span style=display:flex><span>             ccls-args)))
</span></span><span style=display:flex><span>    :major-modes <span style=color:#f92672>&#39;</span>(c-mode c++-mode objc-mode cuda-mode)
</span></span><span style=display:flex><span>    :remote? <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>    :server-id <span style=color:#e6db74>&#39;ccls-remote</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#e6db74>&#39;tramp-remote-path</span> <span style=color:#e6db74>&#39;tramp-own-remote-path</span>))
</span></span></code></pre></div></li></ul><ul><li><p>C/C++ with <code>clangd</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! tramp
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;lsp-mode</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq lsp-enable-snippet <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        lsp-log-io <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; To bypass the &#34;lsp--document-highlight fails if</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; textDocument/documentHighlight is not supported&#34; error</span>
</span></span><span style=display:flex><span>        lsp-enable-symbol-highlighting <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (lsp-register-client
</span></span><span style=display:flex><span>    (make-lsp-client
</span></span><span style=display:flex><span>     :new-connection
</span></span><span style=display:flex><span>     (lsp-tramp-connection
</span></span><span style=display:flex><span>      (lambda ()
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;clangd-12&#34;</span> <span style=color:#75715e>; executable name on remote machine &#39;ccls&#39;</span>
</span></span><span style=display:flex><span>              lsp-clients-clangd-args)))
</span></span><span style=display:flex><span>     :major-modes <span style=color:#f92672>&#39;</span>(c-mode c++-mode objc-mode cuda-mode)
</span></span><span style=display:flex><span>     :remote? <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>     :server-id <span style=color:#e6db74>&#39;clangd-remote</span>)))
</span></span></code></pre></div></li></ul><h6 id=vhdl>VHDL</h6><p>By default, LSP uses the proprietary VHDL-Tool to provide LSP features; however,
there is free and open source alternatives: <code>ghdl-ls</code> and <code>rust_hdl</code>. I have some
issues running <code>ghdl-ls</code> installed form <code>pip</code> through the <code>pyghdl</code> package, so let&rsquo;s
use <code>rust_hdl</code> instead.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! vhdl-mode
</span></span><span style=display:flex><span>  :hook (vhdl-mode <span style=color:#f92672>.</span> <span style=color:#a6e22e>#&#39;</span>+lsp-vhdl-ls-load)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (defun +lsp-vhdl-ls-load ()
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (lsp <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (flycheck-mode <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Required unless vhdl_ls is on the $PATH</span>
</span></span><span style=display:flex><span>  (setq lsp-vhdl-server-path <span style=color:#e6db74>&#34;~/Projects/foss/repos/rust_hdl/target/release/vhdl_ls&#34;</span>
</span></span><span style=display:flex><span>        lsp-vhdl-server <span style=color:#e6db74>&#39;vhdl-ls</span>
</span></span><span style=display:flex><span>        lsp-vhdl--params <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;lsp-vhdl</span>))
</span></span></code></pre></div><h6 id=sonarlint>SonarLint</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! lsp-sonarlint
</span></span><span style=display:flex><span>  :disable <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! lsp-sonarlint)
</span></span></code></pre></div><h4 id=cppcheck>Cppcheck</h4><p>Check for everything!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! flycheck
</span></span><span style=display:flex><span>  (setq flycheck-cppcheck-checks <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;information&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#e6db74>&#34;missingInclude&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#e6db74>&#34;performance&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#e6db74>&#34;portability&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#e6db74>&#34;style&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#e6db74>&#34;unusedFunction&#34;</span>
</span></span><span style=display:flex><span>                                   <span style=color:#e6db74>&#34;warning&#34;</span>))) <span style=color:#75715e>;; Actually, we can use &#34;all&#34;</span>
</span></span></code></pre></div><h4 id=project-cmake>Project CMake</h4><p>A good new package to facilitate using CMake projects with Emacs, it glues
together <code>project</code>, <code>eglot</code>, <code>cmake</code> and <code>clangd</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! project-cmake
</span></span><span style=display:flex><span>  :disable (not (modulep! :tools lsp +eglot)) <span style=color:#75715e>; Enable only if (lsp +eglot) is used</span>
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;juanjosegarciaripoll/project-cmake&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! project-cmake
</span></span><span style=display:flex><span>    :config
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eglot</span>)
</span></span><span style=display:flex><span>    (project-cmake-scan-kits)
</span></span><span style=display:flex><span>    (project-cmake-eglot-integration))
</span></span></code></pre></div><h4 id=clang-format>Clang-format</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! clang-format)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! clang-format
</span></span><span style=display:flex><span>  :when CLANG-FORMAT-P
</span></span><span style=display:flex><span>  :commands (clang-format-region))
</span></span></code></pre></div><h4 id=auto-include-c-plus-plus-headers>Auto-include C++ headers</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! cpp-auto-include
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;emacsorphanage/cpp-auto-include&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! cpp-auto-include
</span></span><span style=display:flex><span>  :commands cpp-auto-include)
</span></span></code></pre></div><h4 id=erefactor>Erefactor</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! erefactor
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;mhayashi1120/Emacs-erefactor&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! erefactor
</span></span><span style=display:flex><span>  :defer <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h4 id=lorem-ipsum>Lorem ipsum</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! emacs-lorem-ipsum
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;jschaf/emacs-lorem-ipsum&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! lorem-ipsum
</span></span><span style=display:flex><span>  :commands (lorem-ipsum-insert-sentences
</span></span><span style=display:flex><span>             lorem-ipsum-insert-paragraphs
</span></span><span style=display:flex><span>             lorem-ipsum-insert-list))
</span></span></code></pre></div><h4 id=coverage-test>Coverage test</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! cov)
</span></span></code></pre></div><h3 id=debugging>Debugging</h3><h4 id=dap>DAP</h4><p>I like to use <a href=https://github.com/Microsoft/vscode-cpptools><code>cpptools</code></a> over <a href=https://github.com/WebFreak001/code-debug><code>webfreak.debug</code></a>. So I enable it after loading
<code>dap-mode</code>. I like also to have a mode minimal UI. And I like to trigger <code>dap-hydra</code>
when the program hits a break point, and automatically delete the session and
close Hydra when DAP is terminated.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(unpin! dap-mode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! dap-mode
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Set latest versions</span>
</span></span><span style=display:flex><span>  (setq dap-cpptools-extension-version <span style=color:#e6db74>&#34;1.11.5&#34;</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;dap-cpptools</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq dap-codelldb-extension-version <span style=color:#e6db74>&#34;1.7.4&#34;</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;dap-codelldb</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq dap-gdb-lldb-extension-version <span style=color:#e6db74>&#34;0.26.0&#34;</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;dap-gdb-lldb</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; More minimal UI</span>
</span></span><span style=display:flex><span>  (setq dap-auto-configure-features <span style=color:#f92672>&#39;</span>(breakpoints locals expressions tooltip)
</span></span><span style=display:flex><span>        dap-auto-show-output <span style=color:#66d9ef>nil</span> <span style=color:#75715e>;; Hide the annoying server output</span>
</span></span><span style=display:flex><span>        lsp-enable-dap-auto-configure <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Automatically trigger dap-hydra when a program hits a breakpoint.</span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;dap-stopped-hook</span> (lambda (arg) (<span style=color:#a6e22e>call-interactively</span> <span style=color:#a6e22e>#&#39;</span>dap-hydra)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Automatically delete session and close dap-hydra when DAP is terminated.</span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;dap-terminated-hook</span>
</span></span><span style=display:flex><span>            (lambda (arg)
</span></span><span style=display:flex><span>              (<span style=color:#a6e22e>call-interactively</span> <span style=color:#a6e22e>#&#39;</span>dap-delete-session)
</span></span><span style=display:flex><span>              (dap-hydra/nil)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; A workaround to correctly show breakpoints</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; from: https://github.com/emacs-lsp/dap-mode/issues/374#issuecomment-1140399819</span>
</span></span><span style=display:flex><span>  (add-hook! +dap-running-session-mode
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-buffer</span> <span style=color:#66d9ef>nil</span> (<span style=color:#a6e22e>current-buffer</span>))))
</span></span></code></pre></div><h5 id=doom-store>Doom store</h5><p>Doom Emacs stores session information persistently using the core <code>store</code>
mechanism. However, relaunching a new session doesn&rsquo;t overwrite the last stored
session, to do so, I define a helper function to clear data stored in the
<code>"+debugger"</code> location. (see <code>+debugger--get-last-config</code> function.)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +debugger/clear-last-session ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Clear the last stored session&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (doom-store-clear <span style=color:#e6db74>&#34;+debugger&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :leader :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>      (:when (modulep! :tools debugger +lsp)
</span></span><span style=display:flex><span>       :prefix (<span style=color:#e6db74>&#34;d&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;debugger&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Clear last DAP session&#34;</span> <span style=color:#e6db74>&#34;c&#34;</span> <span style=color:#a6e22e>#&#39;</span>+debugger/clear-last-session))
</span></span></code></pre></div><h4 id=realgud>RealGUD</h4><p>For C/C++, DAP mode is missing so much features. In my experience, both <code>cpptools</code>
and <code>gdb</code> DAP interfaces aren&rsquo;t mature, it stops and disconnect while debugging,
making it a double pain.</p><h5 id=additional-commands>Additional commands</h5><p>There is no better than using pure GDB, it makes debugging extremely flexible.
Let&rsquo;s define some missing GDB commands, add them to Hydra keys, and define some
reverse debugging commands for usage with <a href=https://rr-project.org>rr</a> (which we can use by substituting
<code>gdb</code> by <code>rr replay</code> when starting a debug session).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! realgud
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;hydra</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Add some missing gdb/rr commands</span>
</span></span><span style=display:flex><span>  (defun +realgud:cmd-start (arg)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;start = break main + run&#34;</span>
</span></span><span style=display:flex><span>    (interactive <span style=color:#e6db74>&#34;p&#34;</span>)
</span></span><span style=display:flex><span>    (realgud-command <span style=color:#e6db74>&#34;start&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +realgud:cmd-reverse-next (arg)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Reverse next&#34;</span>
</span></span><span style=display:flex><span>    (interactive <span style=color:#e6db74>&#34;p&#34;</span>)
</span></span><span style=display:flex><span>    (realgud-command <span style=color:#e6db74>&#34;reverse-next&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +realgud:cmd-reverse-step (arg)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Reverse step&#34;</span>
</span></span><span style=display:flex><span>    (interactive <span style=color:#e6db74>&#34;p&#34;</span>)
</span></span><span style=display:flex><span>    (realgud-command <span style=color:#e6db74>&#34;reverse-step&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +realgud:cmd-reverse-continue (arg)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Reverse continue&#34;</span>
</span></span><span style=display:flex><span>    (interactive <span style=color:#e6db74>&#34;p&#34;</span>)
</span></span><span style=display:flex><span>    (realgud-command <span style=color:#e6db74>&#34;reverse-continue&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +realgud:cmd-reverse-finish (arg)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Reverse finish&#34;</span>
</span></span><span style=display:flex><span>    (interactive <span style=color:#e6db74>&#34;p&#34;</span>)
</span></span><span style=display:flex><span>    (realgud-command <span style=color:#e6db74>&#34;reverse-finish&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Define a hydra binding</span>
</span></span><span style=display:flex><span>  (defhydra realgud-hydra (:color pink :hint <span style=color:#66d9ef>nil</span> :foreign-keys run)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74> Stepping  |  _n_: next      |  _i_: step    |  _o_: finish  |  _c_: continue  |  _R_: restart  |  _u_: until-here
</span></span></span><span style=display:flex><span><span style=color:#e6db74> Revese    | _rn_: next      | _ri_: step    | _ro_: finish  | _rc_: continue  |
</span></span></span><span style=display:flex><span><span style=color:#e6db74> Breakpts  | _ba_: break     | _bD_: delete  | _bt_: tbreak  | _bd_: disable   | _be_: enable   | _tr_: backtrace
</span></span></span><span style=display:flex><span><span style=color:#e6db74> Eval      | _ee_: at-point  | _er_: region  | _eE_: eval    |
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           |  _!_: shell     | _Qk_: kill    | _Qq_: quit    | _Sg_: gdb       | _Ss_: start
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;n&#34;</span>  realgud:cmd-next)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;i&#34;</span>  realgud:cmd-step)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;o&#34;</span>  realgud:cmd-finish)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;c&#34;</span>  realgud:cmd-continue)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;R&#34;</span>  realgud:cmd-restart)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;u&#34;</span>  realgud:cmd-until-here)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rn&#34;</span> +realgud:cmd-reverse-next)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ri&#34;</span> +realgud:cmd-reverse-step)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ro&#34;</span> +realgud:cmd-reverse-finish)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;rc&#34;</span> +realgud:cmd-reverse-continue)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ba&#34;</span> realgud:cmd-break)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;bt&#34;</span> realgud:cmd-tbreak)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;bD&#34;</span> realgud:cmd-delete)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;be&#34;</span> realgud:cmd-enable)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;bd&#34;</span> realgud:cmd-disable)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;ee&#34;</span> realgud:cmd-eval-at-point)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;er&#34;</span> realgud:cmd-eval-region)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;tr&#34;</span> realgud:cmd-backtrace)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;eE&#34;</span> realgud:cmd-eval)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;!&#34;</span>  realgud:cmd-shell)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;Qk&#34;</span> realgud:cmd-kill)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;Sg&#34;</span> realgud:gdb)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;Ss&#34;</span> +realgud:cmd-start)
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;q&#34;</span>  <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#34;quit&#34;</span> :color blue) <span style=color:#75715e>;; :exit</span>
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;Qq&#34;</span> realgud:cmd-quit :color blue)) <span style=color:#75715e>;; :exit</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +debugger/realgud:gdb-hydra ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Run </span><span style=color:#e6db74>`realgud-hydra&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (realgud-hydra/body))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :leader :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>        (:when (modulep! :tools debugger)
</span></span><span style=display:flex><span>         :prefix (<span style=color:#e6db74>&#34;d&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;debugger&#34;</span>)
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;RealGUD hydra&#34;</span> <span style=color:#e6db74>&#34;h&#34;</span> <span style=color:#a6e22e>#&#39;</span>+debugger/realgud:gdb-hydra)))
</span></span></code></pre></div><h5 id=record-and-replay-rr>Record and replay <code>rr</code></h5><p>We then add some shortcuts to run <code>rr</code> from Emacs, the <code>rr record</code> takes the program
name and arguments from my local <code>+realgud-debug-config</code>, when <code>rr replay</code> respects
the arguments configured in RealGUD&rsquo;s GDB command name. Some useful hints could
be found <a href=http://notes.secretsauce.net/notes/2017/02/24_interfacing-rr-to-gdb-in-gnu-emacs.html>here</a>, <a href=https://github.com/rr-debugger/rr/blob/82ab0f9f5bc13fb27acaccb9a85397bcaa7a7b05/src/ReplayCommand.cc#L45>here</a>, <a href=https://github.com/rr-debugger/rr/issues/1484>here</a> and <a href=https://emacs.stackexchange.com/questions/20056/is-it-possible-to-use-mozillas-rr-with-gdb-multi-window>here</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! realgud
</span></span><span style=display:flex><span>  (defun +debugger/rr-replay ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Launch `rr replay&#39;.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (realgud:gdb (+str-replace <span style=color:#e6db74>&#34;gdb&#34;</span> <span style=color:#e6db74>&#34;rr replay&#34;</span> realgud:gdb-command-name)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +debugger/rr-record ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Launch `rr record&#39; with parameters from launch.json or </span><span style=color:#e6db74>`+launch-json-debug-config&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (let* ((conf (launch-json--config-choice))
</span></span><span style=display:flex><span>           (args (launch-json--substite-special-vars (<span style=color:#a6e22e>plist-get</span> conf :program) (<span style=color:#a6e22e>plist-get</span> conf :args))))
</span></span><span style=display:flex><span>      (unless (make-process :name <span style=color:#e6db74>&#34;rr-record&#34;</span>
</span></span><span style=display:flex><span>                            :buffer <span style=color:#e6db74>&#34;*rr record*&#34;</span>
</span></span><span style=display:flex><span>                            :command (<span style=color:#a6e22e>append</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;rr&#34;</span> <span style=color:#e6db74>&#34;record&#34;</span>) args))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Cannot start the &#39;rr record&#39; process&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :leader :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>        (:when (modulep! :tools debugger)
</span></span><span style=display:flex><span>         :prefix (<span style=color:#e6db74>&#34;d&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;debugger&#34;</span>)
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;rr record&#34;</span> <span style=color:#e6db74>&#34;r&#34;</span> <span style=color:#a6e22e>#&#39;</span>+debugger/rr-record
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;rr replay&#34;</span> <span style=color:#e6db74>&#34;R&#34;</span> <span style=color:#a6e22e>#&#39;</span>+debugger/rr-replay)))
</span></span></code></pre></div><h5 id=additional-debuggers-for-realgud>Additional debuggers for RealGUD</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! realgud-lldb)
</span></span><span style=display:flex><span>(package! realgud-ipdb)
</span></span><span style=display:flex><span>(package! realgud-trepan-xpy :recipe (:host github :repo <span style=color:#e6db74>&#34;realgud/trepan-xpy&#34;</span>))
</span></span><span style=display:flex><span>(package! realgud-maxima :recipe (:host github :repo <span style=color:#e6db74>&#34;realgud/realgud-maxima&#34;</span>))
</span></span></code></pre></div><h4 id=gdb>GDB</h4><h5 id=emacs-gdb-a-dot-k-dot-a-dot-gdb-mi>Emacs GDB <em>a.k.a.</em> <code>gdb-mi</code></h5><p>DAP mode is great, however, it is not mature for C/C++ debugging, it does not
support some basic features like <em>Run until cursor</em>, <em>Show disassembled code</em>, etc.
Emacs have builtin <code>gdb</code> support through <code>gdb-mi</code> and <code>gud-gdb</code>.</p><p>The <code>emacs-gdb</code> package overwrites the builtin <code>gdb-mi</code>, it is much faster (thanks
to it&rsquo;s C module), and it defines some easy to use UI, with Visual Studio like
keybindings.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! gdb-mi
</span></span><span style=display:flex><span>  :disable <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;weirdNox/emacs-gdb&#34;</span>
</span></span><span style=display:flex><span>           :files (<span style=color:#e6db74>&#34;*.el&#34;</span> <span style=color:#e6db74>&#34;*.c&#34;</span> <span style=color:#e6db74>&#34;*.h&#34;</span> <span style=color:#e6db74>&#34;Makefile&#34;</span>)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! gdb-mi
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>fmakunbound</span> <span style=color:#e6db74>&#39;gdb</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>fmakunbound</span> <span style=color:#e6db74>&#39;gdb-enable-debug</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq gdb-window-setup-function <span style=color:#a6e22e>#&#39;</span>gdb--setup-windows <span style=color:#75715e>;; TODO: Customize this</span>
</span></span><span style=display:flex><span>        gdb-ignore-gdbinit <span style=color:#66d9ef>nil</span>) <span style=color:#75715e>;; I use gdbinit to define some useful stuff</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; History</span>
</span></span><span style=display:flex><span>  (defvar +gdb-history-file <span style=color:#e6db74>&#34;~/.gdb_history&#34;</span>)
</span></span><span style=display:flex><span>  (defun +gud-gdb-mode-hook-setup ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;GDB setup.&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Suposes &#34;~/.gdbinit&#34; contains:</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; set history save on</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; set history filename ~/.gdb_history</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; set history remove-duplicates 2048</span>
</span></span><span style=display:flex><span>    (when (and (ring-empty-p comint-input-ring)
</span></span><span style=display:flex><span>               (<span style=color:#a6e22e>file-exists-p</span> +gdb-history-file))
</span></span><span style=display:flex><span>      (setq comint-input-ring-file-name +gdb-history-file)
</span></span><span style=display:flex><span>      (comint-read-input-ring <span style=color:#66d9ef>t</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;gud-gdb-mode-hook</span> <span style=color:#e6db74>&#39;+gud-gdb-mode-hook-setup</span>))
</span></span></code></pre></div><h5 id=custom-layout-for-gdb-many-windows>Custom layout for <code>gdb-many-windows</code></h5><p>Stolen from <a href=https://stackoverflow.com/a/41326527/3058915>https://stackoverflow.com/a/41326527/3058915</a>. I used it to change
the builtin <code>gdb-many-windows</code> layout.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq gdb-many-windows <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun set-gdb-layout(<span style=color:#66d9ef>&amp;optional</span> c-buffer)
</span></span><span style=display:flex><span>  (if (not c-buffer)
</span></span><span style=display:flex><span>      (setq c-buffer (<span style=color:#a6e22e>window-buffer</span> (<span style=color:#a6e22e>selected-window</span>)))) <span style=color:#75715e>;; save current buffer</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; from http://stackoverflow.com/q/39762833/846686</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>set-window-dedicated-p</span> (<span style=color:#a6e22e>selected-window</span>) <span style=color:#66d9ef>nil</span>) <span style=color:#75715e>;; unset dedicate state if needed</span>
</span></span><span style=display:flex><span>  (switch-to-buffer gud-comint-buffer)
</span></span><span style=display:flex><span>  (delete-other-windows) <span style=color:#75715e>;; clean all</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (let* ((w-source (<span style=color:#a6e22e>selected-window</span>)) <span style=color:#75715e>;; left top</span>
</span></span><span style=display:flex><span>         (w-gdb (split-window w-source <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#39;right</span>)) <span style=color:#75715e>;; right bottom</span>
</span></span><span style=display:flex><span>         (w-locals (split-window w-gdb <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#39;above</span>)) <span style=color:#75715e>;; right middle bottom</span>
</span></span><span style=display:flex><span>         (w-stack (split-window w-locals <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#39;above</span>)) <span style=color:#75715e>;; right middle top</span>
</span></span><span style=display:flex><span>         (w-breakpoints (split-window w-stack <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#39;above</span>)) <span style=color:#75715e>;; right top</span>
</span></span><span style=display:flex><span>         (w-io (split-window w-source (<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>*</span> <span style=color:#ae81ff>0.9</span> (<span style=color:#a6e22e>window-body-height</span>))) <span style=color:#e6db74>&#39;below</span>))) <span style=color:#75715e>;; left bottom</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-buffer</span> w-io (gdb-get-buffer-create <span style=color:#e6db74>&#39;gdb-inferior-io</span>))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-dedicated-p</span> w-io <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-buffer</span> w-breakpoints (gdb-get-buffer-create <span style=color:#e6db74>&#39;gdb-breakpoints-buffer</span>))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-dedicated-p</span> w-breakpoints <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-buffer</span> w-locals (gdb-get-buffer-create <span style=color:#e6db74>&#39;gdb-locals-buffer</span>))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-dedicated-p</span> w-locals <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-buffer</span> w-stack (gdb-get-buffer-create <span style=color:#e6db74>&#39;gdb-stack-buffer</span>))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-dedicated-p</span> w-stack <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-buffer</span> w-gdb gud-comint-buffer)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>select-window</span> w-source)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>set-window-buffer</span> w-source c-buffer)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defadvice gdb (around args activate)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Change the way to gdb works.&#34;</span>
</span></span><span style=display:flex><span>  (setq global-config-editing (<span style=color:#a6e22e>current-window-configuration</span>)) <span style=color:#75715e>;; to restore: (set-window-configuration c-editing)</span>
</span></span><span style=display:flex><span>  (let ((c-buffer (<span style=color:#a6e22e>window-buffer</span> (<span style=color:#a6e22e>selected-window</span>)))) <span style=color:#75715e>;; save current buffer</span>
</span></span><span style=display:flex><span>    ad-do-it
</span></span><span style=display:flex><span>    (set-gdb-layout c-buffer)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defadvice gdb-reset (around args activate)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Change the way to gdb exit.&#34;</span>
</span></span><span style=display:flex><span>  ad-do-it
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>set-window-configuration</span> global-config-editing))
</span></span></code></pre></div><h5 id=highlight-current-line>Highlight current line</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar gud-overlay
</span></span><span style=display:flex><span>  (let* ((ov (<span style=color:#a6e22e>make-overlay</span> (<span style=color:#a6e22e>point-min</span>) (<span style=color:#a6e22e>point-min</span>))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>overlay-put</span> ov <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;secondary-selection</span>)
</span></span><span style=display:flex><span>    ov)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Overlay variable for GUD highlighting.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defadvice gud-display-line (after my-gud-highlight act)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Highlight current line.&#34;</span>
</span></span><span style=display:flex><span>  (let* ((ov gud-overlay)
</span></span><span style=display:flex><span>         (bf (gud-find-file true-file)))
</span></span><span style=display:flex><span>    (with-current-buffer bf
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>move-overlay</span> ov (<span style=color:#a6e22e>line-beginning-position</span>) (<span style=color:#a6e22e>line-beginning-position</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>                    <span style=color:#75715e>;; (move-overlay ov (line-beginning-position) (line-end-position)</span>
</span></span><span style=display:flex><span>                    (<span style=color:#a6e22e>current-buffer</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun gud-kill-buffer ()
</span></span><span style=display:flex><span>  (if (derived-mode-p <span style=color:#e6db74>&#39;gud-mode</span>)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>delete-overlay</span> gud-overlay)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;kill-buffer-hook</span> <span style=color:#e6db74>&#39;gud-kill-buffer</span>)
</span></span></code></pre></div><h4 id=wip-launch-dot-json-support-for-gud-and-realgud>WIP <code>launch.json</code> support for GUD and RealGUD</h4><p>I do a lot of development on C/C++ apps that gets data from command line
arguments, which means I have to type my arguments manually after calling
<code>realgud:gdb</code>, which is very annoying.</p><p>For DAP mode, there is a support for either <code>dap-debug-edit-template</code>, or
<code>launch.json</code>. For GUD/RealGUD though, I didn&rsquo;t find any ready-to-use feature like
this. So let&rsquo;s code it!</p><p>I like to define a variable named <code>+launch-json-debug-config</code> to use as a
fallback, if no <code>launch.json</code> file is present.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; A variable which to be used in .dir-locals.el, formatted as a list of plists;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; &#39;((:program &#34;...&#34; :args (&#34;args1&#34; &#34;arg2&#34; ...)))</span>
</span></span><span style=display:flex><span>(defvar +launch-json-debug-config <span style=color:#66d9ef>nil</span>)
</span></span></code></pre></div><p>This variable should have the same structure of a <code>launch.json</code> file, in Elisp, it
should be a <em>list of plists</em>, each <code>plist</code> represents a configuration, this variable
can be set in <code>.dir-locals.el</code> for example.</p><p>The configuration plists supports some of <code>launch.json</code> parameters, including:</p><ul><li><code>:name</code> a description of the debug configuration;</li><li><code>:type</code> which debugger to use;</li><li><code>:program</code> the path of the debuggee program;</li><li><code>:args</code> a list of string arguments to pass to the debuggee program.</li></ul><p>The variable <code>+launch-json-debug-config</code> can be set in a per-project basis thanks
to <code>.dir-locals.el</code>, something like this:</p><pre tabindex=0><code class=language-lisp-data data-lang=lisp-data>;; Example entry in .dir-locals.el
((nil . ((+launch-json-debug-config . &#39;((:name &#34;Debug my_prog with csv data&#34;
                                         :type &#34;realgud:gdb&#34; ;; One config with `realgud:gdb&#39;
                                         :program &#34;${workspaceFolder}/build/bin/my_prog&#34;
                                         :args (&#34;--in_file=${workspaceFolder}/some/file.csv&#34;
                                                &#34;--some-parameter&#34; &#34;-a&#34; &#34;-b&#34;
                                                &#34;--out_file=/tmp/some_randome_file&#34;
                                                &#34;-a&#34;))
                                        (:name &#34;Debug my_prog with options &#39;-a&#39; and &#39;-b&#39;&#34;
                                         :type &#34;gdb-mi&#34; ;; Another config with `gdb-mi&#39;
                                         :program &#34;${workspaceFolder}/build/bin/my_prog&#34;
                                         :args (&#34;-a&#34; &#34;-b&#34;)))))))
</code></pre><p>The list of implemented special variables are listed in the table below, they
have been defined as specified in <a href=https://code.visualstudio.com/docs/editor/variables-reference>VS Code</a>.</p><table><thead><tr><th><strong>Variable</strong></th><th><strong>Example</strong></th></tr></thead><tbody><tr><td><code>userHome</code></td><td><code>/home/username</code></td></tr><tr><td><code>workspaceFolder</code></td><td><code>/home/username/your-project</code></td></tr><tr><td><code>workspaceFolderBasename</code></td><td><code>your-project</code></td></tr><tr><td><code>file</code></td><td><code>/home/username/your-project/folder/file.cc</code></td></tr><tr><td><code>fileWorkspaceFolder</code></td><td><code>/home/username/your-project</code></td></tr><tr><td><code>relativeFile</code></td><td><code>folder/file.cc</code></td></tr><tr><td><code>relativeFileDirname</code></td><td><code>folder</code></td></tr><tr><td><code>fileBasename</code></td><td><code>file.cc</code></td></tr><tr><td><code>fileBasenameNoExtension</code></td><td><code>file</code></td></tr><tr><td><code>fileDirname</code></td><td><code>/home/username/your-project/folder</code></td></tr><tr><td><code>fileExtname</code></td><td><code>.cc</code></td></tr><tr><td><code>lineNumber</code></td><td>Line number of the cursor</td></tr><tr><td><code>selectedText</code></td><td>Text selected in your code editor</td></tr><tr><td><code>pathSeparator</code></td><td>Returns <code>/</code> on *nix, and <code>\</code> on Windows</td></tr></tbody></table><p>If a <code>launch.json</code> file is detected in the project directory, it gets read and
searches for a configuration for the <code>realgud:gdb</code> debugger. So you need to have a
section with type <code>realgud:gdb</code>. This is an example of a valid <code>launch.json</code> file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.2.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;configurations&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Emacs::RealGUD:GDB (view_trajectory)&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;realgud:gdb&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;request&#34;</span>: <span style=color:#e6db74>&#34;launch&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;dap-compilation&#34;</span>: <span style=color:#e6db74>&#34;cmake --build build/debug -- -j 8&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;dap-compilation-dir&#34;</span>: <span style=color:#e6db74>&#34;${workspaceFolder}&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;program&#34;</span>: <span style=color:#e6db74>&#34;${workspaceFolder}/build/debug/bin/view_trajectory&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;args&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;htraj=${workspaceFolder}/data/seq1/h_poses.csv&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;traj=${workspaceFolder}/data/seq1/poses.csv&#34;</span>
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;stopAtEntry&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;cwd&#34;</span>: <span style=color:#e6db74>&#34;${workspaceFolder}&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;environment&#34;</span>: [],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;externalConsole&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The example above defines several parameters, however, only <code>type</code>, <code>program</code> and
<code>args</code> are used at the moment.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar launch-json--gud-debugger-regex
</span></span><span style=display:flex><span>  (rx (seq bol (group-n <span style=color:#ae81ff>1</span> (or <span style=color:#e6db74>&#34;gdb&#34;</span> <span style=color:#e6db74>&#34;gud-gdb&#34;</span> <span style=color:#e6db74>&#34;perldb&#34;</span> <span style=color:#e6db74>&#34;pdb&#34;</span> <span style=color:#e6db74>&#34;jdb&#34;</span> <span style=color:#e6db74>&#34;guiler&#34;</span> <span style=color:#e6db74>&#34;dbx&#34;</span> <span style=color:#e6db74>&#34;sdb&#34;</span> <span style=color:#e6db74>&#34;xdb&#34;</span>) eol))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar launch-json--realgud-debugger-regex
</span></span><span style=display:flex><span>  (rx (seq bol (or (seq <span style=color:#e6db74>&#34;realgud:&#34;</span> (group-n <span style=color:#ae81ff>1</span> (or <span style=color:#e6db74>&#34;gdb&#34;</span> <span style=color:#e6db74>&#34;pdb&#34;</span>
</span></span><span style=display:flex><span>                                                  <span style=color:#e6db74>&#34;bashdb&#34;</span>  <span style=color:#e6db74>&#34;kshdb&#34;</span> <span style=color:#e6db74>&#34;zshd&#34;</span>
</span></span><span style=display:flex><span>                                                  <span style=color:#e6db74>&#34;perldb&#34;</span> <span style=color:#e6db74>&#34;rdebug&#34;</span> <span style=color:#e6db74>&#34;remake&#34;</span>
</span></span><span style=display:flex><span>                                                  <span style=color:#e6db74>&#34;trepan&#34;</span> <span style=color:#e6db74>&#34;trepan2&#34;</span> <span style=color:#e6db74>&#34;trepan3k&#34;</span> <span style=color:#e6db74>&#34;trepanjs&#34;</span> <span style=color:#e6db74>&#34;trepan.pl&#34;</span>)))
</span></span><span style=display:flex><span>                   (seq <span style=color:#e6db74>&#34;realgud-&#34;</span> (group-n <span style=color:#ae81ff>1</span> (or <span style=color:#e6db74>&#34;gub&#34;</span>)))
</span></span><span style=display:flex><span>                   <span style=color:#75715e>;; Additional debuggers</span>
</span></span><span style=display:flex><span>                   (seq <span style=color:#e6db74>&#34;realgud:&#34;</span> (group-n <span style=color:#ae81ff>1</span> (or <span style=color:#e6db74>&#34;xdebug&#34;</span> <span style=color:#e6db74>&#34;pry&#34;</span> <span style=color:#e6db74>&#34;jdb&#34;</span> <span style=color:#e6db74>&#34;ipdb&#34;</span> <span style=color:#e6db74>&#34;trepan-xpy&#34;</span> <span style=color:#e6db74>&#34;trepan-ni&#34;</span> <span style=color:#e6db74>&#34;node-inspect&#34;</span>)))
</span></span><span style=display:flex><span>                   <span style=color:#75715e>;; `realgud-lldb&#39; defines the debug command as `realgud--lldb&#39;,</span>
</span></span><span style=display:flex><span>                   <span style=color:#75715e>;; We accept both `realgud:lldb&#39; and `realgud--lldb&#39; in the config</span>
</span></span><span style=display:flex><span>                   (seq <span style=color:#e6db74>&#34;realgud&#34;</span> (or <span style=color:#e6db74>&#34;:&#34;</span> <span style=color:#e6db74>&#34;--&#34;</span>) (group-n <span style=color:#ae81ff>1</span> (or <span style=color:#e6db74>&#34;lldb&#34;</span>)))) eol)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Define aliases for realgud-lldb</span>
</span></span><span style=display:flex><span>(with-eval-after-load <span style=color:#e6db74>&#39;realgud-lldb</span>
</span></span><span style=display:flex><span>  (defalias <span style=color:#e6db74>&#39;realgud:lldb</span> <span style=color:#e6db74>&#39;realgud--lldb</span>)
</span></span><span style=display:flex><span>  (defalias <span style=color:#e6db74>&#39;realgud:lldb-command-name</span> <span style=color:#e6db74>&#39;realgud--lldb-command-name</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Define aliases for realgud-ipdb</span>
</span></span><span style=display:flex><span>(with-eval-after-load <span style=color:#e6db74>&#39;realgud-ipdb</span>
</span></span><span style=display:flex><span>  (defalias <span style=color:#e6db74>&#39;realgud:ipdb-command-name</span> <span style=color:#e6db74>&#39;realgud--ipdb-command-name</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar launch-json--last-config <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun launch-json-last-config-clear ()
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (setq-local launch-json--last-config <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun launch-json--substite-special-vars (program <span style=color:#66d9ef>&amp;optional</span> args)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Substitue variables in PROGRAM and ARGS.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Return a list, in which processed PROGRAM is the first element, followed by ARGS.&#34;</span>
</span></span><span style=display:flex><span>  (let* ((curr-file (ignore-errors (<span style=color:#a6e22e>expand-file-name</span> (<span style=color:#a6e22e>buffer-file-name</span>))))
</span></span><span style=display:flex><span>         (ws-root (string-trim-right
</span></span><span style=display:flex><span>                   (<span style=color:#a6e22e>expand-file-name</span>
</span></span><span style=display:flex><span>                    (or (projectile-project-root)
</span></span><span style=display:flex><span>                        (ignore-errors (<span style=color:#a6e22e>file-name-directory</span> curr-file))
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#34;.&#34;</span>))
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;/&#34;</span>))
</span></span><span style=display:flex><span>         (ws-basename (<span style=color:#a6e22e>file-name-nondirectory</span> ws-root)))
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Replace special variables</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>mapcar</span>
</span></span><span style=display:flex><span>     (lambda (str)
</span></span><span style=display:flex><span>       (+str-replace-all
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>append</span>
</span></span><span style=display:flex><span>         (<span style=color:#a6e22e>list</span>
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${workspaceFolder}&#34;</span> ws-root)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${workspaceFolderBasename}&#34;</span> ws-basename)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${userHome}&#34;</span> (or (getenv <span style=color:#e6db74>&#34;HOME&#34;</span>) (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~&#34;</span>)))
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${pathSeparator}&#34;</span> (if (<span style=color:#a6e22e>memq</span> system-type
</span></span><span style=display:flex><span>                                             <span style=color:#f92672>&#39;</span>(windows-nt ms-dos cygwin))
</span></span><span style=display:flex><span>                                       <span style=color:#e6db74>&#34;\\&#34;</span> <span style=color:#e6db74>&#34;/&#34;</span>))
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${selectedText}&#34;</span> (if (use-region-p)
</span></span><span style=display:flex><span>                                      (<span style=color:#a6e22e>buffer-substring-no-properties</span>
</span></span><span style=display:flex><span>                                       (<span style=color:#a6e22e>region-beginning</span>) (<span style=color:#a6e22e>region-end</span>)) <span style=color:#e6db74>&#34;&#34;</span>)))
</span></span><span style=display:flex><span>         <span style=color:#75715e>;; To avoid problems if launched from a non-file buffer</span>
</span></span><span style=display:flex><span>         (when curr-file
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>list</span>
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${file}&#34;</span> curr-file)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${relativeFile}&#34;</span> (file-relative-name curr-file ws-root))
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${relativeFileDirname}&#34;</span> (file-relative-name
</span></span><span style=display:flex><span>                                            (<span style=color:#a6e22e>file-name-directory</span> curr-file) ws-root))
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${fileBasename}&#34;</span> (<span style=color:#a6e22e>file-name-nondirectory</span> curr-file))
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${fileBasenameNoExtension}&#34;</span> (file-name-base curr-file))
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${fileDirname}&#34;</span> (<span style=color:#a6e22e>file-name-directory</span> curr-file))
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${fileExtname}&#34;</span> (file-name-extension curr-file))
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;${lineNumber}&#34;</span> (line-number-at-pos (<span style=color:#a6e22e>point</span>) <span style=color:#66d9ef>t</span>)))))
</span></span><span style=display:flex><span>        str))
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>cons</span> program args))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun launch-json--debugger-params (type)
</span></span><span style=display:flex><span>  (let* ((front/backend
</span></span><span style=display:flex><span>          (cond ((<span style=color:#a6e22e>string-match</span> launch-json--realgud-debugger-regex type)
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#39;realgud</span> (<span style=color:#a6e22e>intern</span> (match-string <span style=color:#ae81ff>1</span> type))))
</span></span><span style=display:flex><span>                ((<span style=color:#a6e22e>string-match</span> launch-json--gud-debugger-regex type)
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#39;gud</span> (<span style=color:#a6e22e>intern</span> (match-string <span style=color:#ae81ff>1</span> type))))
</span></span><span style=display:flex><span>                (<span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#39;unknown</span> <span style=color:#e6db74>&#39;unknown</span>))))
</span></span><span style=display:flex><span>         (frontend (<span style=color:#a6e22e>car</span> front/backend))
</span></span><span style=display:flex><span>         (backend (<span style=color:#a6e22e>cdr</span> front/backend))
</span></span><span style=display:flex><span>         (cmd-sym (unless (<span style=color:#a6e22e>eq</span> frontend <span style=color:#e6db74>&#39;unknown</span>)
</span></span><span style=display:flex><span>                    (<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>format</span> (cond ((<span style=color:#a6e22e>eq</span> frontend <span style=color:#e6db74>&#39;gud</span>) <span style=color:#e6db74>&#34;gud-%s-%s&#34;</span>)
</span></span><span style=display:flex><span>                                          ((<span style=color:#a6e22e>eq</span> frontend <span style=color:#e6db74>&#39;realgud</span>) <span style=color:#e6db74>&#34;%s-%s&#34;</span>)
</span></span><span style=display:flex><span>                                          (<span style=color:#66d9ef>t</span> <span style=color:#e6db74>&#34;%s-%s&#34;</span>))
</span></span><span style=display:flex><span>                                    type
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;command-name&#34;</span>)))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;[launch-json:params]: Found type: %s -&gt; { frontend: %s | backend: %s }&#34;</span>
</span></span><span style=display:flex><span>             type (<span style=color:#a6e22e>symbol-name</span> frontend) (<span style=color:#a6e22e>symbol-name</span> backend))
</span></span><span style=display:flex><span>    (cond ((<span style=color:#a6e22e>memq</span> backend <span style=color:#f92672>&#39;</span>(gud-gdb gdb))
</span></span><span style=display:flex><span>           <span style=color:#75715e>;; Special case for &#39;(gud . gdb), uses `gdb-mi&#39;</span>
</span></span><span style=display:flex><span>           (let ((use-gdb-mi (<span style=color:#a6e22e>equal</span> front/backend <span style=color:#f92672>&#39;</span>(gud <span style=color:#f92672>.</span> gdb))))
</span></span><span style=display:flex><span>             <span style=color:#f92672>`</span>(:type <span style=color:#f92672>,</span>type
</span></span><span style=display:flex><span>               :debug-cmd <span style=color:#f92672>,</span>(if use-gdb-mi <span style=color:#e6db74>&#39;gdb</span> (<span style=color:#a6e22e>intern</span> type))
</span></span><span style=display:flex><span>               :args-format <span style=color:#e6db74>&#34; --args %s %s&#34;</span>
</span></span><span style=display:flex><span>               :cmd <span style=color:#f92672>,</span>cmd-sym
</span></span><span style=display:flex><span>               :require <span style=color:#f92672>,</span>(if use-gdb-mi <span style=color:#e6db74>&#39;gdb-mi</span> frontend))))
</span></span><span style=display:flex><span>          ((<span style=color:#a6e22e>eq</span> backend <span style=color:#e6db74>&#39;lldb</span>)
</span></span><span style=display:flex><span>           <span style=color:#f92672>`</span>(:type <span style=color:#f92672>,</span>type
</span></span><span style=display:flex><span>             :debug-cmd <span style=color:#f92672>,</span>(<span style=color:#a6e22e>intern</span> type)
</span></span><span style=display:flex><span>             :args-format <span style=color:#e6db74>&#34; -- %s %s&#34;</span>
</span></span><span style=display:flex><span>             :cmd <span style=color:#f92672>,</span>cmd-sym
</span></span><span style=display:flex><span>             :require <span style=color:#f92672>,</span>(<span style=color:#a6e22e>intern</span> (if (<span style=color:#a6e22e>eq</span> frontend <span style=color:#e6db74>&#39;realgud</span>)
</span></span><span style=display:flex><span>                                   (+str-replace-all <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;--&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;-&#34;</span>) (<span style=color:#e6db74>&#34;:&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;-&#34;</span>)) type)
</span></span><span style=display:flex><span>                                 type))))
</span></span><span style=display:flex><span>          (<span style=color:#66d9ef>t</span> <span style=color:#75715e>;; TODO: to be expanded for each debugger</span>
</span></span><span style=display:flex><span>           <span style=color:#f92672>`</span>(:type <span style=color:#f92672>,</span>type
</span></span><span style=display:flex><span>             :debug-cmd <span style=color:#f92672>,</span>(<span style=color:#a6e22e>intern</span> type)
</span></span><span style=display:flex><span>             :args-format <span style=color:#e6db74>&#34; %s %s&#34;</span>
</span></span><span style=display:flex><span>             :cmd <span style=color:#f92672>,</span>(if (<span style=color:#a6e22e>equal</span> front/backend <span style=color:#f92672>&#39;</span>(realgud <span style=color:#f92672>.</span> ipdb)) <span style=color:#e6db74>&#39;realgud--ipdb-command-name</span> cmd-sym)
</span></span><span style=display:flex><span>             :require <span style=color:#f92672>,</span>(cond ((<span style=color:#a6e22e>equal</span> front/backend <span style=color:#f92672>&#39;</span>(realgud <span style=color:#f92672>.</span> trepan-ni)) <span style=color:#e6db74>&#39;realgud-trepan-ni</span>)
</span></span><span style=display:flex><span>                             (<span style=color:#66d9ef>t</span> frontend)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun launch-json--debug-command (params debuggee-args)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Return the debug command for PARAMS with DEBUGGEE-ARGS.&#34;</span>
</span></span><span style=display:flex><span>  (when-let* ((prog (<span style=color:#a6e22e>car</span> debuggee-args))
</span></span><span style=display:flex><span>              (cmd (<span style=color:#a6e22e>plist-get</span> params :cmd))
</span></span><span style=display:flex><span>              (pkg (<span style=color:#a6e22e>plist-get</span> params :require)))
</span></span><span style=display:flex><span>    (if (or (not pkg) (<span style=color:#a6e22e>eq</span> pkg <span style=color:#e6db74>&#39;unknown</span>))
</span></span><span style=display:flex><span>        (progn (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;[launch-json:command]: Unknown debugger&#34;</span>)
</span></span><span style=display:flex><span>               <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>      (if (require (<span style=color:#a6e22e>plist-get</span> params :require) <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>          (let ((args (+str-join <span style=color:#e6db74>&#34; &#34;</span> (<span style=color:#a6e22e>cdr</span> debuggee-args))))
</span></span><span style=display:flex><span>            (when args (setq args (<span style=color:#a6e22e>format</span> (<span style=color:#a6e22e>plist-get</span> params :args-format) prog args)))
</span></span><span style=display:flex><span>            (if (bound-and-true-p cmd)
</span></span><span style=display:flex><span>                (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>eval</span> cmd) (if args args <span style=color:#e6db74>&#34;&#34;</span>))
</span></span><span style=display:flex><span>              (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;[launch-json:command]: Invalid command for type %s&#34;</span> (<span style=color:#a6e22e>plist-get</span> params :type))
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;[launch-json:command]: Cannot add package %s&#34;</span> (<span style=color:#a6e22e>symbol-name</span> pkg))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>nil</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun launch-json-read (<span style=color:#66d9ef>&amp;optional</span> file)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Return the configurations section from a launch.json FILE.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>If FILE is nil, launch.json will be searched in the current project,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if it is set to a launch.json file, it will be used instead.&#34;</span>
</span></span><span style=display:flex><span>  (let ((launch-json (<span style=color:#a6e22e>expand-file-name</span> (or file <span style=color:#e6db74>&#34;launch.json&#34;</span>) (or (projectile-project-root) <span style=color:#e6db74>&#34;.&#34;</span>))))
</span></span><span style=display:flex><span>    (when (<span style=color:#a6e22e>file-exists-p</span> launch-json)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;[launch-json]: Found \&#34;launch.json\&#34; at %s&#34;</span> launch-json)
</span></span><span style=display:flex><span>      (let* ((launch (with-temp-buffer
</span></span><span style=display:flex><span>                       (<span style=color:#a6e22e>insert-file-contents</span> launch-json)
</span></span><span style=display:flex><span>                       (json-parse-buffer :object-type <span style=color:#e6db74>&#39;plist</span> :array-type <span style=color:#e6db74>&#39;list</span> :null-object <span style=color:#66d9ef>nil</span> :false-object <span style=color:#66d9ef>nil</span>)))
</span></span><span style=display:flex><span>             (configs (<span style=color:#a6e22e>plist-get</span> launch :configurations)))
</span></span><span style=display:flex><span>        (+filter (lambda (conf)
</span></span><span style=display:flex><span>                   (or (string-match-p launch-json--gud-debugger-regex (<span style=color:#a6e22e>plist-get</span> conf :type))
</span></span><span style=display:flex><span>                       (string-match-p launch-json--realgud-debugger-regex (<span style=color:#a6e22e>plist-get</span> conf :type))))
</span></span><span style=display:flex><span>                 configs)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun launch-json--config-choice (<span style=color:#66d9ef>&amp;optional</span> file)
</span></span><span style=display:flex><span>  (let* ((confs (or (launch-json-read file)
</span></span><span style=display:flex><span>                    +launch-json-debug-config))
</span></span><span style=display:flex><span>         (candidates (<span style=color:#a6e22e>mapcar</span> (lambda (conf)
</span></span><span style=display:flex><span>                               (<span style=color:#a6e22e>cons</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;%s [%s]&#34;</span> (<span style=color:#a6e22e>plist-get</span> conf :name) (<span style=color:#a6e22e>plist-get</span> conf :type))
</span></span><span style=display:flex><span>                                     conf))
</span></span><span style=display:flex><span>                             confs)))
</span></span><span style=display:flex><span>    (cond ((<span style=color:#a6e22e>eq</span> (<span style=color:#a6e22e>length</span> confs) <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>car</span> confs))
</span></span><span style=display:flex><span>          ((<span style=color:#a6e22e>&gt;</span> (<span style=color:#a6e22e>length</span> confs) <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> (<span style=color:#a6e22e>completing-read</span> <span style=color:#e6db74>&#34;Configuration: &#34;</span> candidates) candidates))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun launch-json-debug (<span style=color:#66d9ef>&amp;optional</span> file)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Launch RealGUD or GDB with parameters from </span><span style=color:#e6db74>`+launch-json-debug-config&#39;</span><span style=color:#e6db74> or launch.json file.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (let* ((conf (or launch-json--last-config
</span></span><span style=display:flex><span>                   (launch-json--config-choice file)))
</span></span><span style=display:flex><span>         (args (launch-json--substite-special-vars (<span style=color:#a6e22e>plist-get</span> conf :program) (<span style=color:#a6e22e>plist-get</span> conf :args)))
</span></span><span style=display:flex><span>         (type (<span style=color:#a6e22e>plist-get</span> conf :type))
</span></span><span style=display:flex><span>         (params (launch-json--debugger-params type)))
</span></span><span style=display:flex><span>    (when params
</span></span><span style=display:flex><span>      (let ((debug-cmd (<span style=color:#a6e22e>plist-get</span> params :debug-cmd)))
</span></span><span style=display:flex><span>        (when (<span style=color:#a6e22e>fboundp</span> debug-cmd)
</span></span><span style=display:flex><span>          (setq-local launch-json--last-config conf)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>funcall</span> debug-cmd
</span></span><span style=display:flex><span>                   (launch-json--debug-command params args)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :leader :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>      (:when (modulep! :tools debugger)
</span></span><span style=display:flex><span>       :prefix (<span style=color:#e6db74>&#34;d&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;debugger&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;GUD/RealGUD launch.json&#34;</span> <span style=color:#e6db74>&#34;d&#34;</span> <span style=color:#a6e22e>#&#39;</span>launch-json-debug))
</span></span></code></pre></div><h4 id=valgrind>Valgrind</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! valgrind
</span></span><span style=display:flex><span>  :recipe (:local-repo <span style=color:#e6db74>&#34;lisp/valgrind&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! valgrind
</span></span><span style=display:flex><span>  :commands valgrind)
</span></span></code></pre></div><h3 id=symbols>Symbols</h3><h4 id=emojify>Emojify</h4><p>For starters, twitter&rsquo;s emojis look nicer than emoji-one.
Other than that, this is pretty great OOTB 😀.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq emojify-emoji-set <span style=color:#e6db74>&#34;twemoji-v2&#34;</span>)
</span></span></code></pre></div><p>One minor annoyance is the use of emojis over the default character
when the default is actually preferred. This occurs with overlay symbols I use
in Org mode, such as checkbox state, and a few other miscellaneous cases.</p><p>We can accommodate our preferences by deleting those entries from the emoji hash
table</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar emojify-disabled-emojis
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(<span style=color:#75715e>;; Org</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;◼&#34;</span> <span style=color:#e6db74>&#34;☑&#34;</span> <span style=color:#e6db74>&#34;☸&#34;</span> <span style=color:#e6db74>&#34;⚙&#34;</span> <span style=color:#e6db74>&#34;⏩&#34;</span> <span style=color:#e6db74>&#34;⏪&#34;</span> <span style=color:#e6db74>&#34;⬆&#34;</span> <span style=color:#e6db74>&#34;⬇&#34;</span> <span style=color:#e6db74>&#34;❓&#34;</span> <span style=color:#e6db74>&#34;⏱&#34;</span> <span style=color:#e6db74>&#34;®&#34;</span> <span style=color:#e6db74>&#34;™&#34;</span> <span style=color:#e6db74>&#34;🅱&#34;</span> <span style=color:#e6db74>&#34;❌&#34;</span> <span style=color:#e6db74>&#34;✳&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Terminal powerline</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;✔&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Box drawing</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;▶&#34;</span> <span style=color:#e6db74>&#34;◀&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Characters that should never be affected by </span><span style=color:#e6db74>`emojify-mode&#39;</span><span style=color:#e6db74>.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defadvice! emojify-delete-from-data ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Ensure </span><span style=color:#e6db74>`emojify-disabled-emojis&#39;</span><span style=color:#e6db74> don&#39;t appear in </span><span style=color:#e6db74>`emojify-emojis&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>  :after <span style=color:#a6e22e>#&#39;</span>emojify-set-emoji-data
</span></span><span style=display:flex><span>  (dolist (emoji emojify-disabled-emojis)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>remhash</span> emoji emojify-emojis)))
</span></span></code></pre></div><p>Now, it would be good to have a minor mode which allowed you to type ascii/gh
emojis and get them converted to unicode. Let’s make one.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun emojify--replace-text-with-emoji (orig-fn emoji text buffer start end <span style=color:#66d9ef>&amp;optional</span> target)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Modify </span><span style=color:#e6db74>`emojify--propertize-text-for-emoji&#39;</span><span style=color:#e6db74> to replace ascii/github emoticons with unicode emojis, on the fly.&#34;</span>
</span></span><span style=display:flex><span>  (if (or (not emoticon-to-emoji) (<span style=color:#a6e22e>=</span> <span style=color:#ae81ff>1</span> (<span style=color:#a6e22e>length</span> text)))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>funcall</span> orig-fn emoji text buffer start end target)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>delete-region</span> start end)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>insert</span> (ht-get emoji <span style=color:#e6db74>&#34;unicode&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(define-minor-mode emoticon-to-emoji
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Write ascii/gh emojis, and have them converted to unicode live.&#34;</span>
</span></span><span style=display:flex><span>  :global <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>  :init-value <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>  (if emoticon-to-emoji
</span></span><span style=display:flex><span>      (progn
</span></span><span style=display:flex><span>        (setq-local emojify-emoji-styles <span style=color:#f92672>&#39;</span>(ascii github unicode))
</span></span><span style=display:flex><span>        (advice-add <span style=color:#e6db74>&#39;emojify--propertize-text-for-emoji</span> :around <span style=color:#a6e22e>#&#39;</span>emojify--replace-text-with-emoji)
</span></span><span style=display:flex><span>        (unless emojify-mode
</span></span><span style=display:flex><span>          (emojify-turn-on-emojify-mode)))
</span></span><span style=display:flex><span>    (setq-local emojify-emoji-styles (<span style=color:#a6e22e>default-value</span> <span style=color:#e6db74>&#39;emojify-emoji-styles</span>))
</span></span><span style=display:flex><span>    (advice-remove <span style=color:#e6db74>&#39;emojify--propertize-text-for-emoji</span> <span style=color:#a6e22e>#&#39;</span>emojify--replace-text-with-emoji)))
</span></span></code></pre></div><p>This new minor mode of ours will be nice for messages, so let&rsquo;s hook it in for
Email and IRC.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook! <span style=color:#f92672>&#39;</span>(mu4e-compose-mode org-msg-edit-mode circe-channel-mode) (emoticon-to-emoji <span style=color:#ae81ff>1</span>))
</span></span></code></pre></div><h4 id=ligatures>Ligatures</h4><p>Extra ligatures are good, however, I&rsquo;d like to see my keywords! Let&rsquo;s disable
them in C/C++, Rust and Python modes. In addition to that, Lisps do replace
lambdas with the greek symbol λ, however, this cause miss formatting and
sometimes messes up with the parenthesis, so let&rsquo;s disable ligatures on Lisps.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +appened-to-negation-list (head tail)
</span></span><span style=display:flex><span>  (if (<span style=color:#a6e22e>sequencep</span> head)
</span></span><span style=display:flex><span>      (delete-dups
</span></span><span style=display:flex><span>       (if (<span style=color:#a6e22e>eq</span> (<span style=color:#a6e22e>car</span> tail) <span style=color:#e6db74>&#39;not</span>)
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>append</span> head tail)
</span></span><span style=display:flex><span>         (<span style=color:#a6e22e>append</span> tail head)))
</span></span><span style=display:flex><span>    tail))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(when (modulep! :ui ligatures)
</span></span><span style=display:flex><span>  (setq +ligatures-extras-in-modes
</span></span><span style=display:flex><span>        (+appened-to-negation-list
</span></span><span style=display:flex><span>         +ligatures-extras-in-modes
</span></span><span style=display:flex><span>         <span style=color:#f92672>&#39;</span>(not c-mode c++-mode emacs-lisp-mode python-mode scheme-mode racket-mode rust-mode)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq +ligatures-in-modes
</span></span><span style=display:flex><span>        (+appened-to-negation-list
</span></span><span style=display:flex><span>         +ligatures-in-modes
</span></span><span style=display:flex><span>         <span style=color:#f92672>&#39;</span>(not emacs-lisp-mode scheme-mode racket-mode))))
</span></span></code></pre></div><h3 id=checkers--spell-and-grammar>Checkers (spell & grammar)</h3><h4 id=spell-fu>Spell-Fu</h4><p>Install the <code>aspell</code> back-end and the dictionaries to use with <code>spell-fu</code></p><p>Now, <code>spell-fu</code> supports multiple languages! Let&rsquo;s add English, French and Arabic.
So I can &ldquo;mélanger les langues sans avoir de problèmes!&rdquo;.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! spell-fu
</span></span><span style=display:flex><span>  (defun +spell-fu-register-dictionary (lang)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Add `LANG` to spell-fu multi-dict, with a personal dictionary.&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Add the dictionary</span>
</span></span><span style=display:flex><span>    (spell-fu-dictionary-add (spell-fu-get-ispell-dictionary lang))
</span></span><span style=display:flex><span>    (let ((personal-dict-file (<span style=color:#a6e22e>expand-file-name</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;aspell.%s.pws&#34;</span> lang) doom-user-dir)))
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; Create an empty personal dictionary if it doesn&#39;t exists</span>
</span></span><span style=display:flex><span>      (unless (<span style=color:#a6e22e>file-exists-p</span> personal-dict-file) (<span style=color:#a6e22e>write-region</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#66d9ef>nil</span> personal-dict-file))
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; Add the personal dictionary</span>
</span></span><span style=display:flex><span>      (spell-fu-dictionary-add (spell-fu-get-personal-dictionary (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;%s-personal&#34;</span> lang) personal-dict-file))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;spell-fu-mode-hook</span>
</span></span><span style=display:flex><span>            (lambda ()
</span></span><span style=display:flex><span>              (+spell-fu-register-dictionary +my/lang-main)
</span></span><span style=display:flex><span>              (+spell-fu-register-dictionary +my/lang-secondary))))
</span></span></code></pre></div><h4 id=grammarly>Grammarly</h4><p>Use either <a href=https://github.com/emacs-grammarly/eglot-grammarly>eglot-grammarly</a> or <a href=https://github.com/emacs-grammarly/lsp-grammarly>lsp-grammarly</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! grammarly
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;emacs-grammarly/grammarly&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! grammarly
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (grammarly-load-from-authinfo))
</span></span></code></pre></div><h5 id=eglot>Eglot</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! eglot-grammarly
</span></span><span style=display:flex><span>  :disable (not (modulep! :tools lsp +eglot))
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;emacs-grammarly/eglot-grammarly&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! eglot-grammarly
</span></span><span style=display:flex><span>  :when (modulep! :tools lsp +eglot)
</span></span><span style=display:flex><span>  :commands (+lsp-grammarly-load)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (defun +lsp-grammarly-load ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Load Grammarly LSP server for Eglot.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eglot-grammarly</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>call-interactively</span> <span style=color:#a6e22e>#&#39;</span>eglot)))
</span></span></code></pre></div><h5 id=lsp-mode>LSP Mode</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! lsp-grammarly
</span></span><span style=display:flex><span>  :disable (or (not (modulep! :tools lsp)) (modulep! :tools lsp +eglot))
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;emacs-grammarly/lsp-grammarly&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! lsp-grammarly
</span></span><span style=display:flex><span>  :when (and (modulep! :tools lsp) (not (modulep! :tools lsp +eglot)))
</span></span><span style=display:flex><span>  :commands (+lsp-grammarly-load +lsp-grammarly-toggle)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (defun +lsp-grammarly-load ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Load Grammarly LSP server for LSP Mode.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;lsp-grammarly</span>)
</span></span><span style=display:flex><span>    (lsp-deferred)) <span style=color:#75715e>;; or (lsp)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +lsp-grammarly-enabled-p ()
</span></span><span style=display:flex><span>    (not (<span style=color:#a6e22e>member</span> <span style=color:#e6db74>&#39;grammarly-ls</span> lsp-disabled-clients)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +lsp-grammarly-enable ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Enable Grammarly LSP.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (when (not (+lsp-grammarly-enabled-p))
</span></span><span style=display:flex><span>      (setq lsp-disabled-clients (remove <span style=color:#e6db74>&#39;grammarly-ls</span> lsp-disabled-clients))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Enabled grammarly-ls&#34;</span>))
</span></span><span style=display:flex><span>    (+lsp-grammarly-load))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +lsp-grammarly-disable ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Disable Grammarly LSP.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (when (+lsp-grammarly-enabled-p)
</span></span><span style=display:flex><span>      (add-to-list <span style=color:#e6db74>&#39;lsp-disabled-clients</span> <span style=color:#e6db74>&#39;grammarly-ls</span>)
</span></span><span style=display:flex><span>      (lsp-disconnect)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Disabled grammarly-ls&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +lsp-grammarly-toggle ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Enable/disable Grammarly LSP.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (if (+lsp-grammarly-enabled-p)
</span></span><span style=display:flex><span>        (+lsp-grammarly-disable)
</span></span><span style=display:flex><span>      (+lsp-grammarly-enable)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (after! lsp-mode
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Disable by default</span>
</span></span><span style=display:flex><span>    (add-to-list <span style=color:#e6db74>&#39;lsp-disabled-clients</span> <span style=color:#e6db74>&#39;grammarly-ls</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (set-lsp-priority! <span style=color:#e6db74>&#39;grammarly-ls</span> <span style=color:#ae81ff>1</span>))
</span></span></code></pre></div><h4 id=grammalecte>Grammalecte</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! flycheck-grammalecte
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;milouse/flycheck-grammalecte&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! flycheck-grammalecte
</span></span><span style=display:flex><span>  :commands (flycheck-grammalecte-correct-error-at-point
</span></span><span style=display:flex><span>             grammalecte-conjugate-verb
</span></span><span style=display:flex><span>             grammalecte-define
</span></span><span style=display:flex><span>             grammalecte-define-at-point
</span></span><span style=display:flex><span>             grammalecte-find-synonyms
</span></span><span style=display:flex><span>             grammalecte-find-synonyms-at-point)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq grammalecte-settings-file (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;grammalecte/grammalecte-cache.el&#34;</span> doom-data-dir)
</span></span><span style=display:flex><span>        grammalecte-python-package-directory (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;grammalecte/grammalecte&#34;</span> doom-data-dir))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq flycheck-grammalecte-report-spellcheck <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        flycheck-grammalecte-report-grammar <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        flycheck-grammalecte-report-apos <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        flycheck-grammalecte-report-esp <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        flycheck-grammalecte-report-nbsp <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        flycheck-grammalecte-filters
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;(?m)^# ?-*-.+$&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>;; Ignore LaTeX equations (inline and block)</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;\\$.*?\\$&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;(?s)\\\\begin{\\(?1:\\(?:equation.\\|align.\\)\\)}.*?\\\\end{\\1}&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :leader :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>        (:prefix (<span style=color:#e6db74>&#34;g&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;grammalecte&#34;</span>)
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Correct error at point&#34;</span>     <span style=color:#e6db74>&#34;p&#34;</span> <span style=color:#a6e22e>#&#39;</span>flycheck-grammalecte-correct-error-at-point
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Conjugate a verb&#34;</span>           <span style=color:#e6db74>&#34;V&#34;</span> <span style=color:#a6e22e>#&#39;</span>grammalecte-conjugate-verb
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Define a word&#34;</span>              <span style=color:#e6db74>&#34;W&#34;</span> <span style=color:#a6e22e>#&#39;</span>grammalecte-define
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Conjugate a verb at point&#34;</span>  <span style=color:#e6db74>&#34;w&#34;</span> <span style=color:#a6e22e>#&#39;</span>grammalecte-define-at-point
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Find synonyms&#34;</span>              <span style=color:#e6db74>&#34;S&#34;</span> <span style=color:#a6e22e>#&#39;</span>grammalecte-find-synonyms
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Find synonyms at point&#34;</span>     <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#a6e22e>#&#39;</span>grammalecte-find-synonyms-at-point))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (grammalecte-download-grammalecte)
</span></span><span style=display:flex><span>  (flycheck-grammalecte-setup)
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#e6db74>&#39;flycheck-grammalecte-enabled-modes</span> <span style=color:#e6db74>&#39;fountain-mode</span>))
</span></span></code></pre></div><h4 id=ltex-languagetool>LTeX/LanguageTool</h4><p>Originally, <a href=https://valentjn.github.io/ltex/index.html>LTeX LS</a> stands for <em>LaTeX Language Server</em>, it acts as a Language
Server for LaTeX, but not only. It can check the grammar and the spelling of
several markup languages such as BibTeX, ConTeXt, LaTeX, Markdown, Org,
reStructuredText&mldr; and others. Alongside, it provides interfacing with
LanguageTool to implement natural language checking.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! lsp-ltex
</span></span><span style=display:flex><span>  (setq lsp-ltex-language <span style=color:#e6db74>&#34;auto&#34;</span>
</span></span><span style=display:flex><span>        lsp-ltex-server-store-path <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        lsp-ltex-java-path <span style=color:#e6db74>&#34;/usr/lib/jvm/java-17-openjdk&#34;</span>
</span></span><span style=display:flex><span>        lsp-ltex-mother-tongue +my/lang-mother-tongue
</span></span><span style=display:flex><span>        flycheck-checker-error-threshold <span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (advice-add
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;+lsp-ltex-setup</span> :after
</span></span><span style=display:flex><span>   (lambda ()
</span></span><span style=display:flex><span>     (setq-local lsp-ui-sideline-show-diagnostics <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                 lsp-ui-sideline-show-code-actions <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                 lsp-ui-sideline-show-hover <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                 lsp-ui-sideline-enable <span style=color:#66d9ef>nil</span>))))
</span></span></code></pre></div><h4 id=go-translate--google-bing-and-deepl>Go Translate (Google, Bing and DeepL)</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! go-translate
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;lorniu/go-translate&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! go-translate
</span></span><span style=display:flex><span>  :commands (gts-do-translate
</span></span><span style=display:flex><span>             +gts-yank-translated-region
</span></span><span style=display:flex><span>             +gts-translate-with)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Your languages pairs</span>
</span></span><span style=display:flex><span>  (setq gts-translate-list (<span style=color:#a6e22e>list</span> (<span style=color:#a6e22e>list</span> +my/lang-main +my/lang-secondary)
</span></span><span style=display:flex><span>                                 (<span style=color:#a6e22e>list</span> +my/lang-main +my/lang-mother-tongue)
</span></span><span style=display:flex><span>                                 (<span style=color:#a6e22e>list</span> +my/lang-secondary +my/lang-mother-tongue)
</span></span><span style=display:flex><span>                                 (<span style=color:#a6e22e>list</span> +my/lang-secondary +my/lang-main)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :localleader
</span></span><span style=display:flex><span>        :map (org-mode-map markdown-mode-map latex-mode-map text-mode-map)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Yank translated region&#34;</span> <span style=color:#e6db74>&#34;R&#34;</span> <span style=color:#a6e22e>#&#39;</span>+gts-yank-translated-region)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :leader :prefix <span style=color:#e6db74>&#34;l&#34;</span>
</span></span><span style=display:flex><span>        (:prefix (<span style=color:#e6db74>&#34;G&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;go-translate&#34;</span>)
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Bing&#34;</span>                   <span style=color:#e6db74>&#34;b&#34;</span> (lambda () (interactive) (+gts-translate-with <span style=color:#e6db74>&#39;bing</span>))
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;DeepL&#34;</span>                  <span style=color:#e6db74>&#34;d&#34;</span> (lambda () (interactive) (+gts-translate-with <span style=color:#e6db74>&#39;deepl</span>))
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Google&#34;</span>                 <span style=color:#e6db74>&#34;g&#34;</span> (lambda () (interactive) (+gts-translate-with))
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Yank translated region&#34;</span> <span style=color:#e6db74>&#34;R&#34;</span> <span style=color:#a6e22e>#&#39;</span>+gts-yank-translated-region
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;gts-do-translate&#34;</span>       <span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#a6e22e>#&#39;</span>gts-do-translate))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Config the default translator, which will be used by the command `gts-do-translate&#39;</span>
</span></span><span style=display:flex><span>  (setq gts-default-translator
</span></span><span style=display:flex><span>        (gts-translator
</span></span><span style=display:flex><span>         <span style=color:#75715e>;; Used to pick source text, from, to. choose one.</span>
</span></span><span style=display:flex><span>         :picker (gts-prompt-picker)
</span></span><span style=display:flex><span>         <span style=color:#75715e>;; One or more engines, provide a parser to give different output.</span>
</span></span><span style=display:flex><span>         :engines (gts-google-engine :parser (gts-google-summary-parser))
</span></span><span style=display:flex><span>         <span style=color:#75715e>;; Render, only one, used to consumer the output result.</span>
</span></span><span style=display:flex><span>         :render (gts-buffer-render)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Custom texter which remove newlines in the same paragraph</span>
</span></span><span style=display:flex><span>  (defclass +gts-translate-paragraph (gts-texter) ())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (cl-defmethod gts-text ((_ +gts-translate-paragraph))
</span></span><span style=display:flex><span>    (when (use-region-p)
</span></span><span style=display:flex><span>      (let ((text (<span style=color:#a6e22e>buffer-substring-no-properties</span> (<span style=color:#a6e22e>region-beginning</span>) (<span style=color:#a6e22e>region-end</span>))))
</span></span><span style=display:flex><span>        (with-temp-buffer
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>insert</span> text)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>          (let ((case-fold-search <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>            (while (<span style=color:#a6e22e>re-search-forward</span> <span style=color:#e6db74>&#34;\n[^\n]&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>              (replace-region-contents
</span></span><span style=display:flex><span>               (<span style=color:#a6e22e>-</span> (<span style=color:#a6e22e>point</span>) <span style=color:#ae81ff>2</span>) (<span style=color:#a6e22e>-</span> (<span style=color:#a6e22e>point</span>) <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>               (lambda (<span style=color:#66d9ef>&amp;optional</span> a b) <span style=color:#e6db74>&#34; &#34;</span>)))
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>buffer-string</span>))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Custom picker to use the paragraph texter</span>
</span></span><span style=display:flex><span>  (defclass +gts-paragraph-picker (gts-picker)
</span></span><span style=display:flex><span>    ((texter :initarg :texter :initform (+gts-translate-paragraph))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (cl-defmethod gts-pick ((o +gts-paragraph-picker))
</span></span><span style=display:flex><span>    (let ((text (gts-text (oref o texter))))
</span></span><span style=display:flex><span>      (when (or (<span style=color:#a6e22e>null</span> text) (zerop (<span style=color:#a6e22e>length</span> text)))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>user-error</span> <span style=color:#e6db74>&#34;Make sure there is any word at point, or selection exists&#34;</span>))
</span></span><span style=display:flex><span>      (let ((path (gts-path o text)))
</span></span><span style=display:flex><span>        (setq gts-picker-current-path path)
</span></span><span style=display:flex><span>        (cl-values text path))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +gts-yank-translated-region ()
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (gts-translate
</span></span><span style=display:flex><span>     (gts-translator
</span></span><span style=display:flex><span>      :picker (+gts-paragraph-picker)
</span></span><span style=display:flex><span>      :engines (gts-google-engine)
</span></span><span style=display:flex><span>      :render (gts-kill-ring-render))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +gts-translate-with (<span style=color:#66d9ef>&amp;optional</span> engine)
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (gts-translate
</span></span><span style=display:flex><span>     (gts-translator
</span></span><span style=display:flex><span>      :picker (+gts-paragraph-picker)
</span></span><span style=display:flex><span>      :engines
</span></span><span style=display:flex><span>      (cond ((<span style=color:#a6e22e>eq</span> engine <span style=color:#e6db74>&#39;deepl</span>)
</span></span><span style=display:flex><span>             (gts-deepl-engine
</span></span><span style=display:flex><span>              :auth-key <span style=color:#75715e>;; Get API key from ~/.authinfo.gpg (machine api-free.deepl.com)</span>
</span></span><span style=display:flex><span>              (<span style=color:#a6e22e>funcall</span>
</span></span><span style=display:flex><span>               (<span style=color:#a6e22e>plist-get</span> (<span style=color:#a6e22e>car</span> (auth-source-search :host <span style=color:#e6db74>&#34;api-free.deepl.com&#34;</span> :max <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>                          :secret))
</span></span><span style=display:flex><span>              :pro <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>            ((<span style=color:#a6e22e>eq</span> engine <span style=color:#e6db74>&#39;bing</span>) (gts-bing-engine))
</span></span><span style=display:flex><span>            (<span style=color:#66d9ef>t</span> (gts-google-engine)))
</span></span><span style=display:flex><span>      :render (gts-buffer-render)))))
</span></span></code></pre></div><h3 id=system-tools>System tools</h3><h4 id=disk-usage>Disk usage</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! disk-usage)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! disk-usage
</span></span><span style=display:flex><span>  :commands (disk-usage))
</span></span></code></pre></div><h4 id=chezmoi>Chezmoi</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! chezmoi)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! chezmoi
</span></span><span style=display:flex><span>  :when CHEZMOI-P
</span></span><span style=display:flex><span>  :commands (chezmoi-write
</span></span><span style=display:flex><span>             chezmoi-magit-status
</span></span><span style=display:flex><span>             chezmoi-diff
</span></span><span style=display:flex><span>             chezmoi-ediff
</span></span><span style=display:flex><span>             chezmoi-find
</span></span><span style=display:flex><span>             chezmoi-write-files
</span></span><span style=display:flex><span>             chezmoi-open-other
</span></span><span style=display:flex><span>             chezmoi-template-buffer-display
</span></span><span style=display:flex><span>             chezmoi-mode)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Company integration</span>
</span></span><span style=display:flex><span>  (when (modulep! :completion company)
</span></span><span style=display:flex><span>    (defun +chezmoi--company-backend-h ()
</span></span><span style=display:flex><span>      (require <span style=color:#e6db74>&#39;chezmoi-company</span>)
</span></span><span style=display:flex><span>      (if chezmoi-mode
</span></span><span style=display:flex><span>          (add-to-list <span style=color:#e6db74>&#39;company-backends</span> <span style=color:#e6db74>&#39;chezmoi-company-backend</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>delete</span> <span style=color:#e6db74>&#39;chezmoi-company-backend</span> <span style=color:#e6db74>&#39;company-backends</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (add-hook <span style=color:#e6db74>&#39;chezmoi-mode-hook</span> <span style=color:#a6e22e>#&#39;</span>+chezmoi--company-backend-h))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Integrate with evil mode by toggling template display when entering insert mode.</span>
</span></span><span style=display:flex><span>  (when (modulep! :editor evil)
</span></span><span style=display:flex><span>    (defun +chezmoi--evil-insert-state-enter-h ()
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;Run after evil-insert-state-entry.&#34;</span>
</span></span><span style=display:flex><span>      (chezmoi-template-buffer-display <span style=color:#66d9ef>nil</span> (<span style=color:#a6e22e>point</span>))
</span></span><span style=display:flex><span>      (remove-hook <span style=color:#e6db74>&#39;after-change-functions</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-template--after-change <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (defun +chezmoi--evil-insert-state-exit-h ()
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;Run after evil-insert-state-exit.&#34;</span>
</span></span><span style=display:flex><span>      (chezmoi-template-buffer-display <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>      (chezmoi-template-buffer-display <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>      (add-hook <span style=color:#e6db74>&#39;after-change-functions</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-template--after-change <span style=color:#66d9ef>nil</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (defun +chezmoi--evil-h ()
</span></span><span style=display:flex><span>      (if chezmoi-mode
</span></span><span style=display:flex><span>          (progn
</span></span><span style=display:flex><span>            (add-hook <span style=color:#e6db74>&#39;evil-insert-state-entry-hook</span> <span style=color:#a6e22e>#&#39;</span>+chezmoi--evil-insert-state-enter-h <span style=color:#66d9ef>nil</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            (add-hook <span style=color:#e6db74>&#39;evil-insert-state-exit-hook</span> <span style=color:#a6e22e>#&#39;</span>+chezmoi--evil-insert-state-exit-h <span style=color:#66d9ef>nil</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>        (progn
</span></span><span style=display:flex><span>          (remove-hook <span style=color:#e6db74>&#39;evil-insert-state-entry-hook</span> <span style=color:#a6e22e>#&#39;</span>+chezmoi--evil-insert-state-enter-h <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>          (remove-hook <span style=color:#e6db74>&#39;evil-insert-state-exit-hook</span> <span style=color:#a6e22e>#&#39;</span>+chezmoi--evil-insert-state-exit-h <span style=color:#ae81ff>1</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (add-hook <span style=color:#e6db74>&#39;chezmoi-mode-hook</span> <span style=color:#a6e22e>#&#39;</span>+chezmoi--evil-h)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :leader :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>      (:prefix (<span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;tools&#34;</span>)
</span></span><span style=display:flex><span>       (:when CHEZMOI-P
</span></span><span style=display:flex><span>        :prefix (<span style=color:#e6db74>&#34;c&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;chezmoi&#34;</span>)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Magit status&#34;</span> <span style=color:#e6db74>&#34;g&#34;</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-magit-status
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Write&#34;</span>        <span style=color:#e6db74>&#34;w&#34;</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-write
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Write files&#34;</span>  <span style=color:#e6db74>&#34;W&#34;</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-write-files
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Find source&#34;</span>  <span style=color:#e6db74>&#34;f&#34;</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-find
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Sync files&#34;</span>   <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-sync-files
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Diff&#34;</span>         <span style=color:#e6db74>&#34;d&#34;</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-diff
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;EDiff&#34;</span>        <span style=color:#e6db74>&#34;e&#34;</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-ediff
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Open other&#34;</span>   <span style=color:#e6db74>&#34;o&#34;</span> <span style=color:#a6e22e>#&#39;</span>chezmoi-open-other)))
</span></span></code></pre></div><h4 id=aweshell>Aweshell</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! aweshell
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;manateelazycat/aweshell&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! aweshell
</span></span><span style=display:flex><span>  :commands (aweshell-new aweshell-dedicated-open))
</span></span></code></pre></div><h4 id=lemon>Lemon</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! lemon
</span></span><span style=display:flex><span>  :recipe (:host <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;https://codeberg.org/emacs-weirdware/lemon.git&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! lemon
</span></span><span style=display:flex><span>  :commands (lemon-mode lemon-display)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;lemon-cpu</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;lemon-memory</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;lemon-network</span>)
</span></span><span style=display:flex><span>  (setq lemon-delay <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>        lemon-refresh-rate <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        lemon-monitors
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>list</span> <span style=color:#f92672>&#39;</span>((lemon-cpufreq-linux :display-opts <span style=color:#f92672>&#39;</span>(:sparkline (:type gridded)))
</span></span><span style=display:flex><span>                (lemon-cpu-linux)
</span></span><span style=display:flex><span>                (lemon-memory-linux)
</span></span><span style=display:flex><span>                (lemon-linux-network-tx)
</span></span><span style=display:flex><span>                (lemon-linux-network-rx)))))
</span></span></code></pre></div><h4 id=ecryptfs>eCryptfs</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(when ECRYPTFS-P
</span></span><span style=display:flex><span>  (defvar +ecryptfs-private-dir <span style=color:#e6db74>&#34;Private&#34;</span>)
</span></span><span style=display:flex><span>  (defvar +ecryptfs-buffer-name <span style=color:#e6db74>&#34;*emacs-ecryptfs*&#34;</span>)
</span></span><span style=display:flex><span>  (defvar +ecryptfs-config-dir (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~/.ecryptfs&#34;</span>))
</span></span><span style=display:flex><span>  (defvar +ecryptfs-passphrase-gpg (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~/.ecryptfs/my-pass.gpg&#34;</span>))
</span></span><span style=display:flex><span>  (defvar +ecryptfs--wrapping-independent-p (not (<span style=color:#a6e22e>null</span> (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;wrapping-independent&#34;</span> +ecryptfs-config-dir))))
</span></span><span style=display:flex><span>  (defvar +ecryptfs--wrapped-passphrase-file (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;wrapped-passphrase&#34;</span> +ecryptfs-config-dir))
</span></span><span style=display:flex><span>  (defvar +ecryptfs--mount-passphrase-sig-file (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>expand-file-name</span> +ecryptfs-private-dir +ecryptfs-config-dir) <span style=color:#e6db74>&#34;.sig&#34;</span>))
</span></span><span style=display:flex><span>  (defvar +ecryptfs--mount-private-cmd <span style=color:#e6db74>&#34;/sbin/mount.ecryptfs_private&#34;</span>)
</span></span><span style=display:flex><span>  (defvar +ecryptfs--umount-private-cmd <span style=color:#e6db74>&#34;/sbin/umount.ecryptfs_private&#34;</span>)
</span></span><span style=display:flex><span>  (defvar +ecryptfs--passphrase
</span></span><span style=display:flex><span>    (lambda ()
</span></span><span style=display:flex><span>      (s-trim-right <span style=color:#75715e>;; To remove the new line</span>
</span></span><span style=display:flex><span>       (epg-decrypt-file (epg-make-context)
</span></span><span style=display:flex><span>                         +ecryptfs-passphrase-gpg
</span></span><span style=display:flex><span>                         <span style=color:#66d9ef>nil</span>))))
</span></span><span style=display:flex><span>  (defvar +ecryptfs--encrypt-filenames-p
</span></span><span style=display:flex><span>    (not (<span style=color:#a6e22e>eq</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>             (with-temp-buffer
</span></span><span style=display:flex><span>               (<span style=color:#a6e22e>insert-file-contents</span> +ecryptfs--mount-passphrase-sig-file)
</span></span><span style=display:flex><span>               (count-lines (<span style=color:#a6e22e>point-min</span>) (<span style=color:#a6e22e>point-max</span>))))))
</span></span><span style=display:flex><span>  (defvar +ecryptfs--command-format
</span></span><span style=display:flex><span>    (if +ecryptfs--encrypt-filenames-p
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ecryptfs-insert-wrapped-passphrase-into-keyring %s &#39;%s&#39;&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;ecryptfs-unwrap-passphrase %s &#39;%s&#39; | ecryptfs-add-passphrase -&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +ecryptfs-mount-private ()
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (unless (and (<span style=color:#a6e22e>file-exists-p</span> +ecryptfs--wrapped-passphrase-file)
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>file-exists-p</span> +ecryptfs--mount-passphrase-sig-file))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>error</span> <span style=color:#e6db74>&#34;Encrypted private directory \&#34;%s\&#34; is not setup properly.&#34;</span>
</span></span><span style=display:flex><span>             +ecryptfs-private-dir)
</span></span><span style=display:flex><span>      (return))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (let ((try-again <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>      (while (and
</span></span><span style=display:flex><span>              <span style=color:#75715e>;; In the first iteration, we try to silently mount the ecryptfs private directory,</span>
</span></span><span style=display:flex><span>              <span style=color:#75715e>;; this would succeed if the key is available in the keyring.</span>
</span></span><span style=display:flex><span>              (shell-command +ecryptfs--mount-private-cmd
</span></span><span style=display:flex><span>                             +ecryptfs-buffer-name)
</span></span><span style=display:flex><span>              try-again)
</span></span><span style=display:flex><span>        (setq try-again <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Encrypted filenames mode [%s].&#34;</span> (if +ecryptfs--encrypt-filenames-p <span style=color:#e6db74>&#34;ENABLED&#34;</span> <span style=color:#e6db74>&#34;DISABLED&#34;</span>))
</span></span><span style=display:flex><span>        (shell-command
</span></span><span style=display:flex><span>         (<span style=color:#a6e22e>format</span> +ecryptfs--command-format
</span></span><span style=display:flex><span>                 +ecryptfs--wrapped-passphrase-file
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>funcall</span> +ecryptfs--passphrase))
</span></span><span style=display:flex><span>         +ecryptfs-buffer-name))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Ecryptfs mount private.&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +ecryptfs-umount-private ()
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (while (string-match-p <span style=color:#e6db74>&#34;Sessions still open, not unmounting&#34;</span>
</span></span><span style=display:flex><span>                           (shell-command-to-string +ecryptfs--umount-private-cmd)))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Unmounted private directory.&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :leader :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>      (:prefix (<span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;tools&#34;</span>)
</span></span><span style=display:flex><span>       (:when ECRYPTFS-P
</span></span><span style=display:flex><span>        :prefix (<span style=color:#e6db74>&#34;e&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;ecryptfs&#34;</span>)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;eCryptfs mount private&#34;</span>    <span style=color:#e6db74>&#34;e&#34;</span> <span style=color:#a6e22e>#&#39;</span>+ecryptfs-mount-private
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;eCryptfs un-mount private&#34;</span> <span style=color:#e6db74>&#34;E&#34;</span> <span style=color:#a6e22e>#&#39;</span>+ecryptfs-umount-private)))
</span></span></code></pre></div><h3 id=features>Features</h3><h4 id=workspaces>Workspaces</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      (:when (modulep! :ui workspaces)
</span></span><span style=display:flex><span>       :prefix (<span style=color:#e6db74>&#34;TAB&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;workspace&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Display tab bar&#34;</span>           <span style=color:#e6db74>&#34;TAB&#34;</span> <span style=color:#a6e22e>#&#39;</span>+workspace/display
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch workspace&#34;</span>          <span style=color:#e6db74>&#34;.&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to last workspace&#34;</span>  <span style=color:#e6db74>&#34;$&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/other <span style=color:#75715e>;; Modified</span>
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;New workspace&#34;</span>             <span style=color:#e6db74>&#34;n&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/new
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;New named workspace&#34;</span>       <span style=color:#e6db74>&#34;N&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/new-named
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Load workspace from file&#34;</span>  <span style=color:#e6db74>&#34;l&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/load
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Save workspace to file&#34;</span>    <span style=color:#e6db74>&#34;s&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/save
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Delete session&#34;</span>            <span style=color:#e6db74>&#34;x&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/kill-session
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Delete this workspace&#34;</span>     <span style=color:#e6db74>&#34;d&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/delete
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Rename workspace&#34;</span>          <span style=color:#e6db74>&#34;r&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/rename
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Restore last session&#34;</span>      <span style=color:#e6db74>&#34;R&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/restore-last-session
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Next workspace&#34;</span>            <span style=color:#e6db74>&#34;&gt;&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-right <span style=color:#75715e>;; Modified</span>
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Previous workspace&#34;</span>        <span style=color:#e6db74>&#34;&lt;&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-left <span style=color:#75715e>;; Modified</span>
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to 1st workspace&#34;</span>   <span style=color:#e6db74>&#34;1&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-0
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to 2nd workspace&#34;</span>   <span style=color:#e6db74>&#34;2&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-1
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to 3rd workspace&#34;</span>   <span style=color:#e6db74>&#34;3&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-2
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to 4th workspace&#34;</span>   <span style=color:#e6db74>&#34;4&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-3
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to 5th workspace&#34;</span>   <span style=color:#e6db74>&#34;5&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-4
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to 6th workspace&#34;</span>   <span style=color:#e6db74>&#34;6&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-5
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to 7th workspace&#34;</span>   <span style=color:#e6db74>&#34;7&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-6
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to 8th workspace&#34;</span>   <span style=color:#e6db74>&#34;8&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-7
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to 9th workspace&#34;</span>   <span style=color:#e6db74>&#34;9&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-8
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Switch to final workspace&#34;</span> <span style=color:#e6db74>&#34;0&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to-final))
</span></span></code></pre></div><h4 id=weather>Weather</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; lisp/wttrin/wttrin.el taken from:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; https://raw.githubusercontent.com/tecosaur/emacs-config/master/lisp/wttrin/wttrin.el</span>
</span></span><span style=display:flex><span>(package! wttrin
</span></span><span style=display:flex><span>  :recipe (:local-repo <span style=color:#e6db74>&#34;lisp/wttrin&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! wttrin
</span></span><span style=display:flex><span>  :commands wttrin)
</span></span></code></pre></div><h4 id=openstreetmap>OpenStreetMap</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! osm)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! osm
</span></span><span style=display:flex><span>  :commands (osm-home
</span></span><span style=display:flex><span>             osm-search
</span></span><span style=display:flex><span>             osm-server
</span></span><span style=display:flex><span>             osm-goto
</span></span><span style=display:flex><span>             osm-gpx-show
</span></span><span style=display:flex><span>             osm-bookmark-jump)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :custom
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Take a look at the customization group `osm&#39; for more options.</span>
</span></span><span style=display:flex><span>  (osm-server <span style=color:#e6db74>&#39;default</span>) <span style=color:#75715e>;; Configure the tile server</span>
</span></span><span style=display:flex><span>  (osm-copyright <span style=color:#66d9ef>t</span>)     <span style=color:#75715e>;; Display the copyright information</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq osm-tile-directory (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;osm&#34;</span> doom-data-dir))
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Load Org link support</span>
</span></span><span style=display:flex><span>  (with-eval-after-load <span style=color:#e6db74>&#39;org</span>
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;osm-ol</span>)))
</span></span></code></pre></div><h4 id=islamic-prayer-times>Islamic prayer times</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! awqat
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;zkry/awqat&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! awqat
</span></span><span style=display:flex><span>  :commands (awqat-display-prayer-time-mode awqat-times-for-day)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Make sure `calendar-latitude&#39; and `calendar-longitude&#39; are set,</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; otherwise, set them here.</span>
</span></span><span style=display:flex><span>  (setq awqat-asr-hanafi <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        awqat-mode-line-format <span style=color:#e6db74>&#34; 🕌 ${prayer} (${hours}h${minutes}m) &#34;</span>)
</span></span><span style=display:flex><span>  (awqat-set-preset-french-muslims))
</span></span></code></pre></div><h4 id=info-colors>Info colors</h4><p>Better colors for manual pages.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! info-colors)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! info-colors
</span></span><span style=display:flex><span>  :commands (info-colors-fontify-node))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;Info-selection-hook</span> <span style=color:#e6db74>&#39;info-colors-fontify-node</span>)
</span></span></code></pre></div><h4 id=zotero-zotxt>Zotero Zotxt</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! zotxt)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! zotxt
</span></span><span style=display:flex><span>  :when ZOTERO-P
</span></span><span style=display:flex><span>  :commands org-zotxt-mode)
</span></span></code></pre></div><h4 id=crdt>CRDT</h4><p>Collaborative editing for geeks! <code>crdt.el</code> adds support for <em><a href=https://en.wikipedia.org/wiki/Conflict-free_replicated_data_type>Conflict-free
Replicated Data Type</a></em>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! crdt)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! crdt
</span></span><span style=display:flex><span>  :commands (crdt-share-buffer
</span></span><span style=display:flex><span>             crdt-connect)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (cond
</span></span><span style=display:flex><span>   (TUNTOX-P  (setq crdt-use-tuntox <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                    crdt-tuntox-password-in-url <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>   (STUNNEL-P (setq crdt-use-stunnel <span style=color:#66d9ef>t</span>))))
</span></span></code></pre></div><h4 id=the-silver-searcher>The Silver Searcher</h4><p>An Emacs front-end to <em>The Silver Searcher</em>, first we need to install <code>ag</code> using <code>sudo pacman -S the_silver_searcher</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! ag)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! ag
</span></span><span style=display:flex><span>  :when AG-P
</span></span><span style=display:flex><span>  :commands (ag
</span></span><span style=display:flex><span>             ag-files
</span></span><span style=display:flex><span>             ag-regexp
</span></span><span style=display:flex><span>             ag-project
</span></span><span style=display:flex><span>             ag-project-files
</span></span><span style=display:flex><span>             ag-project-regexp))
</span></span></code></pre></div><h4 id=page-break-lines>Page break lines</h4><p>A feature that displays ugly form feed characters as tidy horizontal rules.
Inspired by <a href=https://github.com/MatthewZMD/.emacs.d#page-break-lines>M-EMACS</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! page-break-lines)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! page-break-lines
</span></span><span style=display:flex><span>  :diminish
</span></span><span style=display:flex><span>  :init (global-page-break-lines-mode))
</span></span></code></pre></div><h4 id=emacs-application-framework>Emacs Application Framework</h4><p>EAF is presented as: <em>A free/libre and open-source extensible framework that
revolutionizes the graphical capabilities of Emacs</em>. Or the key to ultimately
<em>Live in Emacs</em>.</p><p>First, install EAF as specified in the project&rsquo;s <a href=https://github.com/emacs-eaf/emacs-application-framework#install>readme</a>. To update EAF, we need
to run <code>git pull ; ./install-eaf.py</code> in <code>lisp/emacs-application-framework</code> and <code>(M-x eaf-install-and-update)</code> in Emacs. This updates EAF, applications and their
dependencies.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! eaf
</span></span><span style=display:flex><span>  :when EAF-P
</span></span><span style=display:flex><span>  :load-path EAF-DIR
</span></span><span style=display:flex><span>  :commands (eaf-open
</span></span><span style=display:flex><span>             eaf-open-browser
</span></span><span style=display:flex><span>             eaf-open-jupyter
</span></span><span style=display:flex><span>             +eaf-open-mail-as-html)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (defvar +eaf-enabled-apps
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#39;</span>(org browser mindmap jupyter org-previewer markdown-previewer file-sender video-player))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +eaf-app-p (app-symbol)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>memq</span> app-symbol +eaf-enabled-apps))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;browser</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Make EAF Browser my default browser</span>
</span></span><span style=display:flex><span>    (setq browse-url-browser-function <span style=color:#a6e22e>#&#39;</span>eaf-open-browser)
</span></span><span style=display:flex><span>    (defalias <span style=color:#e6db74>&#39;browse-web</span> <span style=color:#a6e22e>#&#39;</span>eaf-open-browser)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (map! :localleader
</span></span><span style=display:flex><span>          :map (mu4e-headers-mode-map mu4e-view-mode-map)
</span></span><span style=display:flex><span>          :desc <span style=color:#e6db74>&#34;Open mail as HTML&#34;</span> <span style=color:#e6db74>&#34;h&#34;</span> <span style=color:#a6e22e>#&#39;</span>+eaf-open-mail-as-html
</span></span><span style=display:flex><span>          :desc <span style=color:#e6db74>&#34;Open URL (EAF)&#34;</span> <span style=color:#e6db74>&#34;o&#34;</span> <span style=color:#a6e22e>#&#39;</span>eaf-open-browser))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;pdf-viewer</span>)
</span></span><span style=display:flex><span>    (after! org
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; Use EAF PDF Viewer in Org</span>
</span></span><span style=display:flex><span>      (defun +eaf--org-open-file-fn (file <span style=color:#66d9ef>&amp;optional</span> link)
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;An wrapper function on </span><span style=color:#e6db74>`eaf-open&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>        (eaf-open file))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; use `emacs-application-framework&#39; to open PDF file: link</span>
</span></span><span style=display:flex><span>      (add-to-list <span style=color:#e6db74>&#39;org-file-apps</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.pdf\\&#39;&#34;</span> <span style=color:#f92672>.</span> +eaf--org-open-file-fn)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (after! latex
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; Link EAF with the LaTeX compiler in emacs. When a .tex file is open,</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; the Command&gt;Compile and view (C-c C-a) option will compile the .tex</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; file into a .pdf file and display it using EAF. Double clicking on the</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; PDF side jumps to editing the clicked section.</span>
</span></span><span style=display:flex><span>      (add-to-list <span style=color:#e6db74>&#39;TeX-command-list</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;XeLaTeX&#34;</span> <span style=color:#e6db74>&#34;%`xelatex --synctex=1%(mode)%&#39; %t&#34;</span> TeX-run-TeX <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>      (add-to-list <span style=color:#e6db74>&#39;TeX-view-program-list</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;eaf&#34;</span> eaf-pdf-synctex-forward-view))
</span></span><span style=display:flex><span>      (add-to-list <span style=color:#e6db74>&#39;TeX-view-program-selection</span> <span style=color:#f92672>&#39;</span>(output-pdf <span style=color:#e6db74>&#34;eaf&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Generic</span>
</span></span><span style=display:flex><span>  (setq eaf-start-python-process-when-require <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        eaf-kill-process-after-last-buffer-closed <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        eaf-fullscreen-p <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Debug</span>
</span></span><span style=display:flex><span>  (setq eaf-enable-debug <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Web engine</span>
</span></span><span style=display:flex><span>  (setq eaf-webengine-font-family (<span style=color:#a6e22e>symbol-name</span> (<span style=color:#a6e22e>font-get</span> doom-font :family))
</span></span><span style=display:flex><span>        eaf-webengine-fixed-font-family (<span style=color:#a6e22e>symbol-name</span> (<span style=color:#a6e22e>font-get</span> doom-font :family))
</span></span><span style=display:flex><span>        eaf-webengine-serif-font-family (<span style=color:#a6e22e>symbol-name</span> (<span style=color:#a6e22e>font-get</span> doom-serif-font :family))
</span></span><span style=display:flex><span>        eaf-webengine-font-size <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>        eaf-webengine-fixed-font-size <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>        eaf-webengine-enable-scrollbar <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        eaf-webengine-scroll-step <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>        eaf-webengine-default-zoom <span style=color:#ae81ff>1.25</span>
</span></span><span style=display:flex><span>        eaf-webengine-show-hover-link <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        eaf-webengine-download-path <span style=color:#e6db74>&#34;~/Downloads&#34;</span>
</span></span><span style=display:flex><span>        eaf-webengine-enable-plugin <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        eaf-webengine-enable-javascript <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        eaf-webengine-enable-javascript-access-clipboard <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (when (display-graphic-p)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-all-the-icons</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>mapc</span> (lambda (v) (eaf-all-the-icons-icon (<span style=color:#a6e22e>car</span> v)))
</span></span><span style=display:flex><span>          eaf-all-the-icons-alist))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Browser settings</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;browser</span>)
</span></span><span style=display:flex><span>    (setq eaf-browser-continue-where-left-off <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          eaf-browser-dark-mode <span style=color:#66d9ef>nil</span> <span style=color:#75715e>;; &#34;follow&#34;</span>
</span></span><span style=display:flex><span>          eaf-browser-enable-adblocker <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          eaf-browser-enable-autofill <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>          eaf-browser-remember-history <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          eaf-browser-ignore-history-list <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;google.com/search&#34;</span> <span style=color:#e6db74>&#34;file://&#34;</span>)
</span></span><span style=display:flex><span>          eaf-browser-text-selection-color <span style=color:#e6db74>&#34;auto&#34;</span>
</span></span><span style=display:flex><span>          eaf-browser-translate-language +my/lang-main
</span></span><span style=display:flex><span>          eaf-browser-blank-page-url <span style=color:#e6db74>&#34;https://www.duckduckgo.com&#34;</span>
</span></span><span style=display:flex><span>          eaf-browser-chrome-history-file <span style=color:#e6db74>&#34;~/.config/google-chrome/Default/History&#34;</span>
</span></span><span style=display:flex><span>          eaf-browser-default-search-engine <span style=color:#e6db74>&#34;duckduckgo&#34;</span>
</span></span><span style=display:flex><span>          eaf-browser-continue-where-left-off <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          eaf-browser-aria2-auto-file-renaming <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-browser</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (defun +eaf-open-mail-as-html ()
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;Open the html mail in EAF Browser.&#34;</span>
</span></span><span style=display:flex><span>      (interactive)
</span></span><span style=display:flex><span>      (let ((msg (mu4e-message-at-point <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>            <span style=color:#75715e>;; Bind browse-url-browser-function locally, so it works</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>;; even if EAF Browser is not set as a default browser.</span>
</span></span><span style=display:flex><span>            (browse-url-browser-function <span style=color:#a6e22e>#&#39;</span>eaf-open-browser))
</span></span><span style=display:flex><span>        (if msg
</span></span><span style=display:flex><span>            (mu4e-action-view-in-browser msg)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;No message at point.&#34;</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; File manager settings</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;file-manager</span>)
</span></span><span style=display:flex><span>    (setq eaf-file-manager-show-preview <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>          eaf-find-alternate-file-in-dired <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          eaf-file-manager-show-hidden-file <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          eaf-file-manager-show-icon <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-file-manager</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; File Browser</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;file-browser</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-file-browser</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; PDF Viewer settings</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;pdf-viewer</span>)
</span></span><span style=display:flex><span>    (setq eaf-pdf-dark-mode <span style=color:#e6db74>&#34;follow&#34;</span>
</span></span><span style=display:flex><span>          eaf-pdf-show-progress-on-page <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>          eaf-pdf-dark-exclude-image <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          eaf-pdf-notify-file-changed <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-pdf-viewer</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Org</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;rss-reader</span>)
</span></span><span style=display:flex><span>    (setq eaf-rss-reader-split-horizontally <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>          eaf-rss-reader-web-page-other-window <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-org</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Org</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;org</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-org</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Mail</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; BUG The `eaf-open-mail-as-html&#39; is not working,</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;;     I use `+eaf-open-mail-as-html&#39; instead</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;mail</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-mail</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Org Previewer</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;org-previewer</span>)
</span></span><span style=display:flex><span>    (setq eaf-org-dark-mode <span style=color:#e6db74>&#34;follow&#34;</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-org-previewer</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Markdown Previewer</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;markdown-previewer</span>)
</span></span><span style=display:flex><span>    (setq eaf-markdown-dark-mode <span style=color:#e6db74>&#34;follow&#34;</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-markdown-previewer</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Jupyter</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;jupyter</span>)
</span></span><span style=display:flex><span>    (setq eaf-jupyter-dark-mode <span style=color:#e6db74>&#34;follow&#34;</span>
</span></span><span style=display:flex><span>          eaf-jupyter-font-family (<span style=color:#a6e22e>symbol-name</span> (<span style=color:#a6e22e>font-get</span> doom-font :family))
</span></span><span style=display:flex><span>          eaf-jupyter-font-size <span style=color:#ae81ff>13</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-jupyter</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Mindmap</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;mindmap</span>)
</span></span><span style=display:flex><span>    (setq eaf-mindmap-dark-mode <span style=color:#e6db74>&#34;follow&#34;</span>
</span></span><span style=display:flex><span>          eaf-mindmap-save-path <span style=color:#e6db74>&#34;~/Dropbox/Mindmap&#34;</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-mindmap</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; File Sender</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;file-sender</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-file-sender</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Music Player</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;music-player</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-music-player</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Video Player</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;video-player</span>)
</span></span><span style=display:flex><span>    (setq eaf-video-player-keybinding
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;p&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;toggle_play&#34;</span>)
</span></span><span style=display:flex><span>            (<span style=color:#e6db74>&#34;q&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;close_buffer&#34;</span>)
</span></span><span style=display:flex><span>            (<span style=color:#e6db74>&#34;h&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;play_backward&#34;</span>)
</span></span><span style=display:flex><span>            (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;play_forward&#34;</span>)
</span></span><span style=display:flex><span>            (<span style=color:#e6db74>&#34;j&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;decrease_volume&#34;</span>)
</span></span><span style=display:flex><span>            (<span style=color:#e6db74>&#34;k&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;increase_volume&#34;</span>)
</span></span><span style=display:flex><span>            (<span style=color:#e6db74>&#34;f&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;toggle_fullscreen&#34;</span>)
</span></span><span style=display:flex><span>            (<span style=color:#e6db74>&#34;R&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;restart&#34;</span>)))
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-video-player</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Image Viewer</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;image-viewer</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-image-viewer</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Git</span>
</span></span><span style=display:flex><span>  (when (+eaf-app-p <span style=color:#e6db74>&#39;git</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-git</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Fix EVIL keybindings</span>
</span></span><span style=display:flex><span>  (after! evil
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;eaf-evil</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>define-key</span> key-translation-map (kbd <span style=color:#e6db74>&#34;SPC&#34;</span>)
</span></span><span style=display:flex><span>      (lambda (prompt)
</span></span><span style=display:flex><span>        (if (derived-mode-p <span style=color:#e6db74>&#39;eaf-mode</span>)
</span></span><span style=display:flex><span>            (pcase eaf--buffer-app-name
</span></span><span style=display:flex><span>              (<span style=color:#e6db74>&#34;browser&#34;</span> (if (eaf-call-sync <span style=color:#e6db74>&#34;execute_function&#34;</span> eaf--buffer-id <span style=color:#e6db74>&#34;is_focus&#34;</span>)
</span></span><span style=display:flex><span>                             (kbd <span style=color:#e6db74>&#34;SPC&#34;</span>)
</span></span><span style=display:flex><span>                           (kbd eaf-evil-leader-key)))
</span></span><span style=display:flex><span>              (<span style=color:#e6db74>&#34;pdf-viewer&#34;</span> (kbd eaf-evil-leader-key))
</span></span><span style=display:flex><span>              (<span style=color:#e6db74>&#34;image-viewer&#34;</span> (kbd eaf-evil-leader-key))
</span></span><span style=display:flex><span>              (<span style=color:#e6db74>&#34;music-player&#34;</span> (kbd eaf-evil-leader-key))
</span></span><span style=display:flex><span>              (<span style=color:#e6db74>&#34;video-player&#34;</span> (kbd eaf-evil-leader-key))
</span></span><span style=display:flex><span>              (<span style=color:#e6db74>&#34;file-sender&#34;</span> (kbd eaf-evil-leader-key))
</span></span><span style=display:flex><span>              (<span style=color:#e6db74>&#34;mindmap&#34;</span> (kbd eaf-evil-leader-key))
</span></span><span style=display:flex><span>              (_  (kbd <span style=color:#e6db74>&#34;SPC&#34;</span>)))
</span></span><span style=display:flex><span>          (kbd <span style=color:#e6db74>&#34;SPC&#34;</span>))))))
</span></span></code></pre></div><h4 id=bitwarden>Bitwarden</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! bitwarden
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;seanfarley/emacs-bitwarden&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! bitwarden
</span></span><span style=display:flex><span>  <span style=color:#75715e>;;:config</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;;(bitwarden-auth-source-enable)</span>
</span></span><span style=display:flex><span>  :when BITWARDEN-P
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq bitwarden-automatic-unlock
</span></span><span style=display:flex><span>        (lambda ()
</span></span><span style=display:flex><span>          (require <span style=color:#e6db74>&#39;auth-source</span>)
</span></span><span style=display:flex><span>          (if-let* ((matches (auth-source-search :host <span style=color:#e6db74>&#34;bitwarden.com&#34;</span> :max <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>                    (entry (<span style=color:#a6e22e>nth</span> <span style=color:#ae81ff>0</span> matches))
</span></span><span style=display:flex><span>                    (email (<span style=color:#a6e22e>plist-get</span> entry :user))
</span></span><span style=display:flex><span>                    (pass (<span style=color:#a6e22e>plist-get</span> entry :secret)))
</span></span><span style=display:flex><span>              (progn
</span></span><span style=display:flex><span>                (setq bitwarden-user email)
</span></span><span style=display:flex><span>                (if (<span style=color:#a6e22e>functionp</span> pass) (<span style=color:#a6e22e>funcall</span> pass) pass))
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;&#34;</span>))))
</span></span></code></pre></div><h4 id=pdf-tools>PDF tools</h4><h5 id=dark-mode>Dark mode</h5><p>The <code>pdf-tools</code> package supports dark mode (midnight), I use Emacs often to write
and read PDF documents, so let&rsquo;s make it dark by default, this can be toggled
using the <code>m z</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! pdf-tools
</span></span><span style=display:flex><span>  (add-hook! <span style=color:#e6db74>&#39;pdf-view-mode-hook</span>
</span></span><span style=display:flex><span>    (when (<span style=color:#a6e22e>memq</span> doom-theme <span style=color:#f92672>&#39;</span>(modus-vivendi doom-one doom-dark+ doom-vibrant))
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; TODO: find a more generic way to detect if we are in a dark theme</span>
</span></span><span style=display:flex><span>      (pdf-view-midnight-minor-mode <span style=color:#ae81ff>1</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Color the background, so we can see the PDF page borders</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; https://protesilaos.com/emacs/modus-themes#h:ff69dfe1-29c0-447a-915c-b5ff7c5509cd</span>
</span></span><span style=display:flex><span>  (defun +pdf-tools-backdrop ()
</span></span><span style=display:flex><span>    (face-remap-add-relative
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#39;default</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>`</span>(:background <span style=color:#f92672>,</span>(if (<span style=color:#a6e22e>memq</span> doom-theme <span style=color:#f92672>&#39;</span>(modus-vivendi modus-operandi))
</span></span><span style=display:flex><span>                        (modus-themes-color <span style=color:#e6db74>&#39;bg-alt</span>)
</span></span><span style=display:flex><span>                      (doom-color <span style=color:#e6db74>&#39;bg-alt</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;pdf-tools-enabled-hook</span> <span style=color:#a6e22e>#&#39;</span>+pdf-tools-backdrop))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(after! pdf-links
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Tweak for Modus and `pdf-links&#39;</span>
</span></span><span style=display:flex><span>  (when (<span style=color:#a6e22e>memq</span> doom-theme <span style=color:#f92672>&#39;</span>(modus-vivendi modus-operandi))
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; https://protesilaos.com/emacs/modus-themes#h:2659d13e-b1a5-416c-9a89-7c3ce3a76574</span>
</span></span><span style=display:flex><span>    (let ((spec (<span style=color:#a6e22e>apply</span> <span style=color:#a6e22e>#&#39;append</span>
</span></span><span style=display:flex><span>                       (<span style=color:#a6e22e>mapcar</span>
</span></span><span style=display:flex><span>                        (lambda (name)
</span></span><span style=display:flex><span>                          (<span style=color:#a6e22e>list</span> name
</span></span><span style=display:flex><span>                                (face-attribute <span style=color:#e6db74>&#39;pdf-links-read-link</span>
</span></span><span style=display:flex><span>                                                name <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#39;default</span>)))
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#39;</span>(:family :width :weight :slant)))))
</span></span><span style=display:flex><span>      (setq pdf-links-read-link-convert-commands
</span></span><span style=display:flex><span>            <span style=color:#f92672>`</span>(<span style=color:#e6db74>&#34;-density&#34;</span>    <span style=color:#e6db74>&#34;96&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;-family&#34;</span>     <span style=color:#f92672>,</span>(<span style=color:#a6e22e>plist-get</span> spec :family)
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;-stretch&#34;</span>    <span style=color:#f92672>,</span>(let* ((width (<span style=color:#a6e22e>plist-get</span> spec :width))
</span></span><span style=display:flex><span>                                    (name (<span style=color:#a6e22e>symbol-name</span> width)))
</span></span><span style=display:flex><span>                               (replace-regexp-in-string <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                                                         (<span style=color:#a6e22e>capitalize</span> name)))
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;-weight&#34;</span>     <span style=color:#f92672>,</span>(pcase (<span style=color:#a6e22e>plist-get</span> spec :weight)
</span></span><span style=display:flex><span>                               (<span style=color:#e6db74>&#39;ultra-light</span> <span style=color:#e6db74>&#34;Thin&#34;</span>)
</span></span><span style=display:flex><span>                               (<span style=color:#e6db74>&#39;extra-light</span> <span style=color:#e6db74>&#34;ExtraLight&#34;</span>)
</span></span><span style=display:flex><span>                               (<span style=color:#e6db74>&#39;light</span>       <span style=color:#e6db74>&#34;Light&#34;</span>)
</span></span><span style=display:flex><span>                               (<span style=color:#e6db74>&#39;semi-bold</span>   <span style=color:#e6db74>&#34;SemiBold&#34;</span>)
</span></span><span style=display:flex><span>                               (<span style=color:#e6db74>&#39;bold</span>        <span style=color:#e6db74>&#34;Bold&#34;</span>)
</span></span><span style=display:flex><span>                               (<span style=color:#e6db74>&#39;extra-bold</span>  <span style=color:#e6db74>&#34;ExtraBold&#34;</span>)
</span></span><span style=display:flex><span>                               (<span style=color:#e6db74>&#39;ultra-bold</span>  <span style=color:#e6db74>&#34;Black&#34;</span>)
</span></span><span style=display:flex><span>                               (_weight      <span style=color:#e6db74>&#34;Normal&#34;</span>))
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;-style&#34;</span>      <span style=color:#f92672>,</span>(pcase (<span style=color:#a6e22e>plist-get</span> spec :slant)
</span></span><span style=display:flex><span>                               (<span style=color:#e6db74>&#39;italic</span>  <span style=color:#e6db74>&#34;Italic&#34;</span>)
</span></span><span style=display:flex><span>                               (<span style=color:#e6db74>&#39;oblique</span> <span style=color:#e6db74>&#34;Oblique&#34;</span>)
</span></span><span style=display:flex><span>                               (_slant   <span style=color:#e6db74>&#34;Normal&#34;</span>))
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;-pointsize&#34;</span>  <span style=color:#e6db74>&#34;%P&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;-undercolor&#34;</span> <span style=color:#e6db74>&#34;%f&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;-fill&#34;</span>       <span style=color:#e6db74>&#34;%b&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;-draw&#34;</span>       <span style=color:#e6db74>&#34;text %X,%Y &#39;%c&#39;&#34;</span>)))))
</span></span></code></pre></div><h4 id=ltdr>LTDR</h4><p>Add the <code>tldr.el</code> client for <a href=https://github.com/tldr-pages/tldr>TLDR pages</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! tldr)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! tldr
</span></span><span style=display:flex><span>  :commands (tldr-update-docs tldr)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq tldr-enabled-categories <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;common&#34;</span> <span style=color:#e6db74>&#34;linux&#34;</span> <span style=color:#e6db74>&#34;osx&#34;</span> <span style=color:#e6db74>&#34;sunos&#34;</span>)))
</span></span></code></pre></div><h4 id=fzf>FZF</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! fzf)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! evil
</span></span><span style=display:flex><span>  (evil-define-key <span style=color:#e6db74>&#39;insert</span> fzf-mode-map (kbd <span style=color:#e6db74>&#34;ESC&#34;</span>) <span style=color:#a6e22e>#&#39;</span>term-kill-subjob))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(define-minor-mode fzf-mode
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Minor mode for the FZF buffer&#34;</span>
</span></span><span style=display:flex><span>  :init-value <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>  :lighter <span style=color:#e6db74>&#34; FZF&#34;</span>
</span></span><span style=display:flex><span>  :keymap <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;C-c&#34;</span> <span style=color:#f92672>.</span> term-kill-subjob)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defadvice! doom-fzf--override-start-args-a (original-fn <span style=color:#66d9ef>&amp;rest</span> args)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Set the FZF minor mode with the fzf buffer.&#34;</span>
</span></span><span style=display:flex><span>  :around <span style=color:#a6e22e>#&#39;</span>fzf/start
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;called with args %S&#34;</span> args)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>apply</span> original-fn args)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; set the FZF buffer to fzf-mode so we can hook ctrl+c</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>set-buffer</span> <span style=color:#e6db74>&#34;*fzf*&#34;</span>)
</span></span><span style=display:flex><span>  (fzf-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar fzf/args
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;-x --print-query -m --tiebreak=index --expect=ctrl-v,ctrl-x,ctrl-t&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(use-package! fzf
</span></span><span style=display:flex><span>  :commands (fzf fzf-projectile fzf-hg fzf-git fzf-git-files fzf-directory fzf-git-grep))
</span></span></code></pre></div><h4 id=binary-files>Binary files</h4><p>Inspired by <a href=https://emacs.stackexchange.com/questions/10277/make-emacs-automatically-open-binary-files-in-hexl-mode>this discussion</a>.</p><p>Add the new <code>nhexl-mode</code> which allows editing files in Hex mode.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! nhexl-mode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +buffer-binary-p (<span style=color:#66d9ef>&amp;optional</span> buffer)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Return whether BUFFER or the current buffer is binary.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>A binary buffer is defined as containing at least one null byte.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Returns either nil, or the position of the first null byte.&#34;</span>
</span></span><span style=display:flex><span>  (with-current-buffer (or buffer (<span style=color:#a6e22e>current-buffer</span>))
</span></span><span style=display:flex><span>    (save-excursion (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>                    (<span style=color:#a6e22e>search-forward</span> (<span style=color:#a6e22e>string</span> <span style=color:#e6db74>?\x</span><span style=color:#ae81ff>00</span>) <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span> <span style=color:#ae81ff>1</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +hexl--buffer-p ()
</span></span><span style=display:flex><span>  (and (+buffer-binary-p)
</span></span><span style=display:flex><span>       <span style=color:#75715e>;; Executables are viewed with objdump mode</span>
</span></span><span style=display:flex><span>       (not (+buffer-objdump-p))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +hexl-if-binary ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;If </span><span style=color:#e6db74>`hexl-mode&#39;</span><span style=color:#e6db74> is not already active, and the current buffer
</span></span></span><span style=display:flex><span><span style=color:#e6db74>is binary, activate </span><span style=color:#e6db74>`hexl-mode&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (unless (<span style=color:#a6e22e>eq</span> major-mode <span style=color:#e6db74>&#39;hexl-mode</span>)
</span></span><span style=display:flex><span>    (when (+hexl--buffer-p)
</span></span><span style=display:flex><span>      (hexl-mode))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;magic-fallback-mode-alist</span> <span style=color:#f92672>&#39;</span>(+hexl--buffer-p <span style=color:#f92672>.</span> +hexl-if-binary) <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h4 id=objdump-mode>Objdump mode</h4><p>Define a major mode (<code>objdump-disassemble-mode</code>) to display executable files as
assembly code using <code>objdump</code>. The file types are detected using the <code>file</code> utility.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +buffer-objdump-p (<span style=color:#66d9ef>&amp;optional</span> buffer file)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Can the BUFFER be viewed as a disassembled code with objdump.&#34;</span>
</span></span><span style=display:flex><span>  (when-let ((file (or file (<span style=color:#a6e22e>buffer-file-name</span> (or buffer (<span style=color:#a6e22e>current-buffer</span>))))))
</span></span><span style=display:flex><span>    (and
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>file-exists-p</span> file)
</span></span><span style=display:flex><span>     (not (<span style=color:#a6e22e>file-directory-p</span> file))
</span></span><span style=display:flex><span>     (not (zerop (file-attribute-size (<span style=color:#a6e22e>file-attributes</span> file))))
</span></span><span style=display:flex><span>     (not (string-match-p
</span></span><span style=display:flex><span>           <span style=color:#e6db74>&#34;file format not recognized&#34;</span>
</span></span><span style=display:flex><span>           (with-temp-buffer
</span></span><span style=display:flex><span>             (shell-command (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;objdump --file-headers %s&#34;</span>
</span></span><span style=display:flex><span>                                    (shell-quote-argument <span style=color:#e6db74>&#34;/home/hacko/Softwares/Kasparov/Kasparov Chessmate/KasparovChess.Stats&#34;</span>))
</span></span><span style=display:flex><span>                            (<span style=color:#a6e22e>current-buffer</span>))
</span></span><span style=display:flex><span>             (<span style=color:#a6e22e>buffer-string</span>)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(when OBJDUMP-P
</span></span><span style=display:flex><span>  (define-derived-mode objdump-disassemble-mode
</span></span><span style=display:flex><span>    asm-mode <span style=color:#e6db74>&#34;Objdump Mode&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Major mode for viewing executable files disassembled using objdump.&#34;</span>
</span></span><span style=display:flex><span>    (if (not (+buffer-objdump-p))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Objdump can not be used with this buffer.&#34;</span>)
</span></span><span style=display:flex><span>      (let ((file (<span style=color:#a6e22e>buffer-file-name</span>))
</span></span><span style=display:flex><span>            (buffer-read-only <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>erase-buffer</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Disassembling file \&#34;%s\&#34; using objdump.&#34;</span> (<span style=color:#a6e22e>file-name-nondirectory</span> file))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>call-process</span> <span style=color:#e6db74>&#34;objdump&#34;</span> <span style=color:#66d9ef>nil</span> (<span style=color:#a6e22e>current-buffer</span>) <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#34;-d&#34;</span> file)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>set-buffer-modified-p</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>        (view-mode)
</span></span><span style=display:flex><span>        (set-visited-file-name <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#e6db74>&#39;magic-fallback-mode-alist</span> <span style=color:#f92672>&#39;</span>(+buffer-objdump-p <span style=color:#f92672>.</span> objdump-disassemble-mode) <span style=color:#66d9ef>t</span>))
</span></span></code></pre></div><h3 id=fun>Fun</h3><h4 id=speed-type>Speed Type</h4><p>A game to practice speed typing in Emacs.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! speed-type)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! speed-type
</span></span><span style=display:flex><span>  :commands (speed-type-text))
</span></span></code></pre></div><h4 id=2048-game>2048 Game</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! 2048-game)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! 2048-game
</span></span><span style=display:flex><span>  :commands (2048-game))
</span></span></code></pre></div><h4 id=snow>Snow</h4><p>Let it snow in Emacs!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! snow)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! snow
</span></span><span style=display:flex><span>  :commands (snow))
</span></span></code></pre></div><h4 id=xkcd><code>xkcd</code></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! xkcd
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;vibhavp/emacs-xkcd&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! xkcd
</span></span><span style=display:flex><span>  :commands (xkcd-get xkcd)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq xkcd-cache-dir (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;xkcd/&#34;</span> doom-cache-dir)
</span></span><span style=display:flex><span>        xkcd-cache-latest (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;xkcd/latest&#34;</span> doom-cache-dir)))
</span></span></code></pre></div><h2 id=applications>Applications</h2><h3 id=calendar>Calendar</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq calendar-latitude <span style=color:#ae81ff>48.7</span>
</span></span><span style=display:flex><span>      calendar-longitude <span style=color:#ae81ff>2.17</span>
</span></span><span style=display:flex><span>      calendar-location-name <span style=color:#e6db74>&#34;Orsay, FR&#34;</span>
</span></span><span style=display:flex><span>      calendar-time-display-form
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>(24-hours <span style=color:#e6db74>&#34;:&#34;</span> minutes
</span></span><span style=display:flex><span>                 (if time-zone <span style=color:#e6db74>&#34; (&#34;</span>) time-zone (if time-zone <span style=color:#e6db74>&#34;)&#34;</span>)))
</span></span></code></pre></div><h3 id=e-books--nov>e-Books (<code>nov</code>)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! nov)
</span></span></code></pre></div><p>Use <code>nov</code> to read EPUB e-books.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! nov
</span></span><span style=display:flex><span>  :mode (<span style=color:#e6db74>&#34;\\.epub\\&#39;&#34;</span> <span style=color:#f92672>.</span> nov-mode)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (map! :map nov-mode-map
</span></span><span style=display:flex><span>        :n <span style=color:#e6db74>&#34;RET&#34;</span> <span style=color:#a6e22e>#&#39;</span>nov-scroll-up)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun doom-modeline-segment--nov-info ()
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34; &#34;</span>
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>propertize</span> (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> <span style=color:#e6db74>&#39;creator</span> nov-metadata))
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;doom-modeline-project-parent-dir</span>)
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34; &#34;</span>
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> <span style=color:#e6db74>&#39;title</span> nov-metadata))
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34; &#34;</span>
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>propertize</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;%d/%d&#34;</span> (<span style=color:#a6e22e>1+</span> nov-documents-index) (<span style=color:#a6e22e>length</span> nov-documents))
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;doom-modeline-info</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (advice-add <span style=color:#e6db74>&#39;nov-render-title</span> :override <span style=color:#a6e22e>#&#39;</span>ignore)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +nov-mode-setup ()
</span></span><span style=display:flex><span>    (face-remap-add-relative <span style=color:#e6db74>&#39;variable-pitch</span>
</span></span><span style=display:flex><span>                             :family <span style=color:#e6db74>&#34;Merriweather&#34;</span>
</span></span><span style=display:flex><span>                             :height <span style=color:#ae81ff>1.4</span>
</span></span><span style=display:flex><span>                             :width <span style=color:#e6db74>&#39;semi-expanded</span>)
</span></span><span style=display:flex><span>    (face-remap-add-relative <span style=color:#e6db74>&#39;default</span> :height <span style=color:#ae81ff>1.3</span>)
</span></span><span style=display:flex><span>    (setq-local line-spacing <span style=color:#ae81ff>0.2</span>
</span></span><span style=display:flex><span>                next-screen-context-lines <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>                shr-use-colors <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;visual-fill-column</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (setq-local visual-fill-column-center-text <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                visual-fill-column-width <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>                nov-text-width <span style=color:#ae81ff>80</span>)
</span></span><span style=display:flex><span>    (visual-fill-column-mode <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    (hl-line-mode <span style=color:#ae81ff>-1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (add-to-list <span style=color:#e6db74>&#39;+lookup-definition-functions</span>
</span></span><span style=display:flex><span>                 <span style=color:#a6e22e>#&#39;</span>+lookup/dictionary-definition)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (setq-local mode-line-format
</span></span><span style=display:flex><span>                <span style=color:#f92672>`</span>((:eval
</span></span><span style=display:flex><span>                   (doom-modeline-segment--workspace-name))
</span></span><span style=display:flex><span>                  (:eval
</span></span><span style=display:flex><span>                   (doom-modeline-segment--window-number))
</span></span><span style=display:flex><span>                  (:eval
</span></span><span style=display:flex><span>                   (doom-modeline-segment--nov-info))
</span></span><span style=display:flex><span>                  <span style=color:#f92672>,</span>(<span style=color:#a6e22e>propertize</span>
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34; %P &#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;doom-modeline-buffer-minor-mode</span>)
</span></span><span style=display:flex><span>                  <span style=color:#f92672>,</span>(<span style=color:#a6e22e>propertize</span>
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34; &#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;face</span> (if (doom-modeline--active) <span style=color:#e6db74>&#39;mode-line</span> <span style=color:#e6db74>&#39;mode-line-inactive</span>)
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;display</span> <span style=color:#f92672>`</span>((space
</span></span><span style=display:flex><span>                                :align-to
</span></span><span style=display:flex><span>                                (<span style=color:#a6e22e>-</span> (<span style=color:#a6e22e>+</span> right right-fringe right-margin)
</span></span><span style=display:flex><span>                                   <span style=color:#f92672>,</span>(<span style=color:#a6e22e>*</span> (let ((width (doom-modeline--font-width)))
</span></span><span style=display:flex><span>                                         (or (and (<span style=color:#a6e22e>=</span> width <span style=color:#ae81ff>1</span>) <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                                             (<span style=color:#a6e22e>/</span> width (<span style=color:#a6e22e>frame-char-width</span>) <span style=color:#ae81ff>1.0</span>)))
</span></span><span style=display:flex><span>                                       (<span style=color:#a6e22e>string-width</span>
</span></span><span style=display:flex><span>                                        (<span style=color:#a6e22e>format-mode-line</span> (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>&#39;</span>(:eval (doom-modeline-segment--major-mode))))))))))
</span></span><span style=display:flex><span>                  (:eval (doom-modeline-segment--major-mode)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;nov-mode-hook</span> <span style=color:#a6e22e>#&#39;</span>+nov-mode-setup))
</span></span></code></pre></div><h3 id=news-feed--elfeed>News feed (<code>elfeed</code>)</h3><p>Set RSS news feeds</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq elfeed-feeds
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;https://this-week-in-rust.org/rss.xml&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://planet.emacslife.com/atom.xml&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://www.omgubuntu.co.uk/feed&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://itsfoss.com/feed&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://linuxhandbook.com/feed&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://spectrum.ieee.org/rss/robotics/fulltext&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://spectrum.ieee.org/rss/aerospace/fulltext&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://spectrum.ieee.org/rss/computing/fulltext&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://spectrum.ieee.org/rss/blog/automaton/fulltext&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://developers.redhat.com/blog/feed&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;https://lwn.net/headlines/rss&#34;</span>))
</span></span></code></pre></div><h3 id=vpn-configuration>VPN configuration</h3><h4 id=netextender-wrapper>NetExtender wrapper</h4><p>I store my NetExtender VPN parameters in a GPG encrypted file. The credentials file
contains a line of private parameters to pass to <code>netExtender</code>, like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>echo <span style=color:#e6db74>&#34;-u &lt;USERNAME&gt; -d &lt;DOMAINE&gt; -p &lt;PASSWORD&gt; -s &lt;SERVER_IP&gt;&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  | gpg -c &gt; sslvpn.gpg
</span></span></code></pre></div><p>Then I like to have a simple script which decrypt the credentials and launch a
session via the <code>netExtender</code> command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ! command -v netExtender &amp;&gt; /dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;netExtender not found, installing from AUR using &#39;yay&#39;&#34;</span>
</span></span><span style=display:flex><span>  yay -S netextender
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>MY_LOGIN_PARAMS_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.ssh/sslvpn.gpg&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Y\n&#34;</span> | netExtender --auto-reconnect <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#66d9ef>$(</span>gpg -q --for-your-eyes-only --no-tty -d <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>MY_LOGIN_PARAMS_FILE<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span>
</span></span></code></pre></div><h4 id=emacs-plus-netextender>Emacs + NetExtender</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(when NETEXTENDER-P
</span></span><span style=display:flex><span>  (defvar +netextender-process-name <span style=color:#e6db74>&#34;netextender&#34;</span>)
</span></span><span style=display:flex><span>  (defvar +netextender-buffer-name <span style=color:#e6db74>&#34; *NetExtender*&#34;</span>)
</span></span><span style=display:flex><span>  (defvar +netextender-command <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;~/.local/bin/netextender&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +netextender-start ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Launch a NetExtender VPN session&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (unless (<span style=color:#a6e22e>get-process</span> +netextender-process-name)
</span></span><span style=display:flex><span>      (if (make-process :name +netextender-process-name
</span></span><span style=display:flex><span>                        :buffer +netextender-buffer-name
</span></span><span style=display:flex><span>                        :command +netextender-command)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Started NetExtender VPN session&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Cannot start NetExtender&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +netextender-kill ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Kill the created NetExtender VPN session&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (when (<span style=color:#a6e22e>get-process</span> +netextender-process-name)
</span></span><span style=display:flex><span>      (if (<span style=color:#a6e22e>kill-buffer</span> +netextender-buffer-name)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Killed NetExtender VPN session&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Cannot kill NetExtender&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :leader
</span></span><span style=display:flex><span>        :prefix (<span style=color:#e6db74>&#34;l&#34;</span>)
</span></span><span style=display:flex><span>        (:prefix (<span style=color:#e6db74>&#34;t&#34;</span>)
</span></span><span style=display:flex><span>         (:prefix (<span style=color:#e6db74>&#34;n&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;netExtender&#34;</span>)
</span></span><span style=display:flex><span>          :desc <span style=color:#e6db74>&#34;Start&#34;</span> <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#a6e22e>#&#39;</span>+netextender-start
</span></span><span style=display:flex><span>          :desc <span style=color:#e6db74>&#34;Kill&#34;</span>  <span style=color:#e6db74>&#34;k&#34;</span> <span style=color:#a6e22e>#&#39;</span>+netextender-kill))))
</span></span></code></pre></div><h3 id=email--mu4e>Email (<code>mu4e</code>)</h3><p>Configuring <code>mu4e</code> as email client needs three parts:</p><ul><li>Incoming mail configuration IMAP (using <code>mbsync</code>)</li><li>Outgoing mail configuration SMTP (using <code>smtpmail</code> or <code>msmtp</code>)</li><li>Email indexer and viewer (via <code>mu</code> and <code>mu4e</code>)</li></ul><h4 id=imap--mbsync>IMAP (<code>mbsync</code>)</h4><p>You will need to:</p><ul><li>Install <code>mu</code> and <code>isync</code> (<code>sudo pacman -S mu isync</code>)</li><li>Set up a proper configuration file for your accounts at <code>~/.mbsyncrc</code></li><li>Run <code>mu init --maildir=~/Maildir --my-address=user@host1 --my-address=user@host2</code></li><li>Run <code>mbsync -c ~/.mbsyncrc -a</code></li><li>For sending mails from <code>mu4e</code>, add a <code>~/.authinfo</code> file, file contains a line in
this format <code>machine MAIL.DOMAIN.TLD login USER port 587 password PASSWD</code></li><li>Encrypt the <code>~/.authinfo</code> file using GPG <code>gpg -c ~/.authinfo</code> and delete the
original unencrypted file.</li></ul><p>I use a <code>mbsyncrc</code> file for multi-accounts, with some hacks for Gmail accounts (to
rename the <code>[Gmail]/...</code> folders). Here is an explained configuration example.</p><p>In the configuration file, there is an parameter named <code>Pass</code> which should be set
to the password in plain text. Most of the examples you can find online uses
this parameter, but in real life, nobody uses it, it is extremely unsafe to put
the password in plain text configuration file. Instead, <code>mbsync</code> configuration
file provides the alternative <code>PassCmd</code> parameter, which can be set to an
arbitrary shell command which gets the password for you. You can set it for
example to call the <code>pass</code> password manager to output the account password, or to
<code>bw</code> command (for Bitwarden users). For me, I&rsquo;m using it with Emacs'
<code>~/.authinfo.gpg</code>, the <code>PassCmd</code> in my configuration uses GPG and <code>awk</code> to decrypt and
filter the file content to find the required account&rsquo;s password. I set <code>PassCmd</code>
to something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>gpg -q --for-your-eyes-only --no-tty --logger-file /dev/null --batch -d ~/.authinfo.gpg | awk <span style=color:#e6db74>&#39;/machine smtp\.googlemail\.com login username@gmail\.com/ {print $NF}&#39;</span>
</span></span></code></pre></div><p>Remember the line format in the <code>~/.authinfo.gpg</code> file:</p><pre tabindex=0><code class=language-authinfo data-lang=authinfo>machine smtp.googlemail.com login username@gmail.com port 587 password PASSWD
</code></pre><p>This <code>PassCmd</code> command above, decrypts the <code>~/.authinfo.gpg</code>, passes it to <code>awk</code> to
search the line containing <code>"machine smtp.googlemail.com login username@gmail.com"</code> and prints the last field (the last field <code>$NF</code> in the <code>awk</code>
command corresponds to the password, as you can see in the line format).</p><p>The whole <code>~/.mbsync</code> file should look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cfg data-lang=cfg><span style=display:flex><span><span style=color:#75715e># mbsync config file</span>
</span></span><span style=display:flex><span><span style=color:#75715e># GLOBAL OPTIONS</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>BufferLimit 50mb             # Global option:   Default buffer size is 10M, too small for modern machines.</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Sync All                     # Channels global: Sync everything &#34;Pull Push New ReNew Delete Flags&#34; (default option)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Create Both                  # Channels global: Automatically create missing mailboxes on both sides</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Expunge Both                 # Channels global: Delete messages marked for deletion on both sides</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>CopyArrivalDate yes          # Channels global: Propagate arrival time with the messages</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># SECTION (IMAP4 Accounts)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>IMAPAccount work             # IMAP Account name</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Host mail.host.ccc           # The host to connect to</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>User user@host.ccc           # Login user name</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SSLVersions TLSv1.2 TLSv1.1  # Supported SSL versions</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Extract password from encrypted ~/.authinfo.gpg</span>
</span></span><span style=display:flex><span><span style=color:#75715e># File format: &#34;machine &lt;SERVER&gt; login &lt;LOGIN&gt; port &lt;PORT&gt; password &lt;PASSWORD&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This uses sed to extract &lt;PASSWORD&gt; from line matching the account&#39;s &lt;SERVER&gt;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PassCmd &#34;gpg2 -q --for-your-eyes-only --no-tty --logger-file /dev/null --batch -d ~/.authinfo.gpg | awk &#39;/machine smtp.domain.tld/ {print $NF}&#39;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>AuthMechs *                  # Authentication mechanisms</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SSLType IMAPS                # Protocol (STARTTLS/IMAPS)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>CertificateFile /etc/ssl/certs/ca-certificates.crt</span>
</span></span><span style=display:flex><span><span style=color:#75715e># END OF SECTION</span>
</span></span><span style=display:flex><span><span style=color:#75715e># IMPORTANT NOTE: you need to keep the blank line after each section</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># SECTION (IMAP Stores)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>IMAPStore work-remote        # Remote storage name</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Account work                 # Associated account</span>
</span></span><span style=display:flex><span><span style=color:#75715e># END OF SECTION</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># SECTION (Maildir Stores)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>MaildirStore work-local      # Local storage (create directories with mkdir -p ~/Maildir/&lt;ACCOUNT-NAME&gt;)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Path ~/Maildir/work/         # The local store path</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Inbox ~/Maildir/work/Inbox   # Location of the INBOX</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SubFolders Verbatim          # Download all sub-folders</span>
</span></span><span style=display:flex><span><span style=color:#75715e># END OF SECTION</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Connections specify links between remote and local folders</span>
</span></span><span style=display:flex><span><span style=color:#75715e># they are specified using patterns, which match remote mail</span>
</span></span><span style=display:flex><span><span style=color:#75715e># folders. Some commonly used patters include:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - &#34;*&#34; to match everything</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - &#34;!DIR&#34; to exclude &#34;DIR&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - &#34;DIR&#34; to match DIR</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># SECTION (Channels)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel work                 # Channel name</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Far :work-remote:            # Connect remote store</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Near :work-local:            # to the local one</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Patterns &#34;INBOX&#34; &#34;Drafts&#34; &#34;Sent&#34; &#34;Archives/*&#34; &#34;Spam&#34; &#34;Trash&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SyncState *                  # Save state in near side mailbox file &#34;.mbsyncstate&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># END OF SECTION</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># =================================================================================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>IMAPAccount gmail</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Host imap.gmail.com</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>User user@gmail.com</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PassCmd &#34;gpg2 -q --for-your-eyes-only --no-tty --logger-file /dev/null --batch -d ~/.authinfo.gpg | awk &#39;/machine smtp.domain.tld/ {print $NF}&#39;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>AuthMechs LOGIN</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SSLType IMAPS</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>CertificateFile /etc/ssl/certs/ca-certificates.crt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>IMAPStore gmail-remote</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Account gmail</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>MaildirStore gmail-local</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Path ~/Maildir/gmail/</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Inbox ~/Maildir/gmail/Inbox</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># For Gmail, I like to make multiple channels, one for each remote directory</span>
</span></span><span style=display:flex><span><span style=color:#75715e># this is a trick to rename remote &#34;[Gmail]/mailbox&#34; to &#34;mailbox&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-inbox</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Far :gmail-remote:</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Near :gmail-local:</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Patterns &#34;INBOX&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SyncState *</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-trash</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Far :gmail-remote:&#34;[Gmail]/Trash&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Near :gmail-local:&#34;Trash&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SyncState *</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-drafts</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Far :gmail-remote:&#34;[Gmail]/Drafts&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Near :gmail-local:&#34;Drafts&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SyncState *</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-sent</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Far :gmail-remote:&#34;[Gmail]/Sent Mail&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Near :gmail-local:&#34;Sent Mail&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SyncState *</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-all</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Far :gmail-remote:&#34;[Gmail]/All Mail&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Near :gmail-local:&#34;All Mail&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SyncState *</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-starred</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Far :gmail-remote:&#34;[Gmail]/Starred&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Near :gmail-local:&#34;Starred&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SyncState *</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-spam</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Far :gmail-remote:&#34;[Gmail]/Spam&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Near :gmail-local:&#34;Spam&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SyncState *</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># GROUPS PUT TOGETHER CHANNELS, SO THAT WE CAN INVOKE</span>
</span></span><span style=display:flex><span><span style=color:#75715e># MBSYNC ON A GROUP TO SYNC ALL CHANNELS</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># FOR INSTANCE: &#34;mbsync gmail&#34; GETS MAIL FROM</span>
</span></span><span style=display:flex><span><span style=color:#75715e># &#34;gmail-inbox&#34;, &#34;gmail-sent&#34;, and &#34;gmail-trash&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># SECTION (Groups)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Group gmail</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-inbox</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-sent</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-trash</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-drafts</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-all</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-starred</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Channel gmail-spam</span>
</span></span><span style=display:flex><span><span style=color:#75715e># END OF SECTION</span>
</span></span></code></pre></div><h4 id=smtp--msmtp>SMTP (<code>msmtp</code>)</h4><p>I was using the standard <code>smtpmail</code> to send mails; but recently, I&rsquo;m getting
problems when sending mails. I passed a whole day trying to fix mail sending for
one of my accounts, at the end of the day, I got a working setup; BUT, sending
the first mail always ask me about password! I need to enter the password to be
able to send the mail, Emacs asks me then if I want to save it to
<code>~/.authifo.gpg</code>, when I confirm saving it, it got duplicated in the <code>.authinfo.gpg</code>
file.</p><p>This seems to be a bug; I also found somewhere that <code>smtpmail</code> is buggy, and that
<code>msmtp</code> seems to be a good alternative, so now I&rsquo;m using a <code>msmtp</code>-based setup, and
it works like a charm!</p><p>For this, we will need an additional configuration file, <code>~/.msmtprc</code>, I configure
it the same way as <code>mbsync</code>, specifying this time SMTP servers instead of IMAP
ones. I extract the passwords from <code>~/.authinfo.gpg</code> using GPG and <code>awk</code>, the same
way we did in <code>mbsync</code>&rsquo;s configuration.</p><p>The following is a sample file <code>~/.msmtprc</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cfg data-lang=cfg><span style=display:flex><span><span style=color:#75715e># Set default values for all following accounts.</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>defaults</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>auth                    on</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>tls                     on</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>tls_starttls            on</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>tls_trust_file          /etc/ssl/certs/ca-certificates.crt</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>logfile                 ~/.msmtp.log</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Gmail</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>account                 gmail</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>auth                    plain</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>host                    smtp.googlemail.com</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>port                    587</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>from                    username@gmail.com</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>user                    username</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>passwordeval            &#34;gpg -q --for-your-eyes-only --no-tty --logger-file /dev/null --batch -d ~/.authinfo.gpg | awk &#39;/machine smtp.googlemail.com login .*@gmail.com/ {print $NF}&#39;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add_missing_date_header on</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## Gmail - aliases</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>account                 alias-account : gmail</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>from                    alias@mail.com</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>account                 other-alias : gmail</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>from                    other.alias@address.org</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Work</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>account                 work</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>auth                    on</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>host                    smtp.domaine.tld</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>port                    587</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>from                    username@domaine.tld</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>user                    username</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>passwordeval            &#34;gpg -q --for-your-eyes-only --no-tty --logger-file /dev/null --batch -d ~/.authinfo.gpg | awk &#39;/machine smtp.domaine.tld/ {print $NF}&#39;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>tls_nocertcheck # ignore TLS certificate errors</span>
</span></span></code></pre></div><h4 id=mail-client-and-indexer--mu-and-mu4e>Mail client and indexer (<code>mu</code> and <code>mu4e</code>)</h4><p>Add <code>mu4e</code> to path if it exists on the file system.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;load-path</span> <span style=color:#e6db74>&#34;/usr/local/share/emacs/site-lisp/mu4e&#34;</span>)
</span></span></code></pre></div><p>I configure my email accounts in a private file in
<code>lisp/private/+mu4e-accounts.el</code>, which will be loaded after this common part:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! mu4e
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;mu4e-contrib</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;mu4e-icalendar</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;org-agenda</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Common parameters</span>
</span></span><span style=display:flex><span>  (setq mu4e-update-interval (<span style=color:#a6e22e>*</span> <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>60</span>) <span style=color:#75715e>;; Every 3 min</span>
</span></span><span style=display:flex><span>        mu4e-index-update-error-warning <span style=color:#66d9ef>nil</span> <span style=color:#75715e>;; Do not show warning after update</span>
</span></span><span style=display:flex><span>        mu4e-get-mail-command <span style=color:#e6db74>&#34;mbsync -a&#34;</span> <span style=color:#75715e>;; Not needed, as +mu4e-backend is &#39;mbsync by default</span>
</span></span><span style=display:flex><span>        mu4e-main-hide-personal-addresses <span style=color:#66d9ef>t</span> <span style=color:#75715e>;; No need to display a long list of my own addresses!</span>
</span></span><span style=display:flex><span>        mu4e-attachment-dir (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~/Downloads/mu4e-attachements&#34;</span>)
</span></span><span style=display:flex><span>        mu4e-sent-messages-behavior <span style=color:#e6db74>&#39;sent</span> <span style=color:#75715e>;; Save sent messages</span>
</span></span><span style=display:flex><span>        mu4e-context-policy <span style=color:#e6db74>&#39;pick-first</span>   <span style=color:#75715e>;; Start with the first context</span>
</span></span><span style=display:flex><span>        mu4e-compose-context-policy <span style=color:#e6db74>&#39;ask</span>) <span style=color:#75715e>;; Always ask which context to use when composing a new mail</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Use msmtp instead of smtpmail</span>
</span></span><span style=display:flex><span>  (setq sendmail-program (executable-find <span style=color:#e6db74>&#34;msmtp&#34;</span>)
</span></span><span style=display:flex><span>        send-mail-function <span style=color:#a6e22e>#&#39;</span>smtpmail-send-it
</span></span><span style=display:flex><span>        message-sendmail-f-is-evil <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        message-sendmail-extra-arguments <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;--read-envelope-from&#34;</span>)
</span></span><span style=display:flex><span>        message-send-mail-function <span style=color:#a6e22e>#&#39;</span>message-send-mail-with-sendmail
</span></span><span style=display:flex><span>        message-sendmail-envelope-from <span style=color:#e6db74>&#39;obey-mail-envelope-from</span>
</span></span><span style=display:flex><span>        mail-envelope-from <span style=color:#e6db74>&#39;header</span>
</span></span><span style=display:flex><span>        mail-personal-alias-file (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;mail-aliases.mailrc&#34;</span> doom-user-dir)
</span></span><span style=display:flex><span>        mail-specify-envelope-from <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq mu4e-headers-fields <span style=color:#f92672>&#39;</span>((:flags <span style=color:#f92672>.</span> <span style=color:#ae81ff>6</span>) <span style=color:#75715e>;; 3 flags</span>
</span></span><span style=display:flex><span>                              (:account-stripe <span style=color:#f92672>.</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>                              (:from-or-to <span style=color:#f92672>.</span> <span style=color:#ae81ff>25</span>)
</span></span><span style=display:flex><span>                              (:folder <span style=color:#f92672>.</span> <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>                              (:recipnum <span style=color:#f92672>.</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>                              (:subject <span style=color:#f92672>.</span> <span style=color:#ae81ff>80</span>)
</span></span><span style=display:flex><span>                              (:human-date <span style=color:#f92672>.</span> <span style=color:#ae81ff>8</span>))
</span></span><span style=display:flex><span>        +mu4e-min-header-frame-width <span style=color:#ae81ff>142</span>
</span></span><span style=display:flex><span>        mu4e-headers-date-format <span style=color:#e6db74>&#34;%d/%m/%y&#34;</span>
</span></span><span style=display:flex><span>        mu4e-headers-time-format <span style=color:#e6db74>&#34;⧖ %H:%M&#34;</span>
</span></span><span style=display:flex><span>        mu4e-search-results-limit <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        mu4e-index-cleanup <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defvar +mu4e-header--folder-colors <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  (appendq! mu4e-header-info-custom
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#39;</span>((:folder <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>               (:name <span style=color:#e6db74>&#34;Folder&#34;</span> :shortname <span style=color:#e6db74>&#34;Folder&#34;</span> :help <span style=color:#e6db74>&#34;Lowest level folder&#34;</span> :function
</span></span><span style=display:flex><span>                (lambda (msg)
</span></span><span style=display:flex><span>                  (+mu4e-colorize-str
</span></span><span style=display:flex><span>                   (replace-regexp-in-string <span style=color:#e6db74>&#34;\\`.*/&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> (mu4e-message-field msg :maildir))
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#39;+mu4e-header--folder-colors</span>))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Add a unified inbox shortcut</span>
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;mu4e-bookmarks</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(:name <span style=color:#e6db74>&#34;Unified inbox&#34;</span> :query <span style=color:#e6db74>&#34;maildir:/.*inbox/&#34;</span> :key <span style=color:#e6db74>?i</span>) <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Add shortcut to view yesterday&#39;s messages</span>
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;mu4e-bookmarks</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(:name <span style=color:#e6db74>&#34;Yesterday&#39;s messages&#34;</span> :query <span style=color:#e6db74>&#34;date:1d..today&#34;</span> :key <span style=color:#e6db74>?y</span>) <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Load a list of my email addresses &#39;+my-addresses&#39;, defined as:</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; (setq +my-addresses &#39;(&#34;user@gmail.com&#34; &#34;user@hotmail.com&#34;))</span>
</span></span><span style=display:flex><span>  (load! <span style=color:#e6db74>&#34;lisp/private/+my-addresses.el&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (when (bound-and-true-p +my-addresses)
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; I like always to add myself in BCC, Lets add a bookmark to show all my BCC mails</span>
</span></span><span style=display:flex><span>    (defun +mu-long-query (query oper arg-list)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;(&#34;</span> (+str-join (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34; &#34;</span> oper <span style=color:#e6db74>&#34; &#34;</span>) (<span style=color:#a6e22e>mapcar</span> (lambda (addr) (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;%s:%s&#34;</span> query addr)) arg-list)) <span style=color:#e6db74>&#34;)&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Build a query to match mails send from &#34;me&#34; with &#34;me&#34; in BCC</span>
</span></span><span style=display:flex><span>    (let ((bcc-query (+mu-long-query <span style=color:#e6db74>&#34;bcc&#34;</span> <span style=color:#e6db74>&#34;or&#34;</span> +my-addresses))
</span></span><span style=display:flex><span>          (from-query (+mu-long-query <span style=color:#e6db74>&#34;from&#34;</span> <span style=color:#e6db74>&#34;or&#34;</span> +my-addresses)))
</span></span><span style=display:flex><span>      (add-to-list
</span></span><span style=display:flex><span>       <span style=color:#e6db74>&#39;mu4e-bookmarks</span>
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>list</span> :name <span style=color:#e6db74>&#34;My black copies&#34;</span> :query (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;maildir:/.*inbox/ and %s and %s&#34;</span> from-query bcc-query) :key <span style=color:#e6db74>?k</span>) <span style=color:#66d9ef>t</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; `mu4e-alert&#39; configuration</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Use a nicer icon in alerts</span>
</span></span><span style=display:flex><span>  (setq mu4e-alert-icon <span style=color:#e6db74>&#34;/usr/share/icons/Papirus/64x64/apps/mail-client.svg&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +mu4e-alert-helper-name-or-email (msg)
</span></span><span style=display:flex><span>    (let* ((from (<span style=color:#a6e22e>car</span> (<span style=color:#a6e22e>plist-get</span> msg :from)))
</span></span><span style=display:flex><span>           (name (<span style=color:#a6e22e>plist-get</span> from :name)))
</span></span><span style=display:flex><span>      (if (or (<span style=color:#a6e22e>null</span> name) (<span style=color:#a6e22e>eq</span> name <span style=color:#e6db74>&#34;&#34;</span>))
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>plist-get</span> from :email)
</span></span><span style=display:flex><span>        name)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +mu4e-alert-grouped-mail-notif-formatter (mail-group _all-mails)
</span></span><span style=display:flex><span>    (when +mu4e-alert-bell-cmd
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>start-process</span> <span style=color:#e6db74>&#34;mu4e-alert-bell&#34;</span> <span style=color:#66d9ef>nil</span> (<span style=color:#a6e22e>car</span> +mu4e-alert-bell-cmd) (<span style=color:#a6e22e>cdr</span> +mu4e-alert-bell-cmd)))
</span></span><span style=display:flex><span>    (let* ((filtered-mails (+filter
</span></span><span style=display:flex><span>                            (lambda (msg)
</span></span><span style=display:flex><span>                              (not (string-match-p <span style=color:#e6db74>&#34;\\(junk\\|spam\\|trash\\|deleted\\)&#34;</span>
</span></span><span style=display:flex><span>                                                   (<span style=color:#a6e22e>downcase</span> (<span style=color:#a6e22e>plist-get</span> msg :maildir)))))
</span></span><span style=display:flex><span>                            mail-group))
</span></span><span style=display:flex><span>           (mail-count (<span style=color:#a6e22e>length</span> filtered-mails)))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>list</span>
</span></span><span style=display:flex><span>       :title (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;You have %d unread email%s&#34;</span>
</span></span><span style=display:flex><span>                      mail-count (if (<span style=color:#a6e22e>&gt;</span> mail-count <span style=color:#ae81ff>1</span>) <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#e6db74>&#34;&#34;</span>))
</span></span><span style=display:flex><span>       :body (<span style=color:#a6e22e>concat</span>
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;• &#34;</span>
</span></span><span style=display:flex><span>              (+str-join
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#34;\n• &#34;</span>
</span></span><span style=display:flex><span>               (<span style=color:#a6e22e>mapcar</span>
</span></span><span style=display:flex><span>                (lambda (msg)
</span></span><span style=display:flex><span>                  (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;&lt;b&gt;%s&lt;/b&gt;: %s&#34;</span>
</span></span><span style=display:flex><span>                          (+mu4e-alert-helper-name-or-email msg)
</span></span><span style=display:flex><span>                          (<span style=color:#a6e22e>plist-get</span> msg :subject)))
</span></span><span style=display:flex><span>                filtered-mails))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; I use auto-hiding task manager, setting window</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; urgency shows the entier task bar (in KDE), which I find annoying.</span>
</span></span><span style=display:flex><span>  (setq mu4e-alert-set-window-urgency <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        mu4e-alert-grouped-mail-notification-formatter <span style=color:#a6e22e>#&#39;</span>+mu4e-alert-grouped-mail-notif-formatter)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Org-Msg stuff</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; org-msg-[signature|greeting-fmt] are separately set for each account</span>
</span></span><span style=display:flex><span>  (setq mail-user-agent <span style=color:#e6db74>&#39;mu4e-user-agent</span>) <span style=color:#75715e>;; Needed by OrgMsg</span>
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;org-msg</span>)
</span></span><span style=display:flex><span>  (setq org-msg-convert-citation <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-msg-default-alternatives
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>((new           <span style=color:#f92672>.</span> (utf-8 html))
</span></span><span style=display:flex><span>          (reply-to-html <span style=color:#f92672>.</span> (utf-8 html))
</span></span><span style=display:flex><span>          (reply-to-text <span style=color:#f92672>.</span> (utf-8 html))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :map org-msg-edit-mode-map
</span></span><span style=display:flex><span>        :after org-msg
</span></span><span style=display:flex><span>        :n <span style=color:#e6db74>&#34;G&#34;</span> <span style=color:#a6e22e>#&#39;</span>org-msg-goto-body)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :localleader
</span></span><span style=display:flex><span>        :map (mu4e-headers-mode-map mu4e-view-mode-map)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Open URL in Brave&#34;</span>   <span style=color:#e6db74>&#34;b&#34;</span> <span style=color:#a6e22e>#&#39;</span>browse-url-chrome <span style=color:#75715e>;; Brave</span>
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Open URL in Firefox&#34;</span> <span style=color:#e6db74>&#34;f&#34;</span> <span style=color:#a6e22e>#&#39;</span>browse-url-firefox)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; I like to always BCC myself</span>
</span></span><span style=display:flex><span>  (defun +bbc-me ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Add my email to BCC.&#34;</span>
</span></span><span style=display:flex><span>    (save-excursion (message-add-header (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;Bcc: %s\n&#34;</span> +my-bcc-trash))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;mu4e-compose-mode-hook</span> <span style=color:#e6db74>&#39;+bbc-me</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Load my accounts</span>
</span></span><span style=display:flex><span>  (load! <span style=color:#e6db74>&#34;lisp/private/+mu4e-accounts.el&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; iCalendar / Org</span>
</span></span><span style=display:flex><span>  (mu4e-icalendar-setup)
</span></span><span style=display:flex><span>  (setq mu4e-icalendar-trash-after-reply <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        mu4e-icalendar-diary-file <span style=color:#e6db74>&#34;~/Dropbox/Org/diary-invitations.org&#34;</span>
</span></span><span style=display:flex><span>        gnus-icalendar-org-capture-file <span style=color:#e6db74>&#34;~/Dropbox/Org/notes.org&#34;</span>
</span></span><span style=display:flex><span>        gnus-icalendar-org-capture-headline <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;Calendar&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; To enable optional iCalendar-&gt;Org sync functionality</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; NOTE: both the capture file and the headline(s) inside must already exist</span>
</span></span><span style=display:flex><span>  (gnus-icalendar-org-setup))
</span></span></code></pre></div><p>The <code>lisp/private/+mu4e-accounts.el</code> file includes Doom&rsquo;s mu4e multi-account
configuration as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(set-email-account!
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;Work&#34;</span> <span style=color:#75715e>;; Account label</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>;; Mu4e folders</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&#39;</span>((mu4e-sent-folder             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/work-dir/Sent&#34;</span>)
</span></span><span style=display:flex><span>   (mu4e-drafts-folder           <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/work-dir/Drafts&#34;</span>)
</span></span><span style=display:flex><span>   (mu4e-trash-folder            <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/work-dir/Trash&#34;</span>)
</span></span><span style=display:flex><span>   (mu4e-refile-folder           <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/work-dir/Archive&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>;; Org-msg template (signature and greeting)</span>
</span></span><span style=display:flex><span>   (org-msg-greeting-fmt         <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;Hello%s,&#34;</span>)
</span></span><span style=display:flex><span>   (org-msg-signature            <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Regards,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#+begin_signature
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>*Abdelhak BOUGOUFFA* \\\\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/PhD. Candidate in Robotics | R&amp;D Engineer/ \\\\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/Paris-Saclay University - SATIE/MOSS | ez-Wheel/ \\\\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#+end_signature&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>;; &#39;smtpmail&#39; options, no need for these when using &#39;msmtp&#39;</span>
</span></span><span style=display:flex><span>   (smtpmail-smtp-user           <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;username@server.com&#34;</span>)
</span></span><span style=display:flex><span>   (smtpmail-smtp-server         <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;smtps.server.com&#34;</span>)
</span></span><span style=display:flex><span>   (smtpmail-stream-type         <span style=color:#f92672>.</span> ssl)
</span></span><span style=display:flex><span>   (smtpmail-smtp-service        <span style=color:#f92672>.</span> <span style=color:#ae81ff>465</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>;; By default, `smtpmail&#39; will try to send mails without authentication, and if rejected,</span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>;; it tries to send credentials. This behavior broke my configuration. So I set this</span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>;; variable to tell &#39;smtpmail&#39; to require authentication for our server (using a regex).</span>
</span></span><span style=display:flex><span>   (smtpmail-servers-requiring-authorization <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;smtps\\.server\\.com&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>t</span>) <span style=color:#75715e>;; Use as default/fallback account</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Set another account</span>
</span></span><span style=display:flex><span>(set-email-account!
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;Gmail&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&#39;</span>((mu4e-sent-folder             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/gmail-dir/Sent&#34;</span>)
</span></span><span style=display:flex><span>   (mu4e-drafts-folder           <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/gmail-dir/Drafts&#34;</span>)
</span></span><span style=display:flex><span>   (mu4e-trash-folder            <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/gmail-dir/Trash&#34;</span>)
</span></span><span style=display:flex><span>   (mu4e-refile-folder           <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/gmail-dir/Archive&#34;</span>)
</span></span><span style=display:flex><span>   (org-msg-greeting-fmt         <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;Hello%s,&#34;</span>)
</span></span><span style=display:flex><span>   (org-msg-signature            <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;-- SIGNATURE&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>;; No need for these when using &#39;msmtp&#39;</span>
</span></span><span style=display:flex><span>   (smtpmail-smtp-user           <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;username@gmail.com&#34;</span>)
</span></span><span style=display:flex><span>   (smtpmail-smtp-server         <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;smtp.googlemail.com&#34;</span>)
</span></span><span style=display:flex><span>   (smtpmail-stream-type         <span style=color:#f92672>.</span> starttls)
</span></span><span style=display:flex><span>   (smtpmail-smtp-service        <span style=color:#f92672>.</span> <span style=color:#ae81ff>587</span>)
</span></span><span style=display:flex><span>   <span style=color:#f92672>...</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Tell Doom&#39;s mu4e module to override some commands to fix issues on Gmail accounts</span>
</span></span><span style=display:flex><span>(setq +mu4e-gmail-accounts <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;username@gmail.com&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;/gmail-dir&#34;</span>)))
</span></span></code></pre></div><h4 id=dashboard>Dashboard</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! mu4e
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Fix icons</span>
</span></span><span style=display:flex><span>  (defun +mu4e-initialise-icons ()
</span></span><span style=display:flex><span>    (setq mu4e-use-fancy-chars <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          mu4e-headers-draft-mark      (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;D&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;edit&#34;</span>           :set <span style=color:#e6db74>&#34;material&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-flagged-mark    (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;F&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;flag&#34;</span>           :set <span style=color:#e6db74>&#34;material&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-new-mark        (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;N&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;file_download&#34;</span>  :set <span style=color:#e6db74>&#34;material&#34;</span> :color <span style=color:#e6db74>&#34;dred&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-passed-mark     (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;P&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;forward&#34;</span>        :set <span style=color:#e6db74>&#34;material&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-replied-mark    (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;R&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;reply&#34;</span>          :set <span style=color:#e6db74>&#34;material&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-seen-mark       (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;S&#34;</span> <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>          mu4e-headers-trashed-mark    (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;T&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;delete&#34;</span>         :set <span style=color:#e6db74>&#34;material&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-attach-mark     (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;a&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;attach_file&#34;</span>    :set <span style=color:#e6db74>&#34;material&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-encrypted-mark  (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;x&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;lock&#34;</span>           :set <span style=color:#e6db74>&#34;material&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-signed-mark     (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;s&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;verified_user&#34;</span>  :set <span style=color:#e6db74>&#34;material&#34;</span> :color <span style=color:#e6db74>&#34;dpurple&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-unread-mark     (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;u&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;remove_red_eye&#34;</span> :set <span style=color:#e6db74>&#34;material&#34;</span> :color <span style=color:#e6db74>&#34;dred&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-list-mark       (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;l&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;list&#34;</span>           :set <span style=color:#e6db74>&#34;material&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-personal-mark   (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;p&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;person&#34;</span>         :set <span style=color:#e6db74>&#34;material&#34;</span>))
</span></span><span style=display:flex><span>          mu4e-headers-calendar-mark   (<span style=color:#a6e22e>cons</span> <span style=color:#e6db74>&#34;c&#34;</span> (+mu4e-normalised-icon <span style=color:#e6db74>&#34;date_range&#34;</span>     :set <span style=color:#e6db74>&#34;material&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (+mu4e-initialise-icons))
</span></span></code></pre></div><h4 id=save-all-attachements>Save all attachements</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! mu4e
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; From https://github.com/sje30/emacs/blob/d7e21b94c79a5b6f244f33faff514036226e183c/mu4e-view-save-all-attachments.el</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +cleanse-subject (sub)
</span></span><span style=display:flex><span>    (replace-regexp-in-string <span style=color:#e6db74>&#34;[^A-Z0-9]+&#34;</span> <span style=color:#e6db74>&#34;-&#34;</span> (<span style=color:#a6e22e>downcase</span> sub)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +mu4e-view-save-all-attachments (<span style=color:#66d9ef>&amp;optional</span> arg)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Save all MIME parts from current mu4e gnus view buffer.&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Copied from mu4e-view-save-attachments</span>
</span></span><span style=display:flex><span>    (interactive <span style=color:#e6db74>&#34;P&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>cl-assert</span> (and (<span style=color:#a6e22e>eq</span> major-mode <span style=color:#e6db74>&#39;mu4e-view-mode</span>)
</span></span><span style=display:flex><span>                    (derived-mode-p <span style=color:#e6db74>&#39;gnus-article-mode</span>)))
</span></span><span style=display:flex><span>    (let* ((msg (mu4e-message-at-point))
</span></span><span style=display:flex><span>           (id (+cleanse-subject (mu4e-message-field msg :subject)))
</span></span><span style=display:flex><span>           (attachdir (<span style=color:#a6e22e>expand-file-name</span> id mu4e-attachment-dir))
</span></span><span style=display:flex><span>           (parts (mu4e~view-gather-mime-parts))
</span></span><span style=display:flex><span>           (handles <span style=color:#f92672>&#39;</span>())
</span></span><span style=display:flex><span>           (files <span style=color:#f92672>&#39;</span>())
</span></span><span style=display:flex><span>           dir)
</span></span><span style=display:flex><span>      (mkdir attachdir <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>      (dolist (part parts)
</span></span><span style=display:flex><span>        (let ((fname (or (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> <span style=color:#e6db74>&#39;filename</span> (<span style=color:#a6e22e>assoc</span> <span style=color:#e6db74>&#34;attachment&#34;</span> (<span style=color:#a6e22e>cdr</span> part))))
</span></span><span style=display:flex><span>                         (seq-find <span style=color:#a6e22e>#&#39;stringp</span>
</span></span><span style=display:flex><span>                                   (<span style=color:#a6e22e>mapcar</span> (lambda (item) (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> <span style=color:#e6db74>&#39;name</span> item)))
</span></span><span style=display:flex><span>                                           (seq-filter <span style=color:#e6db74>&#39;listp</span> (<span style=color:#a6e22e>cdr</span> part)))))))
</span></span><span style=display:flex><span>          (when fname
</span></span><span style=display:flex><span>            (push <span style=color:#f92672>`</span>(<span style=color:#f92672>,</span>fname <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>(<span style=color:#a6e22e>cdr</span> part)) handles)
</span></span><span style=display:flex><span>            (push fname files))))
</span></span><span style=display:flex><span>      (if files
</span></span><span style=display:flex><span>          (progn
</span></span><span style=display:flex><span>            (setq dir
</span></span><span style=display:flex><span>                  (if arg (read-directory-name <span style=color:#e6db74>&#34;Save to directory: &#34;</span>)
</span></span><span style=display:flex><span>                    attachdir))
</span></span><span style=display:flex><span>            (cl-loop for (f <span style=color:#f92672>.</span> h) in handles
</span></span><span style=display:flex><span>                     when (<span style=color:#a6e22e>member</span> f files)
</span></span><span style=display:flex><span>                     do (mm-save-part-to-file h
</span></span><span style=display:flex><span>                                              (+file-name-incremental
</span></span><span style=display:flex><span>                                               (<span style=color:#a6e22e>expand-file-name</span> f dir)))))
</span></span><span style=display:flex><span>        (mu4e-message <span style=color:#e6db74>&#34;No attached files found&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :map mu4e-view-mode-map
</span></span><span style=display:flex><span>     :ne <span style=color:#e6db74>&#34;P&#34;</span> <span style=color:#a6e22e>#&#39;</span>+mu4e-view-save-all-attachments))
</span></span></code></pre></div><h3 id=irc>IRC</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; TODO: Not tangled</span>
</span></span><span style=display:flex><span>(defun +fetch-my-password (<span style=color:#66d9ef>&amp;rest</span> params)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;auth-source</span>)
</span></span><span style=display:flex><span>  (let ((match (<span style=color:#a6e22e>car</span> (<span style=color:#a6e22e>apply</span> <span style=color:#a6e22e>#&#39;</span>auth-source-search params))))
</span></span><span style=display:flex><span>    (if match
</span></span><span style=display:flex><span>        (let ((secret (<span style=color:#a6e22e>plist-get</span> match :secret)))
</span></span><span style=display:flex><span>          (if (<span style=color:#a6e22e>functionp</span> secret)
</span></span><span style=display:flex><span>              (<span style=color:#a6e22e>funcall</span> secret)
</span></span><span style=display:flex><span>            secret))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>error</span> <span style=color:#e6db74>&#34;Password not found for %S&#34;</span> params))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +my-nickserv-password (server)
</span></span><span style=display:flex><span>  (+fetch-my-password :user <span style=color:#e6db74>&#34;abougouffa&#34;</span> :host <span style=color:#e6db74>&#34;irc.libera.chat&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(set-irc-server! <span style=color:#e6db74>&#34;irc.libera.chat&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(:tls <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>    :port <span style=color:#ae81ff>6697</span>
</span></span><span style=display:flex><span>    :nick <span style=color:#e6db74>&#34;abougouffa&#34;</span>
</span></span><span style=display:flex><span>    :sasl-password +my-nickserver-password
</span></span><span style=display:flex><span>    :channels (<span style=color:#e6db74>&#34;#emacs&#34;</span>)))
</span></span></code></pre></div><h3 id=multimedia>Multimedia</h3><p>I like to use an MPD powered EMMS, so when I restart Emacs I do not lose my
music.</p><h4 id=mpd-and-mpc>MPD and MPC</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Not sure if it is required!</span>
</span></span><span style=display:flex><span>(after! mpc
</span></span><span style=display:flex><span>  (setq mpc-host <span style=color:#e6db74>&#34;localhost:6600&#34;</span>))
</span></span></code></pre></div><p>I like to launch the music daemon <code>mpd</code> using Systemd, let&rsquo;s define some commands
in Emacs to start/kill the server:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +mpd-daemon-start ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Start MPD, connects to it and syncs the metadata cache.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (let ((mpd-daemon-running-p (+mpd-daemon-running-p)))
</span></span><span style=display:flex><span>    (unless mpd-daemon-running-p
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; Start the daemon if it is not already running.</span>
</span></span><span style=display:flex><span>      (setq mpd-daemon-running-p (+systemd-start <span style=color:#e6db74>&#34;mpd&#34;</span>)))
</span></span><span style=display:flex><span>    (cond ((+mpd-daemon-running-p)
</span></span><span style=display:flex><span>           (+mpd-mpc-update)
</span></span><span style=display:flex><span>           (emms-player-mpd-connect)
</span></span><span style=display:flex><span>           (emms-cache-set-from-mpd-all)
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Connected to MPD!&#34;</span>))
</span></span><span style=display:flex><span>          (<span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>warn</span> <span style=color:#e6db74>&#34;An error occured when trying to start Systemd mpd.service.&#34;</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +mpd-daemon-stop ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Stops playback and kill the MPD daemon.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (emms-stop)
</span></span><span style=display:flex><span>  (+systemd-stop <span style=color:#e6db74>&#34;mpd&#34;</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;MPD stopped!&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +mpd-daemon-running-p ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Check if the MPD service is running.&#34;</span>
</span></span><span style=display:flex><span>  (+systemd-running-p <span style=color:#e6db74>&#34;mpd&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +mpd-mpc-update ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Updates the MPD database synchronously.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (if (zerop (<span style=color:#a6e22e>call-process</span> <span style=color:#e6db74>&#34;mpc&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#34;update&#34;</span>))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;MPD database updated!&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>warn</span> <span style=color:#e6db74>&#34;An error occured when trying to update MPD database.&#34;</span>)))
</span></span></code></pre></div><h4 id=emms>EMMS</h4><p>Now, we configure EMMS to use MPD if it is present; otherwise, it uses whatever
default backend EMMS is using.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! emms
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; EMMS basic configuration</span>
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;emms-setup</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (when MPD-P
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;emms-player-mpd</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (emms-all)
</span></span><span style=display:flex><span>  (emms-default-players)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq emms-source-file-default-directory <span style=color:#e6db74>&#34;~/Music/&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; Load cover images</span>
</span></span><span style=display:flex><span>        emms-browser-covers <span style=color:#e6db74>&#39;emms-browser-cache-thumbnail-async</span>
</span></span><span style=display:flex><span>        emms-seek-seconds <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (if MPD-P
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; If using MPD as backend</span>
</span></span><span style=display:flex><span>      (setq emms-player-list <span style=color:#f92672>&#39;</span>(emms-player-mpd)
</span></span><span style=display:flex><span>            emms-info-functions <span style=color:#f92672>&#39;</span>(emms-info-mpd)
</span></span><span style=display:flex><span>            emms-player-mpd-server-name <span style=color:#e6db74>&#34;localhost&#34;</span>
</span></span><span style=display:flex><span>            emms-player-mpd-server-port <span style=color:#e6db74>&#34;6600&#34;</span>
</span></span><span style=display:flex><span>            emms-player-mpd-music-directory (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;~/Music&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Use whatever backend EMMS is using by default (VLC in my machine)</span>
</span></span><span style=display:flex><span>    (setq emms-info-functions <span style=color:#f92672>&#39;</span>(emms-info-tinytag))) <span style=color:#75715e>;; use Tinytag, or &#39;(emms-info-exiftool) for Exiftool</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Keyboard shortcuts</span>
</span></span><span style=display:flex><span>  (global-set-key (kbd <span style=color:#e6db74>&#34;&lt;XF86AudioPrev&gt;&#34;</span>)  <span style=color:#e6db74>&#39;emms-previous</span>)
</span></span><span style=display:flex><span>  (global-set-key (kbd <span style=color:#e6db74>&#34;&lt;XF86AudioNext&gt;&#34;</span>)  <span style=color:#e6db74>&#39;emms-next</span>)
</span></span><span style=display:flex><span>  (global-set-key (kbd <span style=color:#e6db74>&#34;&lt;XF86AudioPlay&gt;&#34;</span>)  <span style=color:#e6db74>&#39;emms-pause</span>)
</span></span><span style=display:flex><span>  (global-set-key (kbd <span style=color:#e6db74>&#34;&lt;XF86AudioPause&gt;&#34;</span>) <span style=color:#e6db74>&#39;emms-pause</span>)
</span></span><span style=display:flex><span>  (global-set-key (kbd <span style=color:#e6db74>&#34;&lt;XF86AudioStop&gt;&#34;</span>)  <span style=color:#e6db74>&#39;emms-stop</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Try to start MPD or connect to it if it is already started.</span>
</span></span><span style=display:flex><span>  (when MPD-P
</span></span><span style=display:flex><span>    (emms-player-set emms-player-mpd <span style=color:#e6db74>&#39;regex</span>
</span></span><span style=display:flex><span>                     (emms-player-simple-regexp
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#34;m3u&#34;</span> <span style=color:#e6db74>&#34;ogg&#34;</span> <span style=color:#e6db74>&#34;flac&#34;</span> <span style=color:#e6db74>&#34;mp3&#34;</span> <span style=color:#e6db74>&#34;wav&#34;</span> <span style=color:#e6db74>&#34;mod&#34;</span> <span style=color:#e6db74>&#34;au&#34;</span> <span style=color:#e6db74>&#34;aiff&#34;</span>))
</span></span><span style=display:flex><span>    (add-hook <span style=color:#e6db74>&#39;emms-playlist-cleared-hook</span> <span style=color:#e6db74>&#39;emms-player-mpd-clear</span>)
</span></span><span style=display:flex><span>    (+mpd-daemon-start))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Activate EMMS in mode line</span>
</span></span><span style=display:flex><span>  (emms-mode-line <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; More descriptive track lines in playlists</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; From: https://www.emacswiki.org/emacs/EMMS#h5o-15</span>
</span></span><span style=display:flex><span>  (defun +better-emms-track-description (track)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Return a somewhat nice track description.&#34;</span>
</span></span><span style=display:flex><span>    (let ((artist (emms-track-get track <span style=color:#e6db74>&#39;info-artist</span>))
</span></span><span style=display:flex><span>          (album (emms-track-get track <span style=color:#e6db74>&#39;info-album</span>))
</span></span><span style=display:flex><span>          (tracknumber (emms-track-get track <span style=color:#e6db74>&#39;info-tracknumber</span>))
</span></span><span style=display:flex><span>          (title (emms-track-get track <span style=color:#e6db74>&#39;info-title</span>)))
</span></span><span style=display:flex><span>      (cond
</span></span><span style=display:flex><span>       ((or artist title)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>concat</span>
</span></span><span style=display:flex><span>         (if (<span style=color:#a6e22e>&gt;</span> (<span style=color:#a6e22e>length</span> artist) <span style=color:#ae81ff>0</span>) artist <span style=color:#e6db74>&#34;Unknown artist&#34;</span>) <span style=color:#e6db74>&#34;: &#34;</span>
</span></span><span style=display:flex><span>         (if (<span style=color:#a6e22e>&gt;</span> (<span style=color:#a6e22e>length</span> album) <span style=color:#ae81ff>0</span>) album <span style=color:#e6db74>&#34;Unknown album&#34;</span>) <span style=color:#e6db74>&#34; - &#34;</span>
</span></span><span style=display:flex><span>         (if (<span style=color:#a6e22e>&gt;</span> (<span style=color:#a6e22e>length</span> tracknumber) <span style=color:#ae81ff>0</span>) (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;%02d. &#34;</span> (<span style=color:#a6e22e>string-to-number</span> tracknumber)) <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>         (if (<span style=color:#a6e22e>&gt;</span> (<span style=color:#a6e22e>length</span> title) <span style=color:#ae81ff>0</span>) title <span style=color:#e6db74>&#34;Unknown title&#34;</span>)))
</span></span><span style=display:flex><span>       (<span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        (emms-track-simple-description track)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq emms-track-description-function <span style=color:#e6db74>&#39;+better-emms-track-description</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Manage notifications, inspired by:</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; https://www.emacswiki.org/emacs/EMMS#h5o-9</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; https://www.emacswiki.org/emacs/EMMS#h5o-11</span>
</span></span><span style=display:flex><span>  (cond
</span></span><span style=display:flex><span>   <span style=color:#75715e>;; Choose D-Bus to disseminate messages, if available.</span>
</span></span><span style=display:flex><span>   ((and (require <span style=color:#e6db74>&#39;dbus</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>) (dbus-ping :session <span style=color:#e6db74>&#34;org.freedesktop.Notifications&#34;</span>))
</span></span><span style=display:flex><span>    (setq +emms-notifier-function <span style=color:#e6db74>&#39;+notify-via-freedesktop-notifications</span>)
</span></span><span style=display:flex><span>    (require <span style=color:#e6db74>&#39;notifications</span>))
</span></span><span style=display:flex><span>   <span style=color:#75715e>;; Try to make use of KNotify if D-Bus isn&#39;t present.</span>
</span></span><span style=display:flex><span>   ((and <span style=color:#a6e22e>window-system</span> (executable-find <span style=color:#e6db74>&#34;kdialog&#34;</span>))
</span></span><span style=display:flex><span>    (setq +emms-notifier-function <span style=color:#e6db74>&#39;+notify-via-kdialog</span>))
</span></span><span style=display:flex><span>   <span style=color:#75715e>;; Use the message system otherwise</span>
</span></span><span style=display:flex><span>   (<span style=color:#66d9ef>t</span> (setq +emms-notifier-function <span style=color:#e6db74>&#39;+notify-via-messages</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq +emms-notification-icon <span style=color:#e6db74>&#34;/usr/share/icons/Papirus/64x64/apps/enjoy-music-player.svg&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +notify-via-kdialog (title msg icon)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Send notification with TITLE, MSG, and ICON via </span><span style=color:#e6db74>`KDialog&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>call-process</span> <span style=color:#e6db74>&#34;kdialog&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                  <span style=color:#e6db74>&#34;--title&#34;</span> title
</span></span><span style=display:flex><span>                  <span style=color:#e6db74>&#34;--passivepopup&#34;</span> msg <span style=color:#e6db74>&#34;5&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#e6db74>&#34;--icon&#34;</span> icon))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +notify-via-freedesktop-notifications (title msg icon)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Send notification with TITLE, MSG, and ICON via </span><span style=color:#e6db74>`D-Bus&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>    (notifications-notify
</span></span><span style=display:flex><span>     :title title
</span></span><span style=display:flex><span>     :body msg
</span></span><span style=display:flex><span>     :app-icon icon
</span></span><span style=display:flex><span>     :urgency <span style=color:#e6db74>&#39;low</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +notify-via-messages (title msg icon)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Send notification with TITLE, MSG to message. ICON is ignored.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;%s %s&#34;</span> title msg))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;emms-player-started-hook</span>
</span></span><span style=display:flex><span>            (lambda () (<span style=color:#a6e22e>funcall</span> +emms-notifier-function
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;EMMS is now playing:&#34;</span>
</span></span><span style=display:flex><span>                                (emms-track-description (emms-playlist-current-selected-track))
</span></span><span style=display:flex><span>                                +emms-notification-icon))))
</span></span></code></pre></div><h4 id=empv>EMPV</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! empv
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;isamert/empv.el&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! empv
</span></span><span style=display:flex><span>  :when MPV-P
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (map! :leader :prefix (<span style=color:#e6db74>&#34;l m&#34;</span>)
</span></span><span style=display:flex><span>        (:prefix (<span style=color:#e6db74>&#34;v&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;empv&#34;</span>)
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Play&#34;</span>                  <span style=color:#e6db74>&#34;p&#34;</span> <span style=color:#a6e22e>#&#39;</span>empv-play
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Seach Youtube&#34;</span>         <span style=color:#e6db74>&#34;y&#34;</span> <span style=color:#a6e22e>#&#39;</span>consult-empv-youtube
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Play radio&#34;</span>            <span style=color:#e6db74>&#34;r&#34;</span> <span style=color:#a6e22e>#&#39;</span>empv-play-radio
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Save current playlist&#34;</span> <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#a6e22e>#&#39;</span>+empv-save-playtlist-to-file))
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; See https://docs.invidious.io/instances/</span>
</span></span><span style=display:flex><span>  (setq empv-invidious-instance <span style=color:#e6db74>&#34;https://invidious.projectsegfau.lt/api/v1&#34;</span>
</span></span><span style=display:flex><span>        empv-audio-dir <span style=color:#e6db74>&#34;~/Music&#34;</span>
</span></span><span style=display:flex><span>        empv-video-dir <span style=color:#e6db74>&#34;~/Videos&#34;</span>
</span></span><span style=display:flex><span>        empv-max-directory-search-depth <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>        empv-radio-log-file (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;logged-radio-songs.org&#34;</span> org-directory)
</span></span><span style=display:flex><span>        empv-audio-file-extensions <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;webm&#34;</span> <span style=color:#e6db74>&#34;mp3&#34;</span> <span style=color:#e6db74>&#34;ogg&#34;</span> <span style=color:#e6db74>&#34;wav&#34;</span> <span style=color:#e6db74>&#34;m4a&#34;</span> <span style=color:#e6db74>&#34;flac&#34;</span> <span style=color:#e6db74>&#34;aac&#34;</span> <span style=color:#e6db74>&#34;opus&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; Links from https://www.radio-browser.info</span>
</span></span><span style=display:flex><span>        empv-radio-channels
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;El-Bahdja FM&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://webradio.tda.dz:8001/ElBahdja_64K.mp3&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;El-Chaabia&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;https://radio-dzair.net/proxy/chaabia?mp=/stream&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;Quran Radio&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://stream.radiojar.com/0tpy1h0kxtzuv&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;Algeria International&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;https://webradio.tda.dz/Internationale_64K.mp3&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;JOW Radio&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;https://str0.creacast.com/jowradio&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;Europe1&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://ais-live.cloud-services.paris:8000/europe1.mp3&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;France Iter&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://direct.franceinter.fr/live/franceinter-hifi.aac&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;France Info&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://direct.franceinfo.fr/live/franceinfo-midfi.mp3&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;France Culture&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://icecast.radiofrance.fr/franceculture-hifi.aac&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;France Musique&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://icecast.radiofrance.fr/francemusique-hifi.aac&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;FIP&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://icecast.radiofrance.fr/fip-hifi.aac&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;Beur FM&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://broadcast.infomaniak.ch/beurfm-high.aac&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;Skyrock&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;http://icecast.skyrock.net/s/natio_mp3_128k&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (empv-playlist-loop-on)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Hacky palylist management (only supports saving playlist,</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; loading a playlist can be achieved using `empv-play-file&#39;)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +empv--dl-playlist (playlist <span style=color:#66d9ef>&amp;optional</span> dist)
</span></span><span style=display:flex><span>    (let ((default-directory
</span></span><span style=display:flex><span>            (or dist
</span></span><span style=display:flex><span>                (let ((d (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;empv-downloads&#34;</span> empv-audio-dir)))
</span></span><span style=display:flex><span>                  (unless (<span style=color:#a6e22e>file-directory-p</span> d) (mkdir d <span style=color:#66d9ef>t</span>)) d)))
</span></span><span style=display:flex><span>          (vids (+filter
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#39;identity</span> <span style=color:#75715e>;; Filter nils</span>
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>mapcar</span>
</span></span><span style=display:flex><span>                  (lambda (item)
</span></span><span style=display:flex><span>                    (when-let
</span></span><span style=display:flex><span>                        ((vid (when (<span style=color:#a6e22e>string-match</span>
</span></span><span style=display:flex><span>                                     (rx (seq <span style=color:#e6db74>&#34;watch?v=&#34;</span> (group-n <span style=color:#ae81ff>1</span> (one-or-more (or alnum <span style=color:#e6db74>&#34;_&#34;</span> <span style=color:#e6db74>&#34;-&#34;</span>)))))
</span></span><span style=display:flex><span>                                     item)
</span></span><span style=display:flex><span>                                (match-string <span style=color:#ae81ff>1</span> item))))
</span></span><span style=display:flex><span>                      vid))
</span></span><span style=display:flex><span>                  playlist)))
</span></span><span style=display:flex><span>          (proc-name <span style=color:#e6db74>&#34;empv-yt-dlp&#34;</span>))
</span></span><span style=display:flex><span>      (unless (zerop (<span style=color:#a6e22e>length</span> vids))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Downloading %d songs to %s&#34;</span> (<span style=color:#a6e22e>length</span> vids) default-directory)
</span></span><span style=display:flex><span>        (when (<span style=color:#a6e22e>get-process</span> proc-name)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>kill-process</span> proc-name))
</span></span><span style=display:flex><span>        (make-process :name proc-name
</span></span><span style=display:flex><span>                      :buffer (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;*%s*&#34;</span> proc-name)
</span></span><span style=display:flex><span>                      :command (<span style=color:#a6e22e>append</span>
</span></span><span style=display:flex><span>                                (<span style=color:#a6e22e>list</span>
</span></span><span style=display:flex><span>                                 (executable-find <span style=color:#e6db74>&#34;yt-dlp&#34;</span>)
</span></span><span style=display:flex><span>                                 <span style=color:#e6db74>&#34;--no-abort-on-error&#34;</span>
</span></span><span style=display:flex><span>                                 <span style=color:#e6db74>&#34;--no-colors&#34;</span>
</span></span><span style=display:flex><span>                                 <span style=color:#e6db74>&#34;--extract-audio&#34;</span>
</span></span><span style=display:flex><span>                                 <span style=color:#e6db74>&#34;--no-progress&#34;</span>
</span></span><span style=display:flex><span>                                 <span style=color:#e6db74>&#34;-f&#34;</span> <span style=color:#e6db74>&#34;bestaudio&#34;</span>)
</span></span><span style=display:flex><span>                                vids)
</span></span><span style=display:flex><span>                      :sentinel (lambda (prc event)
</span></span><span style=display:flex><span>                                  (when (string= event <span style=color:#e6db74>&#34;finished\n&#34;</span>)
</span></span><span style=display:flex><span>                                    (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Finished downloading playlist files!&#34;</span>)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +empv-download-playtlist-files (<span style=color:#66d9ef>&amp;optional</span> path)
</span></span><span style=display:flex><span>    (interactive <span style=color:#e6db74>&#34;DSave download playlist files to: &#34;</span>)
</span></span><span style=display:flex><span>    (empv--playlist-apply <span style=color:#a6e22e>#&#39;</span>+empv--dl-playlist path)))
</span></span></code></pre></div><h4 id=keybindings>Keybindings</h4><p>Lastly, let&rsquo;s define the keybindings for these commands, under <code>&lt;leader> l m</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>      (:when (modulep! :app emms)
</span></span><span style=display:flex><span>       :prefix (<span style=color:#e6db74>&#34;m&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;media&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Playlist go&#34;</span>                 <span style=color:#e6db74>&#34;g&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-playlist-mode-go
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Add playlist&#34;</span>                <span style=color:#e6db74>&#34;D&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-add-playlist
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Toggle random playlist&#34;</span>      <span style=color:#e6db74>&#34;r&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-toggle-random-playlist
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Add directory&#34;</span>               <span style=color:#e6db74>&#34;d&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-add-directory
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Add file&#34;</span>                    <span style=color:#e6db74>&#34;f&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-add-file
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Smart browse&#34;</span>                <span style=color:#e6db74>&#34;b&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-smart-browse
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Play/Pause&#34;</span>                  <span style=color:#e6db74>&#34;p&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-pause
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Start&#34;</span>                       <span style=color:#e6db74>&#34;S&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-start
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Stop&#34;</span>                        <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-stop))
</span></span></code></pre></div><p>Then we add MPD related keybindings if MPD is used.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader :prefix (<span style=color:#e6db74>&#34;l m&#34;</span>)
</span></span><span style=display:flex><span>      (:when (and (modulep! :app emms) MPD-P)
</span></span><span style=display:flex><span>       :prefix (<span style=color:#e6db74>&#34;m&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;mpd/mpc&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Start daemon&#34;</span>              <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#a6e22e>#&#39;</span>+mpd-daemon-start
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Stop daemon&#34;</span>               <span style=color:#e6db74>&#34;k&#34;</span> <span style=color:#a6e22e>#&#39;</span>+mpd-daemon-stop
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;EMMS player (MPD update)&#34;</span>  <span style=color:#e6db74>&#34;R&#34;</span> <span style=color:#a6e22e>#&#39;</span>emms-player-mpd-update-all-reset-cache
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Update database&#34;</span>           <span style=color:#e6db74>&#34;u&#34;</span> <span style=color:#a6e22e>#&#39;</span>+mpd-mpc-update))
</span></span></code></pre></div><h4 id=cycle-song-information-in-mode-line>Cycle song information in mode line</h4><p>I found a useful package named <code>emms-mode-line-cycle</code> which permits to do this;
however, it has not been updated since a while, it uses some obsolete functions
to draw icon in mode line, so I forked it, got rid of the problematic parts, and
added some minor stuff.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! emms-mode-line-cycle
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;abougouffa/emms-mode-line-cycle&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! emms-mode-line-cycle
</span></span><span style=display:flex><span>  :after emms
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq emms-mode-line-cycle-max-width <span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>        emms-mode-line-cycle-additional-space-num <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>        emms-mode-line-cycle-any-width-p <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        emms-mode-line-cycle-velocity <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Some music files do not have metadata, by default, the track title</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; will be the full file path, so, if I detect what seems to be an absolute</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; path, I trim the directory part and get only the file name.</span>
</span></span><span style=display:flex><span>  (setq emms-mode-line-cycle-current-title-function
</span></span><span style=display:flex><span>        (lambda ()
</span></span><span style=display:flex><span>          (let ((name (emms-track-description (emms-playlist-current-selected-track))))
</span></span><span style=display:flex><span>            (if (<span style=color:#a6e22e>file-name-absolute-p</span> name) (file-name-base name) name))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Mode line formatting settings</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; This format complements the &#39;emms-mode-line-format&#39; one.</span>
</span></span><span style=display:flex><span>  (setq emms-mode-line-format <span style=color:#e6db74>&#34; ⟨⏵ %s⟩&#34;</span>  <span style=color:#75715e>;; 𝅘𝅥𝅮 ⏵ ⏸</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; To hide the playing time without stopping the cycling.</span>
</span></span><span style=display:flex><span>        emms-playing-time-display-format <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +emms-mode-line-toggle-format-hook ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Toggle the &#39;emms-mode-line-fotmat&#39; string, when playing or paused.&#34;</span>
</span></span><span style=display:flex><span>    (setq emms-mode-line-format (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34; ⟨&#34;</span> (if emms-player-paused-p <span style=color:#e6db74>&#34;⏸&#34;</span> <span style=color:#e6db74>&#34;⏵&#34;</span>) <span style=color:#e6db74>&#34; %s⟩&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Force a sync to get the right song name over MPD in mode line</span>
</span></span><span style=display:flex><span>    (when MPD-P (emms-player-mpd-sync-from-mpd))
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Trigger a forced update of mode line (useful when pausing)</span>
</span></span><span style=display:flex><span>    (emms-mode-line-alter-mode-line))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; Hook the function to the &#39;emms-player-paused-hook&#39;</span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;emms-player-paused-hook</span> <span style=color:#e6db74>&#39;+emms-mode-line-toggle-format-hook</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (emms-mode-line-cycle <span style=color:#ae81ff>1</span>))
</span></span></code></pre></div><h3 id=maxima>Maxima</h3><p>The Maxima CAS cames bundled with three Emacs modes: <code>maxima</code>, <code>imaxima</code> and
<code>emaxima</code>; installed by default in <code>"/usr/share/emacs/site-lisp/maxima"</code>.</p><h4 id=maxima>Maxima</h4><p>The <a href=https://github.com/emacsmirror/maxima>emacsmirror/maxima</a> seems more up-to-date, and supports completion via
Company, so let&rsquo;s install it from GitHub. Note that, normally, we don&rsquo;t need to
specify a recipe; however, installing it directly seems to not install
<code>company-maxima.el</code> and <code>poly-maxima.el</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! maxima
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;emacsmirror/maxima&#34;</span>
</span></span><span style=display:flex><span>           :files (:defaults
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;keywords&#34;</span>
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;company-maxima.el&#34;</span>
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;poly-maxima.el&#34;</span>)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! maxima
</span></span><span style=display:flex><span>  :when MAXIMA-P
</span></span><span style=display:flex><span>  :commands (maxima-mode maxima-inferior-mode maxima)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;straight</span>) <span style=color:#75715e>;; to use `straight-build-dir&#39; and `straight-base-dir&#39;</span>
</span></span><span style=display:flex><span>  (setq maxima-font-lock-keywords-directory <span style=color:#75715e>;; a workaround to undo the straight workaround!</span>
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>expand-file-name</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;straight/%s/maxima/keywords&#34;</span> straight-build-dir) straight-base-dir))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; The `maxima-hook-function&#39; setup `company-maxima&#39;.</span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;maxima-mode-hook</span> <span style=color:#a6e22e>#&#39;</span>maxima-hook-function)
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;maxima-inferior-mode-hook</span> <span style=color:#a6e22e>#&#39;</span>maxima-hook-function)
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.ma[cx]\\&#39;&#34;</span> <span style=color:#f92672>.</span> maxima-mode)))
</span></span></code></pre></div><h4 id=imaxima>IMaxima</h4><p>For the <code>imaxima</code> (Maxima with image support), the <a href=https://github.com/emacsattic/imaxima>emacsattic/imaxima</a> seems
outdated compared to the <code>imaxima</code> package of the official Maxima distribution, so
let&rsquo;s install <code>imaxima</code> from the source code of Maxima, hosted on Sourceforge
<a href=https://git.code.sf.net/p/maxima/code>git.code.sf.net/p/maxima/code</a>. The package files are stored in the repository&rsquo;s
subdirectory <code>interfaces/emacs/imaxima</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Use the `imaxima&#39; package bundled with the official Maxima distribution.</span>
</span></span><span style=display:flex><span>(package! imaxima
</span></span><span style=display:flex><span>  :recipe (:host <span style=color:#66d9ef>nil</span> <span style=color:#75715e>;; Unsupported host, we will specify the complete repo link</span>
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;https://git.code.sf.net/p/maxima/code&#34;</span>
</span></span><span style=display:flex><span>           :files (<span style=color:#e6db74>&#34;interfaces/emacs/imaxima/*&#34;</span>)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! imaxima
</span></span><span style=display:flex><span>  :when MAXIMA-P
</span></span><span style=display:flex><span>  :commands (imaxima imath-mode)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq imaxima-use-maxima-mode-flag <span style=color:#66d9ef>nil</span> <span style=color:#75715e>;; otherwise, it don&#39;t render equations with LaTeX.</span>
</span></span><span style=display:flex><span>        imaxima-scale-factor <span style=color:#ae81ff>2.0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Hook the `maxima-inferior-mode&#39; to get Company completion.</span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;imaxima-startup-hook</span> <span style=color:#a6e22e>#&#39;</span>maxima-inferior-mode))
</span></span></code></pre></div><h3 id=fricas>FriCAS</h3><p>The FriCAS cames bundled with an Emacs mode, let&rsquo;s load it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! fricas
</span></span><span style=display:flex><span>  :when FRICAS-P
</span></span><span style=display:flex><span>  :load-path <span style=color:#e6db74>&#34;/usr/lib/fricas/emacs&#34;</span>
</span></span><span style=display:flex><span>  :commands (fricas-mode fricas-eval fricas))
</span></span></code></pre></div><h3 id=roam>Roam</h3><p>Org-roam is nice by itself, but there are so <em>extra</em> nice packages which integrate
with it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! websocket
</span></span><span style=display:flex><span>  :after org-roam-ui)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(use-package! org-roam-ui
</span></span><span style=display:flex><span>  :commands org-roam-ui-open
</span></span><span style=display:flex><span>  :config (setq org-roam-ui-sync-theme <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                org-roam-ui-follow <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                org-roam-ui-update-on-save <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                org-roam-ui-open-on-start <span style=color:#66d9ef>t</span>))
</span></span></code></pre></div><h4 id=basic-settings>Basic settings</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-roam
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq org-roam-directory <span style=color:#e6db74>&#34;~/Dropbox/Org/slip-box&#34;</span>
</span></span><span style=display:flex><span>        org-roam-db-location (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;org-roam.db&#34;</span> org-roam-directory)))
</span></span></code></pre></div><p>Let&rsquo;s disable <code>org-roam</code> if the directory doesn&rsquo;t exist.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! org-roam
</span></span><span style=display:flex><span>  :disable <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h4 id=mode-line-file-name>Mode line file name</h4><p>All those numbers! It&rsquo;s messy. Let&rsquo;s adjust this similarly that I have in
the window title</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defadvice! doom-modeline--buffer-file-name-roam-aware-a (orig-fun)
</span></span><span style=display:flex><span>  :around <span style=color:#a6e22e>#&#39;</span>doom-modeline-buffer-file-name <span style=color:#75715e>; takes no args</span>
</span></span><span style=display:flex><span>  (if (s-contains-p org-roam-directory (or <span style=color:#a6e22e>buffer-file-name</span> <span style=color:#e6db74>&#34;&#34;</span>))
</span></span><span style=display:flex><span>      (replace-regexp-in-string
</span></span><span style=display:flex><span>       <span style=color:#e6db74>&#34;\\(?:^\\|.*/\\)\\([0-9]\\{4\\}\\)\\([0-9]\\{2\\}\\)\\([0-9]\\{2\\}\\)[0-9]*-&#34;</span>
</span></span><span style=display:flex><span>       <span style=color:#e6db74>&#34;🢔(\\1-\\2-\\3) &#34;</span>
</span></span><span style=display:flex><span>       (subst-char-in-string <span style=color:#e6db74>?_</span> <span style=color:#e6db74>? </span> <span style=color:#a6e22e>buffer-file-name</span>))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>funcall</span> orig-fun)))
</span></span></code></pre></div><h4 id=org-roam-capture-template>Org Roam Capture template</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org-roam
</span></span><span style=display:flex><span>  (setq org-roam-capture-ref-templates
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;r&#34;</span> <span style=color:#e6db74>&#34;ref&#34;</span> plain <span style=color:#e6db74>&#34;%?&#34;</span>
</span></span><span style=display:flex><span>           :if-new (file+head <span style=color:#e6db74>&#34;web/%&lt;%Y%m%d%H%M%S&gt;-${slug}.org&#34;</span> <span style=color:#e6db74>&#34;#+title: ${title}\n#+created: %U\n\n${body}\n&#34;</span>)
</span></span><span style=display:flex><span>           :unnarrowed <span style=color:#66d9ef>t</span>))))
</span></span></code></pre></div><h4 id=view-notes-in-deft>View notes in Deft</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; From https://org-roam.discourse.group/t/configure-deft-title-stripping-to-hide-org-roam-template-headers/478/10</span>
</span></span><span style=display:flex><span>(use-package! deft
</span></span><span style=display:flex><span>  :after org
</span></span><span style=display:flex><span>  :ensure <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>  :bind
</span></span><span style=display:flex><span>  (<span style=color:#e6db74>&#34;C-c n d&#34;</span> <span style=color:#f92672>.</span> deft)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq deft-directory org-roam-directory
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; deft-recursive t</span>
</span></span><span style=display:flex><span>        deft-use-filter-string-for-filename <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        deft-default-extension <span style=color:#e6db74>&#34;org&#34;</span>)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (defun +deft-parse-title (file contents)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Parse the given FILE and CONTENTS and determine the title.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     If </span><span style=color:#e6db74>`deft-use-filename-as-title&#39;</span><span style=color:#e6db74> is nil, the title is taken to
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     be the first non-empty line of the FILE.  Else the base name of the FILE is
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     used as title.&#34;</span>
</span></span><span style=display:flex><span>    (let ((begin (<span style=color:#a6e22e>string-match</span> <span style=color:#e6db74>&#34;^#\\+[tT][iI][tT][lL][eE]: .*$&#34;</span> contents)))
</span></span><span style=display:flex><span>      (if begin
</span></span><span style=display:flex><span>          (string-trim (<span style=color:#a6e22e>substring</span> contents begin (<span style=color:#a6e22e>match-end</span> <span style=color:#ae81ff>0</span>)) <span style=color:#e6db74>&#34;#\\+[tT][iI][tT][lL][eE]: *&#34;</span> <span style=color:#e6db74>&#34;[\n\t ]+&#34;</span>)
</span></span><span style=display:flex><span>        (deft-base-filename file))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (advice-add <span style=color:#e6db74>&#39;deft-parse-title</span> :override <span style=color:#a6e22e>#&#39;</span>+deft-parse-title)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq deft-strip-summary-regexp
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;\\(&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;[\n\t]&#34;</span> <span style=color:#75715e>;; blank</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;\\|^#\\+[[:alpha:]_]+:.*$&#34;</span> <span style=color:#75715e>;; org-mode metadata</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;\\|^:PROPERTIES:\n\\(.+\n\\)+:END:\n&#34;</span> <span style=color:#75715e>;; org-roam ID</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;\\|\\[\\[\\(.*\\]\\)&#34;</span> <span style=color:#75715e>;; any link</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;\\)&#34;</span>)))
</span></span></code></pre></div><h2 id=programming>Programming</h2><h3 id=csv-rainbow>CSV rainbow</h3><p>Stolen from <a href="https://www.reddit.com/r/emacs/comments/26c71k/comment/chq2r8m/?utm_source=reddit&utm_medium=web2x&context=3">here</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! csv-mode
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; TODO: Need to fix the case of two commas, example &#34;a,b,,c,d&#34;</span>
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;cl-lib</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;color</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :localleader
</span></span><span style=display:flex><span>        :map csv-mode-map
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;R&#34;</span> <span style=color:#a6e22e>#&#39;</span>+csv-rainbow)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +csv-rainbow (<span style=color:#66d9ef>&amp;optional</span> separator)
</span></span><span style=display:flex><span>    (interactive (<span style=color:#a6e22e>list</span> (when current-prefix-arg (<span style=color:#a6e22e>read-char</span> <span style=color:#e6db74>&#34;Separator: &#34;</span>))))
</span></span><span style=display:flex><span>    (font-lock-mode <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    (let* ((separator (or separator <span style=color:#e6db74>?\,</span>))
</span></span><span style=display:flex><span>           (n (count-matches (<span style=color:#a6e22e>string</span> separator) (point-at-bol) (point-at-eol)))
</span></span><span style=display:flex><span>           (colors (cl-loop for i from <span style=color:#ae81ff>0</span> to <span style=color:#ae81ff>1.0</span> by (<span style=color:#a6e22e>/</span> <span style=color:#ae81ff>2.0</span> n)
</span></span><span style=display:flex><span>                            collect (<span style=color:#a6e22e>apply</span> <span style=color:#a6e22e>#&#39;</span>color-rgb-to-hex
</span></span><span style=display:flex><span>                                           (color-hsl-to-rgb i <span style=color:#ae81ff>0.3</span> <span style=color:#ae81ff>0.5</span>)))))
</span></span><span style=display:flex><span>      (cl-loop for i from <span style=color:#ae81ff>2</span> to n by <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>               for c in colors
</span></span><span style=display:flex><span>               for r <span style=color:#a6e22e>=</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;^\\([^%c\n]+%c\\)\\{%d\\}&#34;</span> separator separator i)
</span></span><span style=display:flex><span>               do (font-lock-add-keywords <span style=color:#66d9ef>nil</span> <span style=color:#f92672>`</span>((<span style=color:#f92672>,</span>r (<span style=color:#ae81ff>1</span> <span style=color:#f92672>&#39;</span>(face (:foreground <span style=color:#f92672>,</span>c))))))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; provide CSV mode setup</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (add-hook &#39;csv-mode-hook (lambda () (+csv-rainbow)))</span>
</span></span></code></pre></div><h3 id=vimrc>Vimrc</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! vimrc-mode
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;mcandre/vimrc-mode&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! vimrc-mode
</span></span><span style=display:flex><span>  :mode <span style=color:#e6db74>&#34;\\.vim\\(rc\\)?\\&#39;&#34;</span>)
</span></span></code></pre></div><h3 id=ess>ESS</h3><p>View data frames better with</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! ess-view)
</span></span></code></pre></div><h3 id=python-ide>Python IDE</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! elpy)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! elpy
</span></span><span style=display:flex><span>  :hook ((elpy-mode <span style=color:#f92672>.</span> flycheck-mode)
</span></span><span style=display:flex><span>         (elpy-mode <span style=color:#f92672>.</span> (lambda ()
</span></span><span style=display:flex><span>                        (<span style=color:#a6e22e>set</span> (<span style=color:#a6e22e>make-local-variable</span> <span style=color:#e6db74>&#39;company-backends</span>)
</span></span><span style=display:flex><span>                             <span style=color:#f92672>&#39;</span>((elpy-company-backend :with company-yasnippet))))))
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  <span style=color:#75715e>;;:init</span>
</span></span><span style=display:flex><span>  (elpy-enable))
</span></span></code></pre></div><h3 id=gnu-octave>GNU Octave</h3><p>Files with the <code>.m</code> extension gets recognized automatically as Objective-C files.
I&rsquo;ve never used Objective-C before, so let&rsquo;s change it to be recognized as
Octave/Matlab files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.m\\&#39;&#34;</span> <span style=color:#f92672>.</span> octave-mode))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +octave-eval-last-sexp ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Evaluate Octave sexp before point and print value into current buffer.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (inferior-octave <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>  (let ((print-escape-newlines <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (opoint (<span style=color:#a6e22e>point</span>)))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>prin1</span>
</span></span><span style=display:flex><span>     (save-excursion
</span></span><span style=display:flex><span>       (forward-sexp <span style=color:#ae81ff>-1</span>)
</span></span><span style=display:flex><span>       (inferior-octave-send-list-and-digest
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>list</span> (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>buffer-substring-no-properties</span> (<span style=color:#a6e22e>point</span>) opoint)
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#34;\n&#34;</span>)))
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>mapconcat</span> <span style=color:#e6db74>&#39;identity</span> inferior-octave-output-list <span style=color:#e6db74>&#34;\n&#34;</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +eros-octave-eval-last-sexp ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Wrapper for </span><span style=color:#e6db74>`+octave-eval-last-sexp&#39;</span><span style=color:#e6db74> that overlays results.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (eros--eval-overlay
</span></span><span style=display:flex><span>   (octave-eval-last-sexp)
</span></span><span style=display:flex><span>   (<span style=color:#a6e22e>point</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :localleader
</span></span><span style=display:flex><span>      :map (octave-mode-map)
</span></span><span style=display:flex><span>      (:prefix (<span style=color:#e6db74>&#34;e&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;eval&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Eval and print last sexp&#34;</span> <span style=color:#e6db74>&#34;e&#34;</span> <span style=color:#a6e22e>#&#39;</span>+eros-octave-eval-last-sexp))
</span></span></code></pre></div><h3 id=ros>ROS</h3><h4 id=extensions>Extensions</h4><p>Add ROS specific file formats:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.rviz\\&#39;&#34;</span>   <span style=color:#f92672>.</span> conf-unix-mode))
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.urdf\\&#39;&#34;</span>   <span style=color:#f92672>.</span> xml-mode))
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.xacro\\&#39;&#34;</span>  <span style=color:#f92672>.</span> xml-mode))
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.launch\\&#39;&#34;</span> <span style=color:#f92672>.</span> xml-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Use gdb-script-mode for msg and srv files</span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.msg\\&#39;&#34;</span>    <span style=color:#f92672>.</span> gdb-script-mode))
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.srv\\&#39;&#34;</span>    <span style=color:#f92672>.</span> gdb-script-mode))
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.action\\&#39;&#34;</span> <span style=color:#f92672>.</span> gdb-script-mode))
</span></span></code></pre></div><h4 id=ros-bags>ROS bags</h4><p>Mode to view ROS <code>.bag</code> files. Taken from <a href=https://github.com/code-iai/ros_emacs_utils>code-iai/ros_emacs_utils</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(when ROSBAG-P
</span></span><span style=display:flex><span>  (define-derived-mode rosbag-view-mode
</span></span><span style=display:flex><span>    fundamental-mode <span style=color:#e6db74>&#34;Rosbag view mode&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Major mode for viewing ROS bag files.&#34;</span>
</span></span><span style=display:flex><span>    (let ((f (<span style=color:#a6e22e>buffer-file-name</span>)))
</span></span><span style=display:flex><span>      (let ((buffer-read-only <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>erase-buffer</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Calling rosbag info&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>call-process</span> <span style=color:#e6db74>&#34;rosbag&#34;</span> <span style=color:#66d9ef>nil</span> (<span style=color:#a6e22e>current-buffer</span>) <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#34;info&#34;</span> f)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>set-buffer-modified-p</span> <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>      (view-mode)
</span></span><span style=display:flex><span>      (set-visited-file-name <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; rosbag view mode</span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#e6db74>&#39;auto-mode-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\\.bag$&#34;</span> <span style=color:#f92672>.</span> rosbag-view-mode)))
</span></span></code></pre></div><h4 id=ros-dot-el><code>ros.el</code></h4><p>I found this awesome <a href=https://github.com/DerBeutlin/ros.el><code>ros.el</code></a> package made by <a href=https://github.com/DerBeutlin>Max Beutelspacher</a>, which
facilitate working with ROS machines, supports ROS1 and ROS2, with local
workspaces or remote ones (over Trump!).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; `ros.el&#39; depends on `with-shell-interpreter&#39; among other packages</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; See: https://github.com/DerBeutlin/ros.el/blob/master/Cask</span>
</span></span><span style=display:flex><span>(package! with-shell-interpreter)
</span></span><span style=display:flex><span>(package! ros
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;DerBeutlin/ros.el&#34;</span>))
</span></span></code></pre></div><p>Now, we configure the ROS1/ROS2 workspaces to work on. But before that, we need
to install some tools on the ROS machine, and build the workspace for the first
time using <code>colcon build</code>, the repository contains example Docker files for <a href=https://github.com/DerBeutlin/ros.el/blob/master/docker/Dockerfile_noetic>Noetic</a>
and <a href=https://github.com/DerBeutlin/ros.el/blob/master/docker/Dockerfile_foxy>Foxy</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! ros
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (map! :leader
</span></span><span style=display:flex><span>        :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Hydra ROS&#34;</span> <span style=color:#e6db74>&#34;r&#34;</span> <span style=color:#a6e22e>#&#39;</span>hydra-ros-main/body)
</span></span><span style=display:flex><span>  :commands (hydra-ros-main/body ros-set-workspace)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq ros-workspaces
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>list</span> (ros-dump-workspace
</span></span><span style=display:flex><span>               :tramp-prefix (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;/docker:%s@%s:&#34;</span> <span style=color:#e6db74>&#34;ros&#34;</span> <span style=color:#e6db74>&#34;ros-machine&#34;</span>)
</span></span><span style=display:flex><span>               :workspace <span style=color:#e6db74>&#34;~/ros_ws&#34;</span>
</span></span><span style=display:flex><span>               :extends <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;/opt/ros/noetic/&#34;</span>))
</span></span><span style=display:flex><span>              (ros-dump-workspace
</span></span><span style=display:flex><span>               :tramp-prefix (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;/ssh:%s@%s:&#34;</span> <span style=color:#e6db74>&#34;swd_sk&#34;</span> <span style=color:#e6db74>&#34;172.16.96.42&#34;</span>)
</span></span><span style=display:flex><span>               :workspace <span style=color:#e6db74>&#34;~/ros_ws&#34;</span>
</span></span><span style=display:flex><span>               :extends <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;/opt/ros/noetic/&#34;</span>))
</span></span><span style=display:flex><span>              (ros-dump-workspace
</span></span><span style=display:flex><span>               :tramp-prefix (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;/ssh:%s@%s:&#34;</span> <span style=color:#e6db74>&#34;swd_sk&#34;</span> <span style=color:#e6db74>&#34;172.16.96.42&#34;</span>)
</span></span><span style=display:flex><span>               :workspace <span style=color:#e6db74>&#34;~/ros2_ws&#34;</span>
</span></span><span style=display:flex><span>               :extends <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;/opt/ros/foxy/&#34;</span>)))))
</span></span></code></pre></div><h3 id=scheme>Scheme</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! geiser
</span></span><span style=display:flex><span>  (setq geiser-default-implementation <span style=color:#e6db74>&#39;guile</span>
</span></span><span style=display:flex><span>        geiser-chez-binary <span style=color:#e6db74>&#34;chez-scheme&#34;</span>)) <span style=color:#75715e>;; default is &#34;scheme&#34;</span>
</span></span></code></pre></div><h3 id=embedded-systems>Embedded systems</h3><h4 id=embed-dot-el>Embed.el</h4><p>Some embedded systems development tools.</p><p>TODO: Try to integrate embedded debuggers adapters with <code>dap-mode</code>:</p><ul><li><a href=https://github.com/probe-rs/vscode>probe-rs-debugger</a></li><li><a href=https://github.com/SL-RU/stm32-emacs>stm32-emacs</a></li><li><a href=https://github.com/Marus/cortex-debug>cortex-debug</a> with <a href=https://github.com/emacs-lsp/dap-mode/issues/224>potential integration with DAP</a></li><li><a href=https://github.com/espressif/esp-debug-adapter>esp-debug-adapter</a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! embed
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;sjsch/embed-el&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! embed
</span></span><span style=display:flex><span>  :commands (embed-openocd-start
</span></span><span style=display:flex><span>             embed-openocd-stop
</span></span><span style=display:flex><span>             embed-openocd-gdb
</span></span><span style=display:flex><span>             embed-openocd-flash)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (map! :leader :prefix (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;custom&#34;</span>)
</span></span><span style=display:flex><span>        (:when (modulep! :tools debugger +lsp)
</span></span><span style=display:flex><span>         :prefix (<span style=color:#e6db74>&#34;e&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;embedded&#34;</span>)
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Start OpenOCD&#34;</span>    <span style=color:#e6db74>&#34;o&#34;</span> <span style=color:#a6e22e>#&#39;</span>embed-openocd-start
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;Stop OpenOCD&#34;</span>     <span style=color:#e6db74>&#34;O&#34;</span> <span style=color:#a6e22e>#&#39;</span>embed-openocd-stop
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;OpenOCD GDB&#34;</span>      <span style=color:#e6db74>&#34;g&#34;</span> <span style=color:#a6e22e>#&#39;</span>embed-openocd-gdb
</span></span><span style=display:flex><span>         :desc <span style=color:#e6db74>&#34;OpenOCD flash&#34;</span>    <span style=color:#e6db74>&#34;f&#34;</span> <span style=color:#a6e22e>#&#39;</span>embed-openocd-flash)))
</span></span></code></pre></div><h4 id=arduino>Arduino</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! arduino-mode
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;bookest/arduino-mode&#34;</span>))
</span></span></code></pre></div><h4 id=bitbake--yocto>Bitbake (Yocto)</h4><p>Add support for Yocto Project files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! bitbake-modes
</span></span><span style=display:flex><span>  :recipe (:host bitbucket
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;olanilsson/bitbake-modes&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! bitbake-modes
</span></span><span style=display:flex><span>  :commands (wks-mode
</span></span><span style=display:flex><span>             mmm-mode
</span></span><span style=display:flex><span>             bb-sh-mode
</span></span><span style=display:flex><span>             bb-scc-mode
</span></span><span style=display:flex><span>             bitbake-mode
</span></span><span style=display:flex><span>             conf-bitbake-mode
</span></span><span style=display:flex><span>             bitbake-task-log-mode))
</span></span></code></pre></div><h3 id=git-and-vc>Git & VC</h3><h4 id=magit>Magit</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! code-review
</span></span><span style=display:flex><span>  (setq code-review-auth-login-marker <span style=color:#e6db74>&#39;forge</span>))
</span></span></code></pre></div><h5 id=granular-diff-highlights-for-all-hunks>Granular diff-highlights for <em>all</em> hunks</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! magit
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Disable if it causes performance issues</span>
</span></span><span style=display:flex><span>  (setq magit-diff-refine-hunk <span style=color:#66d9ef>t</span>))
</span></span></code></pre></div><h5 id=gravatars>Gravatars</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! magit
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Show gravatars</span>
</span></span><span style=display:flex><span>  (setq magit-revision-show-gravatars <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;^Author:     &#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;^Commit:     &#34;</span>)))
</span></span></code></pre></div><h5 id=wip-company-for-commit-messages>WIP Company for commit messages</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! company-conventional-commits
</span></span><span style=display:flex><span>  :recipe (:local-repo <span style=color:#e6db74>&#34;lisp/company-conventional-commits&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! company-conventional-commits
</span></span><span style=display:flex><span>  :after (magit company)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;git-commit-setup-hook</span>
</span></span><span style=display:flex><span>            (lambda ()
</span></span><span style=display:flex><span>              (add-to-list <span style=color:#e6db74>&#39;company-backends</span> <span style=color:#e6db74>&#39;company-conventional-commits</span>))))
</span></span></code></pre></div><h5 id=pretty-graph>Pretty graph</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! magit-pretty-graph
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;georgek/magit-pretty-graph&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! magit-pretty-graph
</span></span><span style=display:flex><span>  :after magit
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq magit-pg-command
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;git --no-pager log&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34; --topo-order --decorate=full&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34; --pretty=format:\&#34;%H%x00%P%x00%an%x00%ar%x00%s%x00%d\&#34;&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34; -n 2000&#34;</span>)) <span style=color:#75715e>;; Increase the default 100 limit</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :localleader
</span></span><span style=display:flex><span>        :map (magit-mode-map)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Magit pretty graph&#34;</span> <span style=color:#e6db74>&#34;p&#34;</span> (cmd! (magit-pg-repo (magit-toplevel)))))
</span></span></code></pre></div><h4 id=repo>Repo</h4><p>This adds Emacs integration of <code>repo</code>, The Multiple Git Repository Tool. Make sure
the <a href=https://gerrit.googlesource.com/git-repo>repo</a> tool is installed, if not, <code>pacman -S repo</code> on Arch-based distributions,
or directly with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>REPO_PATH=&#34;$HOME/.local/bin/repo&#34;
</span></span><span style=display:flex><span>curl &#34;https://storage.googleapis.com/git-repo-downloads/repo&#34; &gt; &#34;${REPO_PATH}&#34;
</span></span><span style=display:flex><span>chmod a+x &#34;${REPO_PATH}&#34;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! repo)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! repo
</span></span><span style=display:flex><span>  :when REPO-P
</span></span><span style=display:flex><span>  :commands repo-status)
</span></span></code></pre></div><h4 id=blamer>Blamer</h4><p>Display Git information (author, date, message&mldr;) for current line</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! blamer
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;artawower/blamer.el&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! blamer
</span></span><span style=display:flex><span>  :commands (blamer-mode)
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; :hook ((prog-mode . blamer-mode))</span>
</span></span><span style=display:flex><span>  :custom
</span></span><span style=display:flex><span>  (blamer-idle-time <span style=color:#ae81ff>0.3</span>)
</span></span><span style=display:flex><span>  (blamer-min-offset <span style=color:#ae81ff>60</span>)
</span></span><span style=display:flex><span>  (blamer-prettify-time-p <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>  (blamer-entire-formatter <span style=color:#e6db74>&#34;    %s&#34;</span>)
</span></span><span style=display:flex><span>  (blamer-author-formatter <span style=color:#e6db74>&#34; %s &#34;</span>)
</span></span><span style=display:flex><span>  (blamer-datetime-formatter <span style=color:#e6db74>&#34;[%s], &#34;</span>)
</span></span><span style=display:flex><span>  (blamer-commit-formatter <span style=color:#e6db74>&#34;“%s”&#34;</span>)
</span></span><span style=display:flex><span>  :custom-face
</span></span><span style=display:flex><span>  (blamer-face ((<span style=color:#66d9ef>t</span> :foreground <span style=color:#e6db74>&#34;#7a88cf&#34;</span>
</span></span><span style=display:flex><span>                   :background <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                   :height <span style=color:#ae81ff>125</span>
</span></span><span style=display:flex><span>                   :italic <span style=color:#66d9ef>t</span>)))
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (when (modulep! :ui zen) <span style=color:#75715e>;; Disable in zen (writeroom) mode</span>
</span></span><span style=display:flex><span>    (add-hook <span style=color:#e6db74>&#39;writeroom-mode-enable-hook</span>
</span></span><span style=display:flex><span>              (when (bound-and-true-p blamer-mode)
</span></span><span style=display:flex><span>                (setq +blamer-mode--was-active-p <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>                (blamer-mode <span style=color:#ae81ff>-1</span>)))
</span></span><span style=display:flex><span>    (add-hook <span style=color:#e6db74>&#39;writeroom-mode-disable-hook</span>
</span></span><span style=display:flex><span>              (when (bound-and-true-p +blamer-mode--was-active-p)
</span></span><span style=display:flex><span>                (blamer-mode <span style=color:#ae81ff>1</span>)))))
</span></span></code></pre></div><h3 id=assembly>Assembly</h3><p>Add some packages for better assembly coding.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! nasm-mode)
</span></span><span style=display:flex><span>(package! haxor-mode)
</span></span><span style=display:flex><span>(package! mips-mode)
</span></span><span style=display:flex><span>(package! riscv-mode)
</span></span><span style=display:flex><span>(package! x86-lookup)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! nasm-mode
</span></span><span style=display:flex><span>  :mode <span style=color:#e6db74>&#34;\\.[n]*\\(asm\\|s\\)\\&#39;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Get Haxor VM from https://github.com/krzysztof-magosa/haxor</span>
</span></span><span style=display:flex><span>(use-package! haxor-mode
</span></span><span style=display:flex><span>  :mode <span style=color:#e6db74>&#34;\\.hax\\&#39;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(use-package! mips-mode
</span></span><span style=display:flex><span>  :mode <span style=color:#e6db74>&#34;\\.mips\\&#39;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(use-package! riscv-mode
</span></span><span style=display:flex><span>  :mode <span style=color:#e6db74>&#34;\\.riscv\\&#39;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(use-package! x86-lookup
</span></span><span style=display:flex><span>  :commands (x86-lookup)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (when (modulep! :tools pdf)
</span></span><span style=display:flex><span>    (setq x86-lookup-browse-pdf-function <span style=color:#e6db74>&#39;x86-lookup-browse-pdf-pdf-tools</span>))
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Get manual from https://www.intel.com/content/www/us/en/developer/articles/technical/intel-sdm.html</span>
</span></span><span style=display:flex><span>  (setq x86-lookup-pdf (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;x86-lookup/325383-sdm-vol-2abcd.pdf&#34;</span> doom-data-dir)))
</span></span></code></pre></div><h3 id=disaster>Disaster</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! disaster)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! disaster
</span></span><span style=display:flex><span>  :commands (disaster)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq disaster-assembly-mode <span style=color:#e6db74>&#39;nasm-mode</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (map! :localleader
</span></span><span style=display:flex><span>        :map (c++-mode-map c-mode-map fortran-mode)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Disaster&#34;</span> <span style=color:#e6db74>&#34;d&#34;</span> <span style=color:#a6e22e>#&#39;</span>disaster))
</span></span></code></pre></div><h3 id=devdocs>Devdocs</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! devdocs
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;astoff/devdocs.el&#34;</span>
</span></span><span style=display:flex><span>           :files (<span style=color:#e6db74>&#34;*.el&#34;</span>)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! devdocs
</span></span><span style=display:flex><span>  :commands (devdocs-lookup devdocs-install)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq devdocs-data-dir (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;devdocs&#34;</span> doom-data-dir)))
</span></span></code></pre></div><h3 id=systemd>Systemd</h3><p>For editing systemd unit files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! systemd)
</span></span><span style=display:flex><span>(package! journalctl-mode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! journalctl-mode
</span></span><span style=display:flex><span>  :commands (journalctl
</span></span><span style=display:flex><span>             journalctl-boot
</span></span><span style=display:flex><span>             journalctl-unit
</span></span><span style=display:flex><span>             journalctl-user-unit)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (map! :map journalctl-mode-map
</span></span><span style=display:flex><span>        :nv <span style=color:#e6db74>&#34;J&#34;</span> <span style=color:#a6e22e>#&#39;</span>journalctl-next-chunk
</span></span><span style=display:flex><span>        :nv <span style=color:#e6db74>&#34;K&#34;</span> <span style=color:#a6e22e>#&#39;</span>journalctl-previous-chunk))
</span></span></code></pre></div><h3 id=pkgbuild>PKGBUILD</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! pkgbuild-mode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! pkgbuild-mode
</span></span><span style=display:flex><span>  :commands (pkgbuild-mode)
</span></span><span style=display:flex><span>  :mode <span style=color:#e6db74>&#34;/PKGBUILD$&#34;</span>)
</span></span></code></pre></div><h3 id=franca-idl>Franca IDL</h3><p>Add support for <em><a href=https://github.com/franca/franca>Franca Interface Definition Language</a></em>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! franca-idl
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;zeph1e/franca-idl.el&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! franca-idl
</span></span><span style=display:flex><span>  :commands franca-idl-mode)
</span></span></code></pre></div><h3 id=latex>LaTeX</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! aas
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;ymarco/auto-activating-snippets&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! aas
</span></span><span style=display:flex><span>  :commands aas-mode)
</span></span></code></pre></div><h3 id=flycheck-plus-projectile>Flycheck + Projectile</h3><p>WIP: Not working atm!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! flycheck-projectile
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;nbfalcon/flycheck-projectile&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! flycheck-projectile
</span></span><span style=display:flex><span>  :commands flycheck-projectile-list-errors)
</span></span></code></pre></div><h3 id=graphviz>Graphviz</h3><p>Graphviz is a nice method of visualizing simple graphs, based on th DOT graph
description language (<code>*.dot</code> / <code>*.gv</code> files).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! graphviz-dot-mode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! graphviz-dot-mode
</span></span><span style=display:flex><span>  :commands graphviz-dot-mode
</span></span><span style=display:flex><span>  :mode (<span style=color:#e6db74>&#34;\\.dot\\&#39;&#34;</span> <span style=color:#e6db74>&#34;\\.gv\\&#39;&#34;</span>)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (after! org
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>setcdr</span> (<span style=color:#a6e22e>assoc</span> <span style=color:#e6db74>&#34;dot&#34;</span> org-src-lang-modes) <span style=color:#e6db74>&#39;graphviz-dot</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;company-graphviz-dot</span>))
</span></span></code></pre></div><h3 id=modula-ii>Modula-II</h3><p>Gaius Mulley is doing a great job, bringing Modula-II support to GCC, he also
created a new mode for Modula-II with extended features. The mode is included
with the GNU Modula 2 source code, and can be downloaded separately from the Git
repository, from here <a href=https://git.savannah.gnu.org/cgit/gm2.git/plain/gcc-versionno/gcc/m2/el/gm2-mode.el>gm2-mode.el</a>. I added <code>(provide 'gm2-mode)</code> to the
<code>gm2-mode.el</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! gm2-mode
</span></span><span style=display:flex><span>  :recipe (:local-repo <span style=color:#e6db74>&#34;lisp/gm2-mode&#34;</span>))
</span></span></code></pre></div><h3 id=mermaid>Mermaid</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! mermaid-mode)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(package! ob-mermaid
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;arnm/ob-mermaid&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! mermaid-mode
</span></span><span style=display:flex><span>  :commands mermaid-mode
</span></span><span style=display:flex><span>  :mode <span style=color:#e6db74>&#34;\\.mmd\\&#39;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(use-package! ob-mermaid
</span></span><span style=display:flex><span>  :after org
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (after! org
</span></span><span style=display:flex><span>    (add-to-list <span style=color:#e6db74>&#39;org-babel-load-languages</span> <span style=color:#f92672>&#39;</span>(mermaid <span style=color:#f92672>.</span> <span style=color:#66d9ef>t</span>))))
</span></span></code></pre></div><h3 id=the-v-programming-language>The V Programming Language</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! v-mode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! v-mode
</span></span><span style=display:flex><span>  :mode (<span style=color:#e6db74>&#34;\\(\\.v?v\\|\\.vsh\\)$&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;v-mode</span>)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (map! :localleader
</span></span><span style=display:flex><span>        :map (v-mode-map)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;v-format-buffer&#34;</span> <span style=color:#e6db74>&#34;f&#34;</span> <span style=color:#a6e22e>#&#39;</span>v-format-buffer
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;v-menu&#34;</span> <span style=color:#e6db74>&#34;m&#34;</span> <span style=color:#a6e22e>#&#39;</span>v-menu))
</span></span></code></pre></div><h3 id=inspector>Inspector</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! inspector
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;mmontone/emacs-inspector&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! inspector
</span></span><span style=display:flex><span>  :commands (inspect-expression inspect-last-sexp))
</span></span></code></pre></div><h2 id=office>Office</h2><h3 id=org-additional-packages>Org additional packages</h3><p>To avoid problems in the <code>(after! org)</code> section.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(unpin! org-roam) <span style=color:#75715e>;; To avoid problems with org-roam-ui</span>
</span></span><span style=display:flex><span>(package! websocket)
</span></span><span style=display:flex><span>(package! org-roam-ui)
</span></span><span style=display:flex><span>(package! org-wild-notifier)
</span></span><span style=display:flex><span>(package! org-fragtog)
</span></span><span style=display:flex><span>(package! org-appear)
</span></span><span style=display:flex><span>(package! org-super-agenda)
</span></span><span style=display:flex><span>(package! doct)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(package! citar-org-roam
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;emacs-citar/citar-org-roam&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(package! org-menu
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;sheijk/org-menu&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(package! caldav
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;dengste/org-caldav&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(package! org-ol-tree
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;Townk/org-ol-tree&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(package! org-modern
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;minad/org-modern&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(package! org-bib
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;rougier/org-bib-mode&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(package! academic-phrases
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;nashamri/academic-phrases&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(package! phscroll
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;misohena/phscroll&#34;</span>))
</span></span></code></pre></div><h3 id=org>Org mode</h3><h4 id=intro>Intro</h4><p>Because this section is fairly expensive to initialize, we&rsquo;ll wrap it in a
<code>(after! ...)</code> block.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org
</span></span><span style=display:flex><span>  &lt;&lt;org-conf&gt;&gt;
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h4 id=behavior>Behavior</h4><h5 id=tweaking-defaults>Tweaking defaults</h5><h6 id=org-basics>Org basics</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-directory <span style=color:#e6db74>&#34;~/Dropbox/Org/&#34;</span> <span style=color:#75715e>; let&#39;s put files here</span>
</span></span><span style=display:flex><span>      org-use-property-inheritance <span style=color:#66d9ef>t</span> <span style=color:#75715e>; it&#39;s convenient to have properties inherited</span>
</span></span><span style=display:flex><span>      org-log-done <span style=color:#e6db74>&#39;time</span>             <span style=color:#75715e>; having the time an item is done sounds convenient</span>
</span></span><span style=display:flex><span>      org-list-allow-alphabetical <span style=color:#66d9ef>t</span>  <span style=color:#75715e>; have a. A. a) A) list bullets</span>
</span></span><span style=display:flex><span>      org-export-in-background <span style=color:#66d9ef>nil</span>   <span style=color:#75715e>; run export processes in external emacs process</span>
</span></span><span style=display:flex><span>      org-export-async-debug <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      org-tags-column <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      org-catch-invisible-edits <span style=color:#e6db74>&#39;smart</span> <span style=color:#75715e>;; try not to accidently do weird stuff in invisible regions</span>
</span></span><span style=display:flex><span>      org-export-with-sub-superscripts <span style=color:#e6db74>&#39;{}</span> <span style=color:#75715e>;; don&#39;t treat lone _ / ^ as sub/superscripts, require _{} / ^{}</span>
</span></span><span style=display:flex><span>      org-pretty-entities-include-sub-superscripts <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>      org-auto-align-tags <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>      org-special-ctrl-a/e <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      org-startup-indented <span style=color:#66d9ef>t</span> <span style=color:#75715e>;; Enable &#39;org-indent-mode&#39; by default, override with &#39;+#startup: noindent&#39; for big files</span>
</span></span><span style=display:flex><span>      org-insert-heading-respect-content <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h6 id=babel>Babel</h6><p>I also like the <code>:comments</code> header-argument, so let&rsquo;s make that a
default.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-babel-default-header-args
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((:session  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;none&#34;</span>)
</span></span><span style=display:flex><span>        (:results  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;replace&#34;</span>)
</span></span><span style=display:flex><span>        (:exports  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;code&#34;</span>)
</span></span><span style=display:flex><span>        (:cache    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;no&#34;</span>)
</span></span><span style=display:flex><span>        (:noweb    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;no&#34;</span>)
</span></span><span style=display:flex><span>        (:hlines   <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;no&#34;</span>)
</span></span><span style=display:flex><span>        (:tangle   <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;no&#34;</span>)
</span></span><span style=display:flex><span>        (:comments <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;link&#34;</span>)))
</span></span></code></pre></div><p>Babel is really annoying when it comes to working with Scheme (via Geiser), it
keeps asking about which Scheme implementation to use, I tried to set this as a
local variable (using )
and <code>.dir-locals.el</code>, but it didn&rsquo;t work. This hack should solve the problem now!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; stolen from https://github.com/yohan-pereira/.emacs#babel-config</span>
</span></span><span style=display:flex><span>(defun +org-confirm-babel-evaluate (lang body)
</span></span><span style=display:flex><span>  (not (string= lang <span style=color:#e6db74>&#34;scheme&#34;</span>))) <span style=color:#75715e>;; Don&#39;t ask for scheme</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq org-confirm-babel-evaluate <span style=color:#a6e22e>#&#39;</span>+org-confirm-babel-evaluate)
</span></span></code></pre></div><h6 id=evil>EVIL</h6><p>There also seem to be a few keybindings which use <code>hjkl</code>, but miss arrow key
equivalents.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :map evil-org-mode-map
</span></span><span style=display:flex><span>      :after evil-org
</span></span><span style=display:flex><span>      :n <span style=color:#e6db74>&#34;g &lt;up&gt;&#34;</span> <span style=color:#a6e22e>#&#39;</span>org-backward-heading-same-level
</span></span><span style=display:flex><span>      :n <span style=color:#e6db74>&#34;g &lt;down&gt;&#34;</span> <span style=color:#a6e22e>#&#39;</span>org-forward-heading-same-level
</span></span><span style=display:flex><span>      :n <span style=color:#e6db74>&#34;g &lt;left&gt;&#34;</span> <span style=color:#a6e22e>#&#39;</span>org-up-element
</span></span><span style=display:flex><span>      :n <span style=color:#e6db74>&#34;g &lt;right&gt;&#34;</span> <span style=color:#a6e22e>#&#39;</span>org-down-element)
</span></span></code></pre></div><h5 id=todos>TODOs</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-todo-keywords
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((sequence <span style=color:#e6db74>&#34;IDEA(i)&#34;</span> <span style=color:#e6db74>&#34;TODO(t)&#34;</span> <span style=color:#e6db74>&#34;NEXT(n)&#34;</span> <span style=color:#e6db74>&#34;PROJ(p)&#34;</span> <span style=color:#e6db74>&#34;STRT(s)&#34;</span> <span style=color:#e6db74>&#34;WAIT(w)&#34;</span> <span style=color:#e6db74>&#34;HOLD(h)&#34;</span> <span style=color:#e6db74>&#34;|&#34;</span> <span style=color:#e6db74>&#34;DONE(d)&#34;</span> <span style=color:#e6db74>&#34;KILL(k)&#34;</span>)
</span></span><span style=display:flex><span>        (sequence <span style=color:#e6db74>&#34;[ ](T)&#34;</span> <span style=color:#e6db74>&#34;[-](S)&#34;</span> <span style=color:#e6db74>&#34;|&#34;</span> <span style=color:#e6db74>&#34;[X](D)&#34;</span>)
</span></span><span style=display:flex><span>        (sequence <span style=color:#e6db74>&#34;|&#34;</span> <span style=color:#e6db74>&#34;OKAY(o)&#34;</span> <span style=color:#e6db74>&#34;YES(y)&#34;</span> <span style=color:#e6db74>&#34;NO(n)&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq org-todo-keyword-faces
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;IDEA&#34;</span> <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;goldenrod&#34;</span> :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;NEXT&#34;</span> <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;IndianRed1&#34;</span> :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;STRT&#34;</span> <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;OrangeRed&#34;</span> :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;WAIT&#34;</span> <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;coral&#34;</span> :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;KILL&#34;</span> <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;DarkGreen&#34;</span> :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;PROJ&#34;</span> <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;LimeGreen&#34;</span> :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;HOLD&#34;</span> <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;orange&#34;</span> :weight bold))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +log-todo-next-creation-date (<span style=color:#66d9ef>&amp;rest</span> ignore)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Log NEXT creation time in the property drawer under the key &#39;ACTIVATED&#39;&#34;</span>
</span></span><span style=display:flex><span>  (when (and (string= (org-get-todo-state) <span style=color:#e6db74>&#34;NEXT&#34;</span>)
</span></span><span style=display:flex><span>             (not (org-entry-get <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#34;ACTIVATED&#34;</span>)))
</span></span><span style=display:flex><span>    (org-entry-put <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#34;ACTIVATED&#34;</span> (<span style=color:#a6e22e>format-time-string</span> <span style=color:#e6db74>&#34;[%Y-%m-%d]&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;org-after-todo-state-change-hook</span> <span style=color:#a6e22e>#&#39;</span>+log-todo-next-creation-date)
</span></span></code></pre></div><h5 id=tags>Tags</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-tag-persistent-alist
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((:startgroup <span style=color:#f92672>.</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;home&#34;</span>      <span style=color:#f92672>.</span> <span style=color:#e6db74>?h</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;research&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>?r</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;work&#34;</span>      <span style=color:#f92672>.</span> <span style=color:#e6db74>?w</span>)
</span></span><span style=display:flex><span>        (:endgroup   <span style=color:#f92672>.</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (:startgroup <span style=color:#f92672>.</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;tool&#34;</span>      <span style=color:#f92672>.</span> <span style=color:#e6db74>?o</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;dev&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>?d</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;report&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>?p</span>)
</span></span><span style=display:flex><span>        (:endgroup   <span style=color:#f92672>.</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (:startgroup <span style=color:#f92672>.</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;easy&#34;</span>      <span style=color:#f92672>.</span> <span style=color:#e6db74>?e</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;medium&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>?m</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;hard&#34;</span>      <span style=color:#f92672>.</span> <span style=color:#e6db74>?a</span>)
</span></span><span style=display:flex><span>        (:endgroup   <span style=color:#f92672>.</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;urgent&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>?u</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;key&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>?k</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;bonus&#34;</span>     <span style=color:#f92672>.</span> <span style=color:#e6db74>?b</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;ignore&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>?i</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;noexport&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>?x</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq org-tag-faces
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;home&#34;</span>     <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;goldenrod&#34;</span>  :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;research&#34;</span> <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;goldenrod&#34;</span>  :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;work&#34;</span>     <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;goldenrod&#34;</span>  :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;tool&#34;</span>     <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;IndianRed1&#34;</span> :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;dev&#34;</span>      <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;IndianRed1&#34;</span> :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;report&#34;</span>   <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;IndianRed1&#34;</span> :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;urgent&#34;</span>   <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;red&#34;</span>        :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;key&#34;</span>      <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;red&#34;</span>        :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;easy&#34;</span>     <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;green4&#34;</span>     :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;medium&#34;</span>   <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;orange&#34;</span>     :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;hard&#34;</span>     <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;red&#34;</span>        :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;bonus&#34;</span>    <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;goldenrod&#34;</span>  :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;ignore&#34;</span>   <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;Gray&#34;</span>       :weight bold))
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;noexport&#34;</span> <span style=color:#f92672>.</span> (:foreground <span style=color:#e6db74>&#34;LimeGreen&#34;</span>  :weight bold))))
</span></span></code></pre></div><h5 id=agenda>Agenda</h5><p>Set files for <code>org-agenda</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-agenda-files
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>list</span> (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;inbox.org&#34;</span> org-directory)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;agenda.org&#34;</span> org-directory)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;gcal-agenda.org&#34;</span> org-directory)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;notes.org&#34;</span> org-directory)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;projects.org&#34;</span> org-directory)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;archive.org&#34;</span> org-directory)))
</span></span></code></pre></div><p>Apply some styling on the standard agenda:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Agenda styling</span>
</span></span><span style=display:flex><span>(setq org-agenda-block-separator <span style=color:#e6db74>?─</span>
</span></span><span style=display:flex><span>      org-agenda-time-grid
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((daily today require-timed)
</span></span><span style=display:flex><span>        (<span style=color:#ae81ff>800</span> <span style=color:#ae81ff>1000</span> <span style=color:#ae81ff>1200</span> <span style=color:#ae81ff>1400</span> <span style=color:#ae81ff>1600</span> <span style=color:#ae81ff>1800</span> <span style=color:#ae81ff>2000</span>)
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34; ┄┄┄┄┄ &#34;</span> <span style=color:#e6db74>&#34;┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄&#34;</span>)
</span></span><span style=display:flex><span>      org-agenda-current-time-string
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;⭠ now ─────────────────────────────────────────────────&#34;</span>)
</span></span></code></pre></div><h5 id=super-agenda>Super agenda</h5><p>Configure <code>org-super-agenda</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-super-agenda
</span></span><span style=display:flex><span>  :defer <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (org-super-agenda-mode)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq org-agenda-skip-scheduled-if-done <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-agenda-skip-deadline-if-done <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-agenda-include-deadlines <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-agenda-block-separator <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        org-agenda-tags-column <span style=color:#ae81ff>100</span> <span style=color:#75715e>;; from testing this seems to be a good value</span>
</span></span><span style=display:flex><span>        org-agenda-compact-blocks <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq org-agenda-custom-commands
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;o&#34;</span> <span style=color:#e6db74>&#34;Overview&#34;</span>
</span></span><span style=display:flex><span>           ((agenda <span style=color:#e6db74>&#34;&#34;</span> ((org-agenda-span <span style=color:#e6db74>&#39;day</span>)
</span></span><span style=display:flex><span>                        (org-super-agenda-groups
</span></span><span style=display:flex><span>                         <span style=color:#f92672>&#39;</span>((:name <span style=color:#e6db74>&#34;Today&#34;</span>
</span></span><span style=display:flex><span>                            :time-grid <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                            :date today
</span></span><span style=display:flex><span>                            :todo <span style=color:#e6db74>&#34;TODAY&#34;</span>
</span></span><span style=display:flex><span>                            :scheduled today
</span></span><span style=display:flex><span>                            :order <span style=color:#ae81ff>1</span>)))))
</span></span><span style=display:flex><span>            (alltodo <span style=color:#e6db74>&#34;&#34;</span> ((org-agenda-overriding-header <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>                         (org-super-agenda-groups
</span></span><span style=display:flex><span>                          <span style=color:#f92672>&#39;</span>((:name <span style=color:#e6db74>&#34;Next to do&#34;</span> :todo <span style=color:#e6db74>&#34;NEXT&#34;</span> :order <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Important&#34;</span> :tag <span style=color:#e6db74>&#34;Important&#34;</span> :priority <span style=color:#e6db74>&#34;A&#34;</span> :order <span style=color:#ae81ff>6</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Due Today&#34;</span> :deadline today :order <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Due Soon&#34;</span> :deadline future :order <span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Overdue&#34;</span> :deadline past :face <span style=color:#a6e22e>error</span> :order <span style=color:#ae81ff>7</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Assignments&#34;</span> :tag <span style=color:#e6db74>&#34;Assignment&#34;</span> :order <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Issues&#34;</span> :tag <span style=color:#e6db74>&#34;Issue&#34;</span> :order <span style=color:#ae81ff>12</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Emacs&#34;</span> :tag <span style=color:#e6db74>&#34;Emacs&#34;</span> :order <span style=color:#ae81ff>13</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Projects&#34;</span> :tag <span style=color:#e6db74>&#34;Project&#34;</span> :order <span style=color:#ae81ff>14</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Research&#34;</span> :tag <span style=color:#e6db74>&#34;Research&#34;</span> :order <span style=color:#ae81ff>15</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;To read&#34;</span> :tag <span style=color:#e6db74>&#34;Read&#34;</span> :order <span style=color:#ae81ff>30</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Waiting&#34;</span> :todo <span style=color:#e6db74>&#34;WAIT&#34;</span> :order <span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;University&#34;</span> :tag <span style=color:#e6db74>&#34;Univ&#34;</span> :order <span style=color:#ae81ff>32</span>)
</span></span><span style=display:flex><span>                            (:name <span style=color:#e6db74>&#34;Trivial&#34;</span> :priority&lt;= <span style=color:#e6db74>&#34;E&#34;</span> :tag (<span style=color:#e6db74>&#34;Trivial&#34;</span> <span style=color:#e6db74>&#34;Unimportant&#34;</span>) :todo (<span style=color:#e6db74>&#34;SOMEDAY&#34;</span>) :order <span style=color:#ae81ff>90</span>)
</span></span><span style=display:flex><span>                            (:discard (:tag (<span style=color:#e6db74>&#34;Chore&#34;</span> <span style=color:#e6db74>&#34;Routine&#34;</span> <span style=color:#e6db74>&#34;Daily&#34;</span>))))))))))))
</span></span></code></pre></div><h5 id=calendar>Calendar</h5><h6 id=google-calendar--org-gcal>Google calendar (<code>org-gcal</code>)</h6><p>I store my <code>org-gcal</code> configuration privately, it contains something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>(setq org-gcal-client-id &#34;&lt;SOME_ID&gt;.apps.googleusercontent.com&#34;
</span></span><span style=display:flex><span>      org-gcal-client-secret &#34;&lt;SOME_SECRET&gt;&#34;
</span></span><span style=display:flex><span>      org-gcal-fetch-file-alist &#39;((&#34;&lt;USERNAME&gt;@gmail.com&#34; . &#34;~/Dropbox/Org/gcal-agenda.org&#34;)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org-gcal
</span></span><span style=display:flex><span>  (load! <span style=color:#e6db74>&#34;lisp/private/+org-gcal.el&#34;</span>))
</span></span></code></pre></div><h6 id=caldav>TODO CalDAV</h6><p>Need to be configured, see the <a href=https://github.com/dengste/org-caldav>GitHub repo</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! caldav
</span></span><span style=display:flex><span>  :commands (org-caldav-sync))
</span></span></code></pre></div><h5 id=capture>Capture</h5><p>Set capture files</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq +org-capture-emails-file (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;inbox.org&#34;</span> org-directory)
</span></span><span style=display:flex><span>      +org-capture-todo-file (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;inbox.org&#34;</span> org-directory)
</span></span><span style=display:flex><span>      +org-capture-projects-file (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;projects.org&#34;</span> org-directory))
</span></span></code></pre></div><p>Let&rsquo;s set up some <code>org-capture</code> templates, and make them visually nice to access.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! doct
</span></span><span style=display:flex><span>  :commands (doct))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org-capture
</span></span><span style=display:flex><span>  &lt;&lt;prettify-capture&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +doct-icon-declaration-to-icon (declaration)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Convert :icon declaration to icon&#34;</span>
</span></span><span style=display:flex><span>    (let ((name (pop declaration))
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>set</span>  (<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;all-the-icons-&#34;</span> (<span style=color:#a6e22e>plist-get</span> declaration :set))))
</span></span><span style=display:flex><span>          (face (<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;all-the-icons-&#34;</span> (<span style=color:#a6e22e>plist-get</span> declaration :color))))
</span></span><span style=display:flex><span>          (v-adjust (or (<span style=color:#a6e22e>plist-get</span> declaration :v-adjust) <span style=color:#ae81ff>0.01</span>)))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>apply</span> <span style=color:#a6e22e>set</span> <span style=color:#f92672>`</span>(<span style=color:#f92672>,</span>name :face <span style=color:#f92672>,</span>face :v-adjust <span style=color:#f92672>,</span>v-adjust))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +doct-iconify-capture-templates (groups)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Add declaration&#39;s :icon to each template group in GROUPS.&#34;</span>
</span></span><span style=display:flex><span>    (let ((templates (doct-flatten-lists-in groups)))
</span></span><span style=display:flex><span>      (setq doct-templates
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>mapcar</span> (lambda (template)
</span></span><span style=display:flex><span>                      (when-let* ((props (<span style=color:#a6e22e>nthcdr</span> (if (<span style=color:#a6e22e>=</span> (<span style=color:#a6e22e>length</span> template) <span style=color:#ae81ff>4</span>) <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span>) template))
</span></span><span style=display:flex><span>                                  (spec (<span style=color:#a6e22e>plist-get</span> (<span style=color:#a6e22e>plist-get</span> props :doct) :icon)))
</span></span><span style=display:flex><span>                        (setf (<span style=color:#a6e22e>nth</span> <span style=color:#ae81ff>1</span> template) (<span style=color:#a6e22e>concat</span> (+doct-icon-declaration-to-icon spec)
</span></span><span style=display:flex><span>                                                       <span style=color:#e6db74>&#34;\t&#34;</span>
</span></span><span style=display:flex><span>                                                       (<span style=color:#a6e22e>nth</span> <span style=color:#ae81ff>1</span> template))))
</span></span><span style=display:flex><span>                      template)
</span></span><span style=display:flex><span>                    templates))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq doct-after-conversion-functions <span style=color:#f92672>&#39;</span>(+doct-iconify-capture-templates))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun set-org-capture-templates ()
</span></span><span style=display:flex><span>    (setq org-capture-templates
</span></span><span style=display:flex><span>          (doct <span style=color:#f92672>`</span>((<span style=color:#e6db74>&#34;Personal todo&#34;</span> :keys <span style=color:#e6db74>&#34;t&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;checklist&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Inbox&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* TODO %?&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i %a&#34;</span>))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Personal note&#34;</span> :keys <span style=color:#e6db74>&#34;n&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;sticky-note-o&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Inbox&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* %?&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i %a&#34;</span>))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Email&#34;</span> :keys <span style=color:#e6db74>&#34;e&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;envelope&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;blue&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Inbox&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* TODO %^{type|reply to|contact} %\\3 %? ✉️&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;Send an email %^{urgancy|soon|ASAP|anon|at some point|eventually} to %^{recipiant}&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;about %^{topic}&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%U %i %a&#34;</span>))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Interesting&#34;</span> :keys <span style=color:#e6db74>&#34;i&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;eye&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;lcyan&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Interesting&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* [ ] %{desc}%? :%{i-type}:&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i %a&#34;</span>)
</span></span><span style=display:flex><span>                   :children ((<span style=color:#e6db74>&#34;Webpage&#34;</span> :keys <span style=color:#e6db74>&#34;w&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;globe&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>                               :desc <span style=color:#e6db74>&#34;%(org-cliplink-capture) &#34;</span>
</span></span><span style=display:flex><span>                               :i-type <span style=color:#e6db74>&#34;read:web&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Article&#34;</span> :keys <span style=color:#e6db74>&#34;a&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;file-text&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;yellow&#34;</span>)
</span></span><span style=display:flex><span>                               :desc <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                               :i-type <span style=color:#e6db74>&#34;read:reaserch&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Information&#34;</span> :keys <span style=color:#e6db74>&#34;i&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;info-circle&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;blue&#34;</span>)
</span></span><span style=display:flex><span>                               :desc <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                               :i-type <span style=color:#e6db74>&#34;read:info&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Idea&#34;</span> :keys <span style=color:#e6db74>&#34;I&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;bubble_chart&#34;</span> :set <span style=color:#e6db74>&#34;material&#34;</span> :color <span style=color:#e6db74>&#34;silver&#34;</span>)
</span></span><span style=display:flex><span>                               :desc <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                               :i-type <span style=color:#e6db74>&#34;idea&#34;</span>)))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Tasks&#34;</span> :keys <span style=color:#e6db74>&#34;k&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;inbox&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;yellow&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Tasks&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* TODO %? %^G%{extra}&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i %a&#34;</span>)
</span></span><span style=display:flex><span>                   :children ((<span style=color:#e6db74>&#34;General Task&#34;</span> :keys <span style=color:#e6db74>&#34;k&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;inbox&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;yellow&#34;</span>)
</span></span><span style=display:flex><span>                               :extra <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Task with deadline&#34;</span> :keys <span style=color:#e6db74>&#34;d&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;timer&#34;</span> :set <span style=color:#e6db74>&#34;material&#34;</span> :color <span style=color:#e6db74>&#34;orange&#34;</span> :v-adjust <span style=color:#ae81ff>-0.1</span>)
</span></span><span style=display:flex><span>                               :extra <span style=color:#e6db74>&#34;\nDEADLINE: %^{Deadline:}t&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Scheduled Task&#34;</span> :keys <span style=color:#e6db74>&#34;s&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;calendar&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;orange&#34;</span>)
</span></span><span style=display:flex><span>                               :extra <span style=color:#e6db74>&#34;\nSCHEDULED: %^{Start time:}t&#34;</span>)))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Project&#34;</span> :keys <span style=color:#e6db74>&#34;p&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;repo&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;silver&#34;</span>)
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Inbox&#34;</span>
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* %{time-or-todo} %?&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%a&#34;</span>)
</span></span><span style=display:flex><span>                   :file <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                   :custom (:time-or-todo <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>                   :children ((<span style=color:#e6db74>&#34;Project-local todo&#34;</span> :keys <span style=color:#e6db74>&#34;t&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;checklist&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;TODO&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-project-todo-file)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Project-local note&#34;</span> :keys <span style=color:#e6db74>&#34;n&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;sticky-note&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;yellow&#34;</span>)
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;%U&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-project-notes-file)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Project-local changelog&#34;</span> :keys <span style=color:#e6db74>&#34;c&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;list&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;blue&#34;</span>)
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;%U&#34;</span>
</span></span><span style=display:flex><span>                               :heading <span style=color:#e6db74>&#34;Unreleased&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-project-changelog-file)))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;\tCentralised project templates&#34;</span>
</span></span><span style=display:flex><span>                   :keys <span style=color:#e6db74>&#34;o&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* %{time-or-todo} %?&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%a&#34;</span>)
</span></span><span style=display:flex><span>                   :children ((<span style=color:#e6db74>&#34;Project todo&#34;</span>
</span></span><span style=display:flex><span>                               :keys <span style=color:#e6db74>&#34;t&#34;</span>
</span></span><span style=display:flex><span>                               :prepend <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;TODO&#34;</span>
</span></span><span style=display:flex><span>                               :heading <span style=color:#e6db74>&#34;Tasks&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-central-project-todo-file)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Project note&#34;</span>
</span></span><span style=display:flex><span>                               :keys <span style=color:#e6db74>&#34;n&#34;</span>
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;%U&#34;</span>
</span></span><span style=display:flex><span>                               :heading <span style=color:#e6db74>&#34;Notes&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-central-project-notes-file)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Project changelog&#34;</span>
</span></span><span style=display:flex><span>                               :keys <span style=color:#e6db74>&#34;c&#34;</span>
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;%U&#34;</span>
</span></span><span style=display:flex><span>                               :heading <span style=color:#e6db74>&#34;Unreleased&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-central-project-changelog-file)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (set-org-capture-templates)
</span></span><span style=display:flex><span>  (unless (display-graphic-p)
</span></span><span style=display:flex><span>    (add-hook <span style=color:#e6db74>&#39;server-after-make-frame-hook</span>
</span></span><span style=display:flex><span>              (defun org-capture-reinitialise-hook ()
</span></span><span style=display:flex><span>                (when (display-graphic-p)
</span></span><span style=display:flex><span>                  (set-org-capture-templates)
</span></span><span style=display:flex><span>                  (remove-hook <span style=color:#e6db74>&#39;server-after-make-frame-hook</span>
</span></span><span style=display:flex><span>                               <span style=color:#a6e22e>#&#39;</span>org-capture-reinitialise-hook))))))
</span></span></code></pre></div><p>It would also be nice to improve how the capture dialogue looks</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun org-capture-select-template-prettier (<span style=color:#66d9ef>&amp;optional</span> keys)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Select a capture template, in a prettier way than default
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Lisp programs can force the template by setting KEYS to a string.&#34;</span>
</span></span><span style=display:flex><span>  (let ((org-capture-templates
</span></span><span style=display:flex><span>         (or (org-contextualize-keys
</span></span><span style=display:flex><span>              (org-capture-upgrade-templates org-capture-templates)
</span></span><span style=display:flex><span>              org-capture-templates-contexts)
</span></span><span style=display:flex><span>             <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#e6db74>&#34;Task&#34;</span> entry (file+headline <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;Tasks&#34;</span>)
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;* TODO %?\n  %u\n  %a&#34;</span>)))))
</span></span><span style=display:flex><span>    (if keys
</span></span><span style=display:flex><span>        (or (<span style=color:#a6e22e>assoc</span> keys org-capture-templates)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>error</span> <span style=color:#e6db74>&#34;No capture template referred to by \&#34;%s\&#34; keys&#34;</span> keys))
</span></span><span style=display:flex><span>      (org-mks org-capture-templates
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#34;Select a capture template\n━━━━━━━━━━━━━━━━━━━━━━━━━&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#34;Template key: &#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#f92672>`</span>((<span style=color:#e6db74>&#34;q&#34;</span> <span style=color:#f92672>,</span>(<span style=color:#a6e22e>concat</span> (all-the-icons-octicon <span style=color:#e6db74>&#34;stop&#34;</span> :face <span style=color:#e6db74>&#39;all-the-icons-red</span> :v-adjust <span style=color:#ae81ff>0.01</span>) <span style=color:#e6db74>&#34;\tAbort&#34;</span>)))))))
</span></span><span style=display:flex><span>(advice-add <span style=color:#e6db74>&#39;org-capture-select-template</span> :override <span style=color:#a6e22e>#&#39;</span>org-capture-select-template-prettier)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun org-mks-pretty (table title <span style=color:#66d9ef>&amp;optional</span> prompt specials)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Select a member of an alist with multiple keys. Prettified.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TABLE is the alist which should contain entries where the car is a string.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>There should be two types of entries.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>1. prefix descriptions like (\&#34;a\&#34; \&#34;Description\&#34;)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   This indicates that </span><span style=color:#e6db74>`a&#39;</span><span style=color:#e6db74> is a prefix key for multi-letter selection, and
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   that there are entries following with keys like \&#34;ab\&#34;, \&#34;ax\&#34;…
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>2. Select-able members must have more than two elements, with the first
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   being the string of keys that lead to selecting it, and the second a
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   short description string of the item.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>The command will then make a temporary buffer listing all entries
</span></span></span><span style=display:flex><span><span style=color:#e6db74>that can be selected with a single key, and all the single key
</span></span></span><span style=display:flex><span><span style=color:#e6db74>prefixes.  When you press the key for a single-letter entry, it is selected.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>When you press a prefix key, the commands (and maybe further prefixes)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>under this key will be shown and offered for selection.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TITLE will be placed over the selection in the temporary buffer,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PROMPT will be used when prompting for a key.  SPECIALS is an
</span></span></span><span style=display:flex><span><span style=color:#e6db74>alist with (\&#34;key\&#34; \&#34;description\&#34;) entries.  When one of these
</span></span></span><span style=display:flex><span><span style=color:#e6db74>is selected, only the bare key is returned.&#34;</span>
</span></span><span style=display:flex><span>  (save-window-excursion
</span></span><span style=display:flex><span>    (let ((inhibit-quit <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>          (buffer (org-switch-to-buffer-other-window <span style=color:#e6db74>&#34;*Org Select*&#34;</span>))
</span></span><span style=display:flex><span>          (prompt (or prompt <span style=color:#e6db74>&#34;Select: &#34;</span>))
</span></span><span style=display:flex><span>          case-fold-search
</span></span><span style=display:flex><span>          current)
</span></span><span style=display:flex><span>      (unwind-protect
</span></span><span style=display:flex><span>          (catch <span style=color:#e6db74>&#39;exit</span>
</span></span><span style=display:flex><span>            (while <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>              (setq-local evil-normal-state-cursor (<span style=color:#a6e22e>list</span> <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>              (<span style=color:#a6e22e>erase-buffer</span>)
</span></span><span style=display:flex><span>              (<span style=color:#a6e22e>insert</span> title <span style=color:#e6db74>&#34;\n\n&#34;</span>)
</span></span><span style=display:flex><span>              (let ((des-keys <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>                    (allowed-keys <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\C-g&#34;</span>))
</span></span><span style=display:flex><span>                    (tab-alternatives <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\s&#34;</span> <span style=color:#e6db74>&#34;\t&#34;</span> <span style=color:#e6db74>&#34;\r&#34;</span>))
</span></span><span style=display:flex><span>                    (cursor-type <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>                <span style=color:#75715e>;; Populate allowed keys and descriptions keys</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>;; available with CURRENT selector.</span>
</span></span><span style=display:flex><span>                (let ((re (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;\\`%s\\(.\\)\\&#39;&#34;</span>
</span></span><span style=display:flex><span>                                  (if current (<span style=color:#a6e22e>regexp-quote</span> current) <span style=color:#e6db74>&#34;&#34;</span>)))
</span></span><span style=display:flex><span>                      (prefix (if current (<span style=color:#a6e22e>concat</span> current <span style=color:#e6db74>&#34; &#34;</span>) <span style=color:#e6db74>&#34;&#34;</span>)))
</span></span><span style=display:flex><span>                  (dolist (entry table)
</span></span><span style=display:flex><span>                    (pcase entry
</span></span><span style=display:flex><span>                      <span style=color:#75715e>;; Description.</span>
</span></span><span style=display:flex><span>                      (<span style=color:#f92672>`</span>(<span style=color:#f92672>,</span>(and key (pred (<span style=color:#a6e22e>string-match</span> re))) <span style=color:#f92672>,</span>desc)
</span></span><span style=display:flex><span>                       (let ((k (match-string <span style=color:#ae81ff>1</span> key)))
</span></span><span style=display:flex><span>                         (push k des-keys)
</span></span><span style=display:flex><span>                         <span style=color:#75715e>;; Keys ending in tab, space or RET are equivalent.</span>
</span></span><span style=display:flex><span>                         (if (<span style=color:#a6e22e>member</span> k tab-alternatives)
</span></span><span style=display:flex><span>                             (push <span style=color:#e6db74>&#34;\t&#34;</span> allowed-keys)
</span></span><span style=display:flex><span>                           (push k allowed-keys))
</span></span><span style=display:flex><span>                         (<span style=color:#a6e22e>insert</span> (<span style=color:#a6e22e>propertize</span> prefix <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;font-lock-comment-face</span>) (<span style=color:#a6e22e>propertize</span> k <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;bold</span>) (<span style=color:#a6e22e>propertize</span> <span style=color:#e6db74>&#34;›&#34;</span> <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;font-lock-comment-face</span>) <span style=color:#e6db74>&#34;  &#34;</span> desc <span style=color:#e6db74>&#34;…&#34;</span> <span style=color:#e6db74>&#34;\n&#34;</span>)))
</span></span><span style=display:flex><span>                      <span style=color:#75715e>;; Usable entry.</span>
</span></span><span style=display:flex><span>                      (<span style=color:#f92672>`</span>(<span style=color:#f92672>,</span>(and key (pred (<span style=color:#a6e22e>string-match</span> re))) <span style=color:#f92672>,</span>desc <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>_)
</span></span><span style=display:flex><span>                       (let ((k (match-string <span style=color:#ae81ff>1</span> key)))
</span></span><span style=display:flex><span>                         (<span style=color:#a6e22e>insert</span> (<span style=color:#a6e22e>propertize</span> prefix <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;font-lock-comment-face</span>) (<span style=color:#a6e22e>propertize</span> k <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;bold</span>) <span style=color:#e6db74>&#34;   &#34;</span> desc <span style=color:#e6db74>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>                         (push k allowed-keys)))
</span></span><span style=display:flex><span>                      (_ <span style=color:#66d9ef>nil</span>))))
</span></span><span style=display:flex><span>                <span style=color:#75715e>;; Insert special entries, if any.</span>
</span></span><span style=display:flex><span>                (when specials
</span></span><span style=display:flex><span>                  (<span style=color:#a6e22e>insert</span> <span style=color:#e6db74>&#34;─────────────────────────\n&#34;</span>)
</span></span><span style=display:flex><span>                  (pcase-dolist (<span style=color:#f92672>`</span>(<span style=color:#f92672>,</span>key <span style=color:#f92672>,</span>description) specials)
</span></span><span style=display:flex><span>                    (<span style=color:#a6e22e>insert</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;%s   %s\n&#34;</span> (<span style=color:#a6e22e>propertize</span> key <span style=color:#e6db74>&#39;face</span> <span style=color:#f92672>&#39;</span>(bold all-the-icons-red)) description))
</span></span><span style=display:flex><span>                    (push key allowed-keys)))
</span></span><span style=display:flex><span>                <span style=color:#75715e>;; Display UI and let user select an entry or</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>;; a sublevel prefix.</span>
</span></span><span style=display:flex><span>                (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>                (unless (<span style=color:#a6e22e>pos-visible-in-window-p</span> (<span style=color:#a6e22e>point-max</span>))
</span></span><span style=display:flex><span>                  (org-fit-window-to-buffer))
</span></span><span style=display:flex><span>                (let ((pressed (org--mks-read-key allowed-keys
</span></span><span style=display:flex><span>                                                  prompt
</span></span><span style=display:flex><span>                                                  (not (<span style=color:#a6e22e>pos-visible-in-window-p</span> (<span style=color:#a6e22e>1-</span> (<span style=color:#a6e22e>point-max</span>)))))))
</span></span><span style=display:flex><span>                  (setq current (<span style=color:#a6e22e>concat</span> current pressed))
</span></span><span style=display:flex><span>                  (cond
</span></span><span style=display:flex><span>                   ((<span style=color:#a6e22e>equal</span> pressed <span style=color:#e6db74>&#34;\C-g&#34;</span>) (<span style=color:#a6e22e>user-error</span> <span style=color:#e6db74>&#34;Abort&#34;</span>))
</span></span><span style=display:flex><span>                   <span style=color:#75715e>;; Selection is a prefix: open a new menu.</span>
</span></span><span style=display:flex><span>                   ((<span style=color:#a6e22e>member</span> pressed des-keys))
</span></span><span style=display:flex><span>                   <span style=color:#75715e>;; Selection matches an association: return it.</span>
</span></span><span style=display:flex><span>                   ((let ((entry (<span style=color:#a6e22e>assoc</span> current table)))
</span></span><span style=display:flex><span>                      (and entry (throw <span style=color:#e6db74>&#39;exit</span> entry))))
</span></span><span style=display:flex><span>                   <span style=color:#75715e>;; Selection matches a special entry: return the</span>
</span></span><span style=display:flex><span>                   <span style=color:#75715e>;; selection prefix.</span>
</span></span><span style=display:flex><span>                   ((<span style=color:#a6e22e>assoc</span> current specials) (throw <span style=color:#e6db74>&#39;exit</span> current))
</span></span><span style=display:flex><span>                   (<span style=color:#66d9ef>t</span> (<span style=color:#a6e22e>error</span> <span style=color:#e6db74>&#34;No entry available&#34;</span>)))))))
</span></span><span style=display:flex><span>        (when buffer (<span style=color:#a6e22e>kill-buffer</span> buffer))))))
</span></span><span style=display:flex><span>(advice-add <span style=color:#e6db74>&#39;org-mks</span> :override <span style=color:#a6e22e>#&#39;</span>org-mks-pretty)
</span></span></code></pre></div><p>The <a href=~/.emacs.d/bin/org-capture>org-capture bin</a> is rather nice, but I&rsquo;d be nicer with a smaller frame, and
no modeline.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setf (alist-get <span style=color:#e6db74>&#39;height</span> +org-capture-frame-parameters) <span style=color:#ae81ff>15</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>;; (alist-get &#39;name +org-capture-frame-parameters) &#34;❖ Capture&#34;) ;; ATM hardcoded in other places, so changing breaks stuff</span>
</span></span><span style=display:flex><span>(setq +org-capture-fn
</span></span><span style=display:flex><span>      (lambda ()
</span></span><span style=display:flex><span>        (interactive)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>set-window-parameter</span> <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#39;mode-line-format</span> <span style=color:#e6db74>&#39;none</span>)
</span></span><span style=display:flex><span>        (org-capture)))
</span></span></code></pre></div><h5 id=snippet-helpers>Snippet Helpers</h5><p>I often want to set <code>src-block</code> headers, and it&rsquo;s a pain to:</p><ul><li>type them out</li><li>remember what the accepted values are</li><li>oh, and specifying the same language again and again</li></ul><p>We can solve this in three steps:</p><ul><li>having one-letter snippets, conditioned on <code>(point)</code> being within a src header</li><li>creating a nice prompt showing accepted values and the current default</li><li>pre-filling the <code>src-block</code> language with the last language used</li></ul><p>For header args, the keys I&rsquo;ll use are:</p><ul><li><code>r</code> for <code>:results</code></li><li><code>e</code> for <code>:exports</code></li><li><code>v</code> for <code>:eval</code></li><li><code>s</code> for <code>:session</code></li><li><code>d</code> for <code>:dir</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +yas/org-src-header-p ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Determine whether </span><span style=color:#e6db74>`point&#39;</span><span style=color:#e6db74> is within a src-block header or header-args.&#34;</span>
</span></span><span style=display:flex><span>  (pcase (org-element-type (org-element-context))
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#39;src-block</span> (<span style=color:#a6e22e>&lt;</span> (<span style=color:#a6e22e>point</span>) <span style=color:#75715e>; before code part of the src-block</span>
</span></span><span style=display:flex><span>                   (save-excursion (<span style=color:#a6e22e>goto-char</span> (org-element-property :begin (org-element-context)))
</span></span><span style=display:flex><span>                                   (<span style=color:#a6e22e>forward-line</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                                   (<span style=color:#a6e22e>point</span>))))
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#39;inline-src-block</span> (<span style=color:#a6e22e>&lt;</span> (<span style=color:#a6e22e>point</span>) <span style=color:#75715e>; before code part of the inline-src-block</span>
</span></span><span style=display:flex><span>                          (save-excursion (<span style=color:#a6e22e>goto-char</span> (org-element-property :begin (org-element-context)))
</span></span><span style=display:flex><span>                                          (<span style=color:#a6e22e>search-forward</span> <span style=color:#e6db74>&#34;]{&#34;</span>)
</span></span><span style=display:flex><span>                                          (<span style=color:#a6e22e>point</span>))))
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#39;keyword</span> (string-match-p <span style=color:#e6db74>&#34;^header-args&#34;</span> (org-element-property :value (org-element-context))))))
</span></span></code></pre></div><p>Now let&rsquo;s write a function we can reference in YASnippets to produce a nice
interactive way to specify header arguments.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +yas/org-prompt-header-arg (arg question values)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Prompt the user to set ARG header property to one of VALUES with QUESTION.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>The default value is identified and indicated. If either default is selected,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>or no selection is made: nil is returned.&#34;</span>
</span></span><span style=display:flex><span>  (let* ((src-block-p (not (looking-back <span style=color:#e6db74>&#34;^#\\+property:[ \t]+header-args:.*&#34;</span> (<span style=color:#a6e22e>line-beginning-position</span>))))
</span></span><span style=display:flex><span>         (default
</span></span><span style=display:flex><span>           (or
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> arg
</span></span><span style=display:flex><span>                        (if src-block-p
</span></span><span style=display:flex><span>                            (<span style=color:#a6e22e>nth</span> <span style=color:#ae81ff>2</span> (org-babel-get-src-block-info <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>                          (org-babel-merge-params
</span></span><span style=display:flex><span>                           org-babel-default-header-args
</span></span><span style=display:flex><span>                           (let ((lang-headers
</span></span><span style=display:flex><span>                                  (<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;org-babel-default-header-args:&#34;</span>
</span></span><span style=display:flex><span>                                                  (+yas/org-src-lang)))))
</span></span><span style=display:flex><span>                             (when (<span style=color:#a6e22e>boundp</span> lang-headers) (<span style=color:#a6e22e>eval</span> lang-headers <span style=color:#66d9ef>t</span>)))))))
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;&#34;</span>))
</span></span><span style=display:flex><span>         <span style=color:#a6e22e>default-value</span>)
</span></span><span style=display:flex><span>    (setq values (<span style=color:#a6e22e>mapcar</span>
</span></span><span style=display:flex><span>                  (lambda (value)
</span></span><span style=display:flex><span>                    (if (string-match-p (<span style=color:#a6e22e>regexp-quote</span> value) default)
</span></span><span style=display:flex><span>                        (setq <span style=color:#a6e22e>default-value</span>
</span></span><span style=display:flex><span>                              (<span style=color:#a6e22e>concat</span> value <span style=color:#e6db74>&#34; &#34;</span>
</span></span><span style=display:flex><span>                                      (<span style=color:#a6e22e>propertize</span> <span style=color:#e6db74>&#34;(default)&#34;</span> <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;font-lock-doc-face</span>)))
</span></span><span style=display:flex><span>                      value))
</span></span><span style=display:flex><span>                  values))
</span></span><span style=display:flex><span>    (let ((selection (consult--read question values :default <span style=color:#a6e22e>default-value</span>)))
</span></span><span style=display:flex><span>      (unless (or (string-match-p <span style=color:#e6db74>&#34;(default)$&#34;</span> selection)
</span></span><span style=display:flex><span>                  (string= <span style=color:#e6db74>&#34;&#34;</span> selection))
</span></span><span style=display:flex><span>        selection))))
</span></span></code></pre></div><p>Finally, we fetch the language information for new source blocks.</p><p>Since we&rsquo;re getting this info, we might as well go a step further and also
provide the ability to determine the most popular language in the buffer that
doesn&rsquo;t have any <code>header-args</code> set for it (with <code>#+properties</code>).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +yas/org-src-lang ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Try to find the current language of the src/header at </span><span style=color:#e6db74>`point&#39;</span><span style=color:#e6db74>.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Return nil otherwise.&#34;</span>
</span></span><span style=display:flex><span>  (let ((context (org-element-context)))
</span></span><span style=display:flex><span>    (pcase (org-element-type context)
</span></span><span style=display:flex><span>      (<span style=color:#e6db74>&#39;src-block</span> (org-element-property :language context))
</span></span><span style=display:flex><span>      (<span style=color:#e6db74>&#39;inline-src-block</span> (org-element-property :language context))
</span></span><span style=display:flex><span>      (<span style=color:#e6db74>&#39;keyword</span> (when (<span style=color:#a6e22e>string-match</span> <span style=color:#e6db74>&#34;^header-args:\\([^ ]+\\)&#34;</span> (org-element-property :value context))
</span></span><span style=display:flex><span>                  (match-string <span style=color:#ae81ff>1</span> (org-element-property :value context)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +yas/org-last-src-lang ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Return the language of the last src-block, if it exists.&#34;</span>
</span></span><span style=display:flex><span>  (save-excursion
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>beginning-of-line</span>)
</span></span><span style=display:flex><span>    (when (<span style=color:#a6e22e>re-search-backward</span> <span style=color:#e6db74>&#34;^[ \t]*#\\+begin_src&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>      (org-element-property :language (org-element-context)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +yas/org-most-common-no-property-lang ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Find the lang with the most source blocks that has no global header-args, else nil.&#34;</span>
</span></span><span style=display:flex><span>  (let (src-langs header-langs)
</span></span><span style=display:flex><span>    (save-excursion
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>      (while (<span style=color:#a6e22e>re-search-forward</span> <span style=color:#e6db74>&#34;^[ \t]*#\\+begin_src&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (push (+yas/org-src-lang) src-langs))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>      (while (<span style=color:#a6e22e>re-search-forward</span> <span style=color:#e6db74>&#34;^[ \t]*#\\+property: +header-args&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (push (+yas/org-src-lang) header-langs)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (setq src-langs
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;car</span>
</span></span><span style=display:flex><span>                  <span style=color:#75715e>;; sort alist by frequency (desc.)</span>
</span></span><span style=display:flex><span>                  (<span style=color:#a6e22e>sort</span>
</span></span><span style=display:flex><span>                   <span style=color:#75715e>;; generate alist with form (value . frequency)</span>
</span></span><span style=display:flex><span>                   (cl-loop for (n <span style=color:#f92672>.</span> m) in (seq-group-by <span style=color:#a6e22e>#&#39;identity</span> src-langs)
</span></span><span style=display:flex><span>                            collect (<span style=color:#a6e22e>cons</span> n (<span style=color:#a6e22e>length</span> m)))
</span></span><span style=display:flex><span>                   (lambda (a b) (<span style=color:#a6e22e>&gt;</span> (<span style=color:#a6e22e>cdr</span> a) (<span style=color:#a6e22e>cdr</span> b))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>car</span> (cl-set-difference src-langs header-langs :test <span style=color:#a6e22e>#&#39;</span>string=))))
</span></span></code></pre></div><h5 id=translate-capital-keywords-to-lower-case>Translate capital keywords to lower case</h5><p>Everyone used to use <code>#+CAPITAL</code> keywords. Then people realised that <code>#+lowercase</code>
is actually both marginally easier and visually nicer, so now the capital
version is just used in the manual.</p><blockquote><p>Org is standardized on lower case. Uppercase is used in the manual as a poor
man&rsquo;s bold, and supported for historical reasons. &mdash; <a href=https://orgmode.org/list/87tuuw3n15.fsf@nicolasgoaziou.fr>Nicolas Goaziou</a></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +org-syntax-convert-keyword-case-to-lower ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Convert all #+KEYWORDS to #+keywords.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (save-excursion
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>    (let ((count <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>          (case-fold-search <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>      (while (<span style=color:#a6e22e>re-search-forward</span> <span style=color:#e6db74>&#34;^[ \t]*#\\+[A-Z_]+&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (unless (s-matches-p <span style=color:#e6db74>&#34;RESULTS&#34;</span> (match-string <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>replace-match</span> (<span style=color:#a6e22e>downcase</span> (match-string <span style=color:#ae81ff>0</span>)) <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>          (setq count (<span style=color:#a6e22e>1+</span> count))))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Replaced %d occurances&#34;</span> count))))
</span></span></code></pre></div><h5 id=org-notifier>Org notifier</h5><p>Add support for <a href=https://github.com/akhramov/org-wild-notifier.el><code>org-wild-notifier</code></a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-wild-notifier
</span></span><span style=display:flex><span>  :hook (org-load <span style=color:#f92672>.</span> org-wild-notifier-mode)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq org-wild-notifier-alert-time <span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>60</span> <span style=color:#ae81ff>30</span>)))
</span></span></code></pre></div><h5 id=org-menu>Org menu</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-menu
</span></span><span style=display:flex><span>  :commands (org-menu)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (map! :localleader
</span></span><span style=display:flex><span>        :map org-mode-map
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Org menu&#34;</span> <span style=color:#e6db74>&#34;M&#34;</span> <span style=color:#a6e22e>#&#39;</span>org-menu))
</span></span></code></pre></div><h5 id=lsp-in-src-blocks>LSP in <code>src</code> blocks</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(cl-defmacro +lsp-org-babel-enable (lang)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Support LANG in org source code block.&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; (setq centaur-lsp &#39;lsp-mode)</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>cl-check-type</span> lang <span style=color:#a6e22e>stringp</span>)
</span></span><span style=display:flex><span>  (let* ((edit-pre (<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;org-babel-edit-prep:%s&#34;</span> lang)))
</span></span><span style=display:flex><span>         (intern-pre (<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;lsp--%s&#34;</span> (<span style=color:#a6e22e>symbol-name</span> edit-pre)))))
</span></span><span style=display:flex><span>    <span style=color:#f92672>`</span>(progn
</span></span><span style=display:flex><span>       (defun <span style=color:#f92672>,</span>intern-pre (info)
</span></span><span style=display:flex><span>         (let ((file-name (-&gt;&gt; info caddr (alist-get :file))))
</span></span><span style=display:flex><span>           (unless file-name
</span></span><span style=display:flex><span>             (setq file-name (make-temp-file <span style=color:#e6db74>&#34;babel-lsp-&#34;</span>)))
</span></span><span style=display:flex><span>           (setq <span style=color:#a6e22e>buffer-file-name</span> file-name)
</span></span><span style=display:flex><span>           (lsp-deferred)))
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>put</span> <span style=color:#e6db74>&#39;,intern-pre</span> <span style=color:#e6db74>&#39;function-documentation</span>
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;Enable lsp-mode in the buffer of org source block (%s).&#34;</span>
</span></span><span style=display:flex><span>                    (<span style=color:#a6e22e>upcase</span> <span style=color:#f92672>,</span>lang)))
</span></span><span style=display:flex><span>       (if (<span style=color:#a6e22e>fboundp</span> <span style=color:#e6db74>&#39;,edit-pre</span>)
</span></span><span style=display:flex><span>           (advice-add <span style=color:#e6db74>&#39;,edit-pre</span> :after <span style=color:#e6db74>&#39;,intern-pre</span>)
</span></span><span style=display:flex><span>         (progn
</span></span><span style=display:flex><span>           (defun <span style=color:#f92672>,</span>edit-pre (info)
</span></span><span style=display:flex><span>             (<span style=color:#f92672>,</span>intern-pre info))
</span></span><span style=display:flex><span>           (<span style=color:#a6e22e>put</span> <span style=color:#e6db74>&#39;,edit-pre</span> <span style=color:#e6db74>&#39;function-documentation</span>
</span></span><span style=display:flex><span>                (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;Prepare local buffer environment for org source block (%s).&#34;</span>
</span></span><span style=display:flex><span>                        (<span style=color:#a6e22e>upcase</span> <span style=color:#f92672>,</span>lang))))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar +org-babel-lang-list
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;go&#34;</span> <span style=color:#e6db74>&#34;python&#34;</span> <span style=color:#e6db74>&#34;ipython&#34;</span> <span style=color:#e6db74>&#34;bash&#34;</span> <span style=color:#e6db74>&#34;sh&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(dolist (lang +org-babel-lang-list)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>eval</span> <span style=color:#f92672>`</span>(+lsp-org-babel-enable <span style=color:#f92672>,</span>lang)))
</span></span></code></pre></div><h4 id=custom-links>Custom links</h4><h5 id=sub-figures>Sub-figures</h5><p>This defines a new link type <code>subfig</code> to enable exporting sub-figures to LaTeX,
taken form <a href=https://orgmode.org/list/87mty1an66.fsf@posteo.net/>&ldquo;Export subfigures to LaTeX (and HTML)&rdquo;</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(org-link-set-parameters
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;subfig&#34;</span>
</span></span><span style=display:flex><span> :follow (lambda (file) (find-file file))
</span></span><span style=display:flex><span> :face <span style=color:#f92672>&#39;</span>(:foreground <span style=color:#e6db74>&#34;chocolate&#34;</span> :weight bold :underline <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span> :display <span style=color:#e6db74>&#39;full</span>
</span></span><span style=display:flex><span> :export
</span></span><span style=display:flex><span> (lambda (file desc backend)
</span></span><span style=display:flex><span>   (when (<span style=color:#a6e22e>eq</span> backend <span style=color:#e6db74>&#39;latex</span>)
</span></span><span style=display:flex><span>     (if (<span style=color:#a6e22e>string-match</span> <span style=color:#e6db74>&#34;&gt;(\\(.+\\))&#34;</span> desc)
</span></span><span style=display:flex><span>         (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;\\begin{subfigure}[b]&#34;</span>
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#34;\\caption{&#34;</span> (replace-regexp-in-string <span style=color:#e6db74>&#34;\s+&gt;(.+)&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> desc) <span style=color:#e6db74>&#34;}&#34;</span>
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#34;\\includegraphics&#34;</span> <span style=color:#e6db74>&#34;[&#34;</span> (match-string <span style=color:#ae81ff>1</span> desc) <span style=color:#e6db74>&#34;]&#34;</span> <span style=color:#e6db74>&#34;{&#34;</span> file <span style=color:#e6db74>&#34;}&#34;</span> <span style=color:#e6db74>&#34;\\end{subfigure}&#34;</span>)
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;\\begin{subfigure}\\includegraphics{%s}\\end{subfigure}&#34;</span> desc file)))))
</span></span></code></pre></div><p>Example of usage:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#+caption: Lorem impsum dolor
</span></span><span style=display:flex><span>#+attr_latex: :options \centering
</span></span><span style=display:flex><span>#+begin_figure
</span></span><span style=display:flex><span>[[subfig:img1.jpg][Caption of img1 &gt;(width=.3\textwidth)]]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[[subfig:img2.jpg][Caption of img2 &gt;(width=.3\textwidth)]]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[[subfig:img3.jpg][Caption of img3 &gt;(width=.6\textwidth)]]
</span></span><span style=display:flex><span>#+end_figure
</span></span></code></pre></div><h5 id=latex-inline-markup>LaTeX inline markup</h5><p>Needs to make a ?, with this <a href=https://orgmode.org/worg/org-tutorials/org-latex-export.html>hack</a> you can write
<code>[[latex:textsc][Some text]]</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(org-add-link-type
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;latex&#34;</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span> (lambda (path desc <span style=color:#a6e22e>format</span>)
</span></span><span style=display:flex><span>   (cond
</span></span><span style=display:flex><span>    ((<span style=color:#a6e22e>eq</span> <span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#39;html</span>)
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;&lt;span class=\&#34;%s\&#34;&gt;%s&lt;/span&gt;&#34;</span> path desc))
</span></span><span style=display:flex><span>    ((<span style=color:#a6e22e>eq</span> <span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#39;latex</span>)
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;\\%s{%s}&#34;</span> path desc)))))
</span></span></code></pre></div><h4 id=visuals>Visuals</h4><p>Here I try to do two things: improve the styling of the various documents, via
font changes etc., and also propagate colours from the current theme.</p><h5 id=font-display>Font display</h5><h6 id=headings>Headings</h6><p>Let&rsquo;s make the title and the headings a bit bigger:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(custom-set-faces!
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(org-document-title :height <span style=color:#ae81ff>1.2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(custom-set-faces!
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-1 :weight extra-bold :height <span style=color:#ae81ff>1.25</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-2 :weight bold :height <span style=color:#ae81ff>1.15</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-3 :weight bold :height <span style=color:#ae81ff>1.12</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-4 :weight semi-bold :height <span style=color:#ae81ff>1.09</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-5 :weight semi-bold :height <span style=color:#ae81ff>1.06</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-6 :weight semi-bold :height <span style=color:#ae81ff>1.03</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-8 :weight semi-bold)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-9 :weight semi-bold))
</span></span></code></pre></div><h6 id=deadlines>Deadlines</h6><p>It seems reasonable to have deadlines in the error face when they&rsquo;re passed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-agenda-deadline-faces
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((<span style=color:#ae81ff>1.001</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>        (<span style=color:#ae81ff>1.000</span> <span style=color:#f92672>.</span> org-warning)
</span></span><span style=display:flex><span>        (<span style=color:#ae81ff>0.500</span> <span style=color:#f92672>.</span> org-upcoming-deadline)
</span></span><span style=display:flex><span>        (<span style=color:#ae81ff>0.000</span> <span style=color:#f92672>.</span> org-upcoming-distant-deadline)))
</span></span></code></pre></div><h6 id=font-styling>Font styling</h6><p>We can then have quote blocks stand out a bit more by making them <em>italic</em>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-fontify-quote-and-verse-blocks <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><p>While <code>org-hide-emphasis-markers</code> is very nice, it can sometimes make edits which
occur at the border a bit more fiddley. We can improve this situation without
sacrificing visual amenities with the <code>org-appear</code> package.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-appear
</span></span><span style=display:flex><span>  :hook (org-mode <span style=color:#f92672>.</span> org-appear-mode)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq org-appear-autoemphasis <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-appear-autosubmarkers <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-appear-autolinks <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; for proper first-time setup, `org-appear--set-elements&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; needs to be run after other hooks have acted.</span>
</span></span><span style=display:flex><span>  (run-at-time <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#a6e22e>#&#39;</span>org-appear--set-elements))
</span></span></code></pre></div><h6 id=inline-blocks>Inline blocks</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-inline-src-prettify-results <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;⟨&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⟩&#34;</span>)
</span></span><span style=display:flex><span>      doom-themes-org-fontify-special-tags <span style=color:#66d9ef>nil</span>)
</span></span></code></pre></div><h5 id=org-modern>Org Modern</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-modern
</span></span><span style=display:flex><span>  :hook (org-mode <span style=color:#f92672>.</span> org-modern-mode)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq org-modern-star <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;◉&#34;</span> <span style=color:#e6db74>&#34;○&#34;</span> <span style=color:#e6db74>&#34;◈&#34;</span> <span style=color:#e6db74>&#34;◇&#34;</span> <span style=color:#e6db74>&#34;✳&#34;</span> <span style=color:#e6db74>&#34;◆&#34;</span> <span style=color:#e6db74>&#34;✸&#34;</span> <span style=color:#e6db74>&#34;▶&#34;</span>)
</span></span><span style=display:flex><span>        org-modern-table-vertical <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>        org-modern-table-horizontal <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        org-modern-list <span style=color:#f92672>&#39;</span>((<span style=color:#ae81ff>43</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;➤&#34;</span>) (<span style=color:#ae81ff>45</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;–&#34;</span>) (<span style=color:#ae81ff>42</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;•&#34;</span>))
</span></span><span style=display:flex><span>        org-modern-footnote (<span style=color:#a6e22e>cons</span> <span style=color:#66d9ef>nil</span> (cadr org-script-display))
</span></span><span style=display:flex><span>        org-modern-priority <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-modern-block <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-modern-block-fringe <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        org-modern-horizontal-rule <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-modern-keyword
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#39;</span>((<span style=color:#66d9ef>t</span>                     <span style=color:#f92672>.</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;title&#34;</span>               <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;𝙏&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;subtitle&#34;</span>            <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;𝙩&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;author&#34;</span>              <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;𝘼&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;email&#34;</span>               <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;@&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;date&#34;</span>                <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;𝘿&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;lastmod&#34;</span>             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;✎&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;property&#34;</span>            <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;☸&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;options&#34;</span>             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⌥&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;startup&#34;</span>             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⏻&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;macro&#34;</span>               <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;𝓜&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;bind&#34;</span>                <span style=color:#f92672>.</span> <span style=color:#f92672>#(</span><span style=color:#e6db74>&#34;&#34;</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>1</span> (display (raise <span style=color:#ae81ff>-0.1</span>))))
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;bibliography&#34;</span>        <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;print_bibliography&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#f92672>#(</span><span style=color:#e6db74>&#34;&#34;</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>1</span> (display (raise <span style=color:#ae81ff>-0.1</span>))))
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;print_bibliography&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#f92672>#(</span><span style=color:#e6db74>&#34;&#34;</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>1</span> (display (raise <span style=color:#ae81ff>-0.1</span>))))
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;cite_export&#34;</span>         <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⮭&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;print_glossary&#34;</span>      <span style=color:#f92672>.</span> <span style=color:#f92672>#(</span><span style=color:#e6db74>&#34;ᴬᶻ&#34;</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>1</span> (display (raise <span style=color:#ae81ff>-0.1</span>))))
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;glossary_sources&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#f92672>#(</span><span style=color:#e6db74>&#34;&#34;</span> <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>1</span> (display (raise <span style=color:#ae81ff>-0.14</span>))))
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;export_file_name&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⇒&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;include&#34;</span>             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⇤&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;setupfile&#34;</span>           <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⇐&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;html_head&#34;</span>           <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🅷&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;html&#34;</span>                <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🅗&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;latex_class&#34;</span>         <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🄻&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;latex_class_options&#34;</span> <span style=color:#f92672>.</span> <span style=color:#f92672>#(</span><span style=color:#e6db74>&#34;🄻&#34;</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> (display (raise <span style=color:#ae81ff>-0.14</span>))))
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;latex_header&#34;</span>        <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🅻&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;latex_header_extra&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🅻⁺&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;latex&#34;</span>               <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🅛&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;beamer_theme&#34;</span>        <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🄱&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;beamer_color_theme&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#f92672>#(</span><span style=color:#e6db74>&#34;🄱&#34;</span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>2</span> (display (raise <span style=color:#ae81ff>-0.12</span>))))
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;beamer_font_theme&#34;</span>   <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🄱𝐀&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;beamer_header&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🅱&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;beamer&#34;</span>              <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🅑&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;attr_latex&#34;</span>          <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🄛&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;attr_html&#34;</span>           <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🄗&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;attr_org&#34;</span>            <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⒪&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;name&#34;</span>                <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⁍&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;header&#34;</span>              <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;›&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;caption&#34;</span>             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;☰&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;RESULTS&#34;</span>             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🠶&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;language&#34;</span>            <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;𝙇&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;hugo_base_dir&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;𝐇&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;latex_compiler&#34;</span>      <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⟾&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;results&#34;</span>             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;🠶&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;filetags&#34;</span>            <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;#&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;created&#34;</span>             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;⏱&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;export_select_tags&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;✔&#34;</span>)
</span></span><span style=display:flex><span>          (<span style=color:#e6db74>&#34;export_exclude_tags&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;❌&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Change faces</span>
</span></span><span style=display:flex><span>  (custom-set-faces! <span style=color:#f92672>&#39;</span>(org-modern-tag :inherit (region org-modern-label)))
</span></span><span style=display:flex><span>  (custom-set-faces! <span style=color:#f92672>&#39;</span>(org-modern-statistics :inherit org-checkbox-statistics-todo)))
</span></span></code></pre></div><p>Not let&rsquo;s remove the overlap between the substitutions we set here and those
that Doom applies via <code>:ui ligatures</code> and <code>:lang org</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(when (modulep! :ui ligatures)
</span></span><span style=display:flex><span>  (defadvice! +org-init-appearance-h--no-ligatures-a ()
</span></span><span style=display:flex><span>    :after <span style=color:#a6e22e>#&#39;</span>+org-init-appearance-h
</span></span><span style=display:flex><span>    (set-ligatures! <span style=color:#e6db74>&#39;org-mode</span>
</span></span><span style=display:flex><span>                    :name <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                    :src_block <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                    :src_block_end <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                    :quote <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                    :quote_end <span style=color:#66d9ef>nil</span>)))
</span></span></code></pre></div><p>We’ll bind this to <code>O</code> on the <code>org-mode</code> localleader, and manually apply a <a href=https://github.com/Townk/org-ol-tree/pull/13>PR
recognising the pgtk window system</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-ol-tree
</span></span><span style=display:flex><span>  :commands org-ol-tree
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq org-ol-tree-ui-icon-set
</span></span><span style=display:flex><span>        (if (and (display-graphic-p)
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>fboundp</span> <span style=color:#e6db74>&#39;all-the-icons-material</span>))
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;all-the-icons</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#39;unicode</span>))
</span></span><span style=display:flex><span>  (org-ol-tree-ui--update-icon-set))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :localleader
</span></span><span style=display:flex><span>      :map org-mode-map
</span></span><span style=display:flex><span>      :desc <span style=color:#e6db74>&#34;Outline&#34;</span> <span style=color:#e6db74>&#34;O&#34;</span> <span style=color:#a6e22e>#&#39;</span>org-ol-tree)
</span></span></code></pre></div><h5 id=image-previews>Image previews</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar +org-responsive-image-percentage <span style=color:#ae81ff>0.4</span>)
</span></span><span style=display:flex><span>(defvar +org-responsive-image-width-limits <span style=color:#f92672>&#39;</span>(<span style=color:#ae81ff>400</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>700</span>)) <span style=color:#75715e>;; &#39;(min-width . max-width)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +org--responsive-image-h ()
</span></span><span style=display:flex><span>  (when (<span style=color:#a6e22e>eq</span> major-mode <span style=color:#e6db74>&#39;org-mode</span>)
</span></span><span style=display:flex><span>    (setq org-image-actual-width
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>max</span> (<span style=color:#a6e22e>car</span> +org-responsive-image-width-limits)
</span></span><span style=display:flex><span>               (<span style=color:#a6e22e>min</span> (<span style=color:#a6e22e>cdr</span> +org-responsive-image-width-limits)
</span></span><span style=display:flex><span>                    (<span style=color:#a6e22e>truncate</span> (<span style=color:#a6e22e>*</span> (<span style=color:#a6e22e>window-pixel-width</span>) +org-responsive-image-percentage)))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;window-configuration-change-hook</span> <span style=color:#a6e22e>#&#39;</span>+org--responsive-image-h)
</span></span></code></pre></div><h5 id=list-bullet-sequence>List bullet sequence</h5><p>I think it makes sense to have list bullets change with depth</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-list-demote-modify-bullet
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;+&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;-&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;-&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;+&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;*&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;+&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;1.&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;a.&#34;</span>)))
</span></span></code></pre></div><h5 id=symbols>Symbols</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Org styling, hide markup etc.</span>
</span></span><span style=display:flex><span>(setq org-hide-emphasis-markers <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      org-pretty-entities <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      org-ellipsis <span style=color:#e6db74>&#34; ↩&#34;</span>
</span></span><span style=display:flex><span>      org-hide-leading-stars <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; org-priority-highest ?A</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; org-priority-lowest ?E</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; org-priority-faces</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; &#39;((?A . &#39;all-the-icons-red)</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;;   (?B . &#39;all-the-icons-orange)</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;;   (?C . &#39;all-the-icons-yellow)</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;;   (?D . &#39;all-the-icons-green)</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>;;   (?E . &#39;all-the-icons-blue)))</span>
</span></span></code></pre></div><h5 id=latex-fragments>LaTeX fragments</h5><h6 id=prettier-highlighting>Prettier highlighting</h6><p>First off, we want those fragments to look good.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-highlight-latex-and-related <span style=color:#f92672>&#39;</span>(native script entities))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(require <span style=color:#e6db74>&#39;org-src</span>)
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;org-src-block-faces</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;latex&#34;</span> (:inherit default :extend <span style=color:#66d9ef>t</span>)))
</span></span></code></pre></div><h6 id=prettier-rendering>Prettier rendering</h6><p>Since we can, instead of making the background color match the <code>default</code> face,
let&rsquo;s make it transparent.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-format-latex-options
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>plist-put</span> org-format-latex-options :background <span style=color:#e6db74>&#34;Transparent&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Can be dvipng, dvisvgm, imagemagick</span>
</span></span><span style=display:flex><span>(setq org-preview-latex-default-process <span style=color:#e6db74>&#39;dvisvgm</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Define a function to set the format latex scale (to be reused in hooks)</span>
</span></span><span style=display:flex><span>(defun +org-format-latex-set-scale (scale)
</span></span><span style=display:flex><span>  (setq org-format-latex-options (<span style=color:#a6e22e>plist-put</span> org-format-latex-options :scale scale)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Set the default scale</span>
</span></span><span style=display:flex><span>(+org-format-latex-set-scale <span style=color:#ae81ff>1.4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Increase scale in Zen mode</span>
</span></span><span style=display:flex><span>(when (modulep! :ui zen)
</span></span><span style=display:flex><span>  (add-hook! <span style=color:#e6db74>&#39;writeroom-mode-enable-hook</span> (+org-format-latex-set-scale <span style=color:#ae81ff>2.0</span>))
</span></span><span style=display:flex><span>  (add-hook! <span style=color:#e6db74>&#39;writeroom-mode-disable-hook</span> (+org-format-latex-set-scale <span style=color:#ae81ff>1.4</span>)))
</span></span></code></pre></div><h6 id=better-equation-numbering>Better equation numbering</h6><p>Numbered equations all have (1) as the number for fragments with vanilla
<code>org-mode</code>. This code (from <a href=https://github.com/jkitchin/scimax>scimax</a>) injects the correct numbers into the previews,
so they look good.</p><blockquote><p>This hack is not properly working right now!, it seems to work only with <code>align</code>
blocks. <strong>NEEDS INVESTIGATION.</strong></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +parse-the-fun (str)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Parse the LaTeX environment STR.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Return an AST with newlines counts in each level.&#34;</span>
</span></span><span style=display:flex><span>  (let (ast)
</span></span><span style=display:flex><span>    (with-temp-buffer
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>insert</span> str)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>      (while (<span style=color:#a6e22e>re-search-forward</span>
</span></span><span style=display:flex><span>              (rx <span style=color:#e6db74>&#34;\\&#34;</span>
</span></span><span style=display:flex><span>                  (group (or <span style=color:#e6db74>&#34;\\&#34;</span> <span style=color:#e6db74>&#34;begin&#34;</span> <span style=color:#e6db74>&#34;end&#34;</span> <span style=color:#e6db74>&#34;nonumber&#34;</span>))
</span></span><span style=display:flex><span>                  (zero-or-one <span style=color:#e6db74>&#34;{&#34;</span> (group (zero-or-more not-newline)) <span style=color:#e6db74>&#34;}&#34;</span>))
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (let ((cmd (match-string <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>              (env (match-string <span style=color:#ae81ff>2</span>)))
</span></span><span style=display:flex><span>          (cond ((string= cmd <span style=color:#e6db74>&#34;begin&#34;</span>)
</span></span><span style=display:flex><span>                 (push (<span style=color:#a6e22e>list</span> :env (<span style=color:#a6e22e>intern</span> env)) ast))
</span></span><span style=display:flex><span>                ((string= cmd <span style=color:#e6db74>&#34;\\&#34;</span>)
</span></span><span style=display:flex><span>                 (let ((curr (pop ast)))
</span></span><span style=display:flex><span>                   (push (<span style=color:#a6e22e>plist-put</span> curr :newline (<span style=color:#a6e22e>1+</span> (or (<span style=color:#a6e22e>plist-get</span> curr :newline) <span style=color:#ae81ff>0</span>))) ast)))
</span></span><span style=display:flex><span>                ((string= cmd <span style=color:#e6db74>&#34;nonumber&#34;</span>)
</span></span><span style=display:flex><span>                 (let ((curr (pop ast)))
</span></span><span style=display:flex><span>                   (push (<span style=color:#a6e22e>plist-put</span> curr :nonumber (<span style=color:#a6e22e>1+</span> (or (<span style=color:#a6e22e>plist-get</span> curr :nonumber) <span style=color:#ae81ff>0</span>))) ast)))
</span></span><span style=display:flex><span>                ((string= cmd <span style=color:#e6db74>&#34;end&#34;</span>)
</span></span><span style=display:flex><span>                 (let ((child (pop ast))
</span></span><span style=display:flex><span>                       (parent (pop ast)))
</span></span><span style=display:flex><span>                   (push (<span style=color:#a6e22e>plist-put</span> parent :childs (<span style=color:#a6e22e>cons</span> child (<span style=color:#a6e22e>plist-get</span> parent :childs))) ast)))))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>plist-get</span> (<span style=color:#a6e22e>car</span> ast) :childs)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +scimax-org-renumber-environment (orig-func <span style=color:#66d9ef>&amp;rest</span> args)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;A function to inject numbers in LaTeX fragment previews.&#34;</span>
</span></span><span style=display:flex><span>  (let ((results <span style=color:#f92672>&#39;</span>())
</span></span><span style=display:flex><span>        (counter <span style=color:#ae81ff>-1</span>))
</span></span><span style=display:flex><span>    (setq results
</span></span><span style=display:flex><span>          (cl-loop for (begin <span style=color:#f92672>.</span> env) in
</span></span><span style=display:flex><span>                   (org-element-map (org-element-parse-buffer) <span style=color:#e6db74>&#39;latex-environment</span>
</span></span><span style=display:flex><span>                     (lambda (env)
</span></span><span style=display:flex><span>                       (<span style=color:#a6e22e>cons</span>
</span></span><span style=display:flex><span>                        (org-element-property :begin env)
</span></span><span style=display:flex><span>                        (org-element-property :value env))))
</span></span><span style=display:flex><span>                   collect
</span></span><span style=display:flex><span>                   (cond
</span></span><span style=display:flex><span>                    ((and (<span style=color:#a6e22e>string-match</span> <span style=color:#e6db74>&#34;\\\\begin{equation}&#34;</span> env)
</span></span><span style=display:flex><span>                          (not (<span style=color:#a6e22e>string-match</span> <span style=color:#e6db74>&#34;\\\\tag{&#34;</span> env)))
</span></span><span style=display:flex><span>                     (cl-incf counter)
</span></span><span style=display:flex><span>                     (<span style=color:#a6e22e>cons</span> begin counter))
</span></span><span style=display:flex><span>                    ((<span style=color:#a6e22e>string-match</span> <span style=color:#e6db74>&#34;\\\\begin{align}&#34;</span> env)
</span></span><span style=display:flex><span>                     (cl-incf counter)
</span></span><span style=display:flex><span>                     (let ((p (<span style=color:#a6e22e>car</span> (+parse-the-fun env))))
</span></span><span style=display:flex><span>                       <span style=color:#75715e>;; Parse the `env&#39;, count new lines in the align env as equations, unless</span>
</span></span><span style=display:flex><span>                       (cl-incf counter (<span style=color:#a6e22e>-</span> (or (<span style=color:#a6e22e>plist-get</span> p :newline) <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>                                           (or (<span style=color:#a6e22e>plist-get</span> p :nonumber) <span style=color:#ae81ff>0</span>))))
</span></span><span style=display:flex><span>                     (<span style=color:#a6e22e>cons</span> begin counter))
</span></span><span style=display:flex><span>                    (<span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                     (<span style=color:#a6e22e>cons</span> begin <span style=color:#66d9ef>nil</span>)))))
</span></span><span style=display:flex><span>    (when-let ((number (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> (<span style=color:#a6e22e>point</span>) results))))
</span></span><span style=display:flex><span>      (setf (<span style=color:#a6e22e>car</span> args)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>concat</span>
</span></span><span style=display:flex><span>             (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;\\setcounter{equation}{%s}\n&#34;</span> number)
</span></span><span style=display:flex><span>             (<span style=color:#a6e22e>car</span> args)))))
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>apply</span> orig-func args))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +scimax-toggle-latex-equation-numbering (<span style=color:#66d9ef>&amp;optional</span> enable)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Toggle whether LaTeX fragments are numbered.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (if (or enable (not (<span style=color:#a6e22e>get</span> <span style=color:#e6db74>&#39;+scimax-org-renumber-environment</span> <span style=color:#e6db74>&#39;enabled</span>)))
</span></span><span style=display:flex><span>      (progn
</span></span><span style=display:flex><span>        (advice-add <span style=color:#e6db74>&#39;org-create-formula-image</span> :around <span style=color:#a6e22e>#&#39;</span>+scimax-org-renumber-environment)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>put</span> <span style=color:#e6db74>&#39;+scimax-org-renumber-environment</span> <span style=color:#e6db74>&#39;enabled</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;LaTeX numbering enabled.&#34;</span>))
</span></span><span style=display:flex><span>    (advice-remove <span style=color:#e6db74>&#39;org-create-formula-image</span> <span style=color:#a6e22e>#&#39;</span>+scimax-org-renumber-environment)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>put</span> <span style=color:#e6db74>&#39;+scimax-org-renumber-environment</span> <span style=color:#e6db74>&#39;enabled</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;LaTeX numbering disabled.&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +scimax-org-inject-latex-fragment (orig-func <span style=color:#66d9ef>&amp;rest</span> args)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Advice function to inject latex code before and/or after the equation in a latex fragment.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>You can use this to set \\mathversion{bold} for example to make
</span></span></span><span style=display:flex><span><span style=color:#e6db74>it bolder. The way it works is by defining
</span></span></span><span style=display:flex><span><span style=color:#e6db74>:latex-fragment-pre-body and/or :latex-fragment-post-body in the
</span></span></span><span style=display:flex><span><span style=color:#e6db74>variable </span><span style=color:#e6db74>`org-format-latex-options&#39;</span><span style=color:#e6db74>. These strings will then be
</span></span></span><span style=display:flex><span><span style=color:#e6db74>injected before and after the code for the fragment before it is
</span></span></span><span style=display:flex><span><span style=color:#e6db74>made into an image.&#34;</span>
</span></span><span style=display:flex><span>  (setf (<span style=color:#a6e22e>car</span> args)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>concat</span>
</span></span><span style=display:flex><span>         (or (<span style=color:#a6e22e>plist-get</span> org-format-latex-options :latex-fragment-pre-body) <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>         (<span style=color:#a6e22e>car</span> args)
</span></span><span style=display:flex><span>         (or (<span style=color:#a6e22e>plist-get</span> org-format-latex-options :latex-fragment-post-body) <span style=color:#e6db74>&#34;&#34;</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>apply</span> orig-func args))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +scimax-toggle-inject-latex ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Toggle whether you can insert latex in fragments.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (if (not (<span style=color:#a6e22e>get</span> <span style=color:#e6db74>&#39;+scimax-org-inject-latex-fragment</span> <span style=color:#e6db74>&#39;enabled</span>))
</span></span><span style=display:flex><span>      (progn
</span></span><span style=display:flex><span>        (advice-add <span style=color:#e6db74>&#39;org-create-formula-image</span> :around <span style=color:#a6e22e>#&#39;</span>+scimax-org-inject-latex-fragment)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>put</span> <span style=color:#e6db74>&#39;+scimax-org-inject-latex-fragment</span> <span style=color:#e6db74>&#39;enabled</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Inject latex enabled&#34;</span>))
</span></span><span style=display:flex><span>    (advice-remove <span style=color:#e6db74>&#39;org-create-formula-image</span> <span style=color:#a6e22e>#&#39;</span>+scimax-org-inject-latex-fragment)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>put</span> <span style=color:#e6db74>&#39;+scimax-org-inject-latex-fragment</span> <span style=color:#e6db74>&#39;enabled</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Inject latex disabled&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Enable renumbering by default</span>
</span></span><span style=display:flex><span>(+scimax-toggle-latex-equation-numbering <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h6 id=fragtog>Fragtog</h6><p>Hook <code>org-fragtog-mode</code> to <code>org-mode</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-fragtog
</span></span><span style=display:flex><span>  :hook (org-mode <span style=color:#f92672>.</span> org-fragtog-mode))
</span></span></code></pre></div><h5 id=org-plot>Org plot</h5><p>We can use some variables in <code>org-plot</code> to use the current doom theme
colors.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org-plot
</span></span><span style=display:flex><span>  (defun org-plot/generate-theme (_type)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Use the current Doom theme colours to generate a GnuPlot preamble.&#34;</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>fgt = \&#34;textcolor rgb &#39;%s&#39;\&#34;  # foreground text
</span></span></span><span style=display:flex><span><span style=color:#e6db74>fgat = \&#34;textcolor rgb &#39;%s&#39;\&#34; # foreground alt text
</span></span></span><span style=display:flex><span><span style=color:#e6db74>fgl = \&#34;linecolor rgb &#39;%s&#39;\&#34;  # foreground line
</span></span></span><span style=display:flex><span><span style=color:#e6db74>fgal = \&#34;linecolor rgb &#39;%s&#39;\&#34; # foreground alt line
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># foreground colors
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set border lc rgb &#39;%s&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74># change text colors of  tics
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set xtics @fgt
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set ytics @fgt
</span></span></span><span style=display:flex><span><span style=color:#e6db74># change text colors of labels
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set title @fgt
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set xlabel @fgt
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set ylabel @fgt
</span></span></span><span style=display:flex><span><span style=color:#e6db74># change a text color of key
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set key @fgt
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># line styles
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set linetype 1 lw 2 lc rgb &#39;%s&#39; # red
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set linetype 2 lw 2 lc rgb &#39;%s&#39; # blue
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set linetype 3 lw 2 lc rgb &#39;%s&#39; # green
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set linetype 4 lw 2 lc rgb &#39;%s&#39; # magenta
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set linetype 5 lw 2 lc rgb &#39;%s&#39; # orange
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set linetype 6 lw 2 lc rgb &#39;%s&#39; # yellow
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set linetype 7 lw 2 lc rgb &#39;%s&#39; # teal
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set linetype 8 lw 2 lc rgb &#39;%s&#39; # violet
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># palette
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set palette maxcolors 8
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set palette defined ( 0 &#39;%s&#39;,\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>1 &#39;%s&#39;,\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>2 &#39;%s&#39;,\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>3 &#39;%s&#39;,\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>4 &#39;%s&#39;,\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>5 &#39;%s&#39;,\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>6 &#39;%s&#39;,\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>7 &#39;%s&#39; )
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;fg</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;fg-alt</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;fg</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;fg-alt</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;fg</span>)
</span></span><span style=display:flex><span>            <span style=color:#75715e>;; colours</span>
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;red</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;blue</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;green</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;magenta</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;orange</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;yellow</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;teal</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;violet</span>)
</span></span><span style=display:flex><span>            <span style=color:#75715e>;; duplicated</span>
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;red</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;blue</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;green</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;magenta</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;orange</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;yellow</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;teal</span>)
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;violet</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun org-plot/gnuplot-term-properties (_type)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;background rgb &#39;%s&#39; size 1050,650&#34;</span>
</span></span><span style=display:flex><span>            (doom-color <span style=color:#e6db74>&#39;bg</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq org-plot/gnuplot-script-preamble <span style=color:#a6e22e>#&#39;</span>org-plot/generate-theme
</span></span><span style=display:flex><span>        org-plot/gnuplot-term-extra <span style=color:#a6e22e>#&#39;</span>org-plot/gnuplot-term-properties))
</span></span></code></pre></div><h5 id=large-tables>Large tables</h5><p>Use <em><a href=https://github.com/misohena/phscroll>Partial Horizontal Scroll</a></em> to display long tables without breaking them.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-phscroll
</span></span><span style=display:flex><span>  :hook (org-mode <span style=color:#f92672>.</span> org-phscroll-mode))
</span></span></code></pre></div><h4 id=bibliography>Bibliography</h4><h5 id=bibtex>BibTeX</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq bibtex-completion-bibliography +my/biblio-libraries-list
</span></span><span style=display:flex><span>      bibtex-completion-library-path +my/biblio-storage-list
</span></span><span style=display:flex><span>      bibtex-completion-notes-path +my/biblio-notes-path
</span></span><span style=display:flex><span>      bibtex-completion-notes-template-multiple-files <span style=color:#e6db74>&#34;* ${author-or-editor}, ${title}, ${journal}, (${year}) :${=type=}: \n\nSee [[cite:&amp;${=key=}]]\n&#34;</span>
</span></span><span style=display:flex><span>      bibtex-completion-additional-search-fields <span style=color:#f92672>&#39;</span>(keywords)
</span></span><span style=display:flex><span>      bibtex-completion-display-formats
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((article       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;${=has-pdf=:1}${=has-note=:1} ${year:4} ${author:36} ${title:*} ${journal:40}&#34;</span>)
</span></span><span style=display:flex><span>        (inbook        <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;${=has-pdf=:1}${=has-note=:1} ${year:4} ${author:36} ${title:*} Chapter ${chapter:32}&#34;</span>)
</span></span><span style=display:flex><span>        (incollection  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;${=has-pdf=:1}${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}&#34;</span>)
</span></span><span style=display:flex><span>        (inproceedings <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;${=has-pdf=:1}${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#66d9ef>t</span>             <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;${=has-pdf=:1}${=has-note=:1} ${year:4} ${author:36} ${title:*}&#34;</span>))
</span></span><span style=display:flex><span>      bibtex-completion-pdf-open-function
</span></span><span style=display:flex><span>      (lambda (fpath)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>call-process</span> <span style=color:#e6db74>&#34;open&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>nil</span> fpath)))
</span></span></code></pre></div><h5 id=org-bib>Org-bib</h5><p>A mode to work with annotated bibliography in Org-Mode. See <a href=https://github.com/rougier/org-bib-mode>the repo</a> for an
example.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-bib
</span></span><span style=display:flex><span>  :commands (org-bib-mode))
</span></span></code></pre></div><h5 id=org-cite>Org-cite</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! oc
</span></span><span style=display:flex><span>  (setq org-cite-csl-styles-dir +my/biblio-styles-path)
</span></span><span style=display:flex><span>        <span style=color:#75715e>;; org-cite-global-bibliography +my/biblio-libraries-list)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +org-ref-to-org-cite ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Simple conversion of org-ref citations to org-cite syntax.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (save-excursion
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>      (while (<span style=color:#a6e22e>re-search-forward</span> <span style=color:#e6db74>&#34;\\[cite\\(.*\\):\\([^]]*\\)\\]&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (let* ((old (<span style=color:#a6e22e>substring</span> (match-string <span style=color:#ae81ff>0</span>) <span style=color:#ae81ff>1</span> (<span style=color:#a6e22e>1-</span> (<span style=color:#a6e22e>length</span> (match-string <span style=color:#ae81ff>0</span>)))))
</span></span><span style=display:flex><span>               (new (s-replace <span style=color:#e6db74>&#34;&amp;&#34;</span> <span style=color:#e6db74>&#34;@&#34;</span> old)))
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Replaced citation %s with %s&#34;</span> old new)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>replace-match</span> new))))))
</span></span></code></pre></div><h5 id=citar>Citar</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! citar
</span></span><span style=display:flex><span>  (setq citar-library-paths +my/biblio-storage-list
</span></span><span style=display:flex><span>        citar-notes-paths  (<span style=color:#a6e22e>list</span> +my/biblio-notes-path)
</span></span><span style=display:flex><span>        citar-bibliography  +my/biblio-libraries-list
</span></span><span style=display:flex><span>        citar-symbol-separator <span style=color:#e6db74>&#34;  &#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (when (display-graphic-p)
</span></span><span style=display:flex><span>    (setq citar-symbols
</span></span><span style=display:flex><span>          <span style=color:#f92672>`</span>((file <span style=color:#f92672>,</span>(all-the-icons-octicon <span style=color:#e6db74>&#34;file-pdf&#34;</span>      :face <span style=color:#e6db74>&#39;error</span>) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34; &#34;</span>)
</span></span><span style=display:flex><span>            (note <span style=color:#f92672>,</span>(all-the-icons-octicon <span style=color:#e6db74>&#34;file-text&#34;</span>     :face <span style=color:#e6db74>&#39;warning</span>) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34; &#34;</span>)
</span></span><span style=display:flex><span>            (link <span style=color:#f92672>,</span>(all-the-icons-octicon <span style=color:#e6db74>&#34;link-external&#34;</span> :face <span style=color:#e6db74>&#39;org-link</span>) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34; &#34;</span>)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(use-package! citar-org-roam
</span></span><span style=display:flex><span>  :after citar org-roam
</span></span><span style=display:flex><span>  :no-require
</span></span><span style=display:flex><span>  :config (citar-org-roam-mode)
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Modified form: https://jethrokuan.github.io/org-roam-guide/</span>
</span></span><span style=display:flex><span>  (defun +org-roam-node-from-cite (entry-key)
</span></span><span style=display:flex><span>    (interactive (<span style=color:#a6e22e>list</span> (citar-select-ref)))
</span></span><span style=display:flex><span>    (let ((title (citar-format--entry
</span></span><span style=display:flex><span>                  <span style=color:#e6db74>&#34;${author editor} (${date urldate}) :: ${title}&#34;</span>
</span></span><span style=display:flex><span>                  (citar-get-entry entry-key))))
</span></span><span style=display:flex><span>      (org-roam-capture- :templates
</span></span><span style=display:flex><span>                         <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;r&#34;</span> <span style=color:#e6db74>&#34;reference&#34;</span> plain
</span></span><span style=display:flex><span>                            <span style=color:#e6db74>&#34;%?&#34;</span>
</span></span><span style=display:flex><span>                            :if-new (file+head <span style=color:#e6db74>&#34;references/${citekey}.org&#34;</span>
</span></span><span style=display:flex><span>                                               <span style=color:#e6db74>&#34;:properties:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>:roam_refs: [cite:@${citekey}]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>🔚
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#+title: ${title}\n&#34;</span>)
</span></span><span style=display:flex><span>                            :immediate-finish <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                            :unnarrowed <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>                         :info (<span style=color:#a6e22e>list</span> :citekey entry-key)
</span></span><span style=display:flex><span>                         :node (org-roam-node-create :title title)
</span></span><span style=display:flex><span>                         :props <span style=color:#f92672>&#39;</span>(:finalize find-file)))))
</span></span></code></pre></div><h4 id=exporting>Exporting</h4><h5 id=general-settings>General settings</h5><p>By default, Org only exports the first three levels of headings as <em>headings</em>, the
rest is considered as paragraphs. Let&rsquo;s increase this to 5 levels.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-export-headline-levels <span style=color:#ae81ff>5</span>)
</span></span></code></pre></div><p>Let&rsquo;s make use of the <code>:ignore:</code> tag from <code>ox-extra</code>, which provides a way to ignore
exporting a heading, while exporting the content residing under it (different
from <code>:noexport:</code>).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(require <span style=color:#e6db74>&#39;ox-extra</span>)
</span></span><span style=display:flex><span>(ox-extras-activate <span style=color:#f92672>&#39;</span>(ignore-headlines))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-export-creator-string
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;Made with Emacs %s and Org %s&#34;</span> emacs-version (org-release)))
</span></span></code></pre></div><h5 id=latex-export>LaTeX export</h5><h6 id=compiling>Compiling</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; `org-latex-compilers&#39; contains a list of possible values for the `%latex&#39; argument.</span>
</span></span><span style=display:flex><span>(setq org-latex-pdf-process
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;latexmk -shell-escape -pdf -quiet -f -%latex -interaction=nonstopmode -output-directory=%o %f&#34;</span>))
</span></span></code></pre></div><h6 id=org-latex-packages>Org LaTeX packages</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; &#39;svg&#39; package depends on inkscape, imagemagik and ghostscript</span>
</span></span><span style=display:flex><span>(when (+all (<span style=color:#a6e22e>mapcar</span> <span style=color:#e6db74>&#39;executable-find</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;inkscape&#34;</span> <span style=color:#e6db74>&#34;magick&#34;</span> <span style=color:#e6db74>&#34;gs&#34;</span>)))
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#e6db74>&#39;org-latex-packages-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;svg&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;org-latex-packages-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;svgnames&#34;</span> <span style=color:#e6db74>&#34;xcolor&#34;</span>))
</span></span><span style=display:flex><span><span style=color:#75715e>;; (add-to-list &#39;org-latex-packages-alist &#39;(&#34;&#34; &#34;fontspec&#34;)) ;; for xelatex</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (add-to-list &#39;org-latex-packages-alist &#39;(&#34;utf8&#34; &#34;inputenc&#34;))</span>
</span></span></code></pre></div><h6 id=export-pdfs-with-syntax-highlighting>Export PDFs with syntax highlighting</h6><p>This is for code syntax highlighting in export. You need to use <code>-shell-escape</code>
with latex, and install the <code>python-pygments</code> package.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Should be configured per document, as a local variable</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (setq org-latex-listings &#39;minted)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (add-to-list &#39;org-latex-packages-alist &#39;(&#34;&#34; &#34;minted&#34;))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Default `minted` options, can be overwritten in file/dir locals</span>
</span></span><span style=display:flex><span>(setq org-latex-minted-options
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;frame&#34;</span>         <span style=color:#e6db74>&#34;lines&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;fontsize&#34;</span>      <span style=color:#e6db74>&#34;\\footnotesize&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;tabsize&#34;</span>       <span style=color:#e6db74>&#34;2&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;breaklines&#34;</span>    <span style=color:#e6db74>&#34;true&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;breakanywhere&#34;</span> <span style=color:#e6db74>&#34;true&#34;</span>) <span style=color:#75715e>;; break anywhere, no just on spaces</span>
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;style&#34;</span>         <span style=color:#e6db74>&#34;default&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;bgcolor&#34;</span>       <span style=color:#e6db74>&#34;GhostWhite&#34;</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;linenos&#34;</span>       <span style=color:#e6db74>&#34;true&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; Link some org-mode blocks languages to lexers supported by minted</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; via (pygmentize), you can see supported lexers by running this command</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; in a terminal: `pygmentize -L lexers&#39;</span>
</span></span><span style=display:flex><span>(dolist (pair <span style=color:#f92672>&#39;</span>((ipython    <span style=color:#e6db74>&#34;python&#34;</span>)
</span></span><span style=display:flex><span>                (jupyter    <span style=color:#e6db74>&#34;python&#34;</span>)
</span></span><span style=display:flex><span>                (scheme     <span style=color:#e6db74>&#34;scheme&#34;</span>)
</span></span><span style=display:flex><span>                (lisp-data  <span style=color:#e6db74>&#34;lisp&#34;</span>)
</span></span><span style=display:flex><span>                (conf-unix  <span style=color:#e6db74>&#34;unixconfig&#34;</span>)
</span></span><span style=display:flex><span>                (conf-space <span style=color:#e6db74>&#34;unixconfig&#34;</span>)
</span></span><span style=display:flex><span>                (authinfo   <span style=color:#e6db74>&#34;unixconfig&#34;</span>)
</span></span><span style=display:flex><span>                (gdb-script <span style=color:#e6db74>&#34;unixconfig&#34;</span>)
</span></span><span style=display:flex><span>                (conf-toml  <span style=color:#e6db74>&#34;yaml&#34;</span>)
</span></span><span style=display:flex><span>                (conf       <span style=color:#e6db74>&#34;ini&#34;</span>)
</span></span><span style=display:flex><span>                (gitconfig  <span style=color:#e6db74>&#34;ini&#34;</span>)
</span></span><span style=display:flex><span>                (systemd    <span style=color:#e6db74>&#34;ini&#34;</span>)))
</span></span><span style=display:flex><span>  (unless (<span style=color:#a6e22e>member</span> pair org-latex-minted-langs)
</span></span><span style=display:flex><span>    (add-to-list <span style=color:#e6db74>&#39;org-latex-minted-langs</span> pair)))
</span></span></code></pre></div><h6 id=class-templates>Class templates</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! ox-latex
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;org-latex-classes</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;scr-article&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#34;\\documentclass{scrartcl}&#34;</span>
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\section{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsection{%s}&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsubsection{%s}&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\paragraph{%s}&#34;</span>     <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subparagraph{%s}&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;org-latex-classes</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;lettre&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#34;\\documentclass{lettre}&#34;</span>
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\section{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsection{%s}&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsubsection{%s}&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\paragraph{%s}&#34;</span>     <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subparagraph{%s}&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;org-latex-classes</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;blank&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#34;[NO-DEFAULT-PACKAGES]\n[NO-PACKAGES]\n[EXTRA]&#34;</span>
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\section{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsection{%s}&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsubsection{%s}&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\paragraph{%s}&#34;</span>     <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subparagraph{%s}&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;org-latex-classes</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;IEEEtran&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#34;\\documentclass{IEEEtran}&#34;</span>
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\section{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsection{%s}&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsubsection{%s}&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\paragraph{%s}&#34;</span>     <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subparagraph{%s}&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;org-latex-classes</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;ieeeconf&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#34;\\documentclass{ieeeconf}&#34;</span>
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\section{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsection{%s}&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsubsection{%s}&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\paragraph{%s}&#34;</span>     <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subparagraph{%s}&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;org-latex-classes</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;sagej&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#34;\\documentclass{sagej}&#34;</span>
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\section{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsection{%s}&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsubsection{%s}&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\paragraph{%s}&#34;</span>     <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subparagraph{%s}&#34;</span>  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;org-latex-classes</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;thesis&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#34;\\documentclass[11pt]{book}&#34;</span>
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\chapter{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\chapter*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\section{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsection{%s}&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsubsection{%s}&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\paragraph{%s}&#34;</span>     <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\paragraph*{%s}&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;org-latex-classes</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;thesis-fr&#34;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#34;\\documentclass[french,12pt,a4paper]{book}&#34;</span>
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\chapter{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\chapter*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\section{%s}&#34;</span>       <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\section*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsection{%s}&#34;</span>    <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\subsubsection{%s}&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style=display:flex><span>     (<span style=color:#e6db74>&#34;\\paragraph{%s}&#34;</span>     <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\paragraph*{%s}&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq org-latex-default-class <span style=color:#e6db74>&#34;article&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; org-latex-tables-booktabs t</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; org-latex-reference-command &#34;\\cref{%s}&#34;)</span>
</span></span></code></pre></div><h6 id=export-multi-files-org-documents>Export multi-files Org documents</h6><p>Let&rsquo;s say we have a multi-files document, with <code>main.org</code> as the entry point.
Supposing a document with a structure like this:</p><figure><img src=/ox-hugo/multi-files-org.svg alt="Figure 1: Example of a multi-files document structure"><figcaption><p>Figure 1: Example of a multi-files document structure</p></figcaption></figure><p>Files <code>intro.org</code>, <code>chap1.org</code>, &mldr; are included in <code>main.org</code> using the Org command
. In such a setup, we will spend most of our time
writing in a chapter files, and not the <code>main.org</code>, where when want to export the
document, we would need to open the top-level file <code>main.org</code> before exporting.</p><p>A quick solution is <strong>to admit the following convention</strong>:</p><blockquote><p>If a file named <code>main.org</code> is present beside any other Org file, it should be
considered as the entry point; and whenever we export to PDF (from any of the
Org files like: <code>intro.org</code>, <code>chap1.org</code>, &mldr;), we automatically jump to the
<code>main.org</code>, and run the export there.</p></blockquote><p>This can be achieved by adding an Emacs-Lisp <em>advice</em> around the
<code>(org-latex-export-to-pdf)</code> to switch to <code>main.org</code> (if it exists) before
running the export.</p><p>You can also set the variable <code>+org-export-to-pdf-main-file</code> to the main file, in
<code>.dir-locals.el</code> or as a file local variable.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar +org-export-to-pdf-main-file <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;The main (entry point) Org file for a multi-files document.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(advice-add
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;org-latex-export-to-pdf</span> :around
</span></span><span style=display:flex><span> (lambda (orig-fn <span style=color:#66d9ef>&amp;rest</span> orig-args)
</span></span><span style=display:flex><span>   (<span style=color:#a6e22e>message</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;PDF exported to: %s.&#34;</span>
</span></span><span style=display:flex><span>    (let ((main-file (or (bound-and-true-p +org-export-to-pdf-main-file) <span style=color:#e6db74>&#34;main.org&#34;</span>)))
</span></span><span style=display:flex><span>      (if (<span style=color:#a6e22e>file-exists-p</span> (<span style=color:#a6e22e>expand-file-name</span> main-file))
</span></span><span style=display:flex><span>          (with-current-buffer (find-file-noselect main-file)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>apply</span> orig-fn orig-args))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>apply</span> orig-fn orig-args))))))
</span></span></code></pre></div><h5 id=hugo>Hugo</h5><p>Update files with last modified date, when <code>#+lastmod:</code> is available</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq time-stamp-active <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      time-stamp-start  <span style=color:#e6db74>&#34;#\\+lastmod:[ \t]*&#34;</span>
</span></span><span style=display:flex><span>      time-stamp-end    <span style=color:#e6db74>&#34;$&#34;</span>
</span></span><span style=display:flex><span>      time-stamp-format <span style=color:#e6db74>&#34;%04Y-%02m-%02d&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;before-save-hook</span> <span style=color:#e6db74>&#39;time-stamp</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>(setq org-hugo-auto-set-lastmod <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h3 id=text-editing>Text editing</h3><h4 id=plain-text>Plain text</h4><p>It&rsquo;s nice to see ANSI color codes displayed. However, until Emacs 28 it&rsquo;s not
possible to do this without modifying the buffer, so let&rsquo;s condition this block
on that.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! text-mode
</span></span><span style=display:flex><span>  (add-hook! <span style=color:#e6db74>&#39;text-mode-hook</span>
</span></span><span style=display:flex><span>    (unless (derived-mode-p <span style=color:#e6db74>&#39;org-mode</span>)
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; Apply ANSI color codes</span>
</span></span><span style=display:flex><span>      (with-silent-modifications
</span></span><span style=display:flex><span>        (ansi-color-apply-on-region (<span style=color:#a6e22e>point-min</span>) (<span style=color:#a6e22e>point-max</span>) <span style=color:#66d9ef>t</span>)))))
</span></span></code></pre></div><h4 id=academic-phrases>Academic phrases</h4><p>When writing your academic paper, you might get stuck trying to find the right
phrase that captures your intention. This package tries to alleviate that
problem by presenting you with a list of phrases organized by the topic or by
the paper section that you are writing. This package has around 600 phrases so
far.</p><p>This is based on the book titled &ldquo;English for Writing Research - Papers Useful
Phrases&rdquo;.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! academic-phrases
</span></span><span style=display:flex><span>  :commands (academic-phrases
</span></span><span style=display:flex><span>             academic-phrases-by-section))
</span></span></code></pre></div><h4 id=quarto>Quarto</h4><p>Integration of <a href=https://quarto.org/>Quarto</a> in Emacs.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! quarto-mode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! quarto-mode
</span></span><span style=display:flex><span>  :when QUARTO-P)
</span></span></code></pre></div><h4 id=french-apostrophes>French apostrophes</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +helper--in-buffer-replace (old new)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Replace OLD with NEW in the current buffer.&#34;</span>
</span></span><span style=display:flex><span>  (save-excursion
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>    (let ((case-fold-search <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>          (cnt <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span>      (while (<span style=color:#a6e22e>re-search-forward</span> old <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>replace-match</span> new)
</span></span><span style=display:flex><span>        (setq cnt (<span style=color:#a6e22e>1+</span> cnt)))
</span></span><span style=display:flex><span>      cnt)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun +helper-clear-frenchy-ponctuations ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Replace french apostrophes (’) by regular quotes (&#39;).&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (let ((chars <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;&#34;</span>) (<span style=color:#e6db74>&#34;’&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;&#39;&#34;</span>)))
</span></span><span style=display:flex><span>        (cnt <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span>    (dolist (pair chars)
</span></span><span style=display:flex><span>      (setq cnt (<span style=color:#a6e22e>+</span> cnt (+helper--in-buffer-replace (<span style=color:#a6e22e>car</span> pair) (<span style=color:#a6e22e>cdr</span> pair)))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Replaced %d matche(s).&#34;</span> cnt)))
</span></span></code></pre></div><h4 id=yanking-multi-lines-paragraphs>Yanking multi-lines paragraphs</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun +helper-paragraphized-yank ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Copy, then remove newlines and Org styling (/*_~).&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (copy-region-as-kill <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>  (with-temp-buffer
</span></span><span style=display:flex><span>    (yank)
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Remove newlines, and Org styling (/*_~)</span>
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>    (let ((case-fold-search <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>      (while (<span style=color:#a6e22e>re-search-forward</span> <span style=color:#e6db74>&#34;[\n/*_~]&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>replace-match</span> (if (s-matches-p (match-string <span style=color:#ae81ff>0</span>) <span style=color:#e6db74>&#34;\n&#34;</span>) <span style=color:#e6db74>&#34; &#34;</span> <span style=color:#e6db74>&#34;&#34;</span>) <span style=color:#66d9ef>t</span>)))
</span></span><span style=display:flex><span>    (kill-region (<span style=color:#a6e22e>point-min</span>) (<span style=color:#a6e22e>point-max</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :localleader
</span></span><span style=display:flex><span>      :map (org-mode-map markdown-mode-map latex-mode-map text-mode-map)
</span></span><span style=display:flex><span>      :desc <span style=color:#e6db74>&#34;Paragraphized yank&#34;</span> <span style=color:#e6db74>&#34;y&#34;</span> <span style=color:#a6e22e>#&#39;</span>+helper-paragraphized-yank)
</span></span></code></pre></div><h2 id=system-configuration>System configuration</h2><h3 id=mime-types>Mime types</h3><h4 id=org-mode-files>Org mode files</h4><p>Org mode isn&rsquo;t recognized as its own mime type by default, but that can easily
be changed with the following file. For system-wide changes try
<code>/usr/share/mime/packages/org.xml</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;mime-info</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#39;http://www.freedesktop.org/standards/shared-mime-info&#39;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;mime-type</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;text/org&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;comment&gt;</span>Emacs Org-mode File<span style=color:#f92672>&lt;/comment&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;glob</span> <span style=color:#a6e22e>pattern=</span><span style=color:#e6db74>&#34;*.org&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;alias</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;text/org&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/mime-type&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/mime-info&gt;</span>
</span></span></code></pre></div><p>What&rsquo;s nice is that Papirus <a href=https://github.com/PapirusDevelopmentTeam/papirus-icon-theme/commit/a10fb7f2423d5e30b9c4477416ccdc93c4f3849d>now</a> has an icon for <code>text/org</code>. One simply needs to
refresh their mime database:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>update-mime-database ~/.local/share/mime
</span></span></code></pre></div><p>Then set Emacs as the default editor:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>xdg-mime default emacs-client.desktop text/org
</span></span></code></pre></div><h4 id=registering-org-protocol>Registering <code>org-protocol://</code></h4><p>The recommended method of registering a protocol is by registering a desktop
application, which seems reasonable.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cfg data-lang=cfg><span style=display:flex><span><span style=color:#66d9ef>[Desktop Entry]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Name</span><span style=color:#f92672>=</span><span style=color:#e6db74>Emacs Org-Protocol</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Exec</span><span style=color:#f92672>=</span><span style=color:#e6db74>emacsclient %u</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>/home/hacko/.doom.d/assets/org-mode.svg</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#e6db74>Application</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Terminal</span><span style=color:#f92672>=</span><span style=color:#e6db74>false</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>MimeType</span><span style=color:#f92672>=</span><span style=color:#e6db74>x-scheme-handler/org-protocol</span>
</span></span></code></pre></div><p>To associate <code>org-protocol://</code> links with the desktop file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>xdg-mime default org-protocol.desktop x-scheme-handler/org-protocol
</span></span></code></pre></div><h4 id=configuring-chrome-brave>Configuring Chrome/Brave</h4><p>As specified in the <a href=https://www.orgroam.com/manual.html#Org_002droam-Protocol>official documentation</a>, we would like to invoke the
<code>org-protocol://</code> without confirmation. To do this, we need to add this system-wide configuration.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>read -p <span style=color:#e6db74>&#34;Do you want to set Chrome/Brave to show the &#39;Always open ...&#39; checkbox, to be used with the &#39;org-protocol://&#39; registration? [Y | N]: &#34;</span> INSTALL_CONFIRM
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span>$INSTALL_CONFIRM<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Y&#34;</span> <span style=color:#f92672>]]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  sudo mkdir -p /etc/opt/chrome/policies/managed/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  sudo tee /etc/opt/chrome/policies/managed/external_protocol_dialog.json &gt; /dev/null <span style=color:#e6db74>&lt;&lt;&#39;EOF&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;ExternalProtocolDialogShowAlwaysOpenCheckbox&#34;: true
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  sudo chmod <span style=color:#ae81ff>644</span> /etc/opt/chrome/policies/managed/external_protocol_dialog.json
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><p>Then add a bookmarklet in your browser with this code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>javascript</span><span style=color:#f92672>:</span><span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;org-protocol://roam-ref?template=r&amp;ref=&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>+</span> encodeURIComponent(<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span>)
</span></span><span style=display:flex><span>    <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&amp;title=&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>+</span> encodeURIComponent(document.<span style=color:#a6e22e>title</span>)
</span></span><span style=display:flex><span>    <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;&amp;body=&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>+</span> encodeURIComponent(window.<span style=color:#a6e22e>getSelection</span>())
</span></span></code></pre></div><h3 id=git>Git</h3><h4 id=git-diffs>Git diffs</h4><p>Based on this <a href=https://gist.github.com/ruediger/5647207>gist</a> and <a href=https://protesilaos.com/codelog/2021-01-26-git-diff-hunk-elisp-org/>this article</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cfg data-lang=cfg><span style=display:flex><span><span style=color:#a6e22e>*.tex                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>tex</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.bib                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>bibtex</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.{c,h,c++,h++,cc,hh,cpp,hpp} diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>cpp</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.m                           diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>matlab</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.py                          diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>python</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.rb                          diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>ruby</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.php                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.pl                          diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>perl</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.{html,xhtml}                diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>html</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.f                           diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>fortran</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.{el,lisp,scm}               diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>lisp</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.r                           diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>rstats</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.texi*                       diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>texinfo</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.org                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>org</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.rs                          diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>rust</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.odt                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>odt</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.odp                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>libreoffice</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.ods                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>libreoffice</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.doc                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>doc</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.xls                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>xls</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.ppt                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>ppt</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.docx                        diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>docx</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.xlsx                        diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>xlsx</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.pptx                        diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>pptx</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.rtf                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>rtf</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.{png,jpg,jpeg,gif}          diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>exif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.pdf                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>pdf</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.djvu                        diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>djvu</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.epub                        diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>pandoc</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.chm                         diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>tika</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.mhtml?                      diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>tika</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.{class,jar}                 diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>tika</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>*.{rar,7z,zip,apk}            diff</span><span style=color:#f92672>=</span><span style=color:#e6db74>tika</span>
</span></span></code></pre></div><p>Then adding some regular expressions for it to <code>~/.config/git/config</code>, with some
tools to view diffs on binary files.</p><pre tabindex=0><code class=language-gitconfig data-lang=gitconfig># ====== TEXT FORMATS ======
[diff &#34;org&#34;]
  xfuncname = &#34;^(\\*+ +.*)$&#34;

[diff &#34;lisp&#34;]
  xfuncname = &#34;^(\\(.*)$&#34;

[diff &#34;rstats&#34;]
  xfuncname = &#34;^([a-zA-z.]+ &lt;- function.*)$&#34;

[diff &#34;texinfo&#34;]
# from http://git.savannah.gnu.org/gitweb/?p=coreutils.git;a=blob;f=.gitattributes;h=c3b2926c78c939d94358cc63d051a70d38cfea5d;hb=HEAD
  xfuncname = &#34;^@node[ \t][ \t]*\\([^,][^,]*\\)&#34;

[diff &#34;rust&#34;]
  xfuncname = &#34;^[ \t]*(pub|)[ \t]*((fn|struct|enum|impl|trait|mod)[^;]*)$&#34;

# ====== BINARY FORMATS ======
[diff &#34;pdf&#34;]
  binary = true
# textconv = pdfinfo
# textconv = sh -c &#39;pdftotext &#34;$@&#34; -&#39; # sudo apt install pdftotext
  textconv = sh -c &#39;pdftotext -layout &#34;$0&#34; -enc UTF-8 -nopgbrk -q -&#39;
  cachetextconv = true

[diff &#34;djvu&#34;]
  binary = true
# textconv = pdfinfo
  textconv = djvutxt # yay -S djvulibre
  cachetextconv = true

[diff &#34;odt&#34;]
  textconv = odt2txt
# textconv = pandoc --standalone --from=odt --to=plain
  binary = true
  cachetextconv = true

[diff &#34;doc&#34;]
# textconv = wvText
  textconv = catdoc # yay -S catdoc
  binary = true
  cachetextconv = true

[diff &#34;xls&#34;]
# textconv = in2csv
# textconv = xlscat -a UTF-8
# textconv = soffice --headless --convert-to csv
  textconv = xls2csv # yay -S catdoc
  binary = true
  cachetextconv = true

[diff &#34;ppt&#34;]
  textconv = catppt # yay -S catdoc
  binary = true
  cachetextconv = true

[diff &#34;docx&#34;]
  textconv = pandoc --standalone --from=docx --to=plain
# textconv = sh -c &#39;docx2txt.pl &#34;$0&#34; -&#39;
  binary = true
  cachetextconv = true

[diff &#34;xlsx&#34;]
  textconv = xlsx2csv # pip install xlsx2csv
# textconv = in2csv
# textconv = soffice --headless --convert-to csv
  binary = true
  cachetextconv = true

[diff &#34;pptx&#34;]
# pip install --user pptx2md (currently not wotking with Python 3.10)
# textconv = sh -c &#39;pptx2md --disable_image --disable_wmf -i &#34;$0&#34; -o ~/.cache/git/presentation.md &gt;/dev/null &amp;&amp; cat ~/.cache/git/presentation.md&#39;
# Alternative hack, convert PPTX to PPT, then use the catppt tool
  textconv = sh -c &#39;soffice --headless --convert-to ppt --outdir /tmp &#34;$0&#34; &amp;&amp; TMP_FILENAME=$(basename -- &#34;$0&#34;) &amp;&amp; catppt &#34;/tmp/${TMP_FILENAME%.*}.ppt&#34;&#39;
  binary = true
  cachetextconv = true

[diff &#34;rtf&#34;]
  textconv = unrtf --text # yay -S unrtf
  binary = true
  cachetextconv = true

[diff &#34;epub&#34;]
  textconv = pandoc --standalone --from=epub --to=plain
  binary = true
  cachetextconv = true

[diff &#34;tika&#34;]
  textconv = tika --config=~/.local/share/tika/tika-conf.xml --text
  binary = true
  cachetextconv = true

[diff &#34;libreoffice&#34;]
  textconv = soffice --cat
  binary = true
  cachetextconv = true

[diff &#34;exif&#34;]
  binary = true
  textconv = exiftool # sudo apt install perl-image-exiftool
</code></pre><h4 id=apache-tika-app-wrapper>Apache Tika App wrapper</h4><p><strong>Apache Tika</strong> is a content detection and analysis framework. It detects and
extracts metadata and text from over a thousand different file types. We will be
using the Tika App in command-line mode to show some meaningful diff information
for some binary files.</p><p>First, let&rsquo;s add a custom script to run <code>tika-app</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/bin/sh
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>APACHE_TIKA_JAR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.local/share/tika/tika-app.jar&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APACHE_TIKA_JAR<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  exec java -Dfile.encoding<span style=color:#f92672>=</span>UTF-8 -jar <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APACHE_TIKA_JAR<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span> 2&gt;/dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;JAR file not found at </span><span style=color:#e6db74>${</span>APACHE_TIKA_JAR<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><p>Add <code>tika</code>&rsquo;s installation instructions to the <code>setup.sh</code> file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>update_apache_tika <span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  TIKA_JAR_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.local/share/tika&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! -d <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    mkdir -p <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  TIKA_BASE_URL<span style=color:#f92672>=</span>https://archive.apache.org/dist/tika/
</span></span><span style=display:flex><span>  TIKA_JAR_LINK<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>/tika-app.jar&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  echo -n <span style=color:#e6db74>&#34;Checking for new Apache Tika App version... &#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Get the lastest version</span>
</span></span><span style=display:flex><span>  TIKA_VERSION<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>
</span></span><span style=display:flex><span>    curl -s <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_BASE_URL<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> | <span style=color:#75715e># Get the page</span>
</span></span><span style=display:flex><span>    pandoc -f html -t plain | <span style=color:#75715e># Convert HTML page to plain text.</span>
</span></span><span style=display:flex><span>    awk <span style=color:#e6db74>&#39;/([0-9]+\.)+[0-1]\// {print substr($1, 0, length($1)-1)}&#39;</span> | <span style=color:#75715e># Get the versions directories (pattern: X.X.X/)</span>
</span></span><span style=display:flex><span>    sort -rV | <span style=color:#75715e># Sort versions, the newest first</span>
</span></span><span style=display:flex><span>    head -n <span style=color:#ae81ff>1</span> <span style=color:#75715e># Get the first (newest) version</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_VERSION<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Failed, check your internet connection.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Lastest version is </span><span style=color:#e6db74>${</span>TIKA_VERSION<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  TIKA_JAR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>/tika-app-</span><span style=color:#e6db74>${</span>TIKA_VERSION<span style=color:#e6db74>}</span><span style=color:#e6db74>.jar&#34;</span>
</span></span><span style=display:flex><span>  TIKA_JAR_URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_BASE_URL<span style=color:#e6db74>}${</span>TIKA_VERSION<span style=color:#e6db74>}</span><span style=color:#e6db74>/tika-app-</span><span style=color:#e6db74>${</span>TIKA_VERSION<span style=color:#e6db74>}</span><span style=color:#e6db74>.jar&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! -f <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;New version available!&#34;</span>
</span></span><span style=display:flex><span>    read -p <span style=color:#e6db74>&#34;Do you want to download Apache Tika App v</span><span style=color:#e6db74>${</span>TIKA_VERSION<span style=color:#e6db74>}</span><span style=color:#e6db74>? [Y | N]: &#34;</span> INSTALL_CONFIRM
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span>$INSTALL_CONFIRM<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Y&#34;</span> <span style=color:#f92672>]]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      curl -o <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR_URL<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;Apache Tika App v</span><span style=color:#e6db74>${</span>TIKA_VERSION<span style=color:#e6db74>}</span><span style=color:#e6db74> downloaded successfully&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Apache Tika App is up-to-date, version </span><span style=color:#e6db74>${</span>TIKA_VERSION<span style=color:#e6db74>}</span><span style=color:#e6db74> already downloaded to &#39;</span><span style=color:#e6db74>${</span>TIKA_JAR<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Check the existance of the symbolic link</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -L <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR_LINK<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    unlink <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR_LINK<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Create a symbolic link to the installed version</span>
</span></span><span style=display:flex><span>  ln -s <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIKA_JAR_LINK<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>update_apache_tika;
</span></span></code></pre></div><p>When it detects that Tesseract is installed, Tika App will try to extract text
from some file types. For some reason, it tries to use Tesseract with some
compressed files like <code>*.bz2</code>, <code>*.apk</code>&mldr; etc. I would like to disable this feature
by exporting an XML config file which will be used when launching the Tika App
(using <code>--config=&lt;tika-config.xml></code>).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;properties&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;parsers&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;parser</span> <span style=color:#a6e22e>class=</span><span style=color:#e6db74>&#34;org.apache.tika.parser.DefaultParser&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;parser-exclude</span> <span style=color:#a6e22e>class=</span><span style=color:#e6db74>&#34;org.apache.tika.parser.ocr.TesseractOCRParser&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/parser&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/parsers&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/properties&gt;</span>
</span></span></code></pre></div><h3 id=emacs-systemd-daemon>Emacs&rsquo; Systemd daemon</h3><p>Let&rsquo;s define a Systemd service to launch Emacs server automatically.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-systemd data-lang=systemd><span style=display:flex><span><span style=color:#66d9ef>[Unit]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Description</span><span style=color:#f92672>=</span><span style=color:#e6db74>Emacs server daemon</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Documentation</span><span style=color:#f92672>=</span><span style=color:#e6db74>info:emacs man:emacs(1) https://gnu.org/software/emacs/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Service]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#e6db74>forking</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExecStart</span><span style=color:#f92672>=</span><span style=color:#e6db74>sh -c &#39;emacs --daemon &amp;&amp; emacsclient -c --eval &#34;(delete-frame)&#34;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExecStop</span><span style=color:#f92672>=</span><span style=color:#e6db74>emacsclient --no-wait --eval &#34;(progn (setq kill-emacs-hook nil) (kill-emacs))&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Restart</span><span style=color:#f92672>=</span><span style=color:#e6db74>on-failure</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Install]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>WantedBy</span><span style=color:#f92672>=</span><span style=color:#e6db74>default.target</span>
</span></span></code></pre></div><p>Which is then enabled by:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>systemctl --user enable emacs.service
</span></span></code></pre></div><p>For some reason if a frame isn&rsquo;t opened early in the initialization process, the
daemon doesn&rsquo;t seem to like opening frames later &mdash; hence the <code>&& emacsclient</code>
part of the <code>ExecStart</code> value.</p><h3 id=emacs-client>Emacs client</h3><h4 id=desktop-integration>Desktop integration</h4><p>It can now be nice to use this as a &lsquo;default app&rsquo; for opening files. If we add
an appropriate desktop entry, and enable it in the desktop environment.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cfg data-lang=cfg><span style=display:flex><span><span style=color:#66d9ef>[Desktop Entry]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Name</span><span style=color:#f92672>=</span><span style=color:#e6db74>Emacs (Client)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>GenericName</span><span style=color:#f92672>=</span><span style=color:#e6db74>Text Editor</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Comment</span><span style=color:#f92672>=</span><span style=color:#e6db74>A flexible platform for end-user applications</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>MimeType</span><span style=color:#f92672>=</span><span style=color:#e6db74>text/english;text/plain;text/org;text/x-makefile;text/x-c++hdr;text/x-c++src;text/x-chdr;text/x-csrc;text/x-java;text/x-moc;text/x-pascal;text/x-tcl;text/x-tex;application/x-shellscript;text/x-c;text/x-c++;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Exec</span><span style=color:#f92672>=</span><span style=color:#e6db74>emacsclient -create-frame --frame-parameters=&#34;&#39;(fullscreen . maximized)&#34; --alternate-editor=&#34;/usr/bin/emacs&#34; --no-wait %F</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Icon</span><span style=color:#f92672>=</span><span style=color:#e6db74>emacs</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#e6db74>Application</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Terminal</span><span style=color:#f92672>=</span><span style=color:#e6db74>false</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Categories</span><span style=color:#f92672>=</span><span style=color:#e6db74>TextEditor;Utility;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>StartupWMClass</span><span style=color:#f92672>=</span><span style=color:#e6db74>Emacs</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Keywords</span><span style=color:#f92672>=</span><span style=color:#e6db74>Text;Editor;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>X-KDE-StartupNotify</span><span style=color:#f92672>=</span><span style=color:#e6db74>false</span>
</span></span></code></pre></div><h4 id=command-line-wrapper>Command-line wrapper</h4><p>A wrapper around <code>emacsclient</code>:</p><ul><li>Accepting <code>stdin</code> by putting it in a temporary file and immediately opening it.</li><li>Guessing that the <code>tty</code> is a good idea when <code>$DISPLAY</code> is unset (relevant with SSH
sessions, among other things).</li><li>With a whiff of 24-bit color support, sets <code>TERM</code> variable to a <code>terminfo</code> that
(probably) announces 24-bit color support.</li><li>Changes GUI <code>emacsclient</code> instances to be non-blocking by default (<code>--no-wait</code>),
and instead take a flag to suppress this behavior (<code>-w</code>).</li></ul><p>I would use <code>sh</code>, but using arrays for argument manipulation is just too
convenient, so I&rsquo;ll raise the requirement to <code>bash</code>. Since arrays are the only
&rsquo;extra&rsquo; compared to <code>sh</code>, other shells like <code>ksh</code> etc. should work too.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>force_tty<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>force_wait<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>stdin_mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>args<span style=color:#f92672>=()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>usage <span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  echo -e <span style=color:#e6db74>&#34;Usage: e [-t] [-m MODE] [OPTIONS] FILE [-]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Emacs client convenience wrapper.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Options:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-h, --help            Show this message
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-t, -nw, --tty        Force terminal mode
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-w, --wait            Don&#39;t supply --no-wait to graphical emacsclient
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-                     Take stdin (when last argument)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-m MODE, --mode MODE  Mode to open stdin with
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-mm, --maximized      Start Emacs client in maximized window
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Run emacsclient --help to see help for the emacsclient.&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> :
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> in
</span></span><span style=display:flex><span>    -t | -nw | --tty<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      force_tty<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>      shift ;;
</span></span><span style=display:flex><span>    -w | --wait<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      force_wait<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>      shift ;;
</span></span><span style=display:flex><span>    -m | --mode<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      stdin_mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#34; (</span>$2<span style=color:#e6db74>-mode)&#34;</span>
</span></span><span style=display:flex><span>      shift <span style=color:#ae81ff>2</span> ;;
</span></span><span style=display:flex><span>    -mm | --maximized<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        args<span style=color:#f92672>+=(</span><span style=color:#e6db74>&#34;--frame-parameters=&#39;(fullscreen . maximized)&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        shift ;;
</span></span><span style=display:flex><span>    -h | --help<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      usage
</span></span><span style=display:flex><span>      exit <span style=color:#ae81ff>0</span> ;;
</span></span><span style=display:flex><span>    --*<span style=color:#f92672>=</span>*<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      set -- <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>1%%=*<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>1#*=<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>      shift ;;
</span></span><span style=display:flex><span>    *<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$#<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> break
</span></span><span style=display:flex><span>      args<span style=color:#f92672>+=(</span><span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      shift ;;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>esac</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${#</span>args[*]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>args[-1]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  unset <span style=color:#e6db74>&#39;args[-1]&#39;</span>
</span></span><span style=display:flex><span>  TMP<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>mktemp /tmp/emacsstdin-XXX<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  cat &gt; <span style=color:#e6db74>&#34;</span>$TMP<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  args<span style=color:#f92672>+=(</span>--eval <span style=color:#e6db74>&#34;(let ((b (generate-new-buffer \&#34;*stdin*\&#34;))) (switch-to-buffer b) (insert-file-contents \&#34;</span>$TMP<span style=color:#e6db74>\&#34;) (delete-file \&#34;</span>$TMP<span style=color:#e6db74>\&#34;)</span><span style=color:#e6db74>${</span>stdin_mode<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$DISPLAY<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> $force_tty
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># detect terminals with sneaky 24-bit support</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>{</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$COLORTERM<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span> truecolor <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$COLORTERM<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span> 24bit <span style=color:#f92672>]</span>; <span style=color:#f92672>}</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>tput colors 2&gt;/dev/null<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> -lt <span style=color:#ae81ff>257</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> echo <span style=color:#e6db74>&#34;</span>$TERM<span style=color:#e6db74>&#34;</span> | grep -q <span style=color:#e6db74>&#34;^\w\+-[0-9]&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      termstub<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TERM%%-*<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>      termstub<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TERM#*-<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> infocmp <span style=color:#e6db74>&#34;</span>$termstub<span style=color:#e6db74>-direct&#34;</span> &gt;/dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      TERM<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$termstub<span style=color:#e6db74>-direct&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>      TERM<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;xterm-direct&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span> <span style=color:#75715e># should be fairly safe</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  emacsclient --tty -create-frame --alternate-editor<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/usr/bin/emacs&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>args[@]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ! $force_wait
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    args<span style=color:#f92672>+=(</span>--no-wait<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  emacsclient -create-frame --alternate-editor<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/usr/bin/emacs&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>args[@]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><h5 id=useful-aliases>Useful aliases</h5><p>Now, to set an alias to use <code>e</code> with <code>magit</code>, and then for maximum laziness we can
set aliases for the terminal-forced variants.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Aliases to run emacs+magit</span>
</span></span><span style=display:flex><span>alias magit<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;e --eval &#34;(progn (magit-status) (delete-other-windows))&#34;&#39;</span>
</span></span><span style=display:flex><span>alias magitt<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;e -t --eval &#34;(progn (magit-status) (delete-other-windows))&#34;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Aliases to run emacs+mu4e</span>
</span></span><span style=display:flex><span>alias emu<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;e --eval &#34;(progn (=mu4e) (delete-other-windows))&#34;&#39;</span>
</span></span><span style=display:flex><span>alias emut<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;e -t --eval &#34;(progn (=mu4e) (delete-other-windows))&#34;&#39;</span>
</span></span></code></pre></div><p>And this to launch Emacs in terminal mode <code>et</code>, I use this as a default <code>$EDITOR</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>e -t <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>And <code>ev</code> for use with <code>$VISUAL</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>e -w <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export EDITOR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.local/bin/et&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># export VISUAL=$HOME/.local/bin/ev</span>
</span></span></code></pre></div><h3 id=appimage>AppImage</h3><p>Install/update the <code>appimageupdatetool.AppImage</code> tool:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>update_appimageupdatetool <span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  TOOL_NAME<span style=color:#f92672>=</span>appimageupdatetool
</span></span><span style=display:flex><span>  MACHINE_ARCH<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>uname -m<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>  APPIMAGE_UPDATE_TOOL_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.local/bin/</span><span style=color:#e6db74>${</span>TOOL_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  APPIMAGE_UPDATE_TOOL_URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://github.com/AppImage/AppImageUpdate/releases/download/continuous/</span><span style=color:#e6db74>${</span>TOOL_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>MACHINE_ARCH<span style=color:#e6db74>}</span><span style=color:#e6db74>.AppImage&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#e6db74>&#34;</span>$APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>&#34;</span> -j <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&amp;&gt;/dev/null
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TOOL_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74> already up to date&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      echo <span style=color:#e6db74>&#34;Update available, downloading latest </span><span style=color:#e6db74>${</span>MACHINE_ARCH<span style=color:#e6db74>}</span><span style=color:#e6db74> version to </span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>      mv <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>.backup&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>      echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TOOL_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74> not found, downloading latest </span><span style=color:#e6db74>${</span>MACHINE_ARCH<span style=color:#e6db74>}</span><span style=color:#e6db74> version to </span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>    wget -O <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_URL<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#75715e># 2&amp;&gt;/dev/null</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;Downloaded </span><span style=color:#e6db74>${</span>TOOL_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>MACHINE_ARCH<span style=color:#e6db74>}</span><span style=color:#e6db74>.AppImage&#34;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>[</span> -f <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>.backup&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>        rm <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>.backup&#34;</span>
</span></span><span style=display:flex><span>    chmod a+x <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>APPIMAGE_UPDATE_TOOL_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>update_appimageupdatetool;
</span></span></code></pre></div><h3 id=oh-my-zsh>Oh-my-Zsh</h3><h4 id=path>Path</h4><p>Path to your oh-my-zsh installation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export ZSH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.oh-my-zsh&#34;</span>
</span></span></code></pre></div><h4 id=themes-and-customization>Themes and customization:</h4><p>Set name of the theme to load, if set to <code>"random"</code>, it will load a random theme
each time oh-my-zsh is loaded, in which case, to know which specific one was
loaded, run: <code>echo $RANDOM_THEME</code> See <a href=https://github.com/ohmyzsh/ohmyzsh/wiki/Themes>github.com/ohmyzsh/ohmyzsh/wiki/Themes</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Typewritten customizations</span>
</span></span><span style=display:flex><span>TYPEWRITTEN_RELATIVE_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;adaptive&#34;</span>
</span></span><span style=display:flex><span>TYPEWRITTEN_CURSOR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;underscore&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ZSH_THEME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;typewritten/typewritten&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set list of themes to pick from when loading at random</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Setting this variable when ZSH_THEME=random will cause zsh to load</span>
</span></span><span style=display:flex><span><span style=color:#75715e># a theme from this variable instead of looking in $ZSH/themes/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># If set to an empty array, this variable will have no effect.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ZSH_THEME_RANDOM_CANDIDATES=( &#34;robbyrussell&#34; &#34;agnoster&#34; )</span>
</span></span></code></pre></div><h4 id=behavior>Behavior</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Uncomment the following line to use case-sensitive completion.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># CASE_SENSITIVE=&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line to use hyphen-insensitive completion.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Case-sensitive completion must be off. _ and - will be interchangeable.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># HYPHEN_INSENSITIVE=&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line to disable bi-weekly auto-update checks.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># DISABLE_AUTO_UPDATE=&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line to automatically update without prompting.</span>
</span></span><span style=display:flex><span>DISABLE_UPDATE_PROMPT<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line to change how often to auto-update (in days).</span>
</span></span><span style=display:flex><span>export UPDATE_ZSH_DAYS<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line if pasting URLs and other text is messed up.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># DISABLE_MAGIC_FUNCTIONS=&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line to disable colors in ls.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># DISABLE_LS_COLORS=&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line to disable auto-setting terminal title.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># DISABLE_AUTO_TITLE=&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line to enable command auto-correction.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ENABLE_CORRECTION=&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line to display red dots whilst waiting for completion.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># COMPLETION_WAITING_DOTS=&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line if you want to disable marking untracked files</span>
</span></span><span style=display:flex><span><span style=color:#75715e># under VCS as dirty. This makes repository status check for large repositories</span>
</span></span><span style=display:flex><span><span style=color:#75715e># much, much faster.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># DISABLE_UNTRACKED_FILES_DIRTY=&#34;true&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uncomment the following line if you want to change the command execution time</span>
</span></span><span style=display:flex><span><span style=color:#75715e># stamp shown in the history command output.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># You can set one of the optional three formats:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># &#34;mm/dd/yyyy&#34;|&#34;dd.mm.yyyy&#34;|&#34;yyyy-mm-dd&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># or set a custom format using the strftime function format specifications,</span>
</span></span><span style=display:flex><span><span style=color:#75715e># see &#39;man strftime&#39; for details.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># HIST_STAMPS=&#34;mm/dd/yyyy&#34;</span>
</span></span></code></pre></div><h4 id=plugins>Plugins</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Would you like to use another custom folder than $ZSH/custom?</span>
</span></span><span style=display:flex><span>ZSH_CUSTOM<span style=color:#f92672>=</span>$HOME/.config/my_ohmyzsh_customizations
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Which plugins would you like to load?</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Standard plugins can be found in $ZSH/plugins/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Custom plugins may be added to $ZSH_CUSTOM/plugins/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Example format: plugins=(rails git textmate ruby lighthouse)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add wisely, as too many plugins slow down shell startup.</span>
</span></span><span style=display:flex><span>plugins<span style=color:#f92672>=(</span>
</span></span><span style=display:flex><span>  zsh-autosuggestions
</span></span><span style=display:flex><span>  zsh-navigation-tools
</span></span><span style=display:flex><span>  zsh-interactive-cd
</span></span><span style=display:flex><span>  archlinux
</span></span><span style=display:flex><span>  ssh-agent
</span></span><span style=display:flex><span>  sudo
</span></span><span style=display:flex><span>  docker
</span></span><span style=display:flex><span>  systemd
</span></span><span style=display:flex><span>  tmux
</span></span><span style=display:flex><span>  python
</span></span><span style=display:flex><span>  pip
</span></span><span style=display:flex><span>  rust
</span></span><span style=display:flex><span>  repo
</span></span><span style=display:flex><span>  git
</span></span><span style=display:flex><span>  cp
</span></span><span style=display:flex><span>  rsync
</span></span><span style=display:flex><span>  ripgrep
</span></span><span style=display:flex><span>  fzf
</span></span><span style=display:flex><span>  fd
</span></span><span style=display:flex><span>  z
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>
</span></span></code></pre></div><h4 id=bootstrap-oh-my-zsh>Bootstrap Oh-my-Zsh</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>source $ZSH/oh-my-zsh.sh
</span></span></code></pre></div><h4 id=aliases>Aliases</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Aliases</span>
</span></span><span style=display:flex><span>alias zshconfig<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;vim ~/.zshrc&#34;</span>
</span></span><span style=display:flex><span>alias ohmyzsh<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ranger </span>$ZSH<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><h3 id=zsh-user-configuration>Zsh user configuration</h3><h4 id=pbcopy-and-pbpaste><code>pbcopy</code> and <code>pbpaste</code></h4><p>I like to define MacOS-like commands (<code>pbcopy</code> and <code>pbpaste</code>) to copy and paste in
terminal (from <code>stdin</code>, to <code>stdout</code>). The <code>pbcopy</code> and <code>pbpaste</code> are defined using
either <code>xclip</code> or <code>xsel</code>, you would need to install these tools, otherwise we wouldn&rsquo;t
define the aliases.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Define aliases to &#39;pbcopy&#39; and &#39;pbpaste&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> command -v xclip &amp;&gt; /dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Define aliases using xclip</span>
</span></span><span style=display:flex><span>  alias pbcopy<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;xclip -selection clipboard&#39;</span>
</span></span><span style=display:flex><span>  alias pbpaste<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;xclip -selection clipboard -o&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>elif</span> command -v xsel &amp;&gt; /dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Define aliases using xsel</span>
</span></span><span style=display:flex><span>  alias pbcopy<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;xsel --clipboard --input&#39;</span>
</span></span><span style=display:flex><span>  alias pbpaste<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;xsel --clipboard --output&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><h4 id=netpaste><code>netpaste</code></h4><p>Define a <code>netpaste</code> command to paste to a Pastebin server.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>alias netpaste<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;curl -F file=@- 0x0.st&#39;</span> <span style=color:#75715e># OR &#39;curl -F f:1=&lt;- ix.io &#39;</span>
</span></span></code></pre></div><h4 id=sudo-gui>Sudo GUI!</h4><p>And then define <code>gsuon</code> and <code>gsuoff</code> aliases to run graphical apps from terminal
with root permissions, this requires <code>xhost</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># To run GUI apps from terminal with root permissions</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> command -v xhost &amp;&gt; /dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  alias gsuon<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;xhost si:localuser:root&#39;</span>
</span></span><span style=display:flex><span>  alias gsuoff<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;xhost -si:localuser:root&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><h4 id=neovim>Neovim</h4><p>Use Neovim instead of VIM to provide <code>vi</code> and <code>vim</code> commands.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># NeoVim</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> command -v nvim &amp;&gt; /dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  alias vim<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nvim&#34;</span>
</span></span><span style=display:flex><span>  alias vi<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nvim&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><h4 id=esp-idf>ESP-IDF</h4><p>Add some aliases to work with the <a href=https://github.com/espressif/esp-idf.git>ESP-IDF</a> framework.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -d <span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/Softwares/src/esp-idf/&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  alias esp-prepare-env<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;source $HOME/Softwares/src/esp-idf/export.sh&#39;</span>
</span></span><span style=display:flex><span>  alias esp-update<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;echo &#34;Updating ESP-IDF framework...&#34; &amp;&amp; cd $HOME/src/esp-idf &amp;&amp; git pull --all &amp;&amp; echo &#34;Updated successfully&#34;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  alias esp-prepare-env<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;echo &#34;esp-idf repo not found. You can clone the esp-idf repo using git clone https://github.com/espressif/esp-idf.git&#34;&#39;</span>
</span></span><span style=display:flex><span>  alias esp-update<span style=color:#f92672>=</span>esp-prepare-env
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><h4 id=cli-wttrin-client>CLI wttrin client</h4><p>Define an alias to get weather information for my city:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export WTTRIN_CITY<span style=color:#f92672>=</span>Orsay
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alias wttrin<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;curl wttr.in/$WTTRIN_CITY&#39;</span>
</span></span><span style=display:flex><span>alias wttrin2<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;curl v2.wttr.in/$WTTRIN_CITY&#39;</span>
</span></span></code></pre></div><h4 id=minicom>Minicom</h4><p>Enable Meta key and colors in <code>minicom</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export MINICOM<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-m -c on&#39;</span>
</span></span></code></pre></div><h4 id=rust>Rust</h4><p>Define Rust sources path, and add packages installed from <code>cargo</code> to the <code>PATH</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export RUST_SRC_PATH<span style=color:#f92672>=</span>$HOME/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/src/
</span></span><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>$PATH:$HOME/.cargo/bin
</span></span></code></pre></div><p>I&rsquo;m using the AUR package <code>clang-format-static-bin</code>, which provide multiple
versions of Clang-format, I use it with some work projects requiring a specific
version of Clang-format.</p><h4 id=clang-format>Clang-format</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>$PATH:/opt/clang-format-static
</span></span></code></pre></div><h4 id=cmake>CMake</h4><p>Add my manually installed libraries to CMake and <code>PATH</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export CMAKE_PREFIX_PATH<span style=color:#f92672>=</span>$HOME/Softwares/src/install
</span></span><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>$PATH:$HOME/Softwares/src/install/bin
</span></span></code></pre></div><h4 id=node>Node</h4><p>Set NPM installation path to local:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>NPM_PACKAGES<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>HOME<span style=color:#e6db74>}</span><span style=color:#e6db74>/.npm-packages&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Export NPM bin path</span>
</span></span><span style=display:flex><span>export PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$PATH<span style=color:#e6db74>:</span>$NPM_PACKAGES<span style=color:#e6db74>/bin&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Preserve MANPATH if you already defined it somewhere in your config.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Otherwise, fall back to `manpath` so we can inherit from `/etc/manpath`.</span>
</span></span><span style=display:flex><span>export MANPATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>MANPATH-<span style=color:#66d9ef>$(</span>manpath<span style=color:#66d9ef>)</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:</span>$NPM_PACKAGES<span style=color:#e6db74>/share/man&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Tell Node about these packages</span>
</span></span><span style=display:flex><span>export NODE_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$NPM_PACKAGES<span style=color:#e6db74>/lib/node_modules:</span>$NODE_PATH<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>Tell NPM to use this directory for its global package installs by adding this
in <code>~/.npmrc</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cfg data-lang=cfg><span style=display:flex><span><span style=color:#a6e22e>prefix</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>~/.npm-packages</span>
</span></span></code></pre></div><p>Some useful stuff (<code>fzf</code>, <code>opam</code>, Doom Emacs&mldr;)</p><h4 id=tmux>tmux</h4><p>I like to use <code>tmux</code> by default, even on my local sessions, I like to start a <code>tmux</code>
in a <code>default</code> session on the first time I launch a terminal, and then, attach any
other terminal to this default session:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># If not running inside Emacs (via vterm/eshell...)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z $INSIDE_EMACS <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> command -v tmux &amp;&gt; /dev/null <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$TMUX<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    tmux attach -t default <span style=color:#f92672>||</span> tmux new -s default
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><h4 id=other-stuff>Other stuff</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># You may need to manually set your language environment</span>
</span></span><span style=display:flex><span><span style=color:#75715e># export LANG=en_US.UTF-8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Preferred editor for local and remote sessions</span>
</span></span><span style=display:flex><span><span style=color:#75715e># if [[ -n $SSH_CONNECTION ]]; then</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   export EDITOR=&#39;vim&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># else</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   export EDITOR=&#39;mvim&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Compilation flags</span>
</span></span><span style=display:flex><span><span style=color:#75715e># export ARCHFLAGS=&#34;-arch x86_64&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># FZF</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> -f ~/.fzf.zsh <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> source ~/.fzf.zsh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># OPAM configuration</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[[</span> ! -r $HOME/.opam/opam-init/init.zsh <span style=color:#f92672>]]</span> <span style=color:#f92672>||</span> source $HOME/.opam/opam-init/init.zsh &gt; /dev/null 2&gt; /dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add ~/.config/emacs/bin to path (for DOOM Emacs stuff)</span>
</span></span><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>$PATH:$HOME/.config/emacs/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export TEXMFHOME<span style=color:#f92672>=</span>$HOME/.texmf
</span></span></code></pre></div><p>Define some environment variables.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export DS_DIR<span style=color:#f92672>=</span>~/PhD/datasets-no/experiment_images/
</span></span><span style=display:flex><span>export DSO_BIN_DIR<span style=color:#f92672>=</span>~/PhD/workspace-no/vo/orig/dso/build/release/bin
</span></span><span style=display:flex><span>export DSO_RES_DIR<span style=color:#f92672>=</span>~/PhD/workspace-no/vo/orig/dso_results
</span></span></code></pre></div><p>Load my <code>bitwarden-cli</code> session, exported to <code>BW_SESSION</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>source ~/.bitwarden-session
</span></span></code></pre></div><h3 id=rust-format>Rust format</h3><p>For Rust code base, the file <code>$HOME/.rustfmt.toml</code> contains the global format
settings, I like to set it to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span><span style=color:#75715e># Rust edition 2018</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>edition</span> = <span style=color:#e6db74>&#34;2018&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use Unix style newlines, with 2 spaces tabulation.</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>newline_style</span> = <span style=color:#e6db74>&#34;Unix&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>tab_spaces</span> = <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>hard_tabs</span> = <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Make one line functions in a single line</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fn_single_line</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Format strings</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>format_strings</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Increase the max line width</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max_width</span> = <span style=color:#ae81ff>120</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Merge nested imports</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>merge_imports</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Enum and Struct alignement</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>enum_discrim_align_threshold</span> = <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct_field_align_threshold</span> = <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Reorder impl items: type &gt; const &gt; macros &gt; methods.</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>reorder_impl_items</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Comments and documentation formating</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>wrap_comments</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>normalize_comments</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>normalize_doc_attributes</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>format_code_in_doc_comments</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>report_fixme</span> = <span style=color:#e6db74>&#34;Always&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>todo</span> = <span style=color:#e6db74>&#34;Always&#34;</span>
</span></span></code></pre></div><h3 id=ecryptfs>eCryptfs</h3><h4 id=unlock-and-mount-script>Unlock and mount script</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/bin/sh -e
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e># This script mounts a user&#39;s confidential private folder</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Original by Michael Halcrow, IBM</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Extracted to a stand-alone script by Dustin Kirkland &lt;kirkland@ubuntu.com&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Modified by: Abdelhak Bougouffa &lt;abougouffa@fedoraproject.org&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This script:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  * interactively prompts for a user&#39;s wrapping passphrase (defaults to their</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    login passphrase)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  * checks it for validity</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  * unwraps a users mount passphrase with their supplied wrapping passphrase</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  * inserts the mount passphrase into the keyring</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  * and mounts a user&#39;s encrypted private folder</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PRIVATE_DIR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Private&#34;</span>
</span></span><span style=display:flex><span>PW_ATTEMPTS<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>MESSAGE<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>gettext <span style=color:#e6db74>&#34;Enter your login passphrase:&#34;</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f $HOME/.ecryptfs/wrapping-independent <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># use a wrapping passphrase different from the login passphrase</span>
</span></span><span style=display:flex><span>  MESSAGE<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>gettext <span style=color:#e6db74>&#34;Enter your wrapping passphrase:&#34;</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WRAPPED_PASSPHRASE_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.ecryptfs/wrapped-passphrase&#34;</span>
</span></span><span style=display:flex><span>MOUNT_PASSPHRASE_SIG_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.ecryptfs/</span>$PRIVATE_DIR<span style=color:#e6db74>.sig&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># First, silently try to perform the mount, which would succeed if the appropriate</span>
</span></span><span style=display:flex><span><span style=color:#75715e># key is available in the keyring</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> /sbin/mount.ecryptfs_private &gt;/dev/null 2&gt;&amp;<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Otherwise, interactively prompt for the user&#39;s password</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f <span style=color:#e6db74>&#34;</span>$WRAPPED_PASSPHRASE_FILE<span style=color:#e6db74>&#34;</span> -a -f <span style=color:#e6db74>&#34;</span>$MOUNT_PASSPHRASE_SIG_FILE<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  tries<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> <span style=color:#f92672>[</span> $tries -lt $PW_ATTEMPTS <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    LOGINPASS<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>zenity --password --title <span style=color:#e6db74>&#34;eCryptFS: </span>$MESSAGE<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#66d9ef>$(</span>wc -l &lt; <span style=color:#e6db74>&#34;</span>$MOUNT_PASSPHRASE_SIG_FILE<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e># No filename encryption; only insert fek</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> printf <span style=color:#e6db74>&#34;%s\0&#34;</span> <span style=color:#e6db74>&#34;</span>$LOGINPASS<span style=color:#e6db74>&#34;</span> | ecryptfs-unwrap-passphrase <span style=color:#e6db74>&#34;</span>$WRAPPED_PASSPHRASE_FILE<span style=color:#e6db74>&#34;</span> - | ecryptfs-add-passphrase -
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        break
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        zenity --error --title <span style=color:#e6db74>&#34;eCryptfs&#34;</span> --text <span style=color:#e6db74>&#34;Error: Your passphrase is incorrect&#34;</span>
</span></span><span style=display:flex><span>        tries<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span>$tries <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#66d9ef>))</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> printf <span style=color:#e6db74>&#34;%s\0&#34;</span> <span style=color:#e6db74>&#34;</span>$LOGINPASS<span style=color:#e6db74>&#34;</span> | ecryptfs-insert-wrapped-passphrase-into-keyring <span style=color:#e6db74>&#34;</span>$WRAPPED_PASSPHRASE_FILE<span style=color:#e6db74>&#34;</span> -
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        break
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        zenity --error --title <span style=color:#e6db74>&#34;eCryptfs&#34;</span> --text <span style=color:#e6db74>&#34;Error: Your passphrase is incorrect&#34;</span>
</span></span><span style=display:flex><span>        tries<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span>$tries <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#66d9ef>))</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $tries -ge $PW_ATTEMPTS <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    zenity --error --title <span style=color:#e6db74>&#34;eCryptfs&#34;</span> --text <span style=color:#e6db74>&#34;Too many incorrect password attempts, exiting&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  /sbin/mount.ecryptfs_private
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  zenity --error --title <span style=color:#e6db74>&#34;eCryptfs&#34;</span> --text <span style=color:#e6db74>&#34;Encrypted private directory is not setup properly&#34;</span>
</span></span><span style=display:flex><span>  exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> grep -qs <span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.Private </span>$PWD<span style=color:#e6db74> ecryptfs &#34;</span> /proc/mounts 2&gt;/dev/null; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  zenity --info --title <span style=color:#e6db74>&#34;eCryptfs&#34;</span> --text <span style=color:#e6db74>&#34;Your private directory has been mounted.&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dolphin <span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/Private&#34;</span>
</span></span><span style=display:flex><span>exit <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h4 id=desktop-integration>Desktop integration</h4><pre tabindex=0><code class=language-conf-unix data-lang=conf-unix>[Desktop Entry]
Type=Application
Version=1.0
Name=eCryptfs Unlock Private Directory
Icon=unlock
Exec=/home/hacko/.ecryptfs/ecryptfs-mount-private-gui
Terminal=False
</code></pre><h3 id=gdb>GDB</h3><h4 id=early-init>Early init</h4><p>I like to disable the initial message (containing copyright info and other
stuff), the right way to do this is either by starting <code>gdb</code> with <code>-q</code> option, or
(since GDB v11 I think), by setting in
<code>~/.gdbearlyinit</code>.</p><pre tabindex=0><code class=language-gdb-script data-lang=gdb-script># GDB early init file
# Abdelhak Bougouffa (c) 2022

# Disable showing the initial message
set startup-quietly
</code></pre><h4 id=init>Init</h4><p>GDB loads <code>$HOME/.gdbinit</code> at startup, I like to define some default options in
this file, this is a WIP, but it won&rsquo;t evolve too much, as <a href="https://youtu.be/-n9Fkq1e6sg?t=3377">it is recommended to
keep the <code>.gdbinit</code> clean and simple</a>. For the moment, it does just enable pretty
printing, and defines the <code>c</code> and <code>n</code> commands to wrap <code>continue</code> and <code>next</code> with a post
<code>refresh</code>, which is helpful with the annoying TUI when the program outputs to the
stdout.</p><pre tabindex=0><code class=language-gdb-script data-lang=gdb-script># GDB init file
# Abdelhak Bougouffa (c) 2022

# Save history
set history save on
set history filename ~/.gdb_history
set history remove-duplicates 2048

# When debugging my apps, debug information of system libraries
# aren&#39;t that important
set debuginfod enabled off

# Set pretty print
set print pretty on

# I hate stepping into system libraries when I&#39;m debugging my
# crappy stuff, so lets add system headers to skipped files
skip pending on
python
import os

# Add paths here, they will be explored recursivly
LIB_PATHS = [&#34;/usr/include&#34; &#34;/usr/local/include&#34;]

for lib_path in LIB_PATHS:
  for root, dirs, files in os.walk(lib_path):
    for file in files:
      cmd = f&#34;skip file {os.path.join(root, file)}&#34;
      gdb.execute(cmd, True, to_string=True)
end
skip enable

skip pending on
guile
&lt;&lt;gdb-init-guile&gt;&gt;
end
skip enable

# This fixes the annoying ncurses TUI gliches and saves typing C-l each time to refresh the screen
define cc
  continue
  refresh
end

define nn
  next
  refresh
end
</code></pre><h3 id=gnupg>GnuPG</h3><p>I add this to my <code>~/.gnupg/gpg-agent.conf</code>, to set the time-to-live to one day.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cfg data-lang=cfg><span style=display:flex><span><span style=color:#75715e># Do not ask me about entered passwords for 24h (during the same session)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>default-cache-ttl 86400</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max-cache-ttl 86400</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># As I&#39;m using KDE, use Qt based pinentry tool instead of default GTK+</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>pinentry-program /usr/bin/pinentry-qt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Allow pinentry in Emacs minibuffer (combined with epg-pinentry-mode)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>allow-loopback-pinentry</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>allow-emacs-pinentry</span>
</span></span></code></pre></div><h3 id=ocr-this>OCR This</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>IMG<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>mktemp -u --suffix<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.png&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>scrot -s <span style=color:#e6db74>&#34;</span>$IMG<span style=color:#e6db74>&#34;</span> -q <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>mogrify -modulate 100,0 -resize 400% <span style=color:#e6db74>&#34;</span>$IMG<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>tesseract <span style=color:#e6db74>&#34;</span>$IMG<span style=color:#e6db74>&#34;</span> - -l eng 2&gt; /dev/null | xsel -ib
</span></span></code></pre></div><h3 id=arch-linux-packages>Arch Linux packages</h3><p>Here, we install Arch packages</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>check_and_install_pkg<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    PKG_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ! pacman -Qiq <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>PKG_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> &amp;&gt;/dev/null; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;Package </span><span style=color:#e6db74>${</span>PKG_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74> is missing, installing it using yay&#34;</span>
</span></span><span style=display:flex><span>        yay -S <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>PKG_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PKGS_LIST<span style=color:#f92672>=(</span>
</span></span><span style=display:flex><span>    git ripgrep fd gnupg fzf the_silver_searcher
</span></span><span style=display:flex><span>    ttf-ibm-plex ttf-fira-code ttf-roboto-mono ttf-overpass ttf-lato ttf-input
</span></span><span style=display:flex><span>    ttf-cascadia-code ttf-jetbrains-mono ttf-fantasque-sans-mono
</span></span><span style=display:flex><span>    ttc-iosevka ttf-iosevka-nerd ttc-iosevka-slab ttc-iosevka-curly
</span></span><span style=display:flex><span>    ttc-iosevka-curly-slab ttc-iosevka-etoile ttc-iosevka-ss09
</span></span><span style=display:flex><span>    ccls cppcheck clang gcc gdb lldb valgrind rr openocd
</span></span><span style=display:flex><span>    sbcl cmucl clisp chez-scheme mit-scheme chibi-scheme chicken
</span></span><span style=display:flex><span>    vls vlang rustup
</span></span><span style=display:flex><span>    mu isync msmtp xsel xorg-xhost
</span></span><span style=display:flex><span>    mpc mpv mpd vlc yt-dlp
</span></span><span style=display:flex><span>    maxima fricas octave scilab-bin graphviz
</span></span><span style=display:flex><span>    djvulibre catdoc unrtf perl-image-exiftool
</span></span><span style=display:flex><span>    chezmoi neovim repo ecryptfs-utils
</span></span><span style=display:flex><span>    pandoc quarto-cli-bin hugo inkscape imagemagick
</span></span><span style=display:flex><span>    aspell aspell-en aspell-fr aspell-ar grammalecte
</span></span><span style=display:flex><span>    libvterm brave zotero bitwarden-cli binutils<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> PKG in <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>PKGS_LIST[@]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    check_and_install_pkg <span style=color:#e6db74>&#34;</span>$PKG<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div><h3 id=kde-plasma>KDE Plasma</h3><p>On KDE, there is a good support for HiDPI displays, however, I faced annoying
small icons in some contexts (for example, a right click on desktop). <a href="https://www.reddit.com/r/kde/comments/o8bb4s/comment/h33z7bp/?utm_source=share&utm_medium=web2x&context=3">This can
be fixed</a> by setting <code>PLASMA_USE_QT_SCALING=1</code> before starting KDE Plasma. KDE
sources the files with <code>.sh</code> extension found on <code>~/.config/plasma-workspace/env</code>, so
let&rsquo;s create ours.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export PLASMA_USE_QT_SCALING<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"></div></div><hr><div class="row next-prev-navigator"></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://abdelhakbougouffa.pro#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://abdelhakbougouffa.pro#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://abdelhakbougouffa.pro#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://abdelhakbougouffa.pro#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://abdelhakbougouffa.pro#publications>Publications</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:firstname%20%28dot%29%20lastname@universite-paris-saclay.fr target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>firstname (dot) lastname@universite-paris-saclay.fr</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2022 Copyright</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script type=text/javascript src=/js/darkreader.js></script>
<script type=text/javascript src=/js/darkmode-darkreader.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>
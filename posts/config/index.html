<!DOCTYPE html>
<html>
  <head>
    <title>Doom Emacs Configuration</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/css/layouts/main.css"/>
<link rel="stylesheet" href="/css/navigators/navbar.css"/>
<link rel="stylesheet" href="/css/plyr.css"/>
<link rel="stylesheet" href="/css/flag-icon.min.css"/>


<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600">


<link rel="stylesheet" href="/fontawesome/css/all.min.css"/>




  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/favicon_hu7c842f6b35a8d0374567474454be744c_4177_42x0_resize_box_3.png" />

<meta property="og:title" content="Doom Emacs Configuration" />
<meta property="og:description" content="Intro I&rsquo;ve been using Linux exclusively since 2010, GNU Emacs was always installed on my machine, but I didn&rsquo;t discover the real Emacs until 2020, in the beginning, I started my Vanilla Emacs configuration from scratch, but after a while, it becomes a mess. As a new Emacs user, I didn&rsquo;t understand the in the beginning how to optimize my configuration and how to do things correctly. I discovered then Spacemacs, which made things much easier, but it was a little slow, and just after, I found the awesome Doom Emacs, and since, I didn&rsquo;t quit my Emacs screen!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://abdelhakbougouffa.pro/posts/config/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-24T00:00:00+02:00" />
<meta property="article:modified_time" content="2022-04-24T00:00:00+02:00" />



    
    
<meta name="description" content="Doom Emacs Configuration" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/css/layouts/single.css"/>
<link rel="stylesheet" href="/css/navigators/sidebar.css">

<link rel="stylesheet" href="/css/style.css"/>



    




</head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    





  


  




  
  
    
  
  



  
  
    
  
  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      
        <img src="/favicon_hu7c842f6b35a8d0374567474454be744c_4177_42x0_resize_box_3.png" alt="Logo">
      Abdelhak&#39;s Blog</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      </ul>
    </div>
  </div>
  
  
    <img src="/favicon_hu7c842f6b35a8d0374567474454be744c_4177_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="/favicon_hu7c842f6b35a8d0374567474454be744c_4177_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts" data-filter="all">Posts</a></li>
            <div class="subtree">
                

            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(https://abdelhakbougouffa.pro/images/default-hero.jpg);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/avatar_hu4ca9978d2de9ec8152cd2ee14d9907f8_291124_120x120_fit_q75_box.jpg' alt="Author Image">
          <h5 class="author-name">Abdelhak Bougouffa</h5>
          <p>Sunday, April 24, 2022</p>
        </div>

        <div class="title">
          <h1>Doom Emacs Configuration</h1>
        </div>
        
        <div class="post-content" id="post-content">
          <h2 id="intro">Intro</h2>
<p>I&rsquo;ve been using Linux exclusively since 2010, <strong>GNU Emacs</strong> was always installed on
my machine, but I didn&rsquo;t discover the <strong>real</strong> Emacs until 2020, in the beginning, I
started my Vanilla Emacs configuration from scratch, but after a while, it
becomes a mess. As a new Emacs user, I didn&rsquo;t understand the in the beginning how
to optimize my configuration and how to do things correctly. I discovered then
<a href="https://github.com/syl20bnr/spacemacs">Spacemacs</a>, which made things much easier, but it was a little slow, and just
after, I found the awesome <a href="https://github.com/hlissner/doom-emacs">Doom Emacs</a>, and since, I didn&rsquo;t quit my Emacs screen!</p>
<p>In the beginning, I was basically copying chunks of Emacs Lisp code from the
internet, which quickly becomes a mess, specially because I was using a mixture
of vanilla Emacs style configurations and Doom style ones.</p>
<p>Now I decided to rewrite a cleaner version of my configuration which will be
more Doom friendly, and for that, I found an excellent example in <em><a href="https://github.com/tecosaur">tecosaur</a></em>&rsquo;s
<a href="https://github.com/tecosaur/emacs-config.git">emacs-config</a>, so my current configuration is heavily inspired by <em>tecosaur</em>&rsquo;s.</p>
<h3 id="this-file">This file</h3>
<p>This is my literate configuration file, I use it to generate Doom&rsquo;s config files
(<code>$DOOMDIR/init.el</code>, <code>$DOOMDIR/packages.el</code> and <code>$DOOMDIR/config.el</code>), as well as some
other shell scripts, app installers, app launchers&hellip; etc.</p>
<p>Make <code>config.el</code> run (slightly) faster with lexical binding (see <a href="https://nullprogram.com/blog/2016/12/22/">this blog post</a>
for more info).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;;; config.el -*- lexical-binding: t; -*-</span>
</span></span></code></pre></div><p>Add the shebang and the description to the <code>setup.sh</code> file, which will be used to
set system settings and install some missing dependencies.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This is an automatically generated setup file, it installes some missing</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dependencies, configure system services, set system settings form better</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># desktop integration... etc.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Abdelhak BOUGOUFFA (c) 2022</span>
</span></span></code></pre></div><p>Add the shebang to the <code>~/.env_stuff</code> file used to define some aliases and helpers.
This needs to be sourced in the shell session (source it in <code>~/.zshrc</code>).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/zsh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This is an automatically generated file, it should be sourced from `~/.zshrc&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># it defines some useful aliases, and customize some environment variables for</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># better defaults.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Abdelhak BOUGOUFFA (c) 2022</span>
</span></span></code></pre></div><h2 id="general-settings">General Settings</h2>
<h3 id="user-information">User information</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq <span style="color:#a6e22e">user-full-name</span> <span style="color:#e6db74">&#34;Abdelhak Bougouffa&#34;</span>
</span></span><span style="display:flex;"><span>      user-mail-address <span style="color:#e6db74">&#34;abougouffa@fedoraproject.org&#34;</span>)
</span></span></code></pre></div><h3 id="secrets">Secrets</h3>
<p>Set the path to my GPG encrypted secrets. I like to set the cache expiry to <code>nil</code>
instead of the default 2 hours.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq auth-sources <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;~/.authinfo.gpg&#34;</span>)
</span></span><span style="display:flex;"><span>      auth-source-cache-expiry <span style="color:#66d9ef">nil</span> <span style="color:#75715e">; defaut is 2h (7200)</span>
</span></span><span style="display:flex;"><span>      password-cache-expiry <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>      password-cache <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>      auth-source-do-cache <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>      epa-file-cache-passphrase-for-symmetric-encryption <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><h3 id="better-defaults">Better defaults</h3>
<h4 id="file-deletion">File deletion</h4>
<p>Delete files by moving them to trash.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq-default delete-by-moving-to-trash <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><h4 id="window">Window</h4>
<p>Take new window space from all other windows (not just current).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq-default window-combination-resize <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><h5 id="split-defaults">Split defaults</h5>
<p>Split horizontally to right, vertically below the current window.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq evil-vsplit-window-right <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>      evil-split-window-below <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><p>Show list of buffers when splitting.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defadvice! prompt-for-buffer (<span style="color:#66d9ef">&amp;rest</span> _)
</span></span><span style="display:flex;"><span>  :after <span style="color:#f92672">&#39;</span>(evil-window-split evil-window-vsplit)
</span></span><span style="display:flex;"><span>  (consult-buffer))
</span></span></code></pre></div><h4 id="undo-and-auto-save">Undo and auto-save</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq undo-limit <span style="color:#ae81ff">80000000</span>   <span style="color:#75715e">; Raise undo-limit to 80Mb</span>
</span></span><span style="display:flex;"><span>      evil-want-fine-undo <span style="color:#66d9ef">t</span> <span style="color:#75715e">; By default while in insert all changes are one big blob. Be more granular</span>
</span></span><span style="display:flex;"><span>      auto-save-default <span style="color:#66d9ef">t</span>   <span style="color:#75715e">; Nobody likes to lose work, I certainly don&#39;t</span>
</span></span><span style="display:flex;"><span>      scroll-preserve-screen-position <span style="color:#e6db74">&#39;always</span> <span style="color:#75715e">; Don&#39;t have `point&#39; jump around</span>
</span></span><span style="display:flex;"><span>      scroll-margin <span style="color:#ae81ff">2</span>)      <span style="color:#75715e">; It&#39;s nice to maintain a little margin</span>
</span></span></code></pre></div><h4 id="editing">Editing</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; Stretch cursor to the glyph width</span>
</span></span><span style="display:flex;"><span>(setq-default x-stretch-cursor <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Enable relative line numbers</span>
</span></span><span style="display:flex;"><span>(setq display-line-numbers-type <span style="color:#e6db74">&#39;relative</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Iterate through CamelCase words</span>
</span></span><span style="display:flex;"><span>(global-subword-mode <span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><h4 id="frame">Frame</h4>
<h5 id="maximizing">Maximizing</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled, replaced with params passed to emacsclient</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; start the initial frame maximized</span>
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;initial-frame-alist</span> <span style="color:#f92672">&#39;</span>(fullscreen <span style="color:#f92672">.</span> maximized))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; start every frame maximized</span>
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;default-frame-alist</span> <span style="color:#f92672">&#39;</span>(fullscreen <span style="color:#f92672">.</span> maximized))
</span></span></code></pre></div><p>To avoid conflict when launching Emacs in <code>emacs-everywhere</code> mode. I&rsquo;m using it in
command line when calling <code>emacsclient</code>, by adding this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>--frame-parameters<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#39;(fullscreen . maximized)&#34;</span>
</span></span></code></pre></div><h5 id="focus-created-frame">Focus created frame</h5>
<p>The problem is, every time I launch an Emacs frame (from KDE), Emacs starts
with no focus, I need each time to <code>Alt-TAB</code> to get Emacs under focus, and then
start typing. I tried changing this behavior from Emacs by hooking <code>raise-frame</code>
at startup, but it didn&rsquo;t work.</p>
<p>Got from <a href="https://emacs.stackexchange.com/a/34740">this comment</a>, not working on my Emacs version.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled, not working</span>
</span></span><span style="display:flex;"><span>(add-hook <span style="color:#e6db74">&#39;server-switch-hook</span> <span style="color:#a6e22e">#&#39;raise-frame</span>)
</span></span></code></pre></div><p>After some investigations, I found that this issue is probably KDE specific, the
issue goes away by setting: <strong>Window Management &gt; Window Behavior &gt; Focus &gt; Focus
stealing prevention</strong> to <em>None</em> in the KDE Settings.</p>
<h5 id="margins">Margins</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled</span>
</span></span><span style="display:flex;"><span>(set-frame-parameter <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#39;internal-border-width</span> <span style="color:#ae81ff">15</span>)
</span></span></code></pre></div><h3 id="chemacs2">Chemacs2</h3>
<p>Add Chemacs2 profiles for a set of Emacs configurations. I&rsquo;m using DOOM Emacs,
however, I like to try other configs to get inspired!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>((<span style="color:#e6db74">&#34;doom&#34;</span>      <span style="color:#f92672">.</span> ((user-emacs-directory <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;~/.config/emacs.doom&#34;</span>)
</span></span><span style="display:flex;"><span>                 (env <span style="color:#f92672">.</span> ((<span style="color:#e6db74">&#34;DOOMDIR&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;~/.doom.d&#34;</span>)))))
</span></span><span style="display:flex;"><span> (<span style="color:#e6db74">&#34;rational&#34;</span>  <span style="color:#f92672">.</span> ((user-emacs-directory <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;~/.config/emacs.rational&#34;</span>)
</span></span><span style="display:flex;"><span>                 (env <span style="color:#f92672">.</span> ((<span style="color:#e6db74">&#34;RATIONAL_EMACS_HOME&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;~/.config/emacs.rational&#34;</span>)))))
</span></span><span style="display:flex;"><span> (<span style="color:#e6db74">&#34;scimax&#34;</span>    <span style="color:#f92672">.</span> ((user-emacs-directory <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;~/.config/emcas.scimax&#34;</span>)))
</span></span><span style="display:flex;"><span> (<span style="color:#e6db74">&#34;spacemacs&#34;</span> <span style="color:#f92672">.</span> ((user-emacs-directory <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;~/.config/emacs.spacemacs&#34;</span>))))
</span></span></code></pre></div><p>Make <code>doom</code> the default profile.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>doom
</span></span></code></pre></div><h2 id="modules--init-dot-el">Modules (<code>init.el</code>)</h2>
<p>Here is the literate configuration which generates the Doom&rsquo;s <code>init.el</code> file, this
file contains all the enabled Doom modules with the appropriate flags.</p>
<p>This section defines the default source blocks arguments
. All source blocks in this section
inherits these headers, so they will not be tangled unless overwriting in the
block&rsquo;s header.</p>
<h3 id="file-skeleton">File skeleton</h3>
<p>This first section defines the template for the subsections, it uses the <code>no-web</code>
syntax to include subsections specified as <code>&lt;&lt;sub-section-name&gt;&gt;</code>.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;;; init.el -*- lexical-binding: t; -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; This file controls what Doom modules are enabled and what order they load in.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Press &#39;K&#39; on a module to view its documentation, and &#39;gd&#39; to browse its directory.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(doom! :input
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-input&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :completion
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-completion&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :ui
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-ui&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :editor
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-editor&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :emacs
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-emacs&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :term
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-term&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :checkers
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-checkers&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :tools
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-tools&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :os
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-os&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :lang
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-lang&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :email
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-email&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :app
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-app&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       :config
</span></span><span style="display:flex;"><span>       &lt;&lt;doom-config&gt;&gt;
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><h3 id="input--input">Input (<code>:input</code>)</h3>
<p>Enable bidirectional languages support (<code>bidi</code>).</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>bidi
</span></span></code></pre></div><h3 id="general--config">General (<code>:config</code>)</h3>
<p>Enable <code>literate</code> configuration (like this file!), and some defaults.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>literate
</span></span><span style="display:flex;"><span>(default +bindings
</span></span><span style="display:flex;"><span>         +smartparens)
</span></span></code></pre></div><h3 id="completion--completion">Completion (<code>:completion</code>)</h3>
<p>I&rsquo;m lazy, I like Emacs to complete my writings.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(vertico +icons)             <span style="color:#75715e">; the search engine of the future</span>
</span></span><span style="display:flex;"><span>company                      <span style="color:#75715e">; the ultimate code completion backend</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(ivy +childframe           ; a search engine for love and life</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;     +fuzzy</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;     +icons</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;     +prescient)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;helm                       ; the *other* search engine for love and life</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;ido                        ; the other *other* search engine...</span>
</span></span></code></pre></div><h3 id="user-interface--ui">User interface (<code>:ui</code>)</h3>
<p>Enables some user interface features for better user experience, the beautiful
<code>modeline</code>, the <code>treemacs</code> project tree, better version control integration with
<code>vc-gutter</code>&hellip; and other useful stuff.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>deft                         <span style="color:#75715e">; notational velocity for Emacs</span>
</span></span><span style="display:flex;"><span>doom                         <span style="color:#75715e">; what makes DOOM look the way it does</span>
</span></span><span style="display:flex;"><span>doom-dashboard               <span style="color:#75715e">; a nifty splash screen for Emacs</span>
</span></span><span style="display:flex;"><span>hl-todo                      <span style="color:#75715e">; highlight TODO/FIXME/NOTE/DEPRECATED/HACK/REVIEW</span>
</span></span><span style="display:flex;"><span>hydra                        <span style="color:#75715e">; quick documentation for related commands</span>
</span></span><span style="display:flex;"><span>modeline                     <span style="color:#75715e">; snazzy, Atom-inspired modeline, plus API</span>
</span></span><span style="display:flex;"><span>nav-flash                    <span style="color:#75715e">; blink the current line after jumping</span>
</span></span><span style="display:flex;"><span>ophints                      <span style="color:#75715e">; highlight the region an operation acts on</span>
</span></span><span style="display:flex;"><span>vc-gutter                    <span style="color:#75715e">; vcs diff in the fringe</span>
</span></span><span style="display:flex;"><span>workspaces                   <span style="color:#75715e">; tab emulation, persistence &amp; separate workspaces</span>
</span></span><span style="display:flex;"><span>zen                          <span style="color:#75715e">; distraction-free coding or writing</span>
</span></span><span style="display:flex;"><span>(window-select +numbers)     <span style="color:#75715e">; visually switch windows</span>
</span></span><span style="display:flex;"><span>(ligatures +extra)           <span style="color:#75715e">; ligatures and symbols to make your code pretty again</span>
</span></span><span style="display:flex;"><span>(treemacs +lsp)              <span style="color:#75715e">; a project drawer, like neotree but cooler</span>
</span></span><span style="display:flex;"><span>(popup +all                  <span style="color:#75715e">; tame sudden yet inevitable temporary windows</span>
</span></span><span style="display:flex;"><span>       +defaults)
</span></span><span style="display:flex;"><span>(emoji +ascii
</span></span><span style="display:flex;"><span>       +unicode
</span></span><span style="display:flex;"><span>       +github)
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;doom-quit                  ; DOOM quit-message prompts when you quit Emacs</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;fill-column                ; a `fill-column&#39; indicator</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;indent-guides              ; highlighted indent columns, notoriously slow</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;minimap                    ; show a map of the code on the side</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;neotree                    ; a project drawer, like NERDTree for vim</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;unicode                    ; extended unicode support for various languages</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;tabs                       ; a tab bar for Emacs</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;vi-tilde-fringe            ; fringe tildes to mark beyond EOB</span>
</span></span></code></pre></div><h3 id="editor--editor">Editor (<code>:editor</code>)</h3>
<p>Some editing modules, the most important feature is EVIL to enable Vim style
editing in Emacs. I like also to edit with multiple cursors, enable <code>yasnippet</code>
support, wrap long lines, auto format support.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(evil +everywhere)           <span style="color:#75715e">; come to the dark side, we have cookies</span>
</span></span><span style="display:flex;"><span>(objed +manual)              <span style="color:#75715e">; text object editing for the innocent</span>
</span></span><span style="display:flex;"><span>file-templates               <span style="color:#75715e">; auto-snippets for empty files</span>
</span></span><span style="display:flex;"><span>fold                         <span style="color:#75715e">; (nigh) universal code folding</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">format</span>                       <span style="color:#75715e">; automated prettiness</span>
</span></span><span style="display:flex;"><span>multiple-cursors             <span style="color:#75715e">; editing in many places at once</span>
</span></span><span style="display:flex;"><span>parinfer                     <span style="color:#75715e">; turn lisp into python, sort of</span>
</span></span><span style="display:flex;"><span>snippets                     <span style="color:#75715e">; my elves. They type, so I don&#39;t have to</span>
</span></span><span style="display:flex;"><span>word-wrap                    <span style="color:#75715e">; soft wrapping with language-aware indent</span>
</span></span><span style="display:flex;"><span>lispy                        <span style="color:#75715e">; vim for lisp, for people who don&#39;t like vim</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;god                        ; run Emacs commands without modifier keys</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;rotate-text                ; cycle region at point between text candidates</span>
</span></span></code></pre></div><h3 id="emacs-builtin--emacs">Emacs&rsquo; builtin (<code>:emacs</code>)</h3>
<p>Beautify Emacs builtin packages.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(dired +icons                <span style="color:#75715e">; making dired pretty [functional]</span>
</span></span><span style="display:flex;"><span>       +ranger)
</span></span><span style="display:flex;"><span>(ibuffer +icons)             <span style="color:#75715e">; interactive buffer management</span>
</span></span><span style="display:flex;"><span>(undo +tree)                 <span style="color:#75715e">; persistent, smarter undo for your inevitable mistakes</span>
</span></span><span style="display:flex;"><span>electric                     <span style="color:#75715e">; smarter, keyword-based electric-indent</span>
</span></span><span style="display:flex;"><span>vc                           <span style="color:#75715e">; version-control and Emacs, sitting in a tree</span>
</span></span></code></pre></div><h3 id="terminals--term">Terminals (<code>:term</code>)</h3>
<p>Run commands in terminal from Emacs. I use mainly <code>vterm</code> on my local machine,
however, I like to have <code>eshell</code>, <code>shell</code> and <code>term</code> installed to use them for remote
file editing (via Tramp).</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>eshell                       <span style="color:#75715e">; the elisp shell that works everywhere</span>
</span></span><span style="display:flex;"><span>vterm                        <span style="color:#75715e">; the best terminal emulation in Emacs</span>
</span></span><span style="display:flex;"><span>shell                        <span style="color:#75715e">; simple shell REPL for Emacs</span>
</span></span><span style="display:flex;"><span>term                         <span style="color:#75715e">; basic terminal emulator for Emacs</span>
</span></span></code></pre></div><h3 id="checkers--checkers">Checkers (<code>:checkers</code>)</h3>
<p>I like to check my documents for errors while I&rsquo;m typing. The <code>grammar</code> module
enables <a href="https://languagetool.org/">LanguageTool</a> support.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(syntax +childframe)   <span style="color:#75715e">; tasing you for every semicolon you forget</span>
</span></span><span style="display:flex;"><span>(spell +aspell)
</span></span><span style="display:flex;"><span>grammar                <span style="color:#75715e">; tasing grammar mistake every you make</span>
</span></span></code></pre></div><h3 id="tools--tools">Tools (<code>:tools</code>)</h3>
<p>I enable some useful tools which facilitate my work flow, I like to enable
Docker support, <a href="https://editorconfig.org">EditorConfig</a> is a good feature to have. I like to enable
<code>lsp-mode</code> and <code>dap-mode</code> for coding and debugging by enabling the <code>lsp</code> and <code>debugger</code>
modules with <code>+lsp</code> support (further customization for <code>lsp</code> and <code>dap</code> below). <code>pdf</code>
adds support through <code>pdf-tools</code>, which are great for viewing PDF files inside
Emacs, I also enable some extra tools, like <code>magit</code>, <code>lookup</code>, <code>tmux</code>&hellip; etc.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>direnv
</span></span><span style="display:flex;"><span>editorconfig           <span style="color:#75715e">; let someone else argue about tabs vs spaces</span>
</span></span><span style="display:flex;"><span>ein                    <span style="color:#75715e">; tame Jupyter notebooks with emacs</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;biblio               ; Writes a PhD for you (citation needed)</span>
</span></span><span style="display:flex;"><span>gist                   <span style="color:#75715e">; interacting with github gists</span>
</span></span><span style="display:flex;"><span>make                   <span style="color:#75715e">; run make tasks from Emacs</span>
</span></span><span style="display:flex;"><span>pdf                    <span style="color:#75715e">; pdf enhancements</span>
</span></span><span style="display:flex;"><span>rgb                    <span style="color:#75715e">; creating color strings</span>
</span></span><span style="display:flex;"><span>tmux                   <span style="color:#75715e">; an API for interacting with tmux</span>
</span></span><span style="display:flex;"><span>upload                 <span style="color:#75715e">; map local to remote projects via ssh/ftp</span>
</span></span><span style="display:flex;"><span>(lsp +peek)            <span style="color:#75715e">; LPS</span>
</span></span><span style="display:flex;"><span>(debugger +lsp)        <span style="color:#75715e">; FIXME stepping through code, to help you add bugs</span>
</span></span><span style="display:flex;"><span>(docker +lsp)
</span></span><span style="display:flex;"><span>(<span style="color:#a6e22e">eval</span> +overlay)        <span style="color:#75715e">; run code, run (also, repls)</span>
</span></span><span style="display:flex;"><span>(lookup +docsets)      <span style="color:#75715e">; navigate your code and its documentation</span>
</span></span><span style="display:flex;"><span>(magit +forge)         <span style="color:#75715e">; a git porcelain for Emacs</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;ansible</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;pass                 ; password manager for nerds</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;prodigy              ; FIXME managing external services &amp; code builders</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;taskrunner           ; taskrunner for all your projects</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;terraform            ; infrastructure as code</span>
</span></span></code></pre></div><h3 id="operating-system--os">Operating system (<code>:os</code>)</h3>
<p>I enable <code>tty</code> for better support of terminal editing.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(tty +osc)             <span style="color:#75715e">; Configures Emacs for use in the terminal</span>
</span></span></code></pre></div><h3 id="language-support--lang">Language support (<code>:lang</code>)</h3>
<p>Most of the projects I&rsquo;m working on are mainly written in C/C++, Python, Rust
and some Lisp stuff, I edit also a lot of configuration and data files in
several formats (<code>csv</code>, <code>yaml</code>, <code>xml</code>, <code>json</code>, <code>shell</code> scripts&hellip;). I use Org-mode to
manage all my papers and notes, so I need to enable as many features as I need,
I do enable <code>plantuml</code> also to quickly plot UML models withing Org documents.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>plantuml               <span style="color:#75715e">; diagrams for confusing people more</span>
</span></span><span style="display:flex;"><span>emacs-lisp             <span style="color:#75715e">; drown in parentheses</span>
</span></span><span style="display:flex;"><span>common-lisp            <span style="color:#75715e">; if you&#39;ve seen one lisp, you&#39;ve seen them all</span>
</span></span><span style="display:flex;"><span>markdown               <span style="color:#75715e">; writing docs for people to ignore</span>
</span></span><span style="display:flex;"><span>data                   <span style="color:#75715e">; config/data formats</span>
</span></span><span style="display:flex;"><span>qt                     <span style="color:#75715e">; the &#39;cutest&#39; gui framework ever</span>
</span></span><span style="display:flex;"><span>(cc +lsp)              <span style="color:#75715e">; C/C++/Obj-C madness</span>
</span></span><span style="display:flex;"><span>(json +lsp)            <span style="color:#75715e">; At least it ain&#39;t XML</span>
</span></span><span style="display:flex;"><span>(julia +lsp)           <span style="color:#75715e">; a better, faster MATLAB</span>
</span></span><span style="display:flex;"><span>(latex +lsp)           <span style="color:#75715e">; writing papers in Emacs has never been so fun</span>
</span></span><span style="display:flex;"><span>(rust +lsp)            <span style="color:#75715e">; Fe2O3.unwrap().unwrap().unwrap().unwrap()</span>
</span></span><span style="display:flex;"><span>(ess +lsp)             <span style="color:#75715e">; emacs speaks statistics</span>
</span></span><span style="display:flex;"><span>(yaml +lsp)            <span style="color:#75715e">; JSON, but readable</span>
</span></span><span style="display:flex;"><span>(sh +lsp)              <span style="color:#75715e">; she sells {ba,z,fi}sh shells on the C xor</span>
</span></span><span style="display:flex;"><span>(python +lsp           <span style="color:#75715e">; beautiful is better than ugly</span>
</span></span><span style="display:flex;"><span>        +pyright
</span></span><span style="display:flex;"><span>        +pyenv
</span></span><span style="display:flex;"><span>        +conda)
</span></span><span style="display:flex;"><span>(org +dragndrop        <span style="color:#75715e">; organize your plain life in plain text</span>
</span></span><span style="display:flex;"><span>     +gnuplot
</span></span><span style="display:flex;"><span>     +jupyter
</span></span><span style="display:flex;"><span>     +pandoc
</span></span><span style="display:flex;"><span>     +noter
</span></span><span style="display:flex;"><span>     +hugo
</span></span><span style="display:flex;"><span>     +present
</span></span><span style="display:flex;"><span>     +pomodoro
</span></span><span style="display:flex;"><span>     +roam2
</span></span><span style="display:flex;"><span>     +pretty)
</span></span><span style="display:flex;"><span>(racket +lsp           <span style="color:#75715e">; a DSL for DSLs</span>
</span></span><span style="display:flex;"><span>        +xp)
</span></span><span style="display:flex;"><span>(scheme +mit           <span style="color:#75715e">; a fully conniving family of lisps</span>
</span></span><span style="display:flex;"><span>        +guile
</span></span><span style="display:flex;"><span>        +racket
</span></span><span style="display:flex;"><span>        +chez)
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;rst                  ; ReST in peace</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(lua +lsp)           ; one-based indices? one-based indices</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;agda                 ; types of types of types of types...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(clojure +lsp)       ; java with a lisp</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;coq                  ; proofs-as-programs</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;crystal              ; ruby at the speed of c</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;csharp               ; unity, .NET, and mono shenanigans</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(dart +flutter)      ; paint ui and not much else</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;elixir               ; erlang done right</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;elm                  ; care for a cup of TEA?</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;erlang               ; an elegant language for a more civilized age</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;faust                ; dsp, but you get to keep your soul</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;fsharp               ; ML stands for Microsoft&#39;s Language</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;fstar                ; (dependent) types and (monadic) effects and Z3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;gdscript             ; the language you waited for</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(go +lsp)            ; the hipster dialect</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(haskell +dante)     ; a language that&#39;s lazier than I am</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;hy                   ; readability of scheme w/ speed of python</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;idris                ;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(java +meghanada)    ; the poster child for carpal tunnel syndrome</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;javascript           ; all(hope(abandon(ye(who(enter(here))))))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;kotlin               ; a better, slicker Java(Script)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;lean</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;factor</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;ledger               ; an accounting system in Emacs</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;nim                  ; python + lisp at the speed of c</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;nix                  ; I hereby declare &#34;nix geht mehr!&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;ocaml                ; an objective camel</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;php                  ; perl&#39;s insecure younger brother</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;purescript           ; javascript, but functional</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;raku                 ; the artist formerly known as perl6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;rest                 ; Emacs as a REST client</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(ruby +rails)        ; 1.step {|i| p &#34;Ruby is #{i.even? ? &#39;love&#39; : &#39;life&#39;}&#34;}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;scala                ; java, but good</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;sml</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;solidity             ; do you need a blockchain? No.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;swift                ; who asked for emoji variables?</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;terra                ; Earth and Moon in alignment for performance.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;web                  ; the tubes</span>
</span></span></code></pre></div><h3 id="email--email">Email (<code>:email</code>)</h3>
<p>I like to use <code>mu4e</code> to manage mail mailboxes. The <code>+org</code> flag adds <code>org-msg</code> support and
<code>+gmail</code> adds better management of Gmail accounts.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(mu4e +org
</span></span><span style="display:flex;"><span>      +gmail)
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(notmuch +org</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;         +afew)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(wanderlust +gmail)</span>
</span></span></code></pre></div><h3 id="apps--app">Apps (<code>:app</code>)</h3>
<p>Emacs contains a ton of applications, some of them are supported by Doom, I like
to use Emacs manage my calendar, chat on IRC, and receive news. I do use EMMS
sometimes to play music without leaving Emacs, and I like to enable support for
<code>emacs-everywhere</code>.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>calendar
</span></span><span style="display:flex;"><span>irc                    <span style="color:#75715e">; how neckbeards socialize</span>
</span></span><span style="display:flex;"><span>emms
</span></span><span style="display:flex;"><span>everywhere             <span style="color:#75715e">; *leave* Emacs!? You must be joking</span>
</span></span><span style="display:flex;"><span>(rss +org)             <span style="color:#75715e">; emacs as an RSS reader</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;twitter              ; twitter client https://twitter.com/vnought</span>
</span></span></code></pre></div><h2 id="doom-configuration">Doom Configuration</h2>
<h3 id="user-interface">User Interface</h3>
<h4 id="font-face">Font Face</h4>
<p>Doom exposes five (optional) variables for controlling fonts in Doom. Here are
the three important ones: <code>doom-font</code>, <code>doom-unicode-font</code> and
<code>doom-variable-pitch-font</code>. The <code>doom-big-font</code> is used for <code>doom-big-font-mode</code>; use
this for presentations or streaming.</p>
<p>They all accept either a <code>font-spec</code>, font string (<code>&quot;Input Mono-12&quot;</code>), or xlfd
font string. You generally only need these two:</p>
<p>Some good fonts:</p>
<ul>
<li><code>Iosevka Fixed</code> (THE FONT)</li>
<li>Nerd fonts
<ul>
<li><code>FantasqueSansMono Nerd Font Mono</code></li>
<li><code>mononoki Nerd Font Mono</code></li>
<li><code>CaskaydiaCove Nerd Font Mono</code></li>
</ul>
</li>
<li><code>Cascadia Code</code></li>
<li><code>Fantasque Sans Mono</code></li>
<li><code>JuliaMono</code> (good Unicode support)</li>
<li><code>IBM Plex Mono</code></li>
<li><code>JetBrains Mono</code></li>
<li><code>Roboto Mono</code></li>
<li><code>Source Code Pro</code></li>
<li><code>Input Mono Narrow</code></li>
<li><code>Fira Code</code></li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq doom-font (<span style="color:#a6e22e">font-spec</span> :family <span style="color:#e6db74">&#34;FantasqueSansMono Nerd Font Mono&#34;</span> :size <span style="color:#ae81ff">20</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">;; doom-variable-pitch-font (font-spec :family &#34;Latin Modern Roman&#34;) ; inherits the :size from doom-font</span>
</span></span><span style="display:flex;"><span>      doom-variable-pitch-font (<span style="color:#a6e22e">font-spec</span> :family <span style="color:#e6db74">&#34;Andika&#34;</span>) <span style="color:#75715e">; inherits the :size from doom-font</span>
</span></span><span style="display:flex;"><span>      doom-unicode-font (<span style="color:#a6e22e">font-spec</span> :family <span style="color:#e6db74">&#34;JuliaMono&#34;</span>)
</span></span><span style="display:flex;"><span>      doom-serif-font (<span style="color:#a6e22e">font-spec</span> :family <span style="color:#e6db74">&#34;FantasqueSansMono Nerd Font Mono&#34;</span> :weight <span style="color:#e6db74">&#39;light</span>))
</span></span></code></pre></div><h4 id="theme">Theme</h4>
<p>Set Doom&rsquo;s theme, some good choices:</p>
<ul>
<li><code>doom-palenight</code></li>
<li><code>doom-one</code></li>
<li><code>doom-vibrant</code></li>
<li><code>doom-dark+</code> (VS Code like)</li>
<li><code>doom-tomorrow-night</code></li>
<li><code>doom-xcode</code></li>
<li><code>doom-material</code></li>
<li><code>doom-ayu-mirage</code></li>
<li><code>doom-monokai-pro</code></li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq doom-theme <span style="color:#e6db74">&#39;doom-one</span>) <span style="color:#75715e">; Load theme</span>
</span></span></code></pre></div><h4 id="mode-line">Mode line</h4>
<h5 id="clock">Clock</h5>
<p>Display time and set the format to 24h.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! doom-modeline
</span></span><span style="display:flex;"><span>  (setq display-time-string-forms
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#39;</span>((<span style="color:#a6e22e">propertize</span> (<span style="color:#a6e22e">concat</span> 24-hours <span style="color:#e6db74">&#34;:&#34;</span> minutes))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (display-time-mode <span style="color:#ae81ff">1</span>)) <span style="color:#75715e">; Enable time in the mode-line</span>
</span></span></code></pre></div><h5 id="battery">Battery</h5>
<p>Show battery level unless battery is not present or battery information is unknown.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; This code causes &#39;doom doctor&#39; to fail. TODO: What&#39;s wrong with this function?</span>
</span></span><span style="display:flex;"><span>(after! doom-modeline
</span></span><span style="display:flex;"><span>  (defun ab/display-battery ()
</span></span><span style="display:flex;"><span>    (let ((batt-status (battery)))
</span></span><span style="display:flex;"><span>      (unless (or (string-match-p <span style="color:#e6db74">&#34;unknown&#34;</span>    batt-status)
</span></span><span style="display:flex;"><span>                  (string-match-p <span style="color:#e6db74">&#34;^Power N/A&#34;</span> batt-status))
</span></span><span style="display:flex;"><span>        (display-battery-mode <span style="color:#ae81ff">1</span>)))) <span style="color:#75715e">; it&#39;s nice to know how much power you have</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (ab/display-battery))
</span></span></code></pre></div><h4 id="set-transparency">Set transparency</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled</span>
</span></span><span style="display:flex;"><span>(set-frame-parameter (<span style="color:#a6e22e">selected-frame</span>) <span style="color:#e6db74">&#39;alpha</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">98</span> <span style="color:#ae81ff">100</span>))
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;default-frame-alist</span> <span style="color:#f92672">&#39;</span>(alpha <span style="color:#ae81ff">98</span> <span style="color:#ae81ff">100</span>))
</span></span></code></pre></div><h4 id="splash-screen">Splash Screen</h4>
<h5 id="custom-splash-image">Custom Splash Image</h5>
<p>Change the logo to an image, a set of beautiful images can be found in <code>assets</code>.</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Preview</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>emacs-e.svg</code></td>
<td><img src="/ox-hugo/emacs-e.svg" alt=""></td>
</tr>
<tr>
<td><code>gnu-emacs-white.svg</code></td>
<td><img src="/ox-hugo/gnu-emacs-white.svg" alt=""></td>
</tr>
<tr>
<td><code>gnu-emacs-flat.svg</code></td>
<td><img src="/ox-hugo/gnu-emacs-light.svg" alt=""></td>
</tr>
<tr>
<td><code>blackhole-lines.svg</code></td>
<td><img src="/ox-hugo/blackhole-lines.svg" alt=""></td>
</tr>
<tr>
<td><code>doom-emacs-white.svg</code></td>
<td><img src="/ox-hugo/doom-emacs-white.svg" alt=""></td>
</tr>
<tr>
<td><code>doom-emacs-dark.svg</code></td>
<td><img src="/ox-hugo/doom-emacs-dark.svg" alt=""></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq fancy-splash-image (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;assets/emacs-e.png&#34;</span> doom-private-dir))
</span></span></code></pre></div><h5 id="clean-screen">Clean Screen</h5>
<p>Let&rsquo;s disable the dashboard commands, for a particularly <em>clean</em> look disable the
mode-line and <code>hl-line-mode</code>, then also hide the cursor.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(remove-hook <span style="color:#e6db74">&#39;+doom-dashboard-functions</span> <span style="color:#a6e22e">#&#39;</span>doom-dashboard-widget-shortmenu)
</span></span><span style="display:flex;"><span>(add-hook!   <span style="color:#e6db74">&#39;+doom-dashboard-mode-hook</span> (hide-mode-line-mode <span style="color:#ae81ff">1</span>) (hl-line-mode <span style="color:#ae81ff">-1</span>))
</span></span><span style="display:flex;"><span>(setq-hook!  <span style="color:#e6db74">&#39;+doom-dashboard-mode-hook</span> evil-normal-state-cursor (<span style="color:#a6e22e">list</span> <span style="color:#66d9ef">nil</span>))
</span></span></code></pre></div><h5 id="the-ascii-banner">The ASCII Banner</h5>
<p>Add an ASCII banner, used in terminal mode.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun doom-dashboard-draw-ascii-emacs-banner-fn ()
</span></span><span style="display:flex;"><span>  (let* ((banner
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;______  _____  _____ ___  ___&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;|  _  \|  _  ||  _  ||  \/  |&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;| | | || | | || | | || .  . |&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;| | | || | | || | | || |\/| |&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;| |/ / \ \_/ /\ \_/ /| |  | |&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;|___/   \___/  \___/ \_|  |_/&#34;</span>))
</span></span><span style="display:flex;"><span>         (longest-line (<span style="color:#a6e22e">apply</span> <span style="color:#a6e22e">#&#39;max</span> (<span style="color:#a6e22e">mapcar</span> <span style="color:#a6e22e">#&#39;length</span> banner))))
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">put-text-property</span>
</span></span><span style="display:flex;"><span>     (<span style="color:#a6e22e">point</span>)
</span></span><span style="display:flex;"><span>     (dolist (line banner (<span style="color:#a6e22e">point</span>))
</span></span><span style="display:flex;"><span>       (<span style="color:#a6e22e">insert</span> (+doom-dashboard--center
</span></span><span style="display:flex;"><span>                +doom-dashboard--width
</span></span><span style="display:flex;"><span>                (<span style="color:#a6e22e">concat</span> line (<span style="color:#a6e22e">make-string</span> (<span style="color:#a6e22e">max</span> <span style="color:#ae81ff">0</span> (<span style="color:#a6e22e">-</span> longest-line (<span style="color:#a6e22e">length</span> line))) <span style="color:#ae81ff">32</span>))))
</span></span><span style="display:flex;"><span>       <span style="color:#e6db74">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;doom-dashboard-banner</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(unless (display-graphic-p) <span style="color:#75715e">; for some reason this messes up the graphical splash screen atm</span>
</span></span><span style="display:flex;"><span>  (setq +doom-dashboard-ascii-banner-fn <span style="color:#a6e22e">#&#39;</span>doom-dashboard-draw-ascii-emacs-banner-fn))
</span></span></code></pre></div><h4 id="which-key">Which key</h4>
<p>Make <code>which-key</code> popup faster.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq which-key-idle-delay <span style="color:#ae81ff">0.5</span> <span style="color:#75715e">;; Default is 1.0</span>
</span></span><span style="display:flex;"><span>      which-key-idle-secondary-delay <span style="color:#ae81ff">0.05</span>) <span style="color:#75715e">;; Default is nil</span>
</span></span></code></pre></div><h4 id="window-title">Window title</h4>
<p>Id like to have just the buffer name, then if applicable the project folder</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq frame-title-format
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        (:eval
</span></span><span style="display:flex;"><span>         (if (s-contains-p org-roam-directory (or <span style="color:#a6e22e">buffer-file-name</span> <span style="color:#e6db74">&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>             (replace-regexp-in-string
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#34;.*/[0-9]*-?&#34;</span> <span style="color:#e6db74">&#34; &#34;</span>
</span></span><span style="display:flex;"><span>              (subst-char-in-string <span style="color:#e6db74">?_</span> <span style="color:#e6db74">? </span> <span style="color:#a6e22e">buffer-file-name</span>))
</span></span><span style="display:flex;"><span>           <span style="color:#e6db74">&#34;%b&#34;</span>))
</span></span><span style="display:flex;"><span>        (:eval
</span></span><span style="display:flex;"><span>         (let ((project-name (projectile-project-name)))
</span></span><span style="display:flex;"><span>           (unless (string= <span style="color:#e6db74">&#34;-&#34;</span> project-name)
</span></span><span style="display:flex;"><span>             (<span style="color:#a6e22e">format</span> (if (<span style="color:#a6e22e">buffer-modified-p</span>) <span style="color:#e6db74">&#34;  %s&#34;</span> <span style="color:#e6db74">&#34;  %s&#34;</span>) project-name))))))
</span></span></code></pre></div><h4 id="vertico">Vertico</h4>
<p>Since <a href="https://github.com/hlissner/doom-emacs/commit/ece4a74a9b2ac84a4e85be3d094ceb4f0a441e39">doom-emacs@ece4a74</a>, Doom supports the <code>+childframe</code> for <code>:completion vertico</code>.
This can be used to adjust the left and right fringes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! vertico-posframe
</span></span><span style="display:flex;"><span>  (setq vertico-posframe-parameters
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#39;</span>((left-fringe <span style="color:#f92672">.</span> <span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>          (right-fringe <span style="color:#f92672">.</span> <span style="color:#ae81ff">14</span>))))
</span></span></code></pre></div><h3 id="editor">Editor</h3>
<h4 id="scratch-buffer">Scratch buffer</h4>
<p>Tell the scratch buffer to start in <code>emacs-lisp-mode</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq doom-scratch-initial-major-mode <span style="color:#e6db74">&#39;emacs-lisp-mode</span>)
</span></span></code></pre></div><h4 id="mouse-buttons">Mouse Buttons</h4>
<p>Map extra mouse buttons to jump between buffers</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(map! :n [mouse-8] <span style="color:#a6e22e">#&#39;</span>better-jumper-jump-backward
</span></span><span style="display:flex;"><span>      :n [mouse-9] <span style="color:#a6e22e">#&#39;</span>better-jumper-jump-forward)
</span></span></code></pre></div><h4 id="binary-files">Binary files</h4>
<p>Taken from <a href="https://emacs.stackexchange.com/questions/10277/make-emacs-automatically-open-binary-files-in-hexl-mode">this answer</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun buffer-binary-p (<span style="color:#66d9ef">&amp;optional</span> buffer)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Return whether BUFFER or the current buffer is binary.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">A binary buffer is defined as containing at least one null byte.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Returns either nil, or the position of the first null byte.&#34;</span>
</span></span><span style="display:flex;"><span>  (with-current-buffer (or buffer (<span style="color:#a6e22e">current-buffer</span>))
</span></span><span style="display:flex;"><span>    (save-excursion
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-min</span>))
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">search-forward</span> (<span style="color:#a6e22e">string</span> <span style="color:#e6db74">?\x</span><span style="color:#ae81ff">00</span>) <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">t</span> <span style="color:#ae81ff">1</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun hexl-if-binary ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;If </span><span style="color:#e6db74">`hexl-mode&#39;</span><span style="color:#e6db74"> is not already active, and the current buffer
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">is binary, activate </span><span style="color:#e6db74">`hexl-mode&#39;</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (unless (<span style="color:#a6e22e">eq</span> major-mode <span style="color:#e6db74">&#39;hexl-mode</span>)
</span></span><span style="display:flex;"><span>    (when (buffer-binary-p)
</span></span><span style="display:flex;"><span>      (hexl-mode))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;magic-fallback-mode-alist</span> <span style="color:#f92672">&#39;</span>(buffer-binary-p <span style="color:#f92672">.</span> hexl-mode) <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><h3 id="allow-babel-execution-in-doom-cli-actions">Allow babel execution in <code>doom</code> CLI actions</h3>
<p>This file generates all my Doom config files, it works nicely, but for it to
work with <code>doom sync</code> et al. I need to make sure that Org doesn&rsquo;t try to confirm
that I want to allow evaluation (I do!).</p>
<p>Thankfully Doom supports <code>$DOOMDIR/cli.el</code> file which is sourced every time a CLI
command is run, so we can just enable evaluation by setting
<code>org-confirm-babel-evaluate</code> to <code>nil</code> there.</p>
<p>While we&rsquo;re at it, we should silence <code>org-babel-execute-src-block</code> to
avoid polluting the output.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;;; cli.el -*- lexical-binding: t; -*-</span>
</span></span><span style="display:flex;"><span>(setq org-confirm-babel-evaluate <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun doom-shut-up-a (orig-fn <span style="color:#66d9ef">&amp;rest</span> args)
</span></span><span style="display:flex;"><span>  (quiet! (<span style="color:#a6e22e">apply</span> orig-fn args)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(advice-add <span style="color:#e6db74">&#39;org-babel-execute-src-block</span> :around <span style="color:#a6e22e">#&#39;</span>doom-shut-up-a)
</span></span></code></pre></div><h3 id="asynchronous-config-tangling">Asynchronous config tangling</h3>
<p>Doom adds an <code>org-mode</code> hook <code>+literate-enable-recompile-h</code>. This is a nice idea,
but it&rsquo;s too blocking for my taste. Since I trust my tangling to be fairly
straightforward, I&rsquo;ll just redefine it to a simpler, async, function.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defadvice! +literate-tangle-async-h ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;A very simplified version of </span><span style="color:#e6db74">`+literate-tangle-h&#39;</span><span style="color:#e6db74">, but async.&#34;</span>
</span></span><span style="display:flex;"><span>  :override <span style="color:#a6e22e">#&#39;</span>+literate-tangle-h
</span></span><span style="display:flex;"><span>  (let ((default-directory doom-private-dir))
</span></span><span style="display:flex;"><span>    (async-shell-command
</span></span><span style="display:flex;"><span>     (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;emacs --batch --eval \&#34;(progn \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">(require &#39;org) (setq org-confirm-babel-evaluate nil) \
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">(org-babel-tangle-file \\\&#34;%s\\\&#34;))\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>             +literate-config-file))))
</span></span></code></pre></div><h2 id="additional-packages--packages-dot-el">Additional Packages (<code>packages.el</code>)</h2>
<p>This file shouldn&rsquo;t be byte compiled.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; -*- no-byte-compile: t; -*-</span>
</span></span></code></pre></div><h3 id="general-packages">General Packages</h3>
<h4 id="weather">Weather</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; lisp/wttrin/wttrin.el taken from:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; https://raw.githubusercontent.com/tecosaur/emacs-config/master/lisp/wttrin/wttrin.el</span>
</span></span><span style="display:flex;"><span>(package! wttrin
</span></span><span style="display:flex;"><span>  :recipe (:local-repo <span style="color:#e6db74">&#34;lisp/wttrin&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! wttrin
</span></span><span style="display:flex;"><span>  :commands wttrin)
</span></span></code></pre></div><h4 id="caldav"><!-- raw HTML omitted -->TODO<!-- raw HTML omitted --> CalDAV</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! caldav
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;dengste/org-caldav&#34;</span>))
</span></span></code></pre></div><h4 id="xkcd"><code>xkcd</code></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! xkcd
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;vibhavp/emacs-xkcd&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! xkcd
</span></span><span style="display:flex;"><span>  :commands (xkcd-get xkcd)
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (setq xkcd-cache-dir (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;xkcd/&#34;</span> doom-cache-dir)
</span></span><span style="display:flex;"><span>        xkcd-cache-latest (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;xkcd/latest&#34;</span> doom-cache-dir)))
</span></span></code></pre></div><h3 id="themes-and-ui">Themes and UI</h3>
<h4 id="svg-tag-mode">SVG Tag Mode</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! svg-tag-mode)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! svg-tag-mode
</span></span><span style="display:flex;"><span>  :commands svg-tag-mode
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (setq svg-tag-tags
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">&#34;^\\*.* .* \\(:[A-Za-z0-9]+\\)&#34;</span> <span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>         ((lambda (tag) (svg-tag-make tag
</span></span><span style="display:flex;"><span>                                 :beg <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                                 :font-family <span style="color:#e6db74">&#34;Roboto Mono&#34;</span>
</span></span><span style="display:flex;"><span>                                 :font-size <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>                                 :height <span style="color:#ae81ff">0.6</span>
</span></span><span style="display:flex;"><span>                                 :padding <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                                 :margin <span style="color:#ae81ff">0</span>))))
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">&#34;\\(:[A-Za-z0-9]+:\\)$&#34;</span> <span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>         ((lambda (tag) (svg-tag-make tag
</span></span><span style="display:flex;"><span>                                 :beg <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                                 :end <span style="color:#ae81ff">-1</span>
</span></span><span style="display:flex;"><span>                                 :font-family <span style="color:#e6db74">&#34;Roboto Mono&#34;</span>
</span></span><span style="display:flex;"><span>                                 :font-size <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>                                 :height <span style="color:#ae81ff">0.6</span>
</span></span><span style="display:flex;"><span>                                 :padding <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                                 :margin <span style="color:#ae81ff">0</span>)))))))
</span></span></code></pre></div><h4 id="n--n-o">N  N O</h4>
<p>Dim the font color of text in surrounding paragraphs, focus only on the current line.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! nano-doom
</span></span><span style="display:flex;"><span>  :disable <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>  :recipe (:host github :repo <span style="color:#e6db74">&#34;skyler544/doom-nano-testing&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Note tangled</span>
</span></span><span style="display:flex;"><span>(require <span style="color:#e6db74">&#39;load-nano</span>)
</span></span></code></pre></div><h4 id="bespoke-themes">Bespoke themes</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! bespoke-themes
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;mclear-tools/bespoke-themes&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(package! bespoke-modeline
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;mclear-tools/bespoke-modeline&#34;</span>))
</span></span></code></pre></div><h4 id="focus">Focus</h4>
<p>Dim the font color of text in surrounding paragraphs, focus only on the current line.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! focus)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! focus
</span></span><span style="display:flex;"><span>  :commands focus-mode)
</span></span></code></pre></div><h4 id="goggles">Goggles</h4>
<p>Visual feedback after kill/yank actions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! goggles
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;minad/goggles&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! goggles
</span></span><span style="display:flex;"><span>  :hook ((prog-mode text-mode) <span style="color:#f92672">.</span> goggles-mode)
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (setq-default goggles-pulse <span style="color:#66d9ef">t</span>)) <span style="color:#75715e">;; set to nil to disable pulsing</span>
</span></span></code></pre></div><h4 id="smooth-scrolling">Smooth scrolling</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(when (<span style="color:#a6e22e">&lt;=</span> emacs-major-version <span style="color:#ae81ff">28</span>)
</span></span><span style="display:flex;"><span>  (package! good-scroll))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(if (<span style="color:#a6e22e">&gt;</span> emacs-major-version <span style="color:#ae81ff">28</span>)
</span></span><span style="display:flex;"><span>    (pixel-scroll-precision-mode <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>  (use-package! good-scroll
</span></span><span style="display:flex;"><span>    :config (good-scroll-mode <span style="color:#ae81ff">1</span>)))
</span></span></code></pre></div><h3 id="features">Features</h3>
<h4 id="ess">ESS</h4>
<p>View data frames better with</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! ess-view)
</span></span></code></pre></div><h4 id="very-large-files">Very large files</h4>
<p>The <em>very large files</em> mode loads large files in chunks, allowing one to open ridiculously large files.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! vlf)
</span></span></code></pre></div><p>To make VLF available without delaying startup, we&rsquo;ll just load it in quiet moments.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! vlf-setup
</span></span><span style="display:flex;"><span>  :defer-incrementally vlf-tune vlf-base vlf-write vlf-search vlf-occur vlf-follow vlf-ediff vlf)
</span></span></code></pre></div><h4 id="e-book-reading">e-Book reading</h4>
<p>Then for reading them, the only currently viable options seem to be <a href="https://depp.brause.cc/nov.el/">nov.el</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! nov)
</span></span></code></pre></div><p>Together these should give me a rather good experience reading e-books.</p>
<h4 id="org-related">Org related</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! doct)
</span></span><span style="display:flex;"><span>(package! org-super-agenda)
</span></span><span style="display:flex;"><span>(package! org-ref)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(package! academic-phrases
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;nashamri/academic-phrases&#34;</span>))
</span></span></code></pre></div><h5 id="org-ref-cite"><code>org-ref-cite</code></h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! org-ref-cite
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;jkitchin/org-ref-cite&#34;</span>
</span></span><span style="display:flex;"><span>           :files (:defaults <span style="color:#e6db74">&#34;readme.org&#34;</span>))
</span></span><span style="display:flex;"><span>  :disable <span style="color:#66d9ef">t</span>) <span style="color:#75715e">;; BUG: Not working correctly!</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled</span>
</span></span><span style="display:flex;"><span>(use-package! org-ref-cite
</span></span><span style="display:flex;"><span>  :after org-cite
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; I like green links</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; (set-face-attribute &#39;org-cite nil :foreground &#34;DarkSeaGreen4&#34;)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; (set-face-attribute &#39;org-cite-key nil :foreground &#34;forest green&#34;)</span>
</span></span><span style="display:flex;"><span>  (setq org-cite-global-bibliography bibtex-completion-bibliography
</span></span><span style="display:flex;"><span>        org-cite-csl-styles-dir <span style="color:#e6db74">&#34;~/Zotero/styles&#34;</span>
</span></span><span style="display:flex;"><span>        org-cite-insert-processor <span style="color:#e6db74">&#39;org-ref-cite</span>
</span></span><span style="display:flex;"><span>        org-cite-follow-processor <span style="color:#e6db74">&#39;org-ref-cite</span>
</span></span><span style="display:flex;"><span>        org-cite-activate-processor <span style="color:#e6db74">&#39;org-ref-cite</span>
</span></span><span style="display:flex;"><span>        org-cite-export-processors <span style="color:#f92672">&#39;</span>((html csl <span style="color:#e6db74">&#34;elsevier-with-titles.csl&#34;</span>)
</span></span><span style="display:flex;"><span>                                        (latex org-ref-cite)
</span></span><span style="display:flex;"><span>                                        (<span style="color:#66d9ef">t</span> basic)))
</span></span></code></pre></div><h5 id="fragtog">Fragtog</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! org-fragtog)
</span></span></code></pre></div><p>Hook <code>org-fragtog-mode</code> to <code>org-mode</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! org-fragtog
</span></span><span style="display:flex;"><span>  :hook (org-mode <span style="color:#f92672">.</span> org-fragtog-mode))
</span></span></code></pre></div><h5 id="pretty-table">Pretty table</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! org-pretty-table
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;Fuco1/org-pretty-table&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! org-pretty-table
</span></span><span style="display:flex;"><span>  :hook (org-mode <span style="color:#f92672">.</span> org-pretty-table-mode))
</span></span></code></pre></div><h5 id="org-roam">Org Roam</h5>
<p>Org-roam is nice by itself, but there are so <em>extra</em> nice packages which integrate
with it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(unpin! org-roam) <span style="color:#75715e">;; To avoid problems with org-roam-ui</span>
</span></span><span style="display:flex;"><span>(package! websocket)
</span></span><span style="display:flex;"><span>(package! org-roam-ui)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! websocket
</span></span><span style="display:flex;"><span>  :after org-roam-ui)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(use-package! org-roam-ui
</span></span><span style="display:flex;"><span>  :commands org-roam-ui-open
</span></span><span style="display:flex;"><span>  :config (setq org-roam-ui-sync-theme <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                org-roam-ui-follow <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                org-roam-ui-update-on-save <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                org-roam-ui-open-on-start <span style="color:#66d9ef">t</span>))
</span></span></code></pre></div><h4 id="info-colors">Info colors</h4>
<p>Better colors for manual pages.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! info-colors)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! info-colors
</span></span><span style="display:flex;"><span>  :commands (info-colors-fontify-node))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(add-hook <span style="color:#e6db74">&#39;Info-selection-hook</span> <span style="color:#e6db74">&#39;info-colors-fontify-node</span>)
</span></span></code></pre></div><h4 id="grammarly">Grammarly</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! grammarly
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;emacs-grammarly/grammarly&#34;</span>)
</span></span><span style="display:flex;"><span>  :disable <span style="color:#66d9ef">t</span>) <span style="color:#75715e">;; TODO: It messes my org files up, need to investigate</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(package! flycheck-grammarly
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;emacs-grammarly/flycheck-grammarly&#34;</span>)
</span></span><span style="display:flex;"><span>  :disable <span style="color:#66d9ef">t</span>) <span style="color:#75715e">;; TODO: It messes my org files up, need to investigate</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! flycheck-grammarly
</span></span><span style="display:flex;"><span>  :config (load! <span style="color:#e6db74">&#34;lisp/private/+grammarly-account.el&#34;</span>))
</span></span></code></pre></div><h4 id="grammalecte">Grammalecte</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! flycheck-grammalecte
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;milouse/flycheck-grammalecte&#34;</span>)
</span></span><span style="display:flex;"><span>  :disable <span style="color:#66d9ef">t</span>) <span style="color:#75715e">; FIXME Not working correctly</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! flycheck-grammalecte
</span></span><span style="display:flex;"><span>  :config (flycheck-grammalecte-setup))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; (use-package flycheck-grammalecte</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;              :hook (fountain-mode . flycheck-mode)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;              :init</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;              (setq flycheck-grammalecte-report-apos nil</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;                    flycheck-grammalecte-report-esp nil</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;                    flycheck-grammalecte-report-nbsp nil)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;              :config</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;              (add-to-list &#39;flycheck-grammalecte-enabled-modes &#39;fountain-mode)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;              (grammalecte-download-grammalecte)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;              (flycheck-grammalecte-setup))</span>
</span></span></code></pre></div><h4 id="zotero-zotxt">Zotero Zotxt</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! zotxt)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! zotxt
</span></span><span style="display:flex;"><span>  :commands org-zotxt-mode)
</span></span></code></pre></div><h4 id="crdt">CRDT</h4>
<p>Collaborative editing for geeks! <code>crdt.el</code> adds support for <em><a href="https://en.wikipedia.org/wiki/Conflict-free_replicated_data_type">Conflict-free
Replicated Data Type</a></em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! crdt)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! crdt
</span></span><span style="display:flex;"><span>  :commands (crdt-share-buffer
</span></span><span style="display:flex;"><span>             crdt-connect
</span></span><span style="display:flex;"><span>             crdt-visualize-author-mode
</span></span><span style="display:flex;"><span>             crdt-org-sync-overlay-mode))
</span></span></code></pre></div><h3 id="programming">Programming</h3>
<h4 id="repo">Repo</h4>
<p>Make sure the <a href="https://android.googlesource.com/tools/repo/">repo</a> tool is installed, if not <code>pacman -S repo</code> on Arch-based
distributions, or directly with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>REPO_PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.local/bin/repo&#34;</span>
</span></span><span style="display:flex;"><span>curl <span style="color:#e6db74">&#34;https://storage.googleapis.com/git-repo-downloads/repo&#34;</span> &gt; <span style="color:#e6db74">${</span>REPO_PATH<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>chmod a+x <span style="color:#e6db74">${</span>REPO_PATH<span style="color:#e6db74">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! repo)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! repo
</span></span><span style="display:flex;"><span>  :commands repo-status)
</span></span></code></pre></div><h4 id="devdocs">Devdocs</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! devdocs
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;astoff/devdocs.el&#34;</span>
</span></span><span style="display:flex;"><span>           :files (<span style="color:#e6db74">&#34;*.el&#34;</span>)))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! devdocs
</span></span><span style="display:flex;"><span>  :commands (devdocs-lookup devdocs-install)
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (setq devdocs-data-dir (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;devdocs&#34;</span> doom-etc-dir)))
</span></span></code></pre></div><h4 id="emacs-gdb">Emacs GDB</h4>
<p>DAP mode is great, however, it is not mature for C/C++ debugging, it does not
support some basic features like <em>Run until cursor</em>, <em>Show disassembled code</em>&hellip;
etc. Emacs have builtin <code>gdb</code> support through <code>gdb-mi</code> and <code>gud</code>.</p>
<p>The <code>emacs-gdb</code> package overwrites the builtin <code>gdb-mi</code>, it is much faster (thanks
to it&rsquo;s C module), and it defines some easy to use UI, with Visual Studio like
keybindings.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! gdb-mi
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;weirdNox/emacs-gdb&#34;</span>
</span></span><span style="display:flex;"><span>           :files (<span style="color:#e6db74">&#34;*.el&#34;</span> <span style="color:#e6db74">&#34;*.c&#34;</span> <span style="color:#e6db74">&#34;*.h&#34;</span> <span style="color:#e6db74">&#34;Makefile&#34;</span>)))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! gdb-mi
</span></span><span style="display:flex;"><span>  :init
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">fmakunbound</span> <span style="color:#e6db74">&#39;gdb</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">fmakunbound</span> <span style="color:#e6db74">&#39;gdb-enable-debug</span>)
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (setq <span style="color:#75715e">;; gdb-window-setup-function #&#39;gdb--setup-windows ; TODO: Customize this</span>
</span></span><span style="display:flex;"><span>        gdb-ignore-gdbinit <span style="color:#66d9ef">nil</span>)) <span style="color:#75715e">; I use gdbinit to define some useful stuff</span>
</span></span></code></pre></div><h4 id="disaster">Disaster</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! disaster)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; TODO: Configure to take into account &#34;compile_commands.json&#34;</span>
</span></span><span style="display:flex;"><span>(use-package! disaster
</span></span><span style="display:flex;"><span>  :commands (disaster))
</span></span></code></pre></div><h4 id="magit-delta">Magit Delta</h4>
<p>Integrate <code>git-delta</code> with <code>magit</code>. Currently disabled because it is too slow,
specially with big change chunks.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! magit-delta
</span></span><span style="display:flex;"><span>  :disable <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! magit-delta
</span></span><span style="display:flex;"><span>  :commands magit-status
</span></span><span style="display:flex;"><span>  :hook (magit-mode <span style="color:#f92672">.</span> magit-delta-mode))
</span></span></code></pre></div><h4 id="blamer">Blamer</h4>
<p>Display Git information (author, date, message&hellip;) for current line</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! blamer
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;artawower/blamer.el&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! blamer
</span></span><span style="display:flex;"><span>  :bind ((<span style="color:#e6db74">&#34;s-i&#34;</span> <span style="color:#f92672">.</span> blamer-show-commit-info))
</span></span><span style="display:flex;"><span>  :defer <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>  :custom
</span></span><span style="display:flex;"><span>  (blamer-idle-time <span style="color:#ae81ff">0.3</span>)
</span></span><span style="display:flex;"><span>  (blamer-min-offset <span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>  (blamer-prettify-time-p <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>  (blamer-entire-formatter <span style="color:#e6db74">&#34;    %s&#34;</span>)
</span></span><span style="display:flex;"><span>  (blamer-author-formatter <span style="color:#e6db74">&#34; %s &#34;</span>)
</span></span><span style="display:flex;"><span>  (blamer-datetime-formatter <span style="color:#e6db74">&#34;[%s], &#34;</span>)
</span></span><span style="display:flex;"><span>  (blamer-commit-formatter <span style="color:#e6db74">&#34;%s&#34;</span>)
</span></span><span style="display:flex;"><span>  :custom-face
</span></span><span style="display:flex;"><span>  (blamer-face ((<span style="color:#66d9ef">t</span> :foreground <span style="color:#e6db74">&#34;#7a88cf&#34;</span>
</span></span><span style="display:flex;"><span>                   :background <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>                   :height <span style="color:#ae81ff">125</span>
</span></span><span style="display:flex;"><span>                   :italic <span style="color:#66d9ef">t</span>)))
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (global-blamer-mode <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Disable in zen (writeroom) mode</span>
</span></span><span style="display:flex;"><span>  (when (featurep! :ui zen)
</span></span><span style="display:flex;"><span>    (add-hook! <span style="color:#e6db74">&#39;writeroom-mode-enable-hook</span> (blamer-mode <span style="color:#ae81ff">-1</span>))
</span></span><span style="display:flex;"><span>    (add-hook! <span style="color:#e6db74">&#39;writeroom-mode-disable-hook</span> (blamer-mode <span style="color:#ae81ff">1</span>))))
</span></span></code></pre></div><h4 id="systemd">Systemd</h4>
<p>For editing systemd unit files.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! systemd)
</span></span></code></pre></div><h4 id="bitbake--yocto">Bitbake (Yocto)</h4>
<p>This package is not maintained, but still a good for my Yocto projects. I don&rsquo;t
really use the <code>bitbake</code> commands from Emacs, so this package can be easily
replaced with <a href="https://bitbucket.org/olanilsson/bitbake-modes"><code>bitbake-modes</code></a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! bitbake-modes
</span></span><span style="display:flex;"><span>  :recipe (:host bitbucket
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;olanilsson/bitbake-modes&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package bitbake-modes
</span></span><span style="display:flex;"><span>  :commands (bitbake-mode
</span></span><span style="display:flex;"><span>             conf-bitbake-mode
</span></span><span style="display:flex;"><span>             bb-scc-mode wks-mode
</span></span><span style="display:flex;"><span>             bitbake-task-log-mode
</span></span><span style="display:flex;"><span>             bb-sh-mode
</span></span><span style="display:flex;"><span>             mmm-mode))
</span></span></code></pre></div><h4 id="latex">LaTeX</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! aas
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;ymarco/auto-activating-snippets&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! aas
</span></span><span style="display:flex;"><span>  :commands aas-mode)
</span></span></code></pre></div><h4 id="project-cmake"><code>project-cmake</code></h4>
<p>A good new package to facilitate using CMake projects with Emacs, it glues
together <code>project</code>, <code>eglot</code>, <code>cmake</code> and <code>clangd</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! project-cmake
</span></span><span style="display:flex;"><span>  :disable (not (featurep! lsp +eglot)) <span style="color:#75715e">; Enable only if (lsp +eglot) is used</span>
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;juanjosegarciaripoll/project-cmake&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! project-cmake
</span></span><span style="display:flex;"><span>    :config
</span></span><span style="display:flex;"><span>    (require <span style="color:#e6db74">&#39;eglot</span>)
</span></span><span style="display:flex;"><span>    (project-cmake-scan-kits)
</span></span><span style="display:flex;"><span>    (project-cmake-eglot-integration))
</span></span></code></pre></div><h4 id="franca-idl">Franca IDL</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! franca-idl
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;zeph1e/franca-idl.el&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! franca-idl
</span></span><span style="display:flex;"><span>  :commands franca-idl-mode)
</span></span></code></pre></div><h4 id="flycheck-plus-projectile">Flycheck + projectile</h4>
<p>WIP: Not working atm!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! flycheck-projectile
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;nbfalcon/flycheck-projectile&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! flycheck-projectile
</span></span><span style="display:flex;"><span>  :commands flycheck-projectile-list-errors)
</span></span></code></pre></div><h4 id="graphviz">Graphviz</h4>
<p>Graphviz is a nice method of visualizing simple graphs, based on plaintext
<code>.dot</code> / <code>.gv</code> files.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! graphviz-dot-mode)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! graphviz-dot-mode
</span></span><span style="display:flex;"><span>  :commands (graphviz-dot-mode graphviz-dot-preview))
</span></span></code></pre></div><h4 id="maxima">Maxima</h4>
<p>I&rsquo;ve been experiencing an annoying bug with the <code>maxima</code> package, when I launch
the interpreter, it complains about a file not being found, the package searches
in <code>~/.emacs-doom/.local/straight/repos-28.0.90/maxima/keywords/functions</code> instead
of <code>~/.../build-28.0.90/...</code>, when I investigated this issue, it turned out that,
the package (in the <code>maxima-font-lock.el</code> file), replaces <code>build</code> with <code>repos</code> when it
sees <code>straight</code> in the path (as a workaround to support <code>straight</code>), however, Doom
Emacs redefine the value of <code>straight-build-dir</code> to be <code>build-&lt;emacs-version&gt;</code>,, so
the workaround is no more needed. To fix this, I set the
<code>maxima-font-lock-keywords-directory</code> with the right path.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! imaxima)
</span></span><span style="display:flex;"><span>(package! maxima
</span></span><span style="display:flex;"><span>  :recipe (:host gitlab
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;sasanidas/maxima&#34;</span>
</span></span><span style="display:flex;"><span>           :files (<span style="color:#e6db74">&#34;*.el&#34;</span> <span style="color:#e6db74">&#34;keywords&#34;</span>)))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! maxima
</span></span><span style="display:flex;"><span>  :init
</span></span><span style="display:flex;"><span>  (add-hook <span style="color:#e6db74">&#39;maxima-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>maxima-hook-function)
</span></span><span style="display:flex;"><span>  (add-hook <span style="color:#e6db74">&#39;maxima-inferior-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>maxima-hook-function)
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;straight</span>)
</span></span><span style="display:flex;"><span>  (setq maxima-font-lock-keywords-directory <span style="color:#75715e">;; a workaround to undo the straight workaround!</span>
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">expand-file-name</span> (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;straight/%s/maxima/keywords&#34;</span> straight-build-dir) straight-base-dir))
</span></span><span style="display:flex;"><span>  (setq maxima-display-maxima-buffer <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; (require &#39;org) ;; to set `org-format-latex-options&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; (setq org-format-latex-options (plist-put org-format-latex-options :scale 2.0))</span>
</span></span><span style="display:flex;"><span>  :commands (maxima-mode maxima)
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;company-maxima</span>)
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;company-backends</span> <span style="color:#f92672">&#39;</span>(company-maxima-symbols company-maxima-libraries))
</span></span><span style="display:flex;"><span>  :mode (<span style="color:#e6db74">&#34;\\.mac\\&#39;&#34;</span> <span style="color:#f92672">.</span> maxima-mode)
</span></span><span style="display:flex;"><span>  :interpreter (<span style="color:#e6db74">&#34;maxima&#34;</span> <span style="color:#f92672">.</span> maxima-mode))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(use-package! imaxima
</span></span><span style="display:flex;"><span>  :commands (imaxima))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(use-package! imath
</span></span><span style="display:flex;"><span>  :commands (imath-mode imath))
</span></span></code></pre></div><h4 id="ros">ROS</h4>
<h5 id="ros-emacs-utils">ROS Emacs utils</h5>
<p>This is a WIP, to use the <a href="https://github.com/code-iai/ros_emacs_utils">code-iai/ros_emacs_utils</a> for <code>rosemacs</code> integration. I
need to be able to use it over Tramp, as I mainly do my ROS stuff on a Docker
container or on a remote robot. ATM, I need just to configure <code>rosemacs</code> to use
Emacs to develop ROS packages using C++/Python, I&rsquo;m not interested now for
ROS Common Lisp development.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! rosemacs
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;code-iai/ros_emacs_utils&#34;</span>
</span></span><span style="display:flex;"><span>           :files (<span style="color:#e6db74">&#34;rosemacs/*&#34;</span>))
</span></span><span style="display:flex;"><span>  :disable <span style="color:#66d9ef">t</span>) <span style="color:#75715e">;; No clear way to make it work on a remote machine</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! rosemacs
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;rosemacs-config</span>)
</span></span><span style="display:flex;"><span>  :commands (ros-core ros-topic-info))
</span></span></code></pre></div><h5 id="ros-dot-el"><code>ros.el</code></h5>
<p>I found this awesome <a href="https://github.com/DerBeutlin/ros.el"><code>ros.el</code></a> package made by <a href="https://github.com/DerBeutlin">Max Beutelspacher</a>, which
facilitate working with ROS machines, supports ROS1 and ROS2, with local
workspaces or remote ones (over Trump!),</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; `ros.el&#39; depends on `with-shell-interpreter&#39; among other packages</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; See: https://github.com/DerBeutlin/ros.el/blob/master/Cask</span>
</span></span><span style="display:flex;"><span>(package! with-shell-interpreter)
</span></span><span style="display:flex;"><span>(package! ros
</span></span><span style="display:flex;"><span>  :recipe (:host github
</span></span><span style="display:flex;"><span>           :repo <span style="color:#e6db74">&#34;DerBeutlin/ros.el&#34;</span>))
</span></span></code></pre></div><p>Now, we configure the ROS1/ROS2 workspaces to work on. But before that, we need
to install some tools on the ROS machine, and build the workspace for the first
time using <code>colcon build</code>, the repo contains example Docker files for <a href="https://github.com/DerBeutlin/ros.el/blob/master/docker/Dockerfile_noetic">Noetic</a> and
<a href="https://github.com/DerBeutlin/ros.el/blob/master/docker/Dockerfile_foxy">Foxy</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! ros
</span></span><span style="display:flex;"><span>  :init (map! :leader
</span></span><span style="display:flex;"><span>              :prefix (<span style="color:#e6db74">&#34;l&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;custom&#34;</span>)
</span></span><span style="display:flex;"><span>              :desc <span style="color:#e6db74">&#34;Hydra ROS&#34;</span> <span style="color:#e6db74">&#34;r&#34;</span> <span style="color:#a6e22e">#&#39;</span>hydra-ros-main/body)
</span></span><span style="display:flex;"><span>  :commands (hydra-ros-main/body ros-set-workspace)
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (setq ros-workspaces
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">list</span> (ros-dump-workspace
</span></span><span style="display:flex;"><span>               :tramp-prefix (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;/docker:%s@%s:&#34;</span> <span style="color:#e6db74">&#34;ros&#34;</span> <span style="color:#e6db74">&#34;ros-machine&#34;</span>)
</span></span><span style="display:flex;"><span>               :workspace <span style="color:#e6db74">&#34;~/ros_ws&#34;</span>
</span></span><span style="display:flex;"><span>               :extends <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;/opt/ros/noetic/&#34;</span>))
</span></span><span style="display:flex;"><span>              (ros-dump-workspace
</span></span><span style="display:flex;"><span>               :tramp-prefix (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;/ssh:%s@%s:&#34;</span> <span style="color:#e6db74">&#34;swd_sk&#34;</span> <span style="color:#e6db74">&#34;172.16.96.42&#34;</span>)
</span></span><span style="display:flex;"><span>               :workspace <span style="color:#e6db74">&#34;~/ros_ws&#34;</span>
</span></span><span style="display:flex;"><span>               :extends <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;/opt/ros/noetic/&#34;</span>))
</span></span><span style="display:flex;"><span>              (ros-dump-workspace
</span></span><span style="display:flex;"><span>               :tramp-prefix (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;/ssh:%s@%s:&#34;</span> <span style="color:#e6db74">&#34;swd_sk&#34;</span> <span style="color:#e6db74">&#34;172.16.96.42&#34;</span>)
</span></span><span style="display:flex;"><span>               :workspace <span style="color:#e6db74">&#34;~/ros2_ws&#34;</span>
</span></span><span style="display:flex;"><span>               :extends <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;/opt/ros/foxy/&#34;</span>)))))
</span></span></code></pre></div><h2 id="emacs-daemon">Emacs Daemon</h2>
<h3 id="initialization">Initialization</h3>
<p>When the daemon is running, I almost always want to do a few particular things
with it, so I may as well eat the load time at startup. We also want to keep
<code>mu4e</code> running.</p>
<p>Lastly, while I&rsquo;m not sure quite why it happens, but after a bit it seems that
new Emacs client frames start on the <code>*scratch*</code> buffer instead of the dashboard.
I prefer the dashboard, so let&rsquo;s ensure that&rsquo;s always switched to in new frames.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun greedy-on-daemon-startup ()
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;org</span>)
</span></span><span style="display:flex;"><span>  (when (require <span style="color:#e6db74">&#39;mu4e</span> <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (setq mu4e-confirm-quit <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (setq +mu4e-lock-greedy <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (setq +mu4e-lock-relaxed <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (mu4e~start))
</span></span><span style="display:flex;"><span>  (when (require <span style="color:#e6db74">&#39;elfeed</span> <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (run-at-time <span style="color:#66d9ef">nil</span> (<span style="color:#a6e22e">*</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">60</span> <span style="color:#ae81ff">60</span>) <span style="color:#a6e22e">#&#39;</span>elfeed-update)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(when (<span style="color:#a6e22e">daemonp</span>)
</span></span><span style="display:flex;"><span>  (add-hook  <span style="color:#e6db74">&#39;emacs-startup-hook</span> <span style="color:#a6e22e">#&#39;</span>greedy-on-daemon-startup)
</span></span><span style="display:flex;"><span>  (add-hook! <span style="color:#e6db74">&#39;server-after-make-frame-hook</span> (doom/reload-theme))
</span></span><span style="display:flex;"><span>  (add-hook! <span style="color:#e6db74">&#39;server-after-make-frame-hook</span>
</span></span><span style="display:flex;"><span>    (unless (string-match-p <span style="color:#e6db74">&#34;\\*draft&#34;</span> (<span style="color:#a6e22e">buffer-name</span>))
</span></span><span style="display:flex;"><span>      (switch-to-buffer +doom-dashboard-name))))
</span></span></code></pre></div><h3 id="tweaks">Tweaks</h3>
<h4 id="save-recent-files">Save recent files</h4>
<p>When editing files with Emacs client, the files does not get stored by <code>recentf</code>,
making Emacs forgets about recently opened files. A quick fix is to hook the
<code>recentf-save-list</code> command to the <code>delete-frame-functions</code>
and <code>delete-terminal-functions</code> which gets executed each time a
frame/terminal is deleted.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(when (<span style="color:#a6e22e">daemonp</span>)
</span></span><span style="display:flex;"><span>  (add-hook! <span style="color:#f92672">&#39;</span>(delete-frame-functions delete-terminal-functions) <span style="color:#a6e22e">#&#39;</span>(lambda (arg) (recentf-save-list))))
</span></span></code></pre></div><h2 id="package-configuration">Package configuration</h2>
<h3 id="all-the-icons">All the icons</h3>
<p>Set some custom icons for some file extensions, basically for <code>.m</code> files.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! all-the-icons
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">setcdr</span> (<span style="color:#a6e22e">assoc</span> <span style="color:#e6db74">&#34;m&#34;</span> all-the-icons-extension-icon-alist)
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> <span style="color:#e6db74">&#34;matlab&#34;</span> all-the-icons-extension-icon-alist))))
</span></span></code></pre></div><h3 id="centaur-tabs">Centaur tabs</h3>
<p>A &lsquo;active-bar&rsquo; is nice, so let&rsquo;s have one of those. If we have it <code>under</code> needs us to
turn on <code>x-underline-at-decent</code> though. For some reason this didn&rsquo;t seem to work
inside the <code>(after! ... )</code> block \_()_/.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! centaur-tabs
</span></span><span style="display:flex;"><span>  (centaur-tabs-mode <span style="color:#ae81ff">-1</span>)
</span></span><span style="display:flex;"><span>  (setq centaur-tabs-set-icons <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>        centaur-tabs-modified-marker <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        centaur-tabs-close-button <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        centaur-tabs-gray-out-icons <span style="color:#e6db74">&#39;buffer</span>))
</span></span></code></pre></div><h3 id="better-pdfs-in-mode-line">Better PDFs in mode line</h3>
<p>First up I&rsquo;m going to want a segment for just the buffer file name, and a PDF
icon. Then we&rsquo;ll redefine two functions used to generate the modeline.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! doom-modeline
</span></span><span style="display:flex;"><span>  (doom-modeline-def-segment <span style="color:#a6e22e">buffer-name</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Display the current buffer&#39;s name, without any other information.&#34;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">concat</span>
</span></span><span style="display:flex;"><span>     (doom-modeline-spc)
</span></span><span style="display:flex;"><span>     (doom-modeline--buffer-name)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (doom-modeline-def-segment pdf-icon
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;PDF icon from all-the-icons.&#34;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">concat</span>
</span></span><span style="display:flex;"><span>     (doom-modeline-spc)
</span></span><span style="display:flex;"><span>     (doom-modeline-icon <span style="color:#e6db74">&#39;octicon</span> <span style="color:#e6db74">&#34;file-pdf&#34;</span> <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>                         :face (if (doom-modeline--active)
</span></span><span style="display:flex;"><span>                                   <span style="color:#e6db74">&#39;all-the-icons-red</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#e6db74">&#39;mode-line-inactive</span>)
</span></span><span style="display:flex;"><span>                         :v-adjust <span style="color:#ae81ff">0.02</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun doom-modeline-update-pdf-pages ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Update PDF pages.&#34;</span>
</span></span><span style="display:flex;"><span>    (setq doom-modeline--pdf-pages
</span></span><span style="display:flex;"><span>          (let ((current-page-str (<span style="color:#a6e22e">number-to-string</span> (<span style="color:#a6e22e">eval</span> <span style="color:#f92672">`</span>(pdf-view-current-page))))
</span></span><span style="display:flex;"><span>                (total-page-str (<span style="color:#a6e22e">number-to-string</span> (pdf-cache-number-of-pages))))
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">concat</span>
</span></span><span style="display:flex;"><span>             (<span style="color:#a6e22e">propertize</span>
</span></span><span style="display:flex;"><span>              (<span style="color:#a6e22e">concat</span> (<span style="color:#a6e22e">make-string</span> (<span style="color:#a6e22e">-</span> (<span style="color:#a6e22e">length</span> total-page-str) (<span style="color:#a6e22e">length</span> current-page-str)) <span style="color:#e6db74">? </span>)
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#34; P&#34;</span> current-page-str)
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;mode-line</span>)
</span></span><span style="display:flex;"><span>             (<span style="color:#a6e22e">propertize</span> (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;/&#34;</span> total-page-str) <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;doom-modeline-buffer-minor-mode</span>)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (doom-modeline-def-segment pdf-pages
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Display PDF pages.&#34;</span>
</span></span><span style="display:flex;"><span>    (if (doom-modeline--active) doom-modeline--pdf-pages
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">propertize</span> doom-modeline--pdf-pages <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;mode-line-inactive</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (doom-modeline-def-modeline <span style="color:#e6db74">&#39;pdf</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#39;</span>(bar window-number pdf-pages pdf-icon <span style="color:#a6e22e">buffer-name</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#39;</span>(misc-info matches major-mode process vcs)))
</span></span></code></pre></div><h3 id="emojify">Emojify</h3>
<p>For starters, twitter&rsquo;s emojis look nicer than emoji-one.
Other than that, this is pretty great OOTB .</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq emojify-emoji-set <span style="color:#e6db74">&#34;twemoji-v2&#34;</span>)
</span></span></code></pre></div><p>One minor annoyance is the use of emojis over the default character
when the default is actually preferred. This occurs with overlay symbols I use
in Org mode, such as checkbox state, and a few other miscellaneous cases.</p>
<p>We can accommodate our preferences by deleting those entries from the emoji hash
table</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defvar emojify-disabled-emojis
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(<span style="color:#75715e">;; Org</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">;; Terminal powerline</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">;; Box drawing</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Characters that should never be affected by </span><span style="color:#e6db74">`emojify-mode&#39;</span><span style="color:#e6db74">.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defadvice! emojify-delete-from-data ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Ensure </span><span style="color:#e6db74">`emojify-disabled-emojis&#39;</span><span style="color:#e6db74"> don&#39;t appear in </span><span style="color:#e6db74">`emojify-emojis&#39;</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>  :after <span style="color:#a6e22e">#&#39;</span>emojify-set-emoji-data
</span></span><span style="display:flex;"><span>  (dolist (emoji emojify-disabled-emojis)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">remhash</span> emoji emojify-emojis)))
</span></span></code></pre></div><p>Now, it would be good to have a minor mode which allowed you to type ascii/gh
emojis and get them converted to unicode. Lets make one.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun emojify--replace-text-with-emoji (orig-fn emoji text buffer start end <span style="color:#66d9ef">&amp;optional</span> target)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Modify </span><span style="color:#e6db74">`emojify--propertize-text-for-emoji&#39;</span><span style="color:#e6db74"> to replace ascii/github emoticons with unicode emojis, on the fly.&#34;</span>
</span></span><span style="display:flex;"><span>  (if (or (not emoticon-to-emoji) (<span style="color:#a6e22e">=</span> <span style="color:#ae81ff">1</span> (<span style="color:#a6e22e">length</span> text)))
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">funcall</span> orig-fn emoji text buffer start end target)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">delete-region</span> start end)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">insert</span> (ht-get emoji <span style="color:#e6db74">&#34;unicode&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(define-minor-mode emoticon-to-emoji
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Write ascii/gh emojis, and have them converted to unicode live.&#34;</span>
</span></span><span style="display:flex;"><span>  :global <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>  :init-value <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>  (if emoticon-to-emoji
</span></span><span style="display:flex;"><span>      (progn
</span></span><span style="display:flex;"><span>        (setq-local emojify-emoji-styles <span style="color:#f92672">&#39;</span>(ascii github unicode))
</span></span><span style="display:flex;"><span>        (advice-add <span style="color:#e6db74">&#39;emojify--propertize-text-for-emoji</span> :around <span style="color:#a6e22e">#&#39;</span>emojify--replace-text-with-emoji)
</span></span><span style="display:flex;"><span>        (unless emojify-mode
</span></span><span style="display:flex;"><span>          (emojify-turn-on-emojify-mode)))
</span></span><span style="display:flex;"><span>    (setq-local emojify-emoji-styles (<span style="color:#a6e22e">default-value</span> <span style="color:#e6db74">&#39;emojify-emoji-styles</span>))
</span></span><span style="display:flex;"><span>    (advice-remove <span style="color:#e6db74">&#39;emojify--propertize-text-for-emoji</span> <span style="color:#a6e22e">#&#39;</span>emojify--replace-text-with-emoji)))
</span></span></code></pre></div><p>This new minor mode of ours will be nice for messages, so let&rsquo;s hook it in for
Email and IRC.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(add-hook! <span style="color:#f92672">&#39;</span>(mu4e-compose-mode org-msg-edit-mode circe-channel-mode) (emoticon-to-emoji <span style="color:#ae81ff">1</span>))
</span></span></code></pre></div><h3 id="eros-eval">Eros-eval</h3>
<p>This makes the result of evals slightly prettier.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq eros-eval-result-prefix <span style="color:#e6db74">&#34; &#34;</span>)
</span></span></code></pre></div><h3 id="checkers--spell-and-grammar">Checkers (spell &amp; grammar)</h3>
<h4 id="install-back-end">Install back-end</h4>
<p>For <code>flyspell</code> + <code>hunspell</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>sudo pacman -S hunspell hunspell-en_US hunspell-en_GB hunspell-fr
</span></span></code></pre></div><p>For <code>spell-fu</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>sudo pacman -S aspell aspell-en aspell-fr
</span></span></code></pre></div><h4 id="spell-fu">Spell Fu</h4>
<p>Now, <code>spell-fu</code> supports multiple languages! Lets add English, French and Arabic.
So I can &ldquo;mlanger les langues sans avoir de problmes!&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! spell-fu
</span></span><span style="display:flex;"><span>  (defun spell-fu-register-dictionary (lang)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Add `LANG` to spell-fu multi-dict, with a personal dictionary.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">;; Add the dictionary</span>
</span></span><span style="display:flex;"><span>    (spell-fu-dictionary-add (spell-fu-get-ispell-dictionary lang))
</span></span><span style="display:flex;"><span>    (let ((personal-dict-file (<span style="color:#a6e22e">expand-file-name</span> (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;aspell.%s.pws&#34;</span> lang) doom-private-dir)))
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">;; Create an empty personal dictionary if it doesn&#39;t exists</span>
</span></span><span style="display:flex;"><span>      (unless (<span style="color:#a6e22e">file-exists-p</span> personal-dict-file) (<span style="color:#a6e22e">write-region</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#66d9ef">nil</span> personal-dict-file))
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">;; Add the personal dictionary</span>
</span></span><span style="display:flex;"><span>      (spell-fu-dictionary-add (spell-fu-get-personal-dictionary (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;%s-personal&#34;</span> lang) personal-dict-file))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (add-hook <span style="color:#e6db74">&#39;spell-fu-mode-hook</span>
</span></span><span style="display:flex;"><span>            (lambda ()
</span></span><span style="display:flex;"><span>              (spell-fu-register-dictionary <span style="color:#e6db74">&#34;en&#34;</span>)
</span></span><span style="display:flex;"><span>              (spell-fu-register-dictionary <span style="color:#e6db74">&#34;fr&#34;</span>))))
</span></span></code></pre></div><h4 id="flyspell">Flyspell</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled, using spell-fu instead</span>
</span></span><span style="display:flex;"><span>(after! (ispell flyspell)
</span></span><span style="display:flex;"><span>  (setq ispell-dictionary <span style="color:#e6db74">&#34;en_US,fr_FR&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; ispell-set-spellchecker-params has to be called</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; before ispell-hunspell-add-multi-dic will work</span>
</span></span><span style="display:flex;"><span>  (ispell-set-spellchecker-params)
</span></span><span style="display:flex;"><span>  (ispell-hunspell-add-multi-dic <span style="color:#e6db74">&#34;en_US,fr_FR&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Define the personal dictionary path, and use it only when it exists</span>
</span></span><span style="display:flex;"><span>  (setq ispell-personal-dictionary
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;.ispell_personal_dict&#34;</span> doom-private-dir))
</span></span><span style="display:flex;"><span>  (unless (<span style="color:#a6e22e">file-exists-p</span> ispell-personal-dictionary)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">write-region</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#66d9ef">nil</span> ispell-personal-dictionary <span style="color:#66d9ef">nil</span> <span style="color:#ae81ff">0</span>)))
</span></span></code></pre></div><h5 id="lazy-flyspell">Lazy flyspell</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! flyspell
</span></span><span style="display:flex;"><span>  (setq flyspell-lazy-idle-seconds <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        flyspell-lazy-window-idle-seconds <span style="color:#ae81ff">5</span>))
</span></span></code></pre></div><h4 id="shortcuts-to-change-dictionary">Shortcuts to change dictionary</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled, using spell-fu with multiple dictionaries</span>
</span></span><span style="display:flex;"><span>(defun ab-conf/spelldict (lang)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Switch between language dictionaries.&#34;</span>
</span></span><span style="display:flex;"><span>  (cond ((<span style="color:#a6e22e">eq</span> lang :en)
</span></span><span style="display:flex;"><span>         (setq flyspell-default-dictionary <span style="color:#e6db74">&#34;en_US&#34;</span>
</span></span><span style="display:flex;"><span>               ispell-dictionary <span style="color:#e6db74">&#34;en_US&#34;</span>)
</span></span><span style="display:flex;"><span>         (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Dictionary changed to &#39;english&#39;&#34;</span>))
</span></span><span style="display:flex;"><span>        ((<span style="color:#a6e22e">eq</span> lang :fr)
</span></span><span style="display:flex;"><span>         (setq flyspell-default-dictionary <span style="color:#e6db74">&#34;fr_FR&#34;</span>
</span></span><span style="display:flex;"><span>               ispell-dictionary <span style="color:#e6db74">&#34;fr_FR&#34;</span>)
</span></span><span style="display:flex;"><span>         (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Dictionary changed to &#39;francais&#39;&#34;</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#66d9ef">t</span> (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;No changes have been made.&#34;</span>)))
</span></span><span style="display:flex;"><span>  (flyspell-mode <span style="color:#ae81ff">-1</span>)
</span></span><span style="display:flex;"><span>  (flyspell-mode))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(map! :leader :prefix (<span style="color:#e6db74">&#34;l&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;custom&#34;</span>)
</span></span><span style="display:flex;"><span>      (:when (featurep! :checkers spell)
</span></span><span style="display:flex;"><span>       :prefix-map (<span style="color:#e6db74">&#34;y&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;dictionary&#34;</span>)
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;English (en_US)&#34;</span>    <span style="color:#e6db74">&#34;e&#34;</span> <span style="color:#a6e22e">#&#39;</span>(lambda () (interactive) (ab-conf/spelldict :en))
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Franais (fr_FR)&#34;</span>   <span style="color:#e6db74">&#34;f&#34;</span> <span style="color:#a6e22e">#&#39;</span>(lambda () (interactive) (ab-conf/spelldict :fr))))
</span></span></code></pre></div><h4 id="shortcuts-to-check-grammar">Shortcuts to check grammar</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(map! :leader :prefix (<span style="color:#e6db74">&#34;l&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;custom&#34;</span>)
</span></span><span style="display:flex;"><span>      (:when (featurep! :checkers grammar)
</span></span><span style="display:flex;"><span>       :prefix-map (<span style="color:#e6db74">&#34;l&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;langtool&#34;</span>)
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Check&#34;</span>                   <span style="color:#e6db74">&#34;l&#34;</span> <span style="color:#a6e22e">#&#39;</span>langtool-check
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Correct buffer&#34;</span>          <span style="color:#e6db74">&#34;b&#34;</span> <span style="color:#a6e22e">#&#39;</span>langtool-correct-buffer
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Stop server&#34;</span>             <span style="color:#e6db74">&#34;s&#34;</span> <span style="color:#a6e22e">#&#39;</span>langtool-server-stop
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Done checking&#34;</span>           <span style="color:#e6db74">&#34;d&#34;</span> <span style="color:#a6e22e">#&#39;</span>langtool-check-done
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Show msg at point&#34;</span>       <span style="color:#e6db74">&#34;m&#34;</span> <span style="color:#a6e22e">#&#39;</span>langtool-show-message-at-point
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Next error&#34;</span>              <span style="color:#e6db74">&#34;n&#34;</span> <span style="color:#a6e22e">#&#39;</span>langtool-goto-next-error
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Previous error&#34;</span>          <span style="color:#e6db74">&#34;p&#34;</span> <span style="color:#a6e22e">#&#39;</span>langtool-goto-previous-error
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Switch default language&#34;</span> <span style="color:#e6db74">&#34;L&#34;</span> <span style="color:#a6e22e">#&#39;</span>langtool-switch-default-language))
</span></span></code></pre></div><h3 id="projectile">Projectile</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; Run `M-x projectile-project-search-path&#39; to reload paths from this variable</span>
</span></span><span style="display:flex;"><span>(setq projectile-project-search-path <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;~/PhD/workspace&#34;</span>
</span></span><span style="display:flex;"><span>                                       <span style="color:#e6db74">&#34;~/PhD/workspace-no&#34;</span>
</span></span><span style="display:flex;"><span>                                       <span style="color:#e6db74">&#34;~/PhD/workspace-no/ez-wheel/swd-starter-kit-repo&#34;</span>
</span></span><span style="display:flex;"><span>                                       <span style="color:#e6db74">&#34;~/Projects/foss_projects&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(setq projectile-ignored-projects <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;~/&#34;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#e6db74">&#34;/tmp&#34;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#e6db74">&#34;~/.cache&#34;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#e6db74">&#34;~/.emacs.d/.local/straight/repos/&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun projectile-ignored-project-function (filepath)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Return t if FILEPATH is within any of </span><span style="color:#e6db74">`projectile-ignored-projects&#39;</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  (or (<span style="color:#a6e22e">mapcar</span> (lambda (p) (s-starts-with-p p filepath)) projectile-ignored-projects)))
</span></span></code></pre></div><h3 id="tramp">Tramp</h3>
<p>Let&rsquo;s try to make tramp handle prompts better</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! tramp
</span></span><span style="display:flex;"><span>  (setenv <span style="color:#e6db74">&#34;SHELL&#34;</span> <span style="color:#e6db74">&#34;/bin/bash&#34;</span>)
</span></span><span style="display:flex;"><span>  (setq tramp-shell-prompt-pattern <span style="color:#e6db74">&#34;\\(?:^\\|
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">\\)[^]#$%&gt;\n]*#?[]#$%&gt;] *\\(\\[[0-9;]*[a-zA-Z] *\\)*&#34;</span>)) <span style="color:#75715e">;; default + </span>
</span></span></code></pre></div><h3 id="yasnippet">YASnippet</h3>
<p>Nested snippets are good, enable that.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq yas-triggers-in-field <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><h3 id="ligatures">Ligatures</h3>
<p>Extra ligatures are good, however, I&rsquo;d like to see my keywords! Lets disable
them in C/C++, Rust and Python modes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq +ligatures-extras-in-modes <span style="color:#f92672">&#39;</span>(not c-mode c++-mode rust-mode python-mode))
</span></span></code></pre></div><h2 id="applications">Applications</h2>
<h3 id="e-books-nov">e-Books <code>nov</code></h3>
<p>Use <code>nov</code> to read EPUB e-books.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! nov
</span></span><span style="display:flex;"><span>  :mode (<span style="color:#e6db74">&#34;\\.epub\\&#39;&#34;</span> <span style="color:#f92672">.</span> nov-mode)
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (map! :map nov-mode-map
</span></span><span style="display:flex;"><span>        :n <span style="color:#e6db74">&#34;RET&#34;</span> <span style="color:#a6e22e">#&#39;</span>nov-scroll-up)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun doom-modeline-segment--nov-info ()
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34; &#34;</span>
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">propertize</span> (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> <span style="color:#e6db74">&#39;creator</span> nov-metadata)) <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;doom-modeline-project-parent-dir</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34; &#34;</span>
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> <span style="color:#e6db74">&#39;title</span> nov-metadata))
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34; &#34;</span>
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">propertize</span> (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;%d/%d&#34;</span> (<span style="color:#a6e22e">1+</span> nov-documents-index) (<span style="color:#a6e22e">length</span> nov-documents)) <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;doom-modeline-info</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (advice-add <span style="color:#e6db74">&#39;nov-render-title</span> :override <span style="color:#a6e22e">#&#39;</span>ignore)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun +nov-mode-setup ()
</span></span><span style="display:flex;"><span>    (face-remap-add-relative <span style="color:#e6db74">&#39;variable-pitch</span>
</span></span><span style="display:flex;"><span>                             :family <span style="color:#e6db74">&#34;Merriweather&#34;</span>
</span></span><span style="display:flex;"><span>                             :height <span style="color:#ae81ff">1.4</span>
</span></span><span style="display:flex;"><span>                             :width <span style="color:#e6db74">&#39;semi-expanded</span>)
</span></span><span style="display:flex;"><span>    (face-remap-add-relative <span style="color:#e6db74">&#39;default</span> :height <span style="color:#ae81ff">1.3</span>)
</span></span><span style="display:flex;"><span>    (setq-local line-spacing <span style="color:#ae81ff">0.2</span>
</span></span><span style="display:flex;"><span>                next-screen-context-lines <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                shr-use-colors <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>    (require <span style="color:#e6db74">&#39;visual-fill-column</span> <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (setq-local visual-fill-column-center-text <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                visual-fill-column-width <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>                nov-text-width <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>    (visual-fill-column-mode <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    (hl-line-mode <span style="color:#ae81ff">-1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (add-to-list <span style="color:#e6db74">&#39;+lookup-definition-functions</span> <span style="color:#a6e22e">#&#39;</span>+lookup/dictionary-definition)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (setq-local mode-line-format
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">`</span>((:eval
</span></span><span style="display:flex;"><span>                   (doom-modeline-segment--workspace-name))
</span></span><span style="display:flex;"><span>                  (:eval
</span></span><span style="display:flex;"><span>                   (doom-modeline-segment--window-number))
</span></span><span style="display:flex;"><span>                  (:eval
</span></span><span style="display:flex;"><span>                   (doom-modeline-segment--nov-info))
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">,</span>(<span style="color:#a6e22e">propertize</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34; %P &#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;doom-modeline-buffer-minor-mode</span>)
</span></span><span style="display:flex;"><span>                  <span style="color:#f92672">,</span>(<span style="color:#a6e22e">propertize</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34; &#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;face</span> (if (doom-modeline--active) <span style="color:#e6db74">&#39;mode-line</span> <span style="color:#e6db74">&#39;mode-line-inactive</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;display</span> <span style="color:#f92672">`</span>((space
</span></span><span style="display:flex;"><span>                                :align-to
</span></span><span style="display:flex;"><span>                                (<span style="color:#a6e22e">-</span> (<span style="color:#a6e22e">+</span> right right-fringe right-margin)
</span></span><span style="display:flex;"><span>                                   <span style="color:#f92672">,</span>(<span style="color:#a6e22e">*</span> (let ((width (doom-modeline--font-width)))
</span></span><span style="display:flex;"><span>                                         (or (and (<span style="color:#a6e22e">=</span> width <span style="color:#ae81ff">1</span>) <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>                                             (<span style="color:#a6e22e">/</span> width (<span style="color:#a6e22e">frame-char-width</span>) <span style="color:#ae81ff">1.0</span>)))
</span></span><span style="display:flex;"><span>                                       (<span style="color:#a6e22e">string-width</span>
</span></span><span style="display:flex;"><span>                                        (<span style="color:#a6e22e">format-mode-line</span> (<span style="color:#a6e22e">cons</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">&#39;</span>(:eval (doom-modeline-segment--major-mode))))))))))
</span></span><span style="display:flex;"><span>                  (:eval (doom-modeline-segment--major-mode)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (add-hook <span style="color:#e6db74">&#39;nov-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>+nov-mode-setup))
</span></span></code></pre></div><h3 id="news-feed-elfeed">News feed <code>elfeed</code></h3>
<p>Set RSS news feeds</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq elfeed-feeds
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;https://this-week-in-rust.org/rss.xml&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://www.omgubuntu.co.uk/feed&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://itsfoss.com/feed&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://linuxhandbook.com/feed&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://spectrum.ieee.org/rss/robotics/fulltext&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://spectrum.ieee.org/rss/aerospace/fulltext&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://spectrum.ieee.org/rss/computing/fulltext&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://spectrum.ieee.org/rss/blog/automaton/fulltext&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://developers.redhat.com/blog/feed&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://lwn.net/headlines/rss&#34;</span>))
</span></span></code></pre></div><h3 id="vpn-config">VPN Config</h3>
<h4 id="netextender-wrapper">NetExtender wrapper</h4>
<p>I store my NetExtender VPN parameters in a GPG encrypted file. The credentials file
contains a line of private parameters to pass to <code>netExtender</code>, like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;-u &lt;USERNAME&gt; -d &lt;DOMAINE&gt; -p &lt;PASSWORD&gt; -s &lt;SERVER_IP&gt;&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  | gpg -c &gt; netExtender-params.gpg
</span></span></code></pre></div><p>Then I like to have a simple script which decrypt the credentials and launch a
session via the <code>netExtender</code> command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ! command -v netExtender &amp;&gt; /dev/null
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;netExtender not found, installing from AUR using &#39;yay&#39;&#34;</span>
</span></span><span style="display:flex;"><span>  yay -S netextender
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MY_LOGIN_PARAMS_FILE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.ssh/netExtender-params.gpg&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Y\n&#34;</span> | netExtender --auto-reconnect <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#66d9ef">$(</span>gpg -q --for-your-eyes-only --no-tty -d <span style="color:#e6db74">${</span>MY_LOGIN_PARAMS_FILE<span style="color:#e6db74">}</span><span style="color:#66d9ef">)</span>
</span></span></code></pre></div><h4 id="launch-netextender-session-from-emacs">Launch NetExtender session from Emacs</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq netextender-process-name <span style="color:#e6db74">&#34;netextender&#34;</span>
</span></span><span style="display:flex;"><span>      netextender-buffer-name <span style="color:#e6db74">&#34;*netextender*&#34;</span>
</span></span><span style="display:flex;"><span>      netextender-command <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;~/.local/bin/netextender&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun netextender-start ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Launch a NetExtender VPN session&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (unless (<span style="color:#a6e22e">get-process</span> netextender-process-name)
</span></span><span style="display:flex;"><span>    (if (make-process :name netextender-process-name
</span></span><span style="display:flex;"><span>                      :buffer netextender-buffer-name
</span></span><span style="display:flex;"><span>                      :command netextender-command)
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Started NetExtender VPN session&#34;</span>)
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Cannot start NetExtender&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun netextender-kill ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Kill the created NetExtender VPN session&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (when (<span style="color:#a6e22e">get-process</span> netextender-process-name)
</span></span><span style="display:flex;"><span>    (if (<span style="color:#a6e22e">kill-buffer</span> netextender-buffer-name)
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Killed NetExtender VPN session&#34;</span>)
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Cannot kill NetExtender&#34;</span>))))
</span></span></code></pre></div><h3 id="email-mu4e">Email <code>mu4e</code></h3>
<p>Configuring <code>mu4e</code> email accounts, note that you need to have a proper
<code>mbsyncrc</code> file in the right directory.</p>
<p>You will need to:</p>
<ul>
<li>Install <code>mu</code> and <code>isync</code> (<code>sudo pacman -S mu isync</code>)</li>
<li>Set up a proper configuration file for your accounts at <code>~/.mbsyncrc</code></li>
<li>Run <code>mu init --maildir=~/Maildir --my-address=user@host1 --my-address=user@host2</code></li>
<li>Run <code>mbsync -c ~/.mbsyncrc -a</code></li>
<li>For sending mails from <code>mu4e</code>, add a <code>~/.authinfo</code> file, file contains a line in
this format <code>machine MAIL.EXAMPLE.ORG port 587 login MY_USER password MY_PASSWORD</code></li>
<li>Encrypt the <code>~/.authinfo</code> file using GPG <code>gpg -c ~/.authinfo</code> and delete the
original unencrypted file.</li>
</ul>
<p>I use a <code>mbsyncrc</code> file for multi-accounts, with some hacks for Gmail accounts (to
rename the <code>[Gmail]/...</code> folders). Here is an explained configuration example.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cfg" data-lang="cfg"><span style="display:flex;"><span><span style="color:#75715e"># mbsync config file</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># GLOBAL OPTIONS</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">BufferLimit 50mb             # Global option:   Default buffer size is 10M, too small for modern machines.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Sync All                     # Channels global: Sync everything &#34;Pull Push New ReNew Delete Flags&#34; (default option)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Create Both                  # Channels global: Automatically create missing mailboxes on both sides</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Expunge Both                 # Channels global: Delete messages marked for deletion on both sides</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CopyArrivalDate yes          # Channels global: Propagate arrival time with the messages</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># SECTION (IMAP4 Accounts)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">IMAPAccount work             # IMAP Account name</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Host mail.host.ccc           # The host to connect to</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">User user@host.ccc           # Login user name</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SSLVersions TLSv1.2 TLSv1.1  # Supported SSL versions</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Extract password from encrypted ~/.authinfo.gpg</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># File format: &#34;machine &lt;SERVER&gt; login &lt;LOGIN&gt; port &lt;PORT&gt; password &lt;PASSWORD&gt;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This uses sed to extract &lt;PASSWORD&gt; from line matching the account&#39;s &lt;SERVER&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PassCmd &#34;echo $(gpg --no-tty -qd ~/.authinfo.gpg 2&gt; /dev/null | sed -n &#39;s,^machine smtp\\.host\\.ccc .*password \\(..*\\)$,\\1,p&#39;)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AuthMechs *                  # Authentication mechanisms</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SSLType IMAPS                # Protocol (STARTTLS/IMAPS)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CertificateFile /etc/ssl/certs/ca-certificates.crt</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># END OF SECTION</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># IMPORTANT NOTE: you need to keep the blank line after each section</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># SECTION (IMAP Stores)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">IMAPStore work-remote        # Remote storage name</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Account work                 # Associated account</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># END OF SECTION</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># SECTION (Maildir Stores)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MaildirStore work-local      # Local storage (create directories with mkdir -p ~/Maildir/&lt;ACCOUNT-NAME&gt;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Path ~/Maildir/work/         # The local store path</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Inbox ~/Maildir/work/Inbox   # Location of the INBOX</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SubFolders Verbatim          # Download all sub-folders</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># END OF SECTION</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Connections specify links between remote and local folders</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># they are specified using patterns, which match remote mail</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># folders. Some commonly used patters include:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># - &#34;*&#34; to match everything</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># - &#34;!DIR&#34; to exclude &#34;DIR&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># - &#34;DIR&#34; to match DIR</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># SECTION (Channels)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel work                 # Channel name</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Far :work-remote:            # Connect remote store</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Near :work-local:            # to the local one</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Patterns &#34;INBOX&#34; &#34;Drafts&#34; &#34;Sent&#34; &#34;Archives/*&#34; &#34;Spam&#34; &#34;Trash&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SyncState *                  # Save state in near side mailbox file &#34;.mbsyncstate&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># END OF SECTION</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ================================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">IMAPAccount gmail</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Host imap.gmail.com</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">User user@gmail.com</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PassCmd &#34;echo $(gpg --no-tty -qd ~/.authinfo.gpg 2&gt; /dev/null | sed -n &#39;s,^machine smtp\\.googlemail\\.com .*password \\(..*\\)$,\\1,p&#39;)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AuthMechs LOGIN</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SSLType IMAPS</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CertificateFile /etc/ssl/certs/ca-certificates.crt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">IMAPStore gmail-remote</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Account gmail</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MaildirStore gmail-local</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Path ~/Maildir/gmail/</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Inbox ~/Maildir/gmail/Inbox</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For Gmail, I like to make multiple channels, one for each remote directory</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># this is a trick to rename remote &#34;[Gmail]/mailbox&#34; to &#34;mailbox&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-inbox</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Far :gmail-remote:</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Near :gmail-local:</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Patterns &#34;INBOX&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SyncState *</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-trash</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Far :gmail-remote:&#34;[Gmail]/Trash&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Near :gmail-local:&#34;Trash&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SyncState *</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-drafts</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Far :gmail-remote:&#34;[Gmail]/Drafts&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Near :gmail-local:&#34;Drafts&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SyncState *</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-sent</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Far :gmail-remote:&#34;[Gmail]/Sent Mail&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Near :gmail-local:&#34;Sent Mail&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SyncState *</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-all</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Far :gmail-remote:&#34;[Gmail]/All Mail&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Near :gmail-local:&#34;All Mail&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SyncState *</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-starred</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Far :gmail-remote:&#34;[Gmail]/Starred&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Near :gmail-local:&#34;Starred&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SyncState *</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-spam</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Far :gmail-remote:&#34;[Gmail]/Spam&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Near :gmail-local:&#34;Spam&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SyncState *</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># GROUPS PUT TOGETHER CHANNELS, SO THAT WE CAN INVOKE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># MBSYNC ON A GROUP TO SYNC ALL CHANNELS</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># FOR INSTANCE: &#34;mbsync gmail&#34; GETS MAIL FROM</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># &#34;gmail-inbox&#34;, &#34;gmail-sent&#34;, and &#34;gmail-trash&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># SECTION (Groups)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Group gmail</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-inbox</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-sent</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-trash</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-drafts</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-all</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-starred</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Channel gmail-spam</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># END OF SECTION</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;load-path</span> <span style="color:#e6db74">&#34;/usr/local/share/emacs/site-lisp/mu4e&#34;</span>)
</span></span></code></pre></div><p>I configure my email accounts in a private file in
<code>lisp/private/+mu4e-accounts.el</code>, which will be loaded after this common part:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! mu4e
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;org-msg</span>)
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;smtpmail</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Common parameters</span>
</span></span><span style="display:flex;"><span>  (setq smtpmail-auth-credentials <span style="color:#e6db74">&#34;~/.authinfo.gpg&#34;</span>
</span></span><span style="display:flex;"><span>        mu4e-maildir <span style="color:#e6db74">&#34;~/Maildir&#34;</span>
</span></span><span style="display:flex;"><span>        mu4e-update-interval (<span style="color:#a6e22e">*</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">60</span>) <span style="color:#75715e">;; Every 3 min</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;; mu4e-get-mail-command &#34;mbsync -a&#34; ;; Not needed, as +mu4e-backend is &#39;mbsync by default</span>
</span></span><span style="display:flex;"><span>        mu4e-main-hide-personal-addresses <span style="color:#66d9ef">t</span> <span style="color:#75715e">;; No need to display a long list of my own addresses!</span>
</span></span><span style="display:flex;"><span>        mu4e-attachment-dir (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;~/Maildir/attachements&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;; message-send-mail-function &#39;smtpmail-send-it ;; Set by default</span>
</span></span><span style="display:flex;"><span>        mu4e-sent-messages-behavior <span style="color:#e6db74">&#39;sent</span> <span style="color:#75715e">;; Save sent messages</span>
</span></span><span style="display:flex;"><span>        mu4e-context-policy <span style="color:#e6db74">&#39;pick-first</span> <span style="color:#75715e">;; Start with the first context</span>
</span></span><span style="display:flex;"><span>        mu4e-compose-context-policy <span style="color:#e6db74">&#39;ask</span>) <span style="color:#75715e">;; Always ask which context to use when composing a new mail</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (setq mu4e-headers-fields <span style="color:#f92672">&#39;</span>((:flags <span style="color:#f92672">.</span> <span style="color:#ae81ff">6</span>) <span style="color:#75715e">;; 3 flags</span>
</span></span><span style="display:flex;"><span>                              (:account-stripe <span style="color:#f92672">.</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>                              (:from-or-to <span style="color:#f92672">.</span> <span style="color:#ae81ff">25</span>)
</span></span><span style="display:flex;"><span>                              (:folder <span style="color:#f92672">.</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>                              (:recipnum <span style="color:#f92672">.</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>                              (:subject <span style="color:#f92672">.</span> <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>                              (:human-date <span style="color:#f92672">.</span> <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>        +mu4e-min-header-frame-width <span style="color:#ae81ff">142</span>
</span></span><span style="display:flex;"><span>        mu4e-headers-date-format <span style="color:#e6db74">&#34;%d/%m/%y&#34;</span>
</span></span><span style="display:flex;"><span>        mu4e-headers-time-format <span style="color:#e6db74">&#34; %H:%M&#34;</span>
</span></span><span style="display:flex;"><span>        mu4e-headers-results-limit <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>        mu4e-index-cleanup <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defvar +mu4e-header--folder-colors <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>  (appendq! mu4e-header-info-custom
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#39;</span>((:folder <span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>               (:name <span style="color:#e6db74">&#34;Folder&#34;</span> :shortname <span style="color:#e6db74">&#34;Folder&#34;</span> :help <span style="color:#e6db74">&#34;Lowest level folder&#34;</span> :function
</span></span><span style="display:flex;"><span>                (lambda (msg)
</span></span><span style="display:flex;"><span>                  (+mu4e-colorize-str
</span></span><span style="display:flex;"><span>                   (replace-regexp-in-string <span style="color:#e6db74">&#34;\\`.*/&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> (mu4e-message-field msg :maildir))
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;+mu4e-header--folder-colors</span>))))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Add shortcut to view yesterday&#39;s messages</span>
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;mu4e-bookmarks</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#39;</span>(:name <span style="color:#e6db74">&#34;Yesterday&#39;s messages&#34;</span> :query <span style="color:#e6db74">&#34;date:2d..1d&#34;</span> :key <span style="color:#e6db74">?y</span>) <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Use a nicer icon in alerts</span>
</span></span><span style="display:flex;"><span>  (setq mu4e-alert-icon <span style="color:#e6db74">&#34;/usr/share/icons/Papirus/64x64/apps/mail-client.svg&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Org-Msg stuff</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; org-msg-signature is set for each account separately</span>
</span></span><span style="display:flex;"><span>  (map! :map org-msg-edit-mode-map
</span></span><span style="display:flex;"><span>        :after org-msg
</span></span><span style="display:flex;"><span>        :n <span style="color:#e6db74">&#34;G&#34;</span> <span style="color:#a6e22e">#&#39;</span>org-msg-goto-body)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; I like to always BCC myself</span>
</span></span><span style="display:flex;"><span>  (defun ab/bcc-me ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Add my email to BCC.&#34;</span>
</span></span><span style="display:flex;"><span>    (save-excursion (message-add-header (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;Bcc: &#34;</span> user-mail-address <span style="color:#e6db74">&#34;\n&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (add-hook <span style="color:#e6db74">&#39;mu4e-compose-mode-hook</span> <span style="color:#e6db74">&#39;ab/bcc-me</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Load</span>
</span></span><span style="display:flex;"><span>  (load! <span style="color:#e6db74">&#34;lisp/private/+mu4e-smart-refiling.el&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Load my accounts</span>
</span></span><span style="display:flex;"><span>  (load! <span style="color:#e6db74">&#34;lisp/private/+mu4e-accounts.el&#34;</span>))
</span></span></code></pre></div><p>The <code>lisp/private/+mu4e-accounts.el</code> file includes Doom&rsquo;s mu4e multi-account
configuration as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(set-email-account! <span style="color:#e6db74">&#34;Work&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#39;</span>((mu4e-sent-folder             <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/work-dir/Sent&#34;</span>)
</span></span><span style="display:flex;"><span>                      (mu4e-drafts-folder           <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/work-dir/Drafts&#34;</span>)
</span></span><span style="display:flex;"><span>                      (mu4e-trash-folder            <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/work-dir/Trash&#34;</span>)
</span></span><span style="display:flex;"><span>                      (mu4e-refile-folder           <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/work-dir/Archive&#34;</span>)
</span></span><span style="display:flex;"><span>                      (org-msg-signature            <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;-- SIGNATURE&#34;</span>)
</span></span><span style="display:flex;"><span>                      (smtpmail-smtp-user           <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;username@server.com&#34;</span>)
</span></span><span style="display:flex;"><span>                      (smtpmail-stream-type         <span style="color:#f92672">.</span> ssl)
</span></span><span style="display:flex;"><span>                      (smtpmail-default-smtp-server <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;smtps.server.com&#34;</span>)
</span></span><span style="display:flex;"><span>                      (smtpmail-smtp-server         <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;smtps.server.com&#34;</span>)
</span></span><span style="display:flex;"><span>                      (smtpmail-smtp-service        <span style="color:#f92672">.</span> <span style="color:#ae81ff">465</span>))
</span></span><span style="display:flex;"><span>                     <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(set-email-account! <span style="color:#e6db74">&#34;Gmail&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#39;</span>((mu4e-sent-folder             <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/gmail-dir/Sent&#34;</span>)
</span></span><span style="display:flex;"><span>                      (mu4e-drafts-folder           <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/gmail-dir/Drafts&#34;</span>)
</span></span><span style="display:flex;"><span>                      (mu4e-trash-folder            <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/gmail-dir/Trash&#34;</span>)
</span></span><span style="display:flex;"><span>                      (mu4e-refile-folder           <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/gmail-dir/Archive&#34;</span>)
</span></span><span style="display:flex;"><span>                      (org-msg-signature            <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;-- SIGNATURE&#34;</span>)
</span></span><span style="display:flex;"><span>                      (smtpmail-smtp-user           <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;username@gmail.com&#34;</span>)
</span></span><span style="display:flex;"><span>                      <span style="color:#f92672">...</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; Tell Doom&#39;s mu4e module to override some commands to fix issues on Gmail accounts</span>
</span></span><span style="display:flex;"><span>(setq +mu4e-gmail-accounts <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">&#34;username@gmail.com&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/gmail-dir&#34;</span>)))
</span></span></code></pre></div><h2 id="programming">Programming</h2>
<h3 id="file-templates">File Templates</h3>
<p>For some file types, we overwrite defaults in the <a href="./snippets">snippets</a> directory, others
need to have a template assigned.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(set-file-template! <span style="color:#e6db74">&#34;\\.tex$&#34;</span> :trigger <span style="color:#e6db74">&#34;__&#34;</span> :mode <span style="color:#e6db74">&#39;latex-mode</span>)
</span></span><span style="display:flex;"><span>(set-file-template! <span style="color:#e6db74">&#34;\\.org$&#34;</span> :trigger <span style="color:#e6db74">&#34;__&#34;</span> :mode <span style="color:#e6db74">&#39;org-mode</span>)
</span></span><span style="display:flex;"><span>(set-file-template! <span style="color:#e6db74">&#34;/LICEN[CS]E$&#34;</span> :trigger <span style="color:#e6db74">&#39;+file-templates/insert-license</span>)
</span></span></code></pre></div><h3 id="gnu-octave">GNU Octave</h3>
<p>Files with <code>.m</code> extension gets recognized automatically as Objective C files. Lets
change this to be recognized as Octave/Matlab files.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#a6e22e">autoload</span> <span style="color:#e6db74">&#39;octave-mode</span> <span style="color:#e6db74">&#34;octave-mode&#34;</span> <span style="color:#e6db74">&#34;Loding octave-mode&#34;</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;auto-mode-alist</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;\\.m\\&#39;&#34;</span> <span style="color:#f92672">.</span> octave-mode))
</span></span></code></pre></div><h3 id="ros">ROS</h3>
<p>Add ROS specific file formats:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;auto-mode-alist</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;\\.launch$&#34;</span> <span style="color:#f92672">.</span> xml-mode))
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;auto-mode-alist</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;\\.urdf$&#34;</span>   <span style="color:#f92672">.</span> xml-mode))
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;auto-mode-alist</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;\\.xacro$&#34;</span>  <span style="color:#f92672">.</span> xml-mode))
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;auto-mode-alist</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;\\.rviz$&#34;</span>   <span style="color:#f92672">.</span> conf-unix-mode))
</span></span></code></pre></div><h3 id="lsp">LSP</h3>
<h4 id="enable-some-useful-ui-stuff">Enable some useful UI stuff</h4>
<p>LSP mode provides a <a href="https://emacs-lsp.github.io/lsp-mode/tutorials/how-to-turn-off/">set of configurable UI stuff</a>, Doom Emacs disables a set of
UI components to provide a less intrusive UI, however I like to enable some less
intrusive, more useful UI stuff.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! lsp-ui
</span></span><span style="display:flex;"><span>  (setq lsp-ui-sideline-enable <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>        lsp-ui-sideline-show-code-actions <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>        lsp-ui-sideline-show-diagnostics <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>        lsp-ui-sideline-show-hover <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        lsp-log-io <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        lsp-lens-enable <span style="color:#66d9ef">nil</span> <span style="color:#75715e">; not working properly with ccls!</span>
</span></span><span style="display:flex;"><span>        lsp-diagnostics-provider :auto
</span></span><span style="display:flex;"><span>        lsp-enable-symbol-highlighting <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>        lsp-headerline-breadcrumb-enable <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        lsp-headerline-breadcrumb-segments <span style="color:#f92672">&#39;</span>(symbols)))
</span></span></code></pre></div><h4 id="fringe">Fringe</h4>
<p>Increase the left fringe width, to enable rendering breakpoints correctly.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! lsp-mode
</span></span><span style="display:flex;"><span>  (add-hook <span style="color:#e6db74">&#39;lsp-mode-hook</span> (lambda () (set-fringe-mode <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">15</span> <span style="color:#f92672">.</span> <span style="color:#ae81ff">15</span>)))))
</span></span></code></pre></div><h4 id="eglot">Eglot</h4>
<p>Eglot uses <code>project.el</code> to detect the project root. This is <a href="https://github.com/joaotavora/eglot/issues/129#issuecomment-444130367">a workaround</a> to make
it work with <code>projectile</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! eglot
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; A hack to make it works with projectile</span>
</span></span><span style="display:flex;"><span>  (defun projectile-project-find-function (dir)
</span></span><span style="display:flex;"><span>    (let* ((root (projectile-project-root dir)))
</span></span><span style="display:flex;"><span>      (and root (<span style="color:#a6e22e">cons</span> <span style="color:#e6db74">&#39;transient</span> root))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (with-eval-after-load <span style="color:#e6db74">&#39;project</span>
</span></span><span style="display:flex;"><span>    (add-to-list <span style="color:#e6db74">&#39;project-find-functions</span> <span style="color:#e6db74">&#39;projectile-project-find-function</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Use clangd with some options</span>
</span></span><span style="display:flex;"><span>  (set-eglot-client! <span style="color:#e6db74">&#39;c++-mode</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;clangd&#34;</span> <span style="color:#e6db74">&#34;-j=3&#34;</span> <span style="color:#e6db74">&#34;--clang-tidy&#34;</span>)))
</span></span></code></pre></div><h4 id="lsp-mode-with-clangd">LSP mode with <code>clangd</code></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! lsp-clangd
</span></span><span style="display:flex;"><span>  (setq lsp-clients-clangd-args
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;-j=4&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;--background-index&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;--clang-tidy&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;--completion-style=detailed&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;--header-insertion=never&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;--header-insertion-decorators=0&#34;</span>))
</span></span><span style="display:flex;"><span>  (set-lsp-priority! <span style="color:#e6db74">&#39;clangd</span> <span style="color:#ae81ff">2</span>))
</span></span></code></pre></div><h4 id="lsp-mode-with-ccls">LSP mode with <code>ccls</code></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled, using the default ccls</span>
</span></span><span style="display:flex;"><span>(after! ccls
</span></span><span style="display:flex;"><span>  (setq ccls-initialization-options
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#39;</span>(:index (:comments <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                  :trackDependency <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                  :threads <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>          :completion (:detailedLabel <span style="color:#66d9ef">t</span>)))
</span></span><span style="display:flex;"><span>  (set-lsp-priority! <span style="color:#e6db74">&#39;ccls</span> <span style="color:#ae81ff">2</span>)) <span style="color:#75715e">; optional as ccls is the default in Doom</span>
</span></span></code></pre></div><h4 id="enable-lsp-over-tramp">Enable <code>lsp</code> over <code>tramp</code></h4>
<h5 id="for-python">For Python</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! tramp
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;lsp-mode</span>)
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;lsp-pyright</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (setq lsp-enable-snippet <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        lsp-log-io <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;; To bypass the &#34;lsp--document-highlight fails if</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;; textDocument/documentHighlight is not supported&#34; error</span>
</span></span><span style="display:flex;"><span>        lsp-enable-symbol-highlighting <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (lsp-register-client
</span></span><span style="display:flex;"><span>   (make-lsp-client
</span></span><span style="display:flex;"><span>    :new-connection (lsp-tramp-connection <span style="color:#e6db74">&#34;pyls&#34;</span>)
</span></span><span style="display:flex;"><span>    :major-modes <span style="color:#f92672">&#39;</span>(python-mode)
</span></span><span style="display:flex;"><span>    :remote? <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>    :server-id <span style="color:#e6db74">&#39;pyls-remote</span>)))
</span></span></code></pre></div><h5 id="for-c-c-plus-plus-with-ccls">For C/C++ with <code>ccls</code></h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: WIP: Not tangled</span>
</span></span><span style="display:flex;"><span>(after! tramp
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;lsp-mode</span>)
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;ccls</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (setq lsp-enable-snippet <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        lsp-log-io <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        lsp-enable-symbol-highlighting <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (lsp-register-client
</span></span><span style="display:flex;"><span>   (make-lsp-client
</span></span><span style="display:flex;"><span>    :new-connection
</span></span><span style="display:flex;"><span>    (lsp-tramp-connection
</span></span><span style="display:flex;"><span>     (lambda ()
</span></span><span style="display:flex;"><span>       (<span style="color:#a6e22e">cons</span> ccls-executable <span style="color:#75715e">; executable name on remote machine &#39;ccls&#39;</span>
</span></span><span style="display:flex;"><span>             ccls-args)))
</span></span><span style="display:flex;"><span>    :major-modes <span style="color:#f92672">&#39;</span>(c-mode c++-mode objc-mode cuda-mode)
</span></span><span style="display:flex;"><span>    :remote? <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>    :server-id <span style="color:#e6db74">&#39;ccls-remote</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;tramp-remote-path</span> <span style="color:#e6db74">&#39;tramp-own-remote-path</span>))
</span></span></code></pre></div><h5 id="for-c-c-plus-plus-with-clangd">For C/C++ with <code>clangd</code></h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! tramp
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;lsp-mode</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (setq lsp-enable-snippet <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        lsp-log-io <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;; To bypass the &#34;lsp--document-highlight fails if</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;; textDocument/documentHighlight is not supported&#34; error</span>
</span></span><span style="display:flex;"><span>        lsp-enable-symbol-highlighting <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (lsp-register-client
</span></span><span style="display:flex;"><span>    (make-lsp-client
</span></span><span style="display:flex;"><span>     :new-connection
</span></span><span style="display:flex;"><span>     (lsp-tramp-connection
</span></span><span style="display:flex;"><span>      (lambda ()
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">cons</span> <span style="color:#e6db74">&#34;clangd-12&#34;</span> <span style="color:#75715e">; executable name on remote machine &#39;ccls&#39;</span>
</span></span><span style="display:flex;"><span>              lsp-clients-clangd-args)))
</span></span><span style="display:flex;"><span>     :major-modes <span style="color:#f92672">&#39;</span>(c-mode c++-mode objc-mode cuda-mode)
</span></span><span style="display:flex;"><span>     :remote? <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>     :server-id <span style="color:#e6db74">&#39;clangd-remote</span>)))
</span></span></code></pre></div><h3 id="dap">DAP</h3>
<p>I like to use <a href="https://github.com/Microsoft/vscode-cpptools"><code>cpptools</code></a> over <a href="https://github.com/WebFreak001/code-debug"><code>webfreak.debug</code></a>. So I enable it after loading
<code>dap-mode</code>. I like also to have a mode minimal UI. I like to trigger <code>dap-hydra</code>
when the program hits a break point, and automatically delete the session and
close Hydra when DAP is terminated.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! dap-mode
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;dap-cpptools</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; More minimal UI</span>
</span></span><span style="display:flex;"><span>  (setq dap-auto-configure-features <span style="color:#f92672">&#39;</span>(locals tooltip)
</span></span><span style="display:flex;"><span>        lsp-enable-dap-auto-configure <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>        dap-auto-show-output <span style="color:#66d9ef">nil</span>) <span style="color:#75715e">;; Hide the annoying server output</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Automatically trigger dap-hydra when a program hits a breakpoint.</span>
</span></span><span style="display:flex;"><span>  (add-hook <span style="color:#e6db74">&#39;dap-stopped-hook</span> (lambda (arg) (<span style="color:#a6e22e">call-interactively</span> <span style="color:#a6e22e">#&#39;</span>dap-hydra)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Automatically delete session and close dap-hydra when DAP is terminated.</span>
</span></span><span style="display:flex;"><span>  (add-hook <span style="color:#e6db74">&#39;dap-terminated-hook</span>
</span></span><span style="display:flex;"><span>    (lambda (arg)
</span></span><span style="display:flex;"><span>      (progn (<span style="color:#a6e22e">call-interactively</span> <span style="color:#a6e22e">#&#39;</span>dap-delete-session)
</span></span><span style="display:flex;"><span>             (dap-hydra/nil)))))
</span></span></code></pre></div><h4 id="doom-store">Doom store</h4>
<p>Doom Emacs stores session information persistently using the core <code>store</code>
mechanism. However, relaunching a new session doesn&rsquo;t overwrite the last stored
session, to do so, I define a helper function to clear data stored in the
<code>&quot;+debugger&quot;</code> location. (see <code>+debugger--get-last-config</code> function.)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun +debugger/clear-last-session ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Clear the last stored session&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (doom-store-clear <span style="color:#e6db74">&#34;+debugger&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(map! :leader :prefix (<span style="color:#e6db74">&#34;l&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;custom&#34;</span>)
</span></span><span style="display:flex;"><span>      (:when (featurep! :tools debugger +lsp)
</span></span><span style="display:flex;"><span>       :prefix-map (<span style="color:#e6db74">&#34;d&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;debugger&#34;</span>)
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;Clear last DAP session&#34;</span> <span style="color:#e6db74">&#34;c&#34;</span> <span style="color:#a6e22e">#&#39;</span>+debugger/clear-last-session))
</span></span></code></pre></div><h3 id="the-grand-cathedral-debugger">The Grand &ldquo;Cathedral&rdquo; Debugger</h3>
<p>For C/C++, DAP mode is missing so much features.
In my experience, both <code>cpptools</code> and <code>gdb</code> DAP interfaces aren&rsquo;t mature, it stops
and disconnect while debugging, making it a double pain.</p>
<h4 id="additional-commands">Additional commands</h4>
<p>Using a pure GDB makes things more flexible, I also use <code>rr</code> (by substituting <code>gdb</code>
by <code>rr replay</code> when starting the session), which gives me the possibility to do
reverse debugging.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! realgud
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;hydra</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Add some missing gdb/rr commands</span>
</span></span><span style="display:flex;"><span>  (defun ab/realgud:cmd-start(arg)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;start = break main + run&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive <span style="color:#e6db74">&#34;p&#34;</span>)
</span></span><span style="display:flex;"><span>    (realgud-command <span style="color:#e6db74">&#34;start&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun ab/realgud:cmd-reverse-next(arg)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Reverse next&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive <span style="color:#e6db74">&#34;p&#34;</span>)
</span></span><span style="display:flex;"><span>    (realgud-command <span style="color:#e6db74">&#34;reverse-next&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun ab/realgud:cmd-reverse-step(arg)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Reverse step&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive <span style="color:#e6db74">&#34;p&#34;</span>)
</span></span><span style="display:flex;"><span>    (realgud-command <span style="color:#e6db74">&#34;reverse-step&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun ab/realgud:cmd-reverse-continue(arg)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Reverse continue&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive <span style="color:#e6db74">&#34;p&#34;</span>)
</span></span><span style="display:flex;"><span>    (realgud-command <span style="color:#e6db74">&#34;reverse-continue&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun ab/realgud:cmd-reverse-finish(arg)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Reverse finish&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive <span style="color:#e6db74">&#34;p&#34;</span>)
</span></span><span style="display:flex;"><span>    (realgud-command <span style="color:#e6db74">&#34;reverse-finish&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Define a hydra binding</span>
</span></span><span style="display:flex;"><span>  (defhydra realgud-hydra (:color pink :hint <span style="color:#66d9ef">nil</span> :foreign-keys run)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> Stepping  |  _n_: next      |  _i_: step    |  _o_: finish  |  _c_: continue  |  _R_: restart  |  _u_: until-here
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> Revese    | _rn_: next      | _ri_: step    | _ro_: finish  | _rc_: continue  |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> Breakpts  | _ba_: break     | _bD_: delete  | _bt_: tbreak  | _bd_: disable   | _be_: enable   | _tr_: backtrace
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> Eval      | _ee_: at-point  | _er_: region  | _eE_: eval    |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">           |  _!_: shell     | _Qk_: kill    | _Qq_: quit    | _Sg_: gdb       | _Ss_: start
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;n&#34;</span>  realgud:cmd-next)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;i&#34;</span>  realgud:cmd-step)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;o&#34;</span>  realgud:cmd-finish)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;c&#34;</span>  realgud:cmd-continue)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;R&#34;</span>  realgud:cmd-restart)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;u&#34;</span>  realgud:cmd-until-here)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;rn&#34;</span> ab/realgud:cmd-reverse-next)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;ri&#34;</span> ab/realgud:cmd-reverse-step)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;ro&#34;</span> ab/realgud:cmd-reverse-finish)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;rc&#34;</span> ab/realgud:cmd-reverse-continue)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;ba&#34;</span> realgud:cmd-break)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;bt&#34;</span> realgud:cmd-tbreak)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;bD&#34;</span> realgud:cmd-delete)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;be&#34;</span> realgud:cmd-enable)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;bd&#34;</span> realgud:cmd-disable)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;ee&#34;</span> realgud:cmd-eval-at-point)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;er&#34;</span> realgud:cmd-eval-region)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;tr&#34;</span> realgud:cmd-backtrace)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;eE&#34;</span> realgud:cmd-eval)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;!&#34;</span>  realgud:cmd-shell)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;Qk&#34;</span> realgud:cmd-kill)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;Sg&#34;</span> realgud:gdb)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;Ss&#34;</span> ab/realgud:cmd-start)
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;q&#34;</span>  <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#34;quit&#34;</span> :color blue) <span style="color:#75715e">;; :exit</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;Qq&#34;</span> realgud:cmd-quit :color blue)) <span style="color:#75715e">;; :exit</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun +debugger/realgud:gdb-hydra ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Run </span><span style="color:#e6db74">`realgud-hydra&#39;</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive)
</span></span><span style="display:flex;"><span>    (realgud-hydra/body))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (map! :leader :prefix (<span style="color:#e6db74">&#34;l&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;custom&#34;</span>)
</span></span><span style="display:flex;"><span>        (:when (featurep! :tools debugger)
</span></span><span style="display:flex;"><span>         :prefix-map (<span style="color:#e6db74">&#34;d&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;debugger&#34;</span>)
</span></span><span style="display:flex;"><span>         :desc <span style="color:#e6db74">&#34;RealGUD hydra&#34;</span> <span style="color:#e6db74">&#34;h&#34;</span> <span style="color:#a6e22e">#&#39;</span>+debugger/realgud:gdb-hydra)))
</span></span></code></pre></div><h4 id="realgud-dot-dir-locals-dot-el-support--only-for-gdb">RealGUD <code>.dir-locals.el</code> support (Only for GDB)</h4>
<p>I do a lot of development on C/C++ apps which gets data from command line
arguments, which means I have to type my arguments manually after calling
<code>realgud:gdb</code>, which is very annoying.</p>
<p>For DAP mode, there is support for either <code>dap-debug-edit-template</code>, or
<code>launch.json</code>. For RealGUD though, I didn&rsquo;t find any ready-to-use feature like
this. So I define a parameter list named <code>ab/realgud:launch-plist</code>, which supports
<code>:program</code> and <code>:args</code>. The first is a string of the program path, and the second is
a list of string arguments to pass to the program.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; A variable which to be used in .dir-locals.el, formatted as a property list;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; &#39;(:program &#34;...&#34; :args (&#34;args1&#34; &#34;arg2&#34; ...))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; &#34;${workspaceFolder}&#34; =&gt; gets replaced with project workspace (from projectile)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; &#34;${workspaceFolderBasename}&#34; =&gt; gets replaced with project workspace&#39;s basename</span>
</span></span><span style="display:flex;"><span>(defvar ab/realgud:launch-plist <span style="color:#66d9ef">nil</span>)
</span></span></code></pre></div><p>This variable is set in a per-project basis thanks to <code>.dir-locals.el</code>, some thing
like this:</p>
<pre tabindex="0"><code class="language-lisp-data" data-lang="lisp-data">;; Example entry in .dir-locals.el
((nil . ((ab/realgud:launch-plist . &#39;(:program &#34;${workspaceFolder}/build/bin/my_prog&#34;
                                      :args (&#34;--in_file=${workspaceFolder}/some/file.csv&#34;
                                             &#34;--out_file=/tmp/some_randome_file&#34;
                                             &#34;-a&#34;))))))
</code></pre><p>The special variables <code>${workspaceFolder}</code> and <code>${workspaceFolderBasename}</code> are
defined as in <a href="https://code.visualstudio.com/docs/editor/variables-reference">VS Code</a>, the actual values are filled from
<code>projectile-project-root</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(cl-defun ab/realgud:get-launch-debugger-args (<span style="color:#66d9ef">&amp;key</span> program args)
</span></span><span style="display:flex;"><span>  (let ((debugger--args <span style="color:#e6db74">&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>    (when program
</span></span><span style="display:flex;"><span>      (setq debugger--args program)
</span></span><span style="display:flex;"><span>      (when args
</span></span><span style="display:flex;"><span>        (setq debugger--args (<span style="color:#a6e22e">concat</span> debugger--args <span style="color:#e6db74">&#34; &#34;</span> (s-join <span style="color:#e6db74">&#34; &#34;</span> args)))))
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">;; Replace special variables</span>
</span></span><span style="display:flex;"><span>    (let* ((ws--root (<span style="color:#a6e22e">expand-file-name</span> (or (projectile-project-root) <span style="color:#e6db74">&#34;.&#34;</span>)))
</span></span><span style="display:flex;"><span>           (ws--basename (<span style="color:#a6e22e">file-name-nondirectory</span>
</span></span><span style="display:flex;"><span>                          (if (s-ends-with-p <span style="color:#e6db74">&#34;/&#34;</span> ws--root)
</span></span><span style="display:flex;"><span>                              (<span style="color:#a6e22e">substring</span> ws--root <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">-1</span>)
</span></span><span style="display:flex;"><span>                            ws--root))))
</span></span><span style="display:flex;"><span>      (s-replace-all
</span></span><span style="display:flex;"><span>       (<span style="color:#a6e22e">list</span> (<span style="color:#a6e22e">cons</span> <span style="color:#e6db74">&#34;${workspaceFolder}&#34;</span> ws--root)
</span></span><span style="display:flex;"><span>             (<span style="color:#a6e22e">cons</span> <span style="color:#e6db74">&#34;${workspaceFolderBasename}&#34;</span> ws--basename))
</span></span><span style="display:flex;"><span>       debugger--args))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun +debugger/realgud:gdb-launch ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Launch RealGUD with parameters from </span><span style="color:#e6db74">`ab/realgud:launch-plist&#39;</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;realgud</span>)
</span></span><span style="display:flex;"><span>  (if ab/realgud:launch-plist
</span></span><span style="display:flex;"><span>      (realgud:gdb
</span></span><span style="display:flex;"><span>       (<span style="color:#a6e22e">concat</span> realgud:gdb-command-name
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#34; --args &#34;</span>
</span></span><span style="display:flex;"><span>               (<span style="color:#a6e22e">apply</span> <span style="color:#e6db74">&#39;ab/realgud:get-launch-debugger-args</span> ab/realgud:launch-plist)))
</span></span><span style="display:flex;"><span>    (progn
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Variable </span><span style="color:#e6db74">`ab/realgud:launch-plist&#39;</span><span style="color:#e6db74"> is </span><span style="color:#e6db74">`nil&#39;</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>      (realgud:gdb))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(map! :leader :prefix (<span style="color:#e6db74">&#34;l&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;custom&#34;</span>)
</span></span><span style="display:flex;"><span>      (:when (featurep! :tools debugger)
</span></span><span style="display:flex;"><span>       :prefix-map (<span style="color:#e6db74">&#34;d&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;debugger&#34;</span>)
</span></span><span style="display:flex;"><span>       :desc <span style="color:#e6db74">&#34;RealGUD launch&#34;</span> <span style="color:#e6db74">&#34;d&#34;</span> <span style="color:#a6e22e">#&#39;</span>+debugger/realgud:gdb-launch))
</span></span></code></pre></div><h4 id="record-and-replay-rr">Record and replay <code>rr</code></h4>
<p>Add shortcuts to run <code>rr</code> from Emacs, the <code>rr record</code> takes the program name and
arguments from my local <code>ab/realgud:gdb-launch-plist</code>, when <code>rr replay</code> respects the
arguments configured in RealGUD&rsquo;s GDB command name.
Some useful hints could be found <a href="http://notes.secretsauce.net/notes/2017/02/24_interfacing-rr-to-gdb-in-gnu-emacs.html">here</a>, <a href="https://github.com/rr-debugger/rr/blob/82ab0f9f5bc13fb27acaccb9a85397bcaa7a7b05/src/ReplayCommand.cc#L45">here</a>, <a href="https://github.com/rr-debugger/rr/issues/1484">here</a> and <a href="https://emacs.stackexchange.com/questions/20056/is-it-possible-to-use-mozillas-rr-with-gdb-multi-window">here</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! realgud
</span></span><span style="display:flex;"><span>  (require <span style="color:#e6db74">&#39;s</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun +debugger/rr-replay ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Launch `rr replay&#39;&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive)
</span></span><span style="display:flex;"><span>    (realgud:gdb (s-replace <span style="color:#e6db74">&#34;gdb&#34;</span> <span style="color:#e6db74">&#34;rr replay&#34;</span> realgud:gdb-command-name)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun +debugger/rr-record ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Launch `rr record&#39; with parameters from </span><span style="color:#e6db74">`ab/realgud:launch-plist&#39;</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive)
</span></span><span style="display:flex;"><span>    (let ((debugger--args (<span style="color:#a6e22e">apply</span> <span style="color:#e6db74">&#39;ab/realgud:get-launch-debugger-args</span> ab/realgud:launch-plist)))
</span></span><span style="display:flex;"><span>      (unless (make-process :name <span style="color:#e6db74">&#34;*rr record*&#34;</span>
</span></span><span style="display:flex;"><span>                            :buffer <span style="color:#e6db74">&#34;*rr record*&#34;</span>
</span></span><span style="display:flex;"><span>                            :command (<span style="color:#a6e22e">append</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;rr&#34;</span> <span style="color:#e6db74">&#34;record&#34;</span>) (s-split <span style="color:#e6db74">&#34; &#34;</span> debugger--args)))
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Cannot make process &#39;rr record&#39;&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (map! :leader :prefix (<span style="color:#e6db74">&#34;l&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;custom&#34;</span>)
</span></span><span style="display:flex;"><span>        (:when (featurep! :tools debugger)
</span></span><span style="display:flex;"><span>         :prefix-map (<span style="color:#e6db74">&#34;d&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;debugger&#34;</span>)
</span></span><span style="display:flex;"><span>         :desc <span style="color:#e6db74">&#34;rr record&#34;</span>  <span style="color:#e6db74">&#34;r&#34;</span> <span style="color:#a6e22e">#&#39;</span>+debugger/rr-record
</span></span><span style="display:flex;"><span>         :desc <span style="color:#e6db74">&#34;rr replay&#34;</span>  <span style="color:#e6db74">&#34;R&#34;</span> <span style="color:#a6e22e">#&#39;</span>+debugger/rr-replay)))
</span></span></code></pre></div><h3 id="gdb">GDB</h3>
<h4 id="custom-layout-for-gdb-many-windows">Custom layout for <code>gdb-many-windows</code></h4>
<p>Stolen from <a href="https://stackoverflow.com/a/41326527/3058915">https://stackoverflow.com/a/41326527/3058915</a>. I used it to change
the builtin <code>gdb-many-windows</code> layout.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq gdb-many-windows <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun set-gdb-layout(<span style="color:#66d9ef">&amp;optional</span> c-buffer)
</span></span><span style="display:flex;"><span>  (if (not c-buffer)
</span></span><span style="display:flex;"><span>      (setq c-buffer (<span style="color:#a6e22e">window-buffer</span> (<span style="color:#a6e22e">selected-window</span>)))) <span style="color:#75715e">;; save current buffer</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; from http://stackoverflow.com/q/39762833/846686</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">set-window-dedicated-p</span> (<span style="color:#a6e22e">selected-window</span>) <span style="color:#66d9ef">nil</span>) <span style="color:#75715e">;; unset dedicate state if needed</span>
</span></span><span style="display:flex;"><span>  (switch-to-buffer gud-comint-buffer)
</span></span><span style="display:flex;"><span>  (delete-other-windows) <span style="color:#75715e">;; clean all</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (let* ((w-source (<span style="color:#a6e22e">selected-window</span>)) <span style="color:#75715e">;; left top</span>
</span></span><span style="display:flex;"><span>         (w-gdb (split-window w-source <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#39;right</span>)) <span style="color:#75715e">;; right bottom</span>
</span></span><span style="display:flex;"><span>         (w-locals (split-window w-gdb <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#39;above</span>)) <span style="color:#75715e">;; right middle bottom</span>
</span></span><span style="display:flex;"><span>         (w-stack (split-window w-locals <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#39;above</span>)) <span style="color:#75715e">;; right middle top</span>
</span></span><span style="display:flex;"><span>         (w-breakpoints (split-window w-stack <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#39;above</span>)) <span style="color:#75715e">;; right top</span>
</span></span><span style="display:flex;"><span>         (w-io (split-window w-source (<span style="color:#a6e22e">floor</span>(<span style="color:#a6e22e">*</span> <span style="color:#ae81ff">0.9</span> (<span style="color:#a6e22e">window-body-height</span>))) <span style="color:#e6db74">&#39;below</span>))) <span style="color:#75715e">;; left bottom</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-buffer</span> w-io (gdb-get-buffer-create <span style="color:#e6db74">&#39;gdb-inferior-io</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-dedicated-p</span> w-io <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-buffer</span> w-breakpoints (gdb-get-buffer-create <span style="color:#e6db74">&#39;gdb-breakpoints-buffer</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-dedicated-p</span> w-breakpoints <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-buffer</span> w-locals (gdb-get-buffer-create <span style="color:#e6db74">&#39;gdb-locals-buffer</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-dedicated-p</span> w-locals <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-buffer</span> w-stack (gdb-get-buffer-create <span style="color:#e6db74">&#39;gdb-stack-buffer</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-dedicated-p</span> w-stack <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-buffer</span> w-gdb gud-comint-buffer)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">select-window</span> w-source)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">set-window-buffer</span> w-source c-buffer)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defadvice gdb (around args activate)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Change the way to gdb works.&#34;</span>
</span></span><span style="display:flex;"><span>  (setq global-config-editing (<span style="color:#a6e22e">current-window-configuration</span>)) <span style="color:#75715e">;; to restore: (set-window-configuration c-editing)</span>
</span></span><span style="display:flex;"><span>  (let ((c-buffer (<span style="color:#a6e22e">window-buffer</span> (<span style="color:#a6e22e">selected-window</span>)))) <span style="color:#75715e">;; save current buffer</span>
</span></span><span style="display:flex;"><span>    ad-do-it
</span></span><span style="display:flex;"><span>    (set-gdb-layout c-buffer)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defadvice gdb-reset (around args activate)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Change the way to gdb exit.&#34;</span>
</span></span><span style="display:flex;"><span>  ad-do-it
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">set-window-configuration</span> global-config-editing))
</span></span></code></pre></div><h4 id="highlight-current-line">Highlight current line</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defvar gud-overlay
</span></span><span style="display:flex;"><span>  (let* ((ov (<span style="color:#a6e22e">make-overlay</span> (<span style="color:#a6e22e">point-min</span>) (<span style="color:#a6e22e">point-min</span>))))
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">overlay-put</span> ov <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;secondary-selection</span>)
</span></span><span style="display:flex;"><span>    ov)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Overlay variable for GUD highlighting.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defadvice gud-display-line (after my-gud-highlight act)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Highlight current line.&#34;</span>
</span></span><span style="display:flex;"><span>  (let* ((ov gud-overlay)
</span></span><span style="display:flex;"><span>         (bf (gud-find-file true-file)))
</span></span><span style="display:flex;"><span>    (with-current-buffer bf
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">move-overlay</span> ov (<span style="color:#a6e22e">line-beginning-position</span>) (<span style="color:#a6e22e">line-beginning-position</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">;; (move-overlay ov (line-beginning-position) (line-end-position)</span>
</span></span><span style="display:flex;"><span>                    (<span style="color:#a6e22e">current-buffer</span>)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun gud-kill-buffer ()
</span></span><span style="display:flex;"><span>  (if (derived-mode-p <span style="color:#e6db74">&#39;gud-mode</span>)
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">delete-overlay</span> gud-overlay)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(add-hook <span style="color:#e6db74">&#39;kill-buffer-hook</span> <span style="color:#e6db74">&#39;gud-kill-buffer</span>)
</span></span></code></pre></div><h4 id="history">History</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! gdb-mi
</span></span><span style="display:flex;"><span>  (defvar ab/gdb-history-file <span style="color:#e6db74">&#34;~/.gdb_history&#34;</span>)
</span></span><span style="display:flex;"><span>  (defun ab/gud-gdb-mode-hook-setup ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;GDB setup.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">;; Suposes &#34;~/.gdbinit&#34; contains:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">;; set history save on</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">;; set history filename ~/.gdb_history</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">;; set history remove-duplicates 2048</span>
</span></span><span style="display:flex;"><span>    (when (and (ring-empty-p comint-input-ring)
</span></span><span style="display:flex;"><span>               (<span style="color:#a6e22e">file-exists-p</span> ab/gdb-history-file))
</span></span><span style="display:flex;"><span>      (setq comint-input-ring-file-name ab/gdb-history-file)
</span></span><span style="display:flex;"><span>      (comint-read-input-ring <span style="color:#66d9ef">t</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (add-hook <span style="color:#e6db74">&#39;gud-gdb-mode-hook</span> <span style="color:#e6db74">&#39;ab/gud-gdb-mode-hook-setup</span>))
</span></span></code></pre></div><h3 id="cppcheck">Cppcheck</h3>
<p>Check for everything!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! flycheck
</span></span><span style="display:flex;"><span>  (setq flycheck-cppcheck-checks <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;information&#34;</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#e6db74">&#34;missingInclude&#34;</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#e6db74">&#34;performance&#34;</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#e6db74">&#34;portability&#34;</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#e6db74">&#34;style&#34;</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#e6db74">&#34;unusedFunction&#34;</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#e6db74">&#34;warning&#34;</span>))) <span style="color:#75715e">;; Actually, we can use &#34;all&#34;</span>
</span></span></code></pre></div><h3 id="plain-text">Plain text</h3>
<p>It&rsquo;s nice to see ANSI color codes displayed. However, until Emacs 28 it&rsquo;s not
possible to do this without modifying the buffer, so let&rsquo;s condition this block
on that.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! text-mode
</span></span><span style="display:flex;"><span>  (add-hook! <span style="color:#e6db74">&#39;text-mode-hook</span>
</span></span><span style="display:flex;"><span>             <span style="color:#75715e">;; Apply ANSI color codes</span>
</span></span><span style="display:flex;"><span>             (with-silent-modifications
</span></span><span style="display:flex;"><span>               (ansi-color-apply-on-region (<span style="color:#a6e22e">point-min</span>) (<span style="color:#a6e22e">point-max</span>) <span style="color:#66d9ef">t</span>))))
</span></span></code></pre></div><h3 id="org">Org</h3>
<h4 id="intro">Intro</h4>
<p>Because this section is fairly expensive to initialize, we&rsquo;ll wrap
it in a <code>(after! ...)</code> block.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! org
</span></span><span style="display:flex;"><span>  &lt;&lt;org-conf&gt;&gt;
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><h4 id="behavior">Behavior</h4>
<h5 id="tweaking-defaults">Tweaking defaults</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-directory <span style="color:#e6db74">&#34;~/Dropbox/Org/&#34;</span>        <span style="color:#75715e">; let&#39;s put files here</span>
</span></span><span style="display:flex;"><span>      org-use-property-inheritance <span style="color:#66d9ef">t</span>        <span style="color:#75715e">; it&#39;s convenient to have properties inherited</span>
</span></span><span style="display:flex;"><span>      org-log-done <span style="color:#e6db74">&#39;time</span>                    <span style="color:#75715e">; having the time an item is done sounds convenient</span>
</span></span><span style="display:flex;"><span>      org-list-allow-alphabetical <span style="color:#66d9ef">t</span>         <span style="color:#75715e">; have a. A. a) A) list bullets</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;    org-export-in-background t            ; run export processes in external emacs process</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;    org-export-async-debug t</span>
</span></span><span style="display:flex;"><span>      org-catch-invisible-edits <span style="color:#e6db74">&#39;smart</span>      <span style="color:#75715e">; try not to accidently do weird stuff in invisible regions</span>
</span></span><span style="display:flex;"><span>      org-export-with-sub-superscripts <span style="color:#e6db74">&#39;{}</span>) <span style="color:#75715e">; don&#39;t treat lone _ / ^ as sub/superscripts, require _{} / ^{}</span>
</span></span></code></pre></div><p>I also like the <code>:comments</code> header-argument, so let&rsquo;s make that a
default.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-babel-default-header-args
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>((:session  <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;none&#34;</span>)
</span></span><span style="display:flex;"><span>        (:results  <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;replace&#34;</span>)
</span></span><span style="display:flex;"><span>        (:exports  <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;code&#34;</span>)
</span></span><span style="display:flex;"><span>        (:cache    <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;no&#34;</span>)
</span></span><span style="display:flex;"><span>        (:noweb    <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;no&#34;</span>)
</span></span><span style="display:flex;"><span>        (:hlines   <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;no&#34;</span>)
</span></span><span style="display:flex;"><span>        (:tangle   <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;no&#34;</span>)
</span></span><span style="display:flex;"><span>        (:comments <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;link&#34;</span>)))
</span></span></code></pre></div><p>By default, <code>visual-line-mode</code> is turned <code>on</code>, and <code>auto-fill-mode</code> <code>off</code> by a hook.
However, this messes with tables in Org-mode, and other plaintext files (e.g.
markdown, \LaTeX) so I&rsquo;ll turn it off for this, and manually enable it for more
specific modes as desired.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(remove-hook <span style="color:#e6db74">&#39;text-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>visual-line-mode)
</span></span><span style="display:flex;"><span>(add-hook <span style="color:#e6db74">&#39;text-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>auto-fill-mode)
</span></span></code></pre></div><p>There also seem to be a few keybindings which use <code>hjkl</code>, but miss arrow key equivalents.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(map! :map evil-org-mode-map
</span></span><span style="display:flex;"><span>      :after evil-org
</span></span><span style="display:flex;"><span>      :n <span style="color:#e6db74">&#34;g &lt;up&gt;&#34;</span> <span style="color:#a6e22e">#&#39;</span>org-backward-heading-same-level
</span></span><span style="display:flex;"><span>      :n <span style="color:#e6db74">&#34;g &lt;down&gt;&#34;</span> <span style="color:#a6e22e">#&#39;</span>org-forward-heading-same-level
</span></span><span style="display:flex;"><span>      :n <span style="color:#e6db74">&#34;g &lt;left&gt;&#34;</span> <span style="color:#a6e22e">#&#39;</span>org-up-element
</span></span><span style="display:flex;"><span>      :n <span style="color:#e6db74">&#34;g &lt;right&gt;&#34;</span> <span style="color:#a6e22e">#&#39;</span>org-down-element)
</span></span></code></pre></div><p>Babel is really annoying when it comes to working with Scheme (via Geiser), it
keeps asking about which Scheme implementation to use, I tried to set this in
file local variables and dir-locals but it didn&rsquo;t work. This should work now!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled, I managed to fix the problem by specifying</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; the implementation in file var prop line</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; ===&gt; # -*- geiser-scheme-implementation: &#39;guile; -*-</span>
</span></span><span style="display:flex;"><span>(after! geiser
</span></span><span style="display:flex;"><span>  (setq geiser-default-implementation <span style="color:#e6db74">&#39;guile</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; stolen from https://github.com/yohan-pereira/.emacs#babel-config</span>
</span></span><span style="display:flex;"><span>(defun my-org-confirm-babel-evaluate (lang body)
</span></span><span style="display:flex;"><span>  (not (string= lang <span style="color:#e6db74">&#34;scheme&#34;</span>))) <span style="color:#75715e">; don&#39;t ask for ditaa</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(setq org-confirm-babel-evaluate <span style="color:#a6e22e">#&#39;</span>my-org-confirm-babel-evaluate)
</span></span></code></pre></div><h5 id="extra-functionality">Extra functionality</h5>
<h6 id="list-bullet-sequence">List bullet sequence</h6>
<p>I think it makes sense to have list bullets change with depth</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-list-demote-modify-bullet <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">&#34;+&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;-&#34;</span>) (<span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;+&#34;</span>) (<span style="color:#e6db74">&#34;*&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;+&#34;</span>) (<span style="color:#e6db74">&#34;1.&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;a.&#34;</span>)))
</span></span></code></pre></div><h6 id="citations">Citations</h6>
<!-- raw HTML omitted -->
<ul>
<li>
<p><code>org-ref</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! org-ref
</span></span><span style="display:flex;"><span>  :after org
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (defadvice! org-ref-open-bibtex-pdf-a ()
</span></span><span style="display:flex;"><span>    :override <span style="color:#a6e22e">#&#39;</span>org-ref-open-bibtex-pdf
</span></span><span style="display:flex;"><span>    (save-excursion
</span></span><span style="display:flex;"><span>      (bibtex-beginning-of-entry)
</span></span><span style="display:flex;"><span>      (let* ((bibtex-expand-strings <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>             (entry (bibtex-parse-entry <span style="color:#66d9ef">t</span>))
</span></span><span style="display:flex;"><span>             (key (reftex-get-bib-field <span style="color:#e6db74">&#34;=key=&#34;</span> entry))
</span></span><span style="display:flex;"><span>             (pdf (or
</span></span><span style="display:flex;"><span>                   (<span style="color:#a6e22e">car</span> (-filter (lambda (f) (string-match-p <span style="color:#e6db74">&#34;\\.pdf$&#34;</span> f))
</span></span><span style="display:flex;"><span>                                 (split-string (reftex-get-bib-field <span style="color:#e6db74">&#34;file&#34;</span> entry) <span style="color:#e6db74">&#34;;&#34;</span>)))
</span></span><span style="display:flex;"><span>                   (<span style="color:#a6e22e">funcall</span> <span style="color:#e6db74">&#39;org-ref-get-pdf-filename</span> key))))
</span></span><span style="display:flex;"><span>        (if (<span style="color:#a6e22e">file-exists-p</span> pdf)
</span></span><span style="display:flex;"><span>            (org-open-file pdf)
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">ding</span>)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defadvice! org-ref-open-pdf-at-point-a ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Open the pdf for bibtex key under point if it exists.&#34;</span>
</span></span><span style="display:flex;"><span>    :override <span style="color:#a6e22e">#&#39;</span>org-ref-open-pdf-at-point
</span></span><span style="display:flex;"><span>    (interactive)
</span></span><span style="display:flex;"><span>    (let* ((results (org-ref-get-bibtex-key-and-file))
</span></span><span style="display:flex;"><span>           (key (<span style="color:#a6e22e">car</span> results))
</span></span><span style="display:flex;"><span>           (pdf-file (<span style="color:#a6e22e">funcall</span> <span style="color:#e6db74">&#39;org-ref-get-pdf-filename</span> key)))
</span></span><span style="display:flex;"><span>      (with-current-buffer (find-file-noselect (<span style="color:#a6e22e">cdr</span> results))
</span></span><span style="display:flex;"><span>        (save-excursion
</span></span><span style="display:flex;"><span>          (bibtex-search-entry (<span style="color:#a6e22e">car</span> results))
</span></span><span style="display:flex;"><span>          (org-ref-open-bibtex-pdf))))))
</span></span></code></pre></div></li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p><code>org-cite</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! oc
</span></span><span style="display:flex;"><span>  (defun org-ref-to-org-cite ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Attempt to convert org-ref citations to org-cite syntax.&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive)
</span></span><span style="display:flex;"><span>    (let* ((cite-conversions <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">&#34;cite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;//b&#34;</span>) (<span style="color:#e6db74">&#34;Cite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;//bc&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;nocite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/n&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;citep&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;&#34;</span>) (<span style="color:#e6db74">&#34;citep*&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;//f&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;parencite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;&#34;</span>) (<span style="color:#e6db74">&#34;Parencite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;//c&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;citeauthor&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/a/f&#34;</span>) (<span style="color:#e6db74">&#34;citeauthor*&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/a&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;citeyear&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/na/b&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;Citep&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;//c&#34;</span>) (<span style="color:#e6db74">&#34;Citealp&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;//bc&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;Citeauthor&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/a/cf&#34;</span>) (<span style="color:#e6db74">&#34;Citeauthor*&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/a/c&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;autocite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;&#34;</span>) (<span style="color:#e6db74">&#34;Autocite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;//c&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;notecite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/l/b&#34;</span>) (<span style="color:#e6db74">&#34;Notecite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/l/bc&#34;</span>)
</span></span><span style="display:flex;"><span>                               (<span style="color:#e6db74">&#34;pnotecite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/l&#34;</span>) (<span style="color:#e6db74">&#34;Pnotecite&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;/l/bc&#34;</span>)))
</span></span><span style="display:flex;"><span>           (cite-regexp (rx (regexp (regexp-opt (<span style="color:#a6e22e">mapcar</span> <span style="color:#a6e22e">#&#39;car</span> cite-conversions) <span style="color:#66d9ef">t</span>))
</span></span><span style="display:flex;"><span>                            <span style="color:#e6db74">&#34;:&#34;</span> (group (<span style="color:#a6e22e">+</span> (not (any <span style="color:#e6db74">&#34;\n     ,.)]}&#34;</span>)))))))
</span></span><span style="display:flex;"><span>      (save-excursion
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-min</span>))
</span></span><span style="display:flex;"><span>        (while (<span style="color:#a6e22e">re-search-forward</span> cite-regexp <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">message</span> (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;[cite%s:@%s]&#34;</span>
</span></span><span style="display:flex;"><span>                                 (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> (match-string <span style="color:#ae81ff">1</span>) cite-conversions))
</span></span><span style="display:flex;"><span>                                 (match-string <span style="color:#ae81ff">2</span>)))
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">replace-match</span> (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;[cite%s:@%s]&#34;</span>
</span></span><span style="display:flex;"><span>                                 (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> (match-string <span style="color:#ae81ff">1</span>) cite-conversions))
</span></span><span style="display:flex;"><span>                                 (match-string <span style="color:#ae81ff">2</span>))))))))
</span></span></code></pre></div></li>
</ul>
<h6 id="spellcheck">Spellcheck</h6>
<p>I turn off spell checking by default to make Org files open quickly.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;;(add-hook &#39;org-mode-hook &#39;turn-off-flyspell)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(add-hook &#39;org-mode-hook &#39;turn-on-flyspell)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;(add-hook &#39;org-mode-hook &#39;spell-fu-mode-disable)</span>
</span></span></code></pre></div><h5 id="todos">TODOs</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-todo-keywords
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>((sequence <span style="color:#e6db74">&#34;TODO(t)&#34;</span> <span style="color:#e6db74">&#34;PROJ(p)&#34;</span> <span style="color:#e6db74">&#34;LOOP(r)&#34;</span> <span style="color:#e6db74">&#34;STRT(s)&#34;</span> <span style="color:#e6db74">&#34;WAIT(w)&#34;</span> <span style="color:#e6db74">&#34;HOLD(h)&#34;</span> <span style="color:#e6db74">&#34;IDEA(i)&#34;</span> <span style="color:#e6db74">&#34;|&#34;</span> <span style="color:#e6db74">&#34;DONE(d)&#34;</span> <span style="color:#e6db74">&#34;KILL(k)&#34;</span>)
</span></span><span style="display:flex;"><span>        (sequence <span style="color:#e6db74">&#34;[ ](T)&#34;</span> <span style="color:#e6db74">&#34;[-](S)&#34;</span> <span style="color:#e6db74">&#34;[?](W)&#34;</span> <span style="color:#e6db74">&#34;|&#34;</span> <span style="color:#e6db74">&#34;[X](D)&#34;</span>)
</span></span><span style="display:flex;"><span>        (sequence <span style="color:#e6db74">&#34;|&#34;</span> <span style="color:#e6db74">&#34;OKAY(o)&#34;</span> <span style="color:#e6db74">&#34;YES(y)&#34;</span> <span style="color:#e6db74">&#34;NO(n)&#34;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun log-todo-next-creation-date (<span style="color:#66d9ef">&amp;rest</span> ignore)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Log NEXT creation time in the property drawer under the key &#39;ACTIVATED&#39;&#34;</span>
</span></span><span style="display:flex;"><span>  (when (and (string= (org-get-todo-state) <span style="color:#e6db74">&#34;NEXT&#34;</span>)
</span></span><span style="display:flex;"><span>             (not (org-entry-get <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#34;ACTIVATED&#34;</span>)))
</span></span><span style="display:flex;"><span>    (org-entry-put <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#34;ACTIVATED&#34;</span> (<span style="color:#a6e22e">format-time-string</span> <span style="color:#e6db74">&#34;[%Y-%m-%d]&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(add-hook <span style="color:#e6db74">&#39;org-after-todo-state-change-hook</span> <span style="color:#a6e22e">#&#39;</span>log-todo-next-creation-date)
</span></span></code></pre></div><h5 id="super-agenda">Super agenda</h5>
<p>Set files for <code>org-agenda</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-agenda-files (<span style="color:#a6e22e">list</span> (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;inbox.org&#34;</span> org-directory)
</span></span><span style="display:flex;"><span>                             (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;agenda.org&#34;</span> org-directory)
</span></span><span style="display:flex;"><span>                             (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;gcal-agenda.org&#34;</span> org-directory)
</span></span><span style="display:flex;"><span>                             (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;notes.org&#34;</span> org-directory)
</span></span><span style="display:flex;"><span>                             (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;projects.org&#34;</span> org-directory)))
</span></span></code></pre></div><p>Configure <code>org-super-agenda</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! org-super-agenda
</span></span><span style="display:flex;"><span>  :after org-agenda
</span></span><span style="display:flex;"><span>  :config (org-super-agenda-mode))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(setq org-agenda-skip-scheduled-if-done <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>      org-agenda-skip-deadline-if-done <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>      org-agenda-include-deadlines <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>      org-agenda-block-separator <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>      org-agenda-tags-column <span style="color:#ae81ff">100</span> <span style="color:#75715e">;; from testing this seems to be a good value</span>
</span></span><span style="display:flex;"><span>      org-agenda-compact-blocks <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(setq org-agenda-custom-commands
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">&#34;o&#34;</span> <span style="color:#e6db74">&#34;Overview&#34;</span>
</span></span><span style="display:flex;"><span>         ((agenda <span style="color:#e6db74">&#34;&#34;</span> ((org-agenda-span <span style="color:#e6db74">&#39;day</span>)
</span></span><span style="display:flex;"><span>                      (org-super-agenda-groups
</span></span><span style="display:flex;"><span>                       <span style="color:#f92672">&#39;</span>((:name <span style="color:#e6db74">&#34;Today&#34;</span>
</span></span><span style="display:flex;"><span>                          :time-grid <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                          :date today
</span></span><span style="display:flex;"><span>                          :todo <span style="color:#e6db74">&#34;TODAY&#34;</span>
</span></span><span style="display:flex;"><span>                          :scheduled today
</span></span><span style="display:flex;"><span>                          :order <span style="color:#ae81ff">1</span>)))))
</span></span><span style="display:flex;"><span>          (alltodo <span style="color:#e6db74">&#34;&#34;</span> ((org-agenda-overriding-header <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>                       (org-super-agenda-groups
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&#39;</span>((:name <span style="color:#e6db74">&#34;Next to do&#34;</span>
</span></span><span style="display:flex;"><span>                           :todo <span style="color:#e6db74">&#34;NEXT&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Important&#34;</span>
</span></span><span style="display:flex;"><span>                           :tag <span style="color:#e6db74">&#34;Important&#34;</span>
</span></span><span style="display:flex;"><span>                           :priority <span style="color:#e6db74">&#34;A&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Due Today&#34;</span>
</span></span><span style="display:flex;"><span>                           :deadline today
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Due Soon&#34;</span>
</span></span><span style="display:flex;"><span>                           :deadline future
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">8</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Overdue&#34;</span>
</span></span><span style="display:flex;"><span>                           :deadline past
</span></span><span style="display:flex;"><span>                           :face <span style="color:#a6e22e">error</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Assignments&#34;</span>
</span></span><span style="display:flex;"><span>                           :tag <span style="color:#e6db74">&#34;Assignment&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Issues&#34;</span>
</span></span><span style="display:flex;"><span>                           :tag <span style="color:#e6db74">&#34;Issue&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Emacs&#34;</span>
</span></span><span style="display:flex;"><span>                           :tag <span style="color:#e6db74">&#34;Emacs&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">13</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Projects&#34;</span>
</span></span><span style="display:flex;"><span>                           :tag <span style="color:#e6db74">&#34;Project&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">14</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Research&#34;</span>
</span></span><span style="display:flex;"><span>                           :tag <span style="color:#e6db74">&#34;Research&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;To read&#34;</span>
</span></span><span style="display:flex;"><span>                           :tag <span style="color:#e6db74">&#34;Read&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Waiting&#34;</span>
</span></span><span style="display:flex;"><span>                           :todo <span style="color:#e6db74">&#34;WAIT&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">20</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;University&#34;</span>
</span></span><span style="display:flex;"><span>                           :tag <span style="color:#e6db74">&#34;Univ&#34;</span>
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>                          (:name <span style="color:#e6db74">&#34;Trivial&#34;</span>
</span></span><span style="display:flex;"><span>                           :priority&lt;= <span style="color:#e6db74">&#34;E&#34;</span>
</span></span><span style="display:flex;"><span>                           :tag (<span style="color:#e6db74">&#34;Trivial&#34;</span> <span style="color:#e6db74">&#34;Unimportant&#34;</span>)
</span></span><span style="display:flex;"><span>                           :todo (<span style="color:#e6db74">&#34;SOMEDAY&#34;</span>)
</span></span><span style="display:flex;"><span>                           :order <span style="color:#ae81ff">90</span>)
</span></span><span style="display:flex;"><span>                          (:discard (:tag (<span style="color:#e6db74">&#34;Chore&#34;</span> <span style="color:#e6db74">&#34;Routine&#34;</span> <span style="color:#e6db74">&#34;Daily&#34;</span>)))))))))))
</span></span></code></pre></div><h5 id="google-calendar--org-gcal">Google calendar (<code>org-gcal</code>)</h5>
<p>I store my <code>org-gcal</code> configuration privately, it contains something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! org-gcal
</span></span><span style="display:flex;"><span>  (setq org-gcal-client-id <span style="color:#e6db74">&#34;&lt;SOME_ID&gt;.apps.googleusercontent.com&#34;</span>
</span></span><span style="display:flex;"><span>        org-gcal-client-secret <span style="color:#e6db74">&#34;&lt;SOME_SECRET&gt;&#34;</span>
</span></span><span style="display:flex;"><span>        org-gcal-fetch-file-alist <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">&#34;&lt;USERNAME&gt;@gmail.com&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;~/Dropbox/Org/gcal-agenda.org&#34;</span>))))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(load! <span style="color:#e6db74">&#34;lisp/private/+org-gcal.el&#34;</span>)
</span></span></code></pre></div><h5 id="capture">Capture</h5>
<p>Set capture files</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq +org-capture-emails-file (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;inbox.org&#34;</span> org-directory)
</span></span><span style="display:flex;"><span>      +org-capture-todo-file (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;inbox.org&#34;</span> org-directory)
</span></span><span style="display:flex;"><span>      +org-capture-projects-file (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;projects.org&#34;</span> org-directory))
</span></span></code></pre></div><p>Lets set up some org-capture templates, and make them visually nice to access.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! doct
</span></span><span style="display:flex;"><span>  :commands (doct))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(after! org-capture
</span></span><span style="display:flex;"><span>  &lt;&lt;prettify-capture&gt;&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun +doct-icon-declaration-to-icon (declaration)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Convert :icon declaration to icon&#34;</span>
</span></span><span style="display:flex;"><span>    (let ((name (pop declaration))
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">set</span>  (<span style="color:#a6e22e">intern</span> (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;all-the-icons-&#34;</span> (<span style="color:#a6e22e">plist-get</span> declaration :set))))
</span></span><span style="display:flex;"><span>          (face (<span style="color:#a6e22e">intern</span> (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;all-the-icons-&#34;</span> (<span style="color:#a6e22e">plist-get</span> declaration :color))))
</span></span><span style="display:flex;"><span>          (v-adjust (or (<span style="color:#a6e22e">plist-get</span> declaration :v-adjust) <span style="color:#ae81ff">0.01</span>)))
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">apply</span> <span style="color:#a6e22e">set</span> <span style="color:#f92672">`</span>(<span style="color:#f92672">,</span>name :face <span style="color:#f92672">,</span>face :v-adjust <span style="color:#f92672">,</span>v-adjust))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun +doct-iconify-capture-templates (groups)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Add declaration&#39;s :icon to each template group in GROUPS.&#34;</span>
</span></span><span style="display:flex;"><span>    (let ((templates (doct-flatten-lists-in groups)))
</span></span><span style="display:flex;"><span>      (setq doct-templates (<span style="color:#a6e22e">mapcar</span> (lambda (template)
</span></span><span style="display:flex;"><span>                                     (when-let* ((props (<span style="color:#a6e22e">nthcdr</span> (if (<span style="color:#a6e22e">=</span> (<span style="color:#a6e22e">length</span> template) <span style="color:#ae81ff">4</span>) <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">5</span>) template))
</span></span><span style="display:flex;"><span>                                                 (spec (<span style="color:#a6e22e">plist-get</span> (<span style="color:#a6e22e">plist-get</span> props :doct) :icon)))
</span></span><span style="display:flex;"><span>                                       (setf (<span style="color:#a6e22e">nth</span> <span style="color:#ae81ff">1</span> template) (<span style="color:#a6e22e">concat</span> (+doct-icon-declaration-to-icon spec)
</span></span><span style="display:flex;"><span>                                                                      <span style="color:#e6db74">&#34;\t&#34;</span>
</span></span><span style="display:flex;"><span>                                                                      (<span style="color:#a6e22e">nth</span> <span style="color:#ae81ff">1</span> template))))
</span></span><span style="display:flex;"><span>                                     template)
</span></span><span style="display:flex;"><span>                                   templates))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (setq doct-after-conversion-functions <span style="color:#f92672">&#39;</span>(+doct-iconify-capture-templates))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun set-org-capture-templates ()
</span></span><span style="display:flex;"><span>    (setq org-capture-templates
</span></span><span style="display:flex;"><span>          (doct <span style="color:#f92672">`</span>((<span style="color:#e6db74">&#34;Personal todo&#34;</span> :keys <span style="color:#e6db74">&#34;t&#34;</span>
</span></span><span style="display:flex;"><span>                   :icon (<span style="color:#e6db74">&#34;checklist&#34;</span> :set <span style="color:#e6db74">&#34;octicon&#34;</span> :color <span style="color:#e6db74">&#34;green&#34;</span>)
</span></span><span style="display:flex;"><span>                   :file +org-capture-todo-file
</span></span><span style="display:flex;"><span>                   :prepend <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                   :headline <span style="color:#e6db74">&#34;Inbox&#34;</span>
</span></span><span style="display:flex;"><span>                   :type entry
</span></span><span style="display:flex;"><span>                   :template (<span style="color:#e6db74">&#34;* TODO %?&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;%i %a&#34;</span>))
</span></span><span style="display:flex;"><span>                  (<span style="color:#e6db74">&#34;Personal note&#34;</span> :keys <span style="color:#e6db74">&#34;n&#34;</span>
</span></span><span style="display:flex;"><span>                   :icon (<span style="color:#e6db74">&#34;sticky-note-o&#34;</span> :set <span style="color:#e6db74">&#34;faicon&#34;</span> :color <span style="color:#e6db74">&#34;green&#34;</span>)
</span></span><span style="display:flex;"><span>                   :file +org-capture-todo-file
</span></span><span style="display:flex;"><span>                   :prepend <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                   :headline <span style="color:#e6db74">&#34;Inbox&#34;</span>
</span></span><span style="display:flex;"><span>                   :type entry
</span></span><span style="display:flex;"><span>                   :template (<span style="color:#e6db74">&#34;* %?&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;%i %a&#34;</span>))
</span></span><span style="display:flex;"><span>                  (<span style="color:#e6db74">&#34;Email&#34;</span> :keys <span style="color:#e6db74">&#34;e&#34;</span>
</span></span><span style="display:flex;"><span>                   :icon (<span style="color:#e6db74">&#34;envelope&#34;</span> :set <span style="color:#e6db74">&#34;faicon&#34;</span> :color <span style="color:#e6db74">&#34;blue&#34;</span>)
</span></span><span style="display:flex;"><span>                   :file +org-capture-todo-file
</span></span><span style="display:flex;"><span>                   :prepend <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                   :headline <span style="color:#e6db74">&#34;Inbox&#34;</span>
</span></span><span style="display:flex;"><span>                   :type entry
</span></span><span style="display:flex;"><span>                   :template (<span style="color:#e6db74">&#34;* TODO %^{type|reply to|contact} %\\3 %? &#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;Send an email %^{urgancy|soon|ASAP|anon|at some point|eventually} to %^{recipiant}&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;about %^{topic}&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;%U %i %a&#34;</span>))
</span></span><span style="display:flex;"><span>                  (<span style="color:#e6db74">&#34;Interesting&#34;</span> :keys <span style="color:#e6db74">&#34;i&#34;</span>
</span></span><span style="display:flex;"><span>                   :icon (<span style="color:#e6db74">&#34;eye&#34;</span> :set <span style="color:#e6db74">&#34;faicon&#34;</span> :color <span style="color:#e6db74">&#34;lcyan&#34;</span>)
</span></span><span style="display:flex;"><span>                   :file +org-capture-todo-file
</span></span><span style="display:flex;"><span>                   :prepend <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                   :headline <span style="color:#e6db74">&#34;Interesting&#34;</span>
</span></span><span style="display:flex;"><span>                   :type entry
</span></span><span style="display:flex;"><span>                   :template (<span style="color:#e6db74">&#34;* [ ] %{desc}%? :%{i-type}:&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;%i %a&#34;</span>)
</span></span><span style="display:flex;"><span>                   :children ((<span style="color:#e6db74">&#34;Webpage&#34;</span> :keys <span style="color:#e6db74">&#34;w&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;globe&#34;</span> :set <span style="color:#e6db74">&#34;faicon&#34;</span> :color <span style="color:#e6db74">&#34;green&#34;</span>)
</span></span><span style="display:flex;"><span>                               :desc <span style="color:#e6db74">&#34;%(org-cliplink-capture) &#34;</span>
</span></span><span style="display:flex;"><span>                               :i-type <span style="color:#e6db74">&#34;read:web&#34;</span>)
</span></span><span style="display:flex;"><span>                              (<span style="color:#e6db74">&#34;Article&#34;</span> :keys <span style="color:#e6db74">&#34;a&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;file-text&#34;</span> :set <span style="color:#e6db74">&#34;octicon&#34;</span> :color <span style="color:#e6db74">&#34;yellow&#34;</span>)
</span></span><span style="display:flex;"><span>                               :desc <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>                               :i-type <span style="color:#e6db74">&#34;read:reaserch&#34;</span>)
</span></span><span style="display:flex;"><span>                              (<span style="color:#e6db74">&#34;Information&#34;</span> :keys <span style="color:#e6db74">&#34;i&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;info-circle&#34;</span> :set <span style="color:#e6db74">&#34;faicon&#34;</span> :color <span style="color:#e6db74">&#34;blue&#34;</span>)
</span></span><span style="display:flex;"><span>                               :desc <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>                               :i-type <span style="color:#e6db74">&#34;read:info&#34;</span>)
</span></span><span style="display:flex;"><span>                              (<span style="color:#e6db74">&#34;Idea&#34;</span> :keys <span style="color:#e6db74">&#34;I&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;bubble_chart&#34;</span> :set <span style="color:#e6db74">&#34;material&#34;</span> :color <span style="color:#e6db74">&#34;silver&#34;</span>)
</span></span><span style="display:flex;"><span>                               :desc <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>                               :i-type <span style="color:#e6db74">&#34;idea&#34;</span>)))
</span></span><span style="display:flex;"><span>                  (<span style="color:#e6db74">&#34;Tasks&#34;</span> :keys <span style="color:#e6db74">&#34;k&#34;</span>
</span></span><span style="display:flex;"><span>                   :icon (<span style="color:#e6db74">&#34;inbox&#34;</span> :set <span style="color:#e6db74">&#34;octicon&#34;</span> :color <span style="color:#e6db74">&#34;yellow&#34;</span>)
</span></span><span style="display:flex;"><span>                   :file +org-capture-todo-file
</span></span><span style="display:flex;"><span>                   :prepend <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                   :headline <span style="color:#e6db74">&#34;Tasks&#34;</span>
</span></span><span style="display:flex;"><span>                   :type entry
</span></span><span style="display:flex;"><span>                   :template (<span style="color:#e6db74">&#34;* TODO %? %^G%{extra}&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;%i %a&#34;</span>)
</span></span><span style="display:flex;"><span>                   :children ((<span style="color:#e6db74">&#34;General Task&#34;</span> :keys <span style="color:#e6db74">&#34;k&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;inbox&#34;</span> :set <span style="color:#e6db74">&#34;octicon&#34;</span> :color <span style="color:#e6db74">&#34;yellow&#34;</span>)
</span></span><span style="display:flex;"><span>                               :extra <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>                               )
</span></span><span style="display:flex;"><span>                              (<span style="color:#e6db74">&#34;Task with deadline&#34;</span> :keys <span style="color:#e6db74">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;timer&#34;</span> :set <span style="color:#e6db74">&#34;material&#34;</span> :color <span style="color:#e6db74">&#34;orange&#34;</span> :v-adjust <span style="color:#ae81ff">-0.1</span>)
</span></span><span style="display:flex;"><span>                               :extra <span style="color:#e6db74">&#34;\nDEADLINE: %^{Deadline:}t&#34;</span>
</span></span><span style="display:flex;"><span>                               )
</span></span><span style="display:flex;"><span>                              (<span style="color:#e6db74">&#34;Scheduled Task&#34;</span> :keys <span style="color:#e6db74">&#34;s&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;calendar&#34;</span> :set <span style="color:#e6db74">&#34;octicon&#34;</span> :color <span style="color:#e6db74">&#34;orange&#34;</span>)
</span></span><span style="display:flex;"><span>                               :extra <span style="color:#e6db74">&#34;\nSCHEDULED: %^{Start time:}t&#34;</span>)))
</span></span><span style="display:flex;"><span>                  (<span style="color:#e6db74">&#34;Project&#34;</span> :keys <span style="color:#e6db74">&#34;p&#34;</span>
</span></span><span style="display:flex;"><span>                   :icon (<span style="color:#e6db74">&#34;repo&#34;</span> :set <span style="color:#e6db74">&#34;octicon&#34;</span> :color <span style="color:#e6db74">&#34;silver&#34;</span>)
</span></span><span style="display:flex;"><span>                   :prepend <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                   :type entry
</span></span><span style="display:flex;"><span>                   :headline <span style="color:#e6db74">&#34;Inbox&#34;</span>
</span></span><span style="display:flex;"><span>                   :template (<span style="color:#e6db74">&#34;* %{time-or-todo} %?&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;%i&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;%a&#34;</span>)
</span></span><span style="display:flex;"><span>                   :file <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>                   :custom (:time-or-todo <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>                   :children ((<span style="color:#e6db74">&#34;Project-local todo&#34;</span> :keys <span style="color:#e6db74">&#34;t&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;checklist&#34;</span> :set <span style="color:#e6db74">&#34;octicon&#34;</span> :color <span style="color:#e6db74">&#34;green&#34;</span>)
</span></span><span style="display:flex;"><span>                               :time-or-todo <span style="color:#e6db74">&#34;TODO&#34;</span>
</span></span><span style="display:flex;"><span>                               :file +org-capture-project-todo-file)
</span></span><span style="display:flex;"><span>                              (<span style="color:#e6db74">&#34;Project-local note&#34;</span> :keys <span style="color:#e6db74">&#34;n&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;sticky-note&#34;</span> :set <span style="color:#e6db74">&#34;faicon&#34;</span> :color <span style="color:#e6db74">&#34;yellow&#34;</span>)
</span></span><span style="display:flex;"><span>                               :time-or-todo <span style="color:#e6db74">&#34;%U&#34;</span>
</span></span><span style="display:flex;"><span>                               :file +org-capture-project-notes-file)
</span></span><span style="display:flex;"><span>                              (<span style="color:#e6db74">&#34;Project-local changelog&#34;</span> :keys <span style="color:#e6db74">&#34;c&#34;</span>
</span></span><span style="display:flex;"><span>                               :icon (<span style="color:#e6db74">&#34;list&#34;</span> :set <span style="color:#e6db74">&#34;faicon&#34;</span> :color <span style="color:#e6db74">&#34;blue&#34;</span>)
</span></span><span style="display:flex;"><span>                               :time-or-todo <span style="color:#e6db74">&#34;%U&#34;</span>
</span></span><span style="display:flex;"><span>                               :heading <span style="color:#e6db74">&#34;Unreleased&#34;</span>
</span></span><span style="display:flex;"><span>                               :file +org-capture-project-changelog-file)))
</span></span><span style="display:flex;"><span>                  (<span style="color:#e6db74">&#34;\tCentralised project templates&#34;</span>
</span></span><span style="display:flex;"><span>                   :keys <span style="color:#e6db74">&#34;o&#34;</span>
</span></span><span style="display:flex;"><span>                   :type entry
</span></span><span style="display:flex;"><span>                   :prepend <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                   :template (<span style="color:#e6db74">&#34;* %{time-or-todo} %?&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;%i&#34;</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#e6db74">&#34;%a&#34;</span>)
</span></span><span style="display:flex;"><span>                   :children ((<span style="color:#e6db74">&#34;Project todo&#34;</span>
</span></span><span style="display:flex;"><span>                               :keys <span style="color:#e6db74">&#34;t&#34;</span>
</span></span><span style="display:flex;"><span>                               :prepend <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>                               :time-or-todo <span style="color:#e6db74">&#34;TODO&#34;</span>
</span></span><span style="display:flex;"><span>                               :heading <span style="color:#e6db74">&#34;Tasks&#34;</span>
</span></span><span style="display:flex;"><span>                               :file +org-capture-central-project-todo-file)
</span></span><span style="display:flex;"><span>                              (<span style="color:#e6db74">&#34;Project note&#34;</span>
</span></span><span style="display:flex;"><span>                               :keys <span style="color:#e6db74">&#34;n&#34;</span>
</span></span><span style="display:flex;"><span>                               :time-or-todo <span style="color:#e6db74">&#34;%U&#34;</span>
</span></span><span style="display:flex;"><span>                               :heading <span style="color:#e6db74">&#34;Notes&#34;</span>
</span></span><span style="display:flex;"><span>                               :file +org-capture-central-project-notes-file)
</span></span><span style="display:flex;"><span>                              (<span style="color:#e6db74">&#34;Project changelog&#34;</span>
</span></span><span style="display:flex;"><span>                               :keys <span style="color:#e6db74">&#34;c&#34;</span>
</span></span><span style="display:flex;"><span>                               :time-or-todo <span style="color:#e6db74">&#34;%U&#34;</span>
</span></span><span style="display:flex;"><span>                               :heading <span style="color:#e6db74">&#34;Unreleased&#34;</span>
</span></span><span style="display:flex;"><span>                               :file +org-capture-central-project-changelog-file)))))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (set-org-capture-templates)
</span></span><span style="display:flex;"><span>  (unless (display-graphic-p)
</span></span><span style="display:flex;"><span>    (add-hook <span style="color:#e6db74">&#39;server-after-make-frame-hook</span>
</span></span><span style="display:flex;"><span>              (defun org-capture-reinitialise-hook ()
</span></span><span style="display:flex;"><span>                (when (display-graphic-p)
</span></span><span style="display:flex;"><span>                  (set-org-capture-templates)
</span></span><span style="display:flex;"><span>                  (remove-hook <span style="color:#e6db74">&#39;server-after-make-frame-hook</span>
</span></span><span style="display:flex;"><span>                               <span style="color:#a6e22e">#&#39;</span>org-capture-reinitialise-hook))))))
</span></span></code></pre></div><p>It would also be nice to improve how the capture dialogue looks</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun org-capture-select-template-prettier (<span style="color:#66d9ef">&amp;optional</span> keys)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Select a capture template, in a prettier way than default
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Lisp programs can force the template by setting KEYS to a string.&#34;</span>
</span></span><span style="display:flex;"><span>  (let ((org-capture-templates
</span></span><span style="display:flex;"><span>         (or (org-contextualize-keys
</span></span><span style="display:flex;"><span>              (org-capture-upgrade-templates org-capture-templates)
</span></span><span style="display:flex;"><span>              org-capture-templates-contexts)
</span></span><span style="display:flex;"><span>             <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">&#34;t&#34;</span> <span style="color:#e6db74">&#34;Task&#34;</span> entry (file+headline <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;Tasks&#34;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;* TODO %?\n  %u\n  %a&#34;</span>)))))
</span></span><span style="display:flex;"><span>    (if keys
</span></span><span style="display:flex;"><span>        (or (<span style="color:#a6e22e">assoc</span> keys org-capture-templates)
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">error</span> <span style="color:#e6db74">&#34;No capture template referred to by \&#34;%s\&#34; keys&#34;</span> keys))
</span></span><span style="display:flex;"><span>      (org-mks org-capture-templates
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#34;Select a capture template\n&#34;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">&#34;Template key: &#34;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">`</span>((<span style="color:#e6db74">&#34;q&#34;</span> <span style="color:#f92672">,</span>(<span style="color:#a6e22e">concat</span> (all-the-icons-octicon <span style="color:#e6db74">&#34;stop&#34;</span> :face <span style="color:#e6db74">&#39;all-the-icons-red</span> :v-adjust <span style="color:#ae81ff">0.01</span>) <span style="color:#e6db74">&#34;\tAbort&#34;</span>)))))))
</span></span><span style="display:flex;"><span>(advice-add <span style="color:#e6db74">&#39;org-capture-select-template</span> :override <span style="color:#a6e22e">#&#39;</span>org-capture-select-template-prettier)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun org-mks-pretty (table title <span style="color:#66d9ef">&amp;optional</span> prompt specials)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Select a member of an alist with multiple keys. Prettified.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">TABLE is the alist which should contain entries where the car is a string.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">There should be two types of entries.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1. prefix descriptions like (\&#34;a\&#34; \&#34;Description\&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   This indicates that </span><span style="color:#e6db74">`a&#39;</span><span style="color:#e6db74"> is a prefix key for multi-letter selection, and
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   that there are entries following with keys like \&#34;ab\&#34;, \&#34;ax\&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2. Select-able members must have more than two elements, with the first
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   being the string of keys that lead to selecting it, and the second a
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   short description string of the item.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">The command will then make a temporary buffer listing all entries
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">that can be selected with a single key, and all the single key
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">prefixes.  When you press the key for a single-letter entry, it is selected.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">When you press a prefix key, the commands (and maybe further prefixes)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">under this key will be shown and offered for selection.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">TITLE will be placed over the selection in the temporary buffer,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">PROMPT will be used when prompting for a key.  SPECIALS is an
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">alist with (\&#34;key\&#34; \&#34;description\&#34;) entries.  When one of these
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">is selected, only the bare key is returned.&#34;</span>
</span></span><span style="display:flex;"><span>  (save-window-excursion
</span></span><span style="display:flex;"><span>    (let ((inhibit-quit <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>          (buffer (org-switch-to-buffer-other-window <span style="color:#e6db74">&#34;*Org Select*&#34;</span>))
</span></span><span style="display:flex;"><span>          (prompt (or prompt <span style="color:#e6db74">&#34;Select: &#34;</span>))
</span></span><span style="display:flex;"><span>          case-fold-search
</span></span><span style="display:flex;"><span>          current)
</span></span><span style="display:flex;"><span>      (unwind-protect
</span></span><span style="display:flex;"><span>          (catch <span style="color:#e6db74">&#39;exit</span>
</span></span><span style="display:flex;"><span>            (while <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>              (setq-local evil-normal-state-cursor (<span style="color:#a6e22e">list</span> <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#a6e22e">erase-buffer</span>)
</span></span><span style="display:flex;"><span>              (<span style="color:#a6e22e">insert</span> title <span style="color:#e6db74">&#34;\n\n&#34;</span>)
</span></span><span style="display:flex;"><span>              (let ((des-keys <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>                    (allowed-keys <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;\C-g&#34;</span>))
</span></span><span style="display:flex;"><span>                    (tab-alternatives <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;\s&#34;</span> <span style="color:#e6db74">&#34;\t&#34;</span> <span style="color:#e6db74">&#34;\r&#34;</span>))
</span></span><span style="display:flex;"><span>                    (cursor-type <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">;; Populate allowed keys and descriptions keys</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">;; available with CURRENT selector.</span>
</span></span><span style="display:flex;"><span>                (let ((re (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;\\`%s\\(.\\)\\&#39;&#34;</span>
</span></span><span style="display:flex;"><span>                                  (if current (<span style="color:#a6e22e">regexp-quote</span> current) <span style="color:#e6db74">&#34;&#34;</span>)))
</span></span><span style="display:flex;"><span>                      (prefix (if current (<span style="color:#a6e22e">concat</span> current <span style="color:#e6db74">&#34; &#34;</span>) <span style="color:#e6db74">&#34;&#34;</span>)))
</span></span><span style="display:flex;"><span>                  (dolist (entry table)
</span></span><span style="display:flex;"><span>                    (pcase entry
</span></span><span style="display:flex;"><span>                      <span style="color:#75715e">;; Description.</span>
</span></span><span style="display:flex;"><span>                      (<span style="color:#f92672">`</span>(<span style="color:#f92672">,</span>(and key (pred (<span style="color:#a6e22e">string-match</span> re))) <span style="color:#f92672">,</span>desc)
</span></span><span style="display:flex;"><span>                       (let ((k (match-string <span style="color:#ae81ff">1</span> key)))
</span></span><span style="display:flex;"><span>                         (push k des-keys)
</span></span><span style="display:flex;"><span>                         <span style="color:#75715e">;; Keys ending in tab, space or RET are equivalent.</span>
</span></span><span style="display:flex;"><span>                         (if (<span style="color:#a6e22e">member</span> k tab-alternatives)
</span></span><span style="display:flex;"><span>                             (push <span style="color:#e6db74">&#34;\t&#34;</span> allowed-keys)
</span></span><span style="display:flex;"><span>                           (push k allowed-keys))
</span></span><span style="display:flex;"><span>                         (<span style="color:#a6e22e">insert</span> (<span style="color:#a6e22e">propertize</span> prefix <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;font-lock-comment-face</span>) (<span style="color:#a6e22e">propertize</span> k <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;bold</span>) (<span style="color:#a6e22e">propertize</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;font-lock-comment-face</span>) <span style="color:#e6db74">&#34;  &#34;</span> desc <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;\n&#34;</span>)))
</span></span><span style="display:flex;"><span>                      <span style="color:#75715e">;; Usable entry.</span>
</span></span><span style="display:flex;"><span>                      (<span style="color:#f92672">`</span>(<span style="color:#f92672">,</span>(and key (pred (<span style="color:#a6e22e">string-match</span> re))) <span style="color:#f92672">,</span>desc <span style="color:#f92672">.</span> <span style="color:#f92672">,</span>_)
</span></span><span style="display:flex;"><span>                       (let ((k (match-string <span style="color:#ae81ff">1</span> key)))
</span></span><span style="display:flex;"><span>                         (<span style="color:#a6e22e">insert</span> (<span style="color:#a6e22e">propertize</span> prefix <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;font-lock-comment-face</span>) (<span style="color:#a6e22e">propertize</span> k <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;bold</span>) <span style="color:#e6db74">&#34;   &#34;</span> desc <span style="color:#e6db74">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>                         (push k allowed-keys)))
</span></span><span style="display:flex;"><span>                      (_ <span style="color:#66d9ef">nil</span>))))
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">;; Insert special entries, if any.</span>
</span></span><span style="display:flex;"><span>                (when specials
</span></span><span style="display:flex;"><span>                  (<span style="color:#a6e22e">insert</span> <span style="color:#e6db74">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>                  (pcase-dolist (<span style="color:#f92672">`</span>(<span style="color:#f92672">,</span>key <span style="color:#f92672">,</span>description) specials)
</span></span><span style="display:flex;"><span>                    (<span style="color:#a6e22e">insert</span> (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;%s   %s\n&#34;</span> (<span style="color:#a6e22e">propertize</span> key <span style="color:#e6db74">&#39;face</span> <span style="color:#f92672">&#39;</span>(bold all-the-icons-red)) description))
</span></span><span style="display:flex;"><span>                    (push key allowed-keys)))
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">;; Display UI and let user select an entry or</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">;; a sublevel prefix.</span>
</span></span><span style="display:flex;"><span>                (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-min</span>))
</span></span><span style="display:flex;"><span>                (unless (<span style="color:#a6e22e">pos-visible-in-window-p</span> (<span style="color:#a6e22e">point-max</span>))
</span></span><span style="display:flex;"><span>                  (org-fit-window-to-buffer))
</span></span><span style="display:flex;"><span>                (let ((pressed (org--mks-read-key allowed-keys
</span></span><span style="display:flex;"><span>                                                  prompt
</span></span><span style="display:flex;"><span>                                                  (not (<span style="color:#a6e22e">pos-visible-in-window-p</span> (<span style="color:#a6e22e">1-</span> (<span style="color:#a6e22e">point-max</span>)))))))
</span></span><span style="display:flex;"><span>                  (setq current (<span style="color:#a6e22e">concat</span> current pressed))
</span></span><span style="display:flex;"><span>                  (cond
</span></span><span style="display:flex;"><span>                   ((<span style="color:#a6e22e">equal</span> pressed <span style="color:#e6db74">&#34;\C-g&#34;</span>) (<span style="color:#a6e22e">user-error</span> <span style="color:#e6db74">&#34;Abort&#34;</span>))
</span></span><span style="display:flex;"><span>                   <span style="color:#75715e">;; Selection is a prefix: open a new menu.</span>
</span></span><span style="display:flex;"><span>                   ((<span style="color:#a6e22e">member</span> pressed des-keys))
</span></span><span style="display:flex;"><span>                   <span style="color:#75715e">;; Selection matches an association: return it.</span>
</span></span><span style="display:flex;"><span>                   ((let ((entry (<span style="color:#a6e22e">assoc</span> current table)))
</span></span><span style="display:flex;"><span>                      (and entry (throw <span style="color:#e6db74">&#39;exit</span> entry))))
</span></span><span style="display:flex;"><span>                   <span style="color:#75715e">;; Selection matches a special entry: return the</span>
</span></span><span style="display:flex;"><span>                   <span style="color:#75715e">;; selection prefix.</span>
</span></span><span style="display:flex;"><span>                   ((<span style="color:#a6e22e">assoc</span> current specials) (throw <span style="color:#e6db74">&#39;exit</span> current))
</span></span><span style="display:flex;"><span>                   (<span style="color:#66d9ef">t</span> (<span style="color:#a6e22e">error</span> <span style="color:#e6db74">&#34;No entry available&#34;</span>)))))))
</span></span><span style="display:flex;"><span>        (when buffer (<span style="color:#a6e22e">kill-buffer</span> buffer))))))
</span></span><span style="display:flex;"><span>(advice-add <span style="color:#e6db74">&#39;org-mks</span> :override <span style="color:#a6e22e">#&#39;</span>org-mks-pretty)
</span></span></code></pre></div><p>The <a href="~/.emacs.d/bin/org-capture">org-capture bin</a> is rather nice, but I&rsquo;d be nicer with a smaller frame, and
no modeline.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setf (alist-get <span style="color:#e6db74">&#39;height</span> +org-capture-frame-parameters) <span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; (alist-get &#39;name +org-capture-frame-parameters) &#34; Capture&#34;) ;; ATM hardcoded in other places, so changing breaks stuff</span>
</span></span><span style="display:flex;"><span>(setq +org-capture-fn
</span></span><span style="display:flex;"><span>      (lambda ()
</span></span><span style="display:flex;"><span>        (interactive)
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">set-window-parameter</span> <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#39;mode-line-format</span> <span style="color:#e6db74">&#39;none</span>)
</span></span><span style="display:flex;"><span>        (org-capture)))
</span></span></code></pre></div><h5 id="roam">Roam</h5>
<h6 id="basic-settings">Basic settings</h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-roam-directory <span style="color:#e6db74">&#34;~/Dropbox/Org/slip-box&#34;</span>)
</span></span><span style="display:flex;"><span>(setq org-roam-db-location (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;org-roam.db&#34;</span> org-roam-directory))
</span></span></code></pre></div><p>That said, if the directory doesn&rsquo;t exist we likely don&rsquo;t want to be using roam.
Since we don&rsquo;t want to trigger errors (which will happen as soon as roam tries
to initialize), let&rsquo;s not load roam.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(package! org-roam :disable <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><h6 id="mode-line-file-name">Mode line file name</h6>
<p>All those numbers! It&rsquo;s messy. Let&rsquo;s adjust this similarly that I have in
the window title</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defadvice! doom-modeline--buffer-file-name-roam-aware-a (orig-fun)
</span></span><span style="display:flex;"><span>  :around <span style="color:#a6e22e">#&#39;</span>doom-modeline-buffer-file-name <span style="color:#75715e">; takes no args</span>
</span></span><span style="display:flex;"><span>  (if (s-contains-p org-roam-directory (or <span style="color:#a6e22e">buffer-file-name</span> <span style="color:#e6db74">&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>      (replace-regexp-in-string
</span></span><span style="display:flex;"><span>       <span style="color:#e6db74">&#34;\\(?:^\\|.*/\\)\\([0-9]\\{4\\}\\)\\([0-9]\\{2\\}\\)\\([0-9]\\{2\\}\\)[0-9]*-&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#e6db74">&#34;(\\1-\\2-\\3) &#34;</span>
</span></span><span style="display:flex;"><span>       (subst-char-in-string <span style="color:#e6db74">?_</span> <span style="color:#e6db74">? </span> <span style="color:#a6e22e">buffer-file-name</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">funcall</span> orig-fun)))
</span></span></code></pre></div><h6 id="org-roam-capture-template">Org Roam Capture template</h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! org-roam
</span></span><span style="display:flex;"><span>  (setq org-roam-capture-ref-templates
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">&#34;r&#34;</span> <span style="color:#e6db74">&#34;ref&#34;</span> plain <span style="color:#e6db74">&#34;%?&#34;</span>
</span></span><span style="display:flex;"><span>           :if-new (file+head <span style="color:#e6db74">&#34;web/%&lt;%Y%m%d%H%M%S&gt;-${slug}.org&#34;</span> <span style="color:#e6db74">&#34;#+title: ${title}\n#+created: %U\n\n${body}\n&#34;</span>)
</span></span><span style="display:flex;"><span>           :unnarrowed <span style="color:#66d9ef">t</span>))))
</span></span></code></pre></div><h5 id="snippet-helpers">Snippet Helpers</h5>
<p>I often want to set <code>src-block</code> headers, and it&rsquo;s a pain to:</p>
<ul>
<li>type them out</li>
<li>remember what the accepted values are</li>
<li>oh, and specifying the same language again and again</li>
</ul>
<p>We can solve this in three steps:</p>
<ul>
<li>having one-letter snippets, conditioned on <code>(point)</code> being within a src header</li>
<li>creating a nice prompt showing accepted values and the current default</li>
<li>pre-filling the <code>src-block</code> language with the last language used</li>
</ul>
<p>For header args, the keys I&rsquo;ll use are:</p>
<ul>
<li><code>r</code> for <code>:results</code></li>
<li><code>e</code> for <code>:exports</code></li>
<li><code>v</code> for <code>:eval</code></li>
<li><code>s</code> for <code>:session</code></li>
<li><code>d</code> for <code>:dir</code></li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun +yas/org-src-header-p ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Determine whether </span><span style="color:#e6db74">`point&#39;</span><span style="color:#e6db74"> is within a src-block header or header-args.&#34;</span>
</span></span><span style="display:flex;"><span>  (pcase (org-element-type (org-element-context))
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#39;src-block</span> (<span style="color:#a6e22e">&lt;</span> (<span style="color:#a6e22e">point</span>) <span style="color:#75715e">; before code part of the src-block</span>
</span></span><span style="display:flex;"><span>                   (save-excursion (<span style="color:#a6e22e">goto-char</span> (org-element-property :begin (org-element-context)))
</span></span><span style="display:flex;"><span>                                   (<span style="color:#a6e22e">forward-line</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>                                   (<span style="color:#a6e22e">point</span>))))
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#39;inline-src-block</span> (<span style="color:#a6e22e">&lt;</span> (<span style="color:#a6e22e">point</span>) <span style="color:#75715e">; before code part of the inline-src-block</span>
</span></span><span style="display:flex;"><span>                          (save-excursion (<span style="color:#a6e22e">goto-char</span> (org-element-property :begin (org-element-context)))
</span></span><span style="display:flex;"><span>                                          (<span style="color:#a6e22e">search-forward</span> <span style="color:#e6db74">&#34;]{&#34;</span>)
</span></span><span style="display:flex;"><span>                                          (<span style="color:#a6e22e">point</span>))))
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#39;keyword</span> (string-match-p <span style="color:#e6db74">&#34;^header-args&#34;</span> (org-element-property :value (org-element-context))))))
</span></span></code></pre></div><p>Now let&rsquo;s write a function we can reference in yasnippets to produce a nice
interactive way to specify header args.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun +yas/org-prompt-header-arg (arg question values)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Prompt the user to set ARG header property to one of VALUES with QUESTION.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">The default value is identified and indicated. If either default is selected,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">or no selection is made: nil is returned.&#34;</span>
</span></span><span style="display:flex;"><span>  (let* ((src-block-p (not (looking-back <span style="color:#e6db74">&#34;^#\\+property:[ \t]+header-args:.*&#34;</span> (<span style="color:#a6e22e">line-beginning-position</span>))))
</span></span><span style="display:flex;"><span>         (default
</span></span><span style="display:flex;"><span>           (or
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> arg
</span></span><span style="display:flex;"><span>                        (if src-block-p
</span></span><span style="display:flex;"><span>                            (<span style="color:#a6e22e">nth</span> <span style="color:#ae81ff">2</span> (org-babel-get-src-block-info <span style="color:#66d9ef">t</span>))
</span></span><span style="display:flex;"><span>                          (org-babel-merge-params
</span></span><span style="display:flex;"><span>                           org-babel-default-header-args
</span></span><span style="display:flex;"><span>                           (let ((lang-headers
</span></span><span style="display:flex;"><span>                                  (<span style="color:#a6e22e">intern</span> (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;org-babel-default-header-args:&#34;</span>
</span></span><span style="display:flex;"><span>                                                  (+yas/org-src-lang)))))
</span></span><span style="display:flex;"><span>                             (when (<span style="color:#a6e22e">boundp</span> lang-headers) (<span style="color:#a6e22e">eval</span> lang-headers <span style="color:#66d9ef">t</span>)))))))
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">default-value</span>)
</span></span><span style="display:flex;"><span>    (setq values (<span style="color:#a6e22e">mapcar</span>
</span></span><span style="display:flex;"><span>                  (lambda (value)
</span></span><span style="display:flex;"><span>                    (if (string-match-p (<span style="color:#a6e22e">regexp-quote</span> value) default)
</span></span><span style="display:flex;"><span>                        (setq <span style="color:#a6e22e">default-value</span>
</span></span><span style="display:flex;"><span>                              (<span style="color:#a6e22e">concat</span> value <span style="color:#e6db74">&#34; &#34;</span>
</span></span><span style="display:flex;"><span>                                      (<span style="color:#a6e22e">propertize</span> <span style="color:#e6db74">&#34;(default)&#34;</span> <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;font-lock-doc-face</span>)))
</span></span><span style="display:flex;"><span>                      value))
</span></span><span style="display:flex;"><span>                  values))
</span></span><span style="display:flex;"><span>    (let ((selection (consult--read question values :default <span style="color:#a6e22e">default-value</span>)))
</span></span><span style="display:flex;"><span>      (unless (or (string-match-p <span style="color:#e6db74">&#34;(default)$&#34;</span> selection)
</span></span><span style="display:flex;"><span>                  (string= <span style="color:#e6db74">&#34;&#34;</span> selection))
</span></span><span style="display:flex;"><span>        selection))))
</span></span></code></pre></div><p>Finally, we fetch the language information for new source blocks.</p>
<p>Since we&rsquo;re getting this info, we might as well go a step further and also
provide the ability to determine the most popular language in the buffer that
doesn&rsquo;t have any <code>header-args</code> set for it (with <code>#+properties</code>).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun +yas/org-src-lang ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Try to find the current language of the src/header at </span><span style="color:#e6db74">`point&#39;</span><span style="color:#e6db74">.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Return nil otherwise.&#34;</span>
</span></span><span style="display:flex;"><span>  (let ((context (org-element-context)))
</span></span><span style="display:flex;"><span>    (pcase (org-element-type context)
</span></span><span style="display:flex;"><span>      (<span style="color:#e6db74">&#39;src-block</span> (org-element-property :language context))
</span></span><span style="display:flex;"><span>      (<span style="color:#e6db74">&#39;inline-src-block</span> (org-element-property :language context))
</span></span><span style="display:flex;"><span>      (<span style="color:#e6db74">&#39;keyword</span> (when (<span style="color:#a6e22e">string-match</span> <span style="color:#e6db74">&#34;^header-args:\\([^ ]+\\)&#34;</span> (org-element-property :value context))
</span></span><span style="display:flex;"><span>                  (match-string <span style="color:#ae81ff">1</span> (org-element-property :value context)))))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun +yas/org-last-src-lang ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Return the language of the last src-block, if it exists.&#34;</span>
</span></span><span style="display:flex;"><span>  (save-excursion
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">beginning-of-line</span>)
</span></span><span style="display:flex;"><span>    (when (<span style="color:#a6e22e">re-search-backward</span> <span style="color:#e6db74">&#34;^[ \t]*#\\+begin_src&#34;</span> <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>      (org-element-property :language (org-element-context)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun +yas/org-most-common-no-property-lang ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Find the lang with the most source blocks that has no global header-args, else nil.&#34;</span>
</span></span><span style="display:flex;"><span>  (let (src-langs header-langs)
</span></span><span style="display:flex;"><span>    (save-excursion
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-min</span>))
</span></span><span style="display:flex;"><span>      (while (<span style="color:#a6e22e">re-search-forward</span> <span style="color:#e6db74">&#34;^[ \t]*#\\+begin_src&#34;</span> <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>        (push (+yas/org-src-lang) src-langs))
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-min</span>))
</span></span><span style="display:flex;"><span>      (while (<span style="color:#a6e22e">re-search-forward</span> <span style="color:#e6db74">&#34;^[ \t]*#\\+property: +header-args&#34;</span> <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>        (push (+yas/org-src-lang) header-langs)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (setq src-langs
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">mapcar</span> <span style="color:#a6e22e">#&#39;car</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#75715e">;; sort alist by frequency (desc.)</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#a6e22e">sort</span>
</span></span><span style="display:flex;"><span>                   <span style="color:#75715e">;; generate alist with form (value . frequency)</span>
</span></span><span style="display:flex;"><span>                   (cl-loop for (n <span style="color:#f92672">.</span> m) in (seq-group-by <span style="color:#a6e22e">#&#39;identity</span> src-langs)
</span></span><span style="display:flex;"><span>                            collect (<span style="color:#a6e22e">cons</span> n (<span style="color:#a6e22e">length</span> m)))
</span></span><span style="display:flex;"><span>                   (lambda (a b) (<span style="color:#a6e22e">&gt;</span> (<span style="color:#a6e22e">cdr</span> a) (<span style="color:#a6e22e">cdr</span> b))))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">car</span> (cl-set-difference src-langs header-langs :test <span style="color:#a6e22e">#&#39;</span>string=))))
</span></span></code></pre></div><h5 id="translate-capital-keywords--old--to-lower-case--new">Translate capital keywords (old) to lower case (new)</h5>
<p>Everyone used to use <code>#+CAPITAL</code> keywords. Then people realised that <code>#+lowercase</code>
is actually both marginally easier and visually nicer, so now the capital
version is just used in the manual.</p>
<blockquote>
<p>Org is standardized on lower case. Uppercase is used in the manual as a poor
man&rsquo;s bold, and supported for historical reasons. &mdash; <a href="https://orgmode.org/list/87tuuw3n15.fsf@nicolasgoaziou.fr">Nicolas Goaziou on the Org ML</a></p>
</blockquote>
<p>To avoid sometimes having to choose between the hassle out of updating old
documents and using mixed syntax, I&rsquo;ll whip up a basic transcode-y function.
It likely misses some edge cases, but should mostly work.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun org-syntax-convert-keyword-case-to-lower ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Convert all #+KEYWORDS to #+keywords.&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (save-excursion
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-min</span>))
</span></span><span style="display:flex;"><span>    (let ((count <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>          (case-fold-search <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>      (while (<span style="color:#a6e22e">re-search-forward</span> <span style="color:#e6db74">&#34;^[ \t]*#\\+[A-Z_]+&#34;</span> <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>        (unless (s-matches-p <span style="color:#e6db74">&#34;RESULTS&#34;</span> (match-string <span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">replace-match</span> (<span style="color:#a6e22e">downcase</span> (match-string <span style="color:#ae81ff">0</span>)) <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>          (setq count (<span style="color:#a6e22e">1+</span> count))))
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Replaced %d occurances&#34;</span> count))))
</span></span></code></pre></div><h5 id="fix-problematic-hooks">Fix problematic hooks</h5>
<p>When one of the <code>org-mode-hook</code> functions errors, it halts the hook
execution. This is problematic, and there are two hooks in particular which
cause issues. Let&rsquo;s make their failure less eventful.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defadvice! shut-up-org-problematic-hooks (orig-fn <span style="color:#66d9ef">&amp;rest</span> args)
</span></span><span style="display:flex;"><span>  :around <span style="color:#a6e22e">#&#39;</span>org-fancy-priorities-mode
</span></span><span style="display:flex;"><span>  :around <span style="color:#a6e22e">#&#39;</span>org-superstar-mode
</span></span><span style="display:flex;"><span><span style="color:#75715e">; :around #&#39;dap-mode-hook</span>
</span></span><span style="display:flex;"><span>  (ignore-errors (<span style="color:#a6e22e">apply</span> orig-fn args)))
</span></span></code></pre></div><h4 id="custom-links">Custom links</h4>
<h5 id="subfig">Subfig</h5>
<p>This defines a new link type <code>subfig</code> to enable exporting sub-figures to LaTeX,
taken form <a href="https://orgmode.org/list/87mty1an66.fsf@posteo.net/">&ldquo;Export subfigures to LaTeX (and HTML)&rdquo;</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(org-link-set-parameters
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#34;subfig&#34;</span>
</span></span><span style="display:flex;"><span> :follow (lambda (file) (find-file file))
</span></span><span style="display:flex;"><span> :face <span style="color:#f92672">&#39;</span>(:foreground <span style="color:#e6db74">&#34;chocolate&#34;</span> :weight bold :underline <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span> :display <span style="color:#e6db74">&#39;full</span>
</span></span><span style="display:flex;"><span> :export (lambda (file desc backend)
</span></span><span style="display:flex;"><span>           (when (<span style="color:#a6e22e">eq</span> backend <span style="color:#e6db74">&#39;latex</span>)
</span></span><span style="display:flex;"><span>             (if (<span style="color:#a6e22e">string-match</span> <span style="color:#e6db74">&#34;&gt;(\\(.+\\))&#34;</span> desc)
</span></span><span style="display:flex;"><span>                 (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;\\begin{subfigure}[b]&#34;</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;\\caption{&#34;</span>
</span></span><span style="display:flex;"><span>                         (replace-regexp-in-string <span style="color:#e6db74">&#34;\s+&gt;(.+)&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> desc)
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;}&#34;</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;\\includegraphics&#34;</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;[&#34;</span>
</span></span><span style="display:flex;"><span>                         (match-string <span style="color:#ae81ff">1</span> desc)
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;]&#34;</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;{&#34;</span>
</span></span><span style="display:flex;"><span>                         file
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;}&#34;</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;\\end{subfigure}&#34;</span>)
</span></span><span style="display:flex;"><span>               (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;\\begin{subfigure}\\includegraphics{%s}\\end{subfigure}&#34;</span> desc file)))))
</span></span></code></pre></div><p>Example of usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>#+caption: Lorem impsum dolor
</span></span><span style="display:flex;"><span>#+attr_latex: :options \centering
</span></span><span style="display:flex;"><span>#+begin_figure
</span></span><span style="display:flex;"><span>[[subfig:img1.jpg][Caption of img1 &gt;(width=.3\textwidth)]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[subfig:img2.jpg][Caption of img2 &gt;(width=.3\textwidth)]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[subfig:img3.jpg][Caption of img3 &gt;(width=.6\textwidth)]]
</span></span><span style="display:flex;"><span>#+end_figure
</span></span></code></pre></div><h4 id="visuals">Visuals</h4>
<p>Here I try to do two things: improve the styling of the various documents, via
font changes etc., and also propagate colours from the current theme.</p>
<h5 id="font-display">Font Display</h5>
<h6 id="headings">Headings</h6>
<p>Let&rsquo;s make the title and the headings a bit bigger:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(custom-set-faces!
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(org-document-title :height <span style="color:#ae81ff">1.2</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(custom-set-faces!
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(outline-1 :weight extra-bold :height <span style="color:#ae81ff">1.25</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(outline-2 :weight bold :height <span style="color:#ae81ff">1.15</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(outline-3 :weight bold :height <span style="color:#ae81ff">1.12</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(outline-4 :weight semi-bold :height <span style="color:#ae81ff">1.09</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(outline-5 :weight semi-bold :height <span style="color:#ae81ff">1.06</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(outline-6 :weight semi-bold :height <span style="color:#ae81ff">1.03</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(outline-8 :weight semi-bold)
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#39;</span>(outline-9 :weight semi-bold))
</span></span></code></pre></div><h6 id="deadlines">Deadlines</h6>
<p>It seems reasonable to have deadlines in the error face when they&rsquo;re passed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-agenda-deadline-faces
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>((<span style="color:#ae81ff">1.001</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">error</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#ae81ff">1.0</span> <span style="color:#f92672">.</span> org-warning)
</span></span><span style="display:flex;"><span>        (<span style="color:#ae81ff">0.5</span> <span style="color:#f92672">.</span> org-upcoming-deadline)
</span></span><span style="display:flex;"><span>        (<span style="color:#ae81ff">0.0</span> <span style="color:#f92672">.</span> org-upcoming-distant-deadline)))
</span></span></code></pre></div><h6 id="org-pretty-mode">Org Pretty Mode</h6>
<p>Activate <code>+org-pretty-mode</code>.</p>
<pre tabindex="0"><code class="language-nillangnilswitchesnilflags" data-lang="nillangnilswitchesnilflags">nilbody
</code></pre><h6 id="font-styling">Font styling</h6>
<p>We can then have quote blocks stand out a bit more by making them <em>italic</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-fontify-quote-and-verse-blocks <span style="color:#66d9ef">t</span>)
</span></span></code></pre></div><p>While <code>org-hide-emphasis-markers</code> is very nice, it can sometimes make edits which
occur at the border a bit more fiddley. We can improve this situation without
sacrificing visual amenities with the <code>org-appear</code> package.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(use-package! org-appear
</span></span><span style="display:flex;"><span>  :hook (org-mode <span style="color:#f92672">.</span> org-appear-mode)
</span></span><span style="display:flex;"><span>  :config
</span></span><span style="display:flex;"><span>  (setq org-appear-autoemphasis <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>        org-appear-autosubmarkers <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>        org-appear-autolinks <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; for proper first-time setup, `org-appear--set-elements&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; needs to be run after other hooks have acted.</span>
</span></span><span style="display:flex;"><span>  (run-at-time <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">nil</span> <span style="color:#a6e22e">#&#39;</span>org-appear--set-elements))
</span></span></code></pre></div><h5 id="fontifying-inline-src-blocks">Fontifying inline src blocks</h5>
<p>Org does lovely things with <code>#+begin_src</code> blocks, like using font-lock for
language&rsquo;s major-mode behind the scenes and pulling out the lovely colorful
results. By contrast, inline <code>src_</code> blocks are somewhat neglected.</p>
<p>I am not the first person to feel this way, thankfully others have <a href="https://stackoverflow.com/questions/20309842/how-to-syntax-highlight-for-org-mode-inline-source-code-src-lang/28059832">taken to
stackexchange</a> to voice their desire for inline src fontification. I was going to
steal their work, but unfortunately they didn&rsquo;t perform <em>true</em> source code
fontification, but simply applied the <code>org-code</code> face to the content.</p>
<p>We can do better than that, and we shall! Using <code>org-src-font-lock-fontify-block</code>
we can apply language-appropriate syntax highlighting. Then, continuing on to
<code>{{{results(...)}}}</code> , it can have the <code>org-block</code> face applied to match, and then
the value-surrounding constructs hidden by mimicking the behavior of
<code>prettify-symbols-mode</code>.</p>
<!-- raw HTML omitted -->
<p>This currently only highlights a single inline src block per line.
I have no idea why it stops, but I&rsquo;d rather it didn&rsquo;t.
If you have any idea what&rsquo;s going on or how to fix this <em>please</em> get in touch.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defvar org-prettify-inline-results <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Whether to use (ab)use prettify-symbols-mode on {{{results(...)}}}.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Either t or a cons cell of strings which are used as substitutions
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">for the start and end of inline results, respectively.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defvar org-fontify-inline-src-blocks-max-length <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Maximum content length of an inline src block that will be fontified.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun org-fontify-inline-src-blocks (limit)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Try to apply </span><span style="color:#e6db74">`org-fontify-inline-src-blocks-1&#39;</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>  (condition-case <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>      (org-fontify-inline-src-blocks-1 limit)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">error</span> (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Org mode fontification error in %S at %d&#34;</span>
</span></span><span style="display:flex;"><span>                    (<span style="color:#a6e22e">current-buffer</span>)
</span></span><span style="display:flex;"><span>                    (line-number-at-pos)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun org-fontify-inline-src-blocks-1 (limit)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Fontify inline src_LANG blocks, from </span><span style="color:#e6db74">`point&#39;</span><span style="color:#e6db74"> up to LIMIT.&#34;</span>
</span></span><span style="display:flex;"><span>  (let ((case-fold-search <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>        (initial-point (<span style="color:#a6e22e">point</span>)))
</span></span><span style="display:flex;"><span>    (while (<span style="color:#a6e22e">re-search-forward</span> <span style="color:#e6db74">&#34;\\_&lt;src_\\([^ \t\n[{]+\\)[{[]?&#34;</span> limit <span style="color:#66d9ef">t</span>) <span style="color:#75715e">; stolen from `org-element-inline-src-block-parser&#39;</span>
</span></span><span style="display:flex;"><span>      (let ((beg (<span style="color:#a6e22e">match-beginning</span> <span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>            pt
</span></span><span style="display:flex;"><span>            (lang-beg (<span style="color:#a6e22e">match-beginning</span> <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>            (lang-end (<span style="color:#a6e22e">match-end</span> <span style="color:#ae81ff">1</span>)))
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">remove-text-properties</span> beg lang-end <span style="color:#f92672">&#39;</span>(face <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>        (font-lock-append-text-property lang-beg lang-end <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;org-meta-line</span>)
</span></span><span style="display:flex;"><span>        (font-lock-append-text-property beg lang-beg <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;shadow</span>)
</span></span><span style="display:flex;"><span>        (font-lock-append-text-property beg lang-end <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;org-block</span>)
</span></span><span style="display:flex;"><span>        (setq pt (<span style="color:#a6e22e">goto-char</span> lang-end))
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;; `org-element--parse-paired-brackets&#39; doesn&#39;t take a limit, so to</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;; prevent it searching the entire rest of the buffer we temporarily</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;; narrow the active region.</span>
</span></span><span style="display:flex;"><span>        (save-restriction
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">narrow-to-region</span> beg (<span style="color:#a6e22e">min</span> (<span style="color:#a6e22e">point-max</span>) limit (<span style="color:#a6e22e">+</span> lang-end org-fontify-inline-src-blocks-max-length)))
</span></span><span style="display:flex;"><span>          (when (ignore-errors (org-element--parse-paired-brackets <span style="color:#e6db74">?\[</span>))
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">remove-text-properties</span> pt (<span style="color:#a6e22e">point</span>) <span style="color:#f92672">&#39;</span>(face <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>            (font-lock-append-text-property pt (<span style="color:#a6e22e">point</span>) <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;org-block</span>)
</span></span><span style="display:flex;"><span>            (setq pt (<span style="color:#a6e22e">point</span>)))
</span></span><span style="display:flex;"><span>          (when (ignore-errors (org-element--parse-paired-brackets <span style="color:#e6db74">?\{</span>))
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">remove-text-properties</span> pt (<span style="color:#a6e22e">point</span>) <span style="color:#f92672">&#39;</span>(face <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>            (font-lock-append-text-property pt (<span style="color:#a6e22e">1+</span> pt) <span style="color:#e6db74">&#39;face</span> <span style="color:#f92672">&#39;</span>(org-block shadow))
</span></span><span style="display:flex;"><span>            (unless (<span style="color:#a6e22e">=</span> (<span style="color:#a6e22e">1+</span> pt) (<span style="color:#a6e22e">1-</span> (<span style="color:#a6e22e">point</span>)))
</span></span><span style="display:flex;"><span>              (if org-src-fontify-natively
</span></span><span style="display:flex;"><span>                  (org-src-font-lock-fontify-block (<span style="color:#a6e22e">buffer-substring-no-properties</span> lang-beg lang-end) (<span style="color:#a6e22e">1+</span> pt) (<span style="color:#a6e22e">1-</span> (<span style="color:#a6e22e">point</span>)))
</span></span><span style="display:flex;"><span>                (font-lock-append-text-property (<span style="color:#a6e22e">1+</span> pt) (<span style="color:#a6e22e">1-</span> (<span style="color:#a6e22e">point</span>)) <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;org-block</span>)))
</span></span><span style="display:flex;"><span>            (font-lock-append-text-property (<span style="color:#a6e22e">1-</span> (<span style="color:#a6e22e">point</span>)) (<span style="color:#a6e22e">point</span>) <span style="color:#e6db74">&#39;face</span> <span style="color:#f92672">&#39;</span>(org-block shadow))
</span></span><span style="display:flex;"><span>            (setq pt (<span style="color:#a6e22e">point</span>))))
</span></span><span style="display:flex;"><span>        (when (and org-prettify-inline-results (<span style="color:#a6e22e">re-search-forward</span> <span style="color:#e6db74">&#34;\\= {{{results(&#34;</span> limit <span style="color:#66d9ef">t</span>))
</span></span><span style="display:flex;"><span>          (font-lock-append-text-property pt (<span style="color:#a6e22e">1+</span> pt) <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;org-block</span>)
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">goto-char</span> pt))))
</span></span><span style="display:flex;"><span>    (when org-prettify-inline-results
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">goto-char</span> initial-point)
</span></span><span style="display:flex;"><span>      (org-fontify-inline-src-results limit))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun org-fontify-inline-src-results (limit)
</span></span><span style="display:flex;"><span>  (while (<span style="color:#a6e22e">re-search-forward</span> <span style="color:#e6db74">&#34;{{{results(\\(.+?\\))}}}&#34;</span> limit <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">remove-list-of-text-properties</span> (<span style="color:#a6e22e">match-beginning</span> <span style="color:#ae81ff">0</span>) (<span style="color:#a6e22e">point</span>)
</span></span><span style="display:flex;"><span>                                    <span style="color:#f92672">&#39;</span>(composition
</span></span><span style="display:flex;"><span>                                      prettify-symbols-start
</span></span><span style="display:flex;"><span>                                      prettify-symbols-end))
</span></span><span style="display:flex;"><span>    (font-lock-append-text-property (<span style="color:#a6e22e">match-beginning</span> <span style="color:#ae81ff">0</span>) (<span style="color:#a6e22e">match-end</span> <span style="color:#ae81ff">0</span>) <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;org-block</span>)
</span></span><span style="display:flex;"><span>    (let ((start (<span style="color:#a6e22e">match-beginning</span> <span style="color:#ae81ff">0</span>)) (end (<span style="color:#a6e22e">match-beginning</span> <span style="color:#ae81ff">1</span>)))
</span></span><span style="display:flex;"><span>      (with-silent-modifications
</span></span><span style="display:flex;"><span>        (compose-region start end (if (<span style="color:#a6e22e">eq</span> org-prettify-inline-results <span style="color:#66d9ef">t</span>) <span style="color:#e6db74">&#34;&#34;</span> (<span style="color:#a6e22e">car</span> org-prettify-inline-results)))
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">add-text-properties</span> start end <span style="color:#f92672">`</span>(prettify-symbols-start <span style="color:#f92672">,</span>start prettify-symbols-end <span style="color:#f92672">,</span>end))))
</span></span><span style="display:flex;"><span>    (let ((start (<span style="color:#a6e22e">match-end</span> <span style="color:#ae81ff">1</span>)) (end (<span style="color:#a6e22e">point</span>)))
</span></span><span style="display:flex;"><span>      (with-silent-modifications
</span></span><span style="display:flex;"><span>        (compose-region start end (if (<span style="color:#a6e22e">eq</span> org-prettify-inline-results <span style="color:#66d9ef">t</span>) <span style="color:#e6db74">&#34;&#34;</span> (<span style="color:#a6e22e">cdr</span> org-prettify-inline-results)))
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">add-text-properties</span> start end <span style="color:#f92672">`</span>(prettify-symbols-start <span style="color:#f92672">,</span>start prettify-symbols-end <span style="color:#f92672">,</span>end))))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun org-fontify-inline-src-blocks-enable ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Add inline src fontification to font-lock in Org.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Must be run as part of </span><span style="color:#e6db74">`org-font-lock-set-keywords-hook&#39;</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>  (setq org-font-lock-extra-keywords
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">append</span> org-font-lock-extra-keywords <span style="color:#f92672">&#39;</span>((org-fontify-inline-src-blocks)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(add-hook <span style="color:#e6db74">&#39;org-font-lock-set-keywords-hook</span> <span style="color:#a6e22e">#&#39;</span>org-fontify-inline-src-blocks-enable)
</span></span></code></pre></div><h5 id="symbols">Symbols</h5>
<p>It&rsquo;s also nice to change the character used for collapsed items (by default <code></code>),
I think <code></code> is better for indicating &lsquo;collapsed section&rsquo;.
and add an extra <code>org-bullet</code> to the default list of four.
I&rsquo;ve also added some fun alternatives, just commented out.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! org-superstar
</span></span><span style="display:flex;"><span>  (setq org-superstar-headline-bullets-list <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>        org-superstar-prettify-item-bullets <span style="color:#66d9ef">t</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(setq org-ellipsis <span style="color:#e6db74">&#34;  &#34;</span>
</span></span><span style="display:flex;"><span>      org-hide-leading-stars <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>      org-priority-highest <span style="color:#e6db74">?A</span>
</span></span><span style="display:flex;"><span>      org-priority-lowest <span style="color:#e6db74">?E</span>
</span></span><span style="display:flex;"><span>      org-priority-faces
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">?A</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;all-the-icons-red</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">?B</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;all-the-icons-orange</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">?C</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;all-the-icons-yellow</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">?D</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;all-the-icons-green</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">?E</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;all-the-icons-blue</span>)))
</span></span></code></pre></div><p>It&rsquo;s also nice to make use of the Unicode characters for check boxes, and other
commands.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(appendq! +ligatures-extra-symbols
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#39;</span>(:checkbox                <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :pending                 <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :checkedbox              <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :list_property           <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :em_dash                 <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :ellipses                <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :arrow_right             <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :arrow_left              <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :title                   <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :subtitle                <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :language                <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :author                  <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :email                   <span style="color:#e6db74">&#34;@&#34;</span>
</span></span><span style="display:flex;"><span>            :date                    <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :property                <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :options                 <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :startup                 <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :macro                   <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :html_head               <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :html                    <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :latex_class             <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :latex_class_options     <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :latex_header            <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :beamer_header           <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :latex                   <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :attr_latex              <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :attr_html               <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :attr_org                <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :begin_quote             <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :end_quote               <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :begin_signature         <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :end_signature           <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :caption                 <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :name                    <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :header                  <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :results                 <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :begin_export            <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :end_export              <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :filetags                <span style="color:#e6db74">&#34;#&#34;</span>
</span></span><span style="display:flex;"><span>            :created                 <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :include                 <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :setupfile               <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :export_file_name        <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :properties              <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :end                     <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            :priority_a              <span style="color:#f92672">,</span>(<span style="color:#a6e22e">propertize</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;all-the-icons-red</span>)
</span></span><span style="display:flex;"><span>            :priority_b              <span style="color:#f92672">,</span>(<span style="color:#a6e22e">propertize</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;all-the-icons-orange</span>)
</span></span><span style="display:flex;"><span>            :priority_c              <span style="color:#f92672">,</span>(<span style="color:#a6e22e">propertize</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;all-the-icons-yellow</span>)
</span></span><span style="display:flex;"><span>            :priority_d              <span style="color:#f92672">,</span>(<span style="color:#a6e22e">propertize</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;all-the-icons-green</span>)
</span></span><span style="display:flex;"><span>            :priority_e              <span style="color:#f92672">,</span>(<span style="color:#a6e22e">propertize</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#e6db74">&#39;face</span> <span style="color:#e6db74">&#39;all-the-icons-blue</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(set-ligatures! <span style="color:#e6db74">&#39;org-mode</span>
</span></span><span style="display:flex;"><span>  :merge <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>  :checkbox                <span style="color:#e6db74">&#34;[ ]&#34;</span>
</span></span><span style="display:flex;"><span>  :pending                 <span style="color:#e6db74">&#34;[-]&#34;</span>
</span></span><span style="display:flex;"><span>  :checkedbox              <span style="color:#e6db74">&#34;[X]&#34;</span>
</span></span><span style="display:flex;"><span>  :list_property           <span style="color:#e6db74">&#34;::&#34;</span>
</span></span><span style="display:flex;"><span>  :em_dash                 <span style="color:#e6db74">&#34;---&#34;</span>
</span></span><span style="display:flex;"><span>  :ellipsis                <span style="color:#e6db74">&#34;...&#34;</span>
</span></span><span style="display:flex;"><span>  :arrow_right             <span style="color:#e6db74">&#34;-&gt;&#34;</span>
</span></span><span style="display:flex;"><span>  :arrow_left              <span style="color:#e6db74">&#34;&lt;-&#34;</span>
</span></span><span style="display:flex;"><span>  :title                   <span style="color:#e6db74">&#34;#+title:&#34;</span>
</span></span><span style="display:flex;"><span>  :subtitle                <span style="color:#e6db74">&#34;#+subtitle:&#34;</span>
</span></span><span style="display:flex;"><span>  :language                <span style="color:#e6db74">&#34;#+language:&#34;</span>
</span></span><span style="display:flex;"><span>  :author                  <span style="color:#e6db74">&#34;#+author:&#34;</span>
</span></span><span style="display:flex;"><span>  :email                   <span style="color:#e6db74">&#34;#+email:&#34;</span>
</span></span><span style="display:flex;"><span>  :date                    <span style="color:#e6db74">&#34;#+date:&#34;</span>
</span></span><span style="display:flex;"><span>  :property                <span style="color:#e6db74">&#34;#+property:&#34;</span>
</span></span><span style="display:flex;"><span>  :options                 <span style="color:#e6db74">&#34;#+options:&#34;</span>
</span></span><span style="display:flex;"><span>  :startup                 <span style="color:#e6db74">&#34;#+startup:&#34;</span>
</span></span><span style="display:flex;"><span>  :macro                   <span style="color:#e6db74">&#34;#+macro:&#34;</span>
</span></span><span style="display:flex;"><span>  :html_head               <span style="color:#e6db74">&#34;#+html_head:&#34;</span>
</span></span><span style="display:flex;"><span>  :html                    <span style="color:#e6db74">&#34;#+html:&#34;</span>
</span></span><span style="display:flex;"><span>  :latex_class             <span style="color:#e6db74">&#34;#+latex_class:&#34;</span>
</span></span><span style="display:flex;"><span>  :latex_class_options     <span style="color:#e6db74">&#34;#+latex_class_options&#34;</span>
</span></span><span style="display:flex;"><span>  :latex_header            <span style="color:#e6db74">&#34;#+latex_header:&#34;</span>
</span></span><span style="display:flex;"><span>  :beamer_header           <span style="color:#e6db74">&#34;#+beamer_header:&#34;</span>
</span></span><span style="display:flex;"><span>  :latex                   <span style="color:#e6db74">&#34;#+latex:&#34;</span>
</span></span><span style="display:flex;"><span>  :attr_latex              <span style="color:#e6db74">&#34;#+attr_latex:&#34;</span>
</span></span><span style="display:flex;"><span>  :attr_html               <span style="color:#e6db74">&#34;#+attr_html:&#34;</span>
</span></span><span style="display:flex;"><span>  :attr_org                <span style="color:#e6db74">&#34;#+attr_org:&#34;</span>
</span></span><span style="display:flex;"><span>  :begin_quote             <span style="color:#e6db74">&#34;#+begin_quote&#34;</span>
</span></span><span style="display:flex;"><span>  :end_quote               <span style="color:#e6db74">&#34;#+end_quote&#34;</span>
</span></span><span style="display:flex;"><span>  :begin_signature         <span style="color:#e6db74">&#34;#+begin_signature&#34;</span>
</span></span><span style="display:flex;"><span>  :end_signature           <span style="color:#e6db74">&#34;#+end_signature&#34;</span>
</span></span><span style="display:flex;"><span>  :caption                 <span style="color:#e6db74">&#34;#+caption:&#34;</span>
</span></span><span style="display:flex;"><span>  :header                  <span style="color:#e6db74">&#34;#+header:&#34;</span>
</span></span><span style="display:flex;"><span>  :begin_export            <span style="color:#e6db74">&#34;#+begin_export&#34;</span>
</span></span><span style="display:flex;"><span>  :end_export              <span style="color:#e6db74">&#34;#+end_export&#34;</span>
</span></span><span style="display:flex;"><span>  :filetags                <span style="color:#e6db74">&#34;#+filetags:&#34;</span>
</span></span><span style="display:flex;"><span>  :created                 <span style="color:#e6db74">&#34;#+created:&#34;</span>
</span></span><span style="display:flex;"><span>  :include                 <span style="color:#e6db74">&#34;#+include:&#34;</span>
</span></span><span style="display:flex;"><span>  :setupfile               <span style="color:#e6db74">&#34;#+setupfile:&#34;</span>
</span></span><span style="display:flex;"><span>  :export_file_name        <span style="color:#e6db74">&#34;#+export_file_name:&#34;</span>
</span></span><span style="display:flex;"><span>  :results                 <span style="color:#e6db74">&#34;#+RESULTS:&#34;</span>
</span></span><span style="display:flex;"><span>  :property                <span style="color:#e6db74">&#34;:PROPERTIES:&#34;</span>
</span></span><span style="display:flex;"><span>  :end                     <span style="color:#e6db74">&#34;:END:&#34;</span>
</span></span><span style="display:flex;"><span>  :priority_a              <span style="color:#e6db74">&#34;[#A]&#34;</span>
</span></span><span style="display:flex;"><span>  :priority_b              <span style="color:#e6db74">&#34;[#B]&#34;</span>
</span></span><span style="display:flex;"><span>  :priority_c              <span style="color:#e6db74">&#34;[#C]&#34;</span>
</span></span><span style="display:flex;"><span>  :priority_d              <span style="color:#e6db74">&#34;[#D]&#34;</span>
</span></span><span style="display:flex;"><span>  :priority_e              <span style="color:#e6db74">&#34;[#E]&#34;</span>)
</span></span></code></pre></div><h5 id="latex-fragments">LaTeX Fragments</h5>
<h6 id="prettier-highlighting">Prettier highlighting</h6>
<p>First off, we want those fragments to look good.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-highlight-latex-and-related <span style="color:#f92672">&#39;</span>(native script entities))
</span></span></code></pre></div><p>However, by using <code>native</code> highlighting the <code>org-block</code> face is added, and that
doesn&rsquo;t look too great &mdash; particularly when the fragments are previewed.</p>
<p>Ideally <code>org-src-font-lock-fontify-block</code> wouldn&rsquo;t add the <code>org-block</code> face, but we
can avoid advising that entire function by just adding another face with
<code>:inherit default</code> which will override the background color.</p>
<p>Inspecting <code>org-do-latex-and-related</code> shows that <code>&quot;latex&quot;</code> is the language argument
passed, and so we can override the background as discussed above.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(require <span style="color:#e6db74">&#39;org-src</span>)
</span></span><span style="display:flex;"><span>(add-to-list <span style="color:#e6db74">&#39;org-src-block-faces</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;latex&#34;</span> (:inherit default :extend <span style="color:#66d9ef">t</span>)))
</span></span></code></pre></div><h6 id="prettier-rendering">Prettier rendering</h6>
<p>It&rsquo;s nice to customize the look of LaTeX fragments, so they fit better in the
text &mdash; like this \(\sqrt{\beta^2+3}-\sum_{\phi=1}^\infty \frac{x^\phi-1}{\Gamma(a)}\).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; (setq org-format-latex-header &#34;\\documentclass{article}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\usepackage[usenames]{xcolor}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\usepackage[T1]{fontenc}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\usepackage{booktabs}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\pagestyle{empty} % do not remove</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\setlength{\\textwidth}{\\paperwidth}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\addtolength{\\textwidth}{-3cm}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\setlength{\\oddsidemargin}{1.5cm}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\addtolength{\\oddsidemargin}{-2.54cm}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\setlength{\\evensidemargin}{\\oddsidemargin}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\setlength{\\textheight}{\\paperheight}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\addtolength{\\textheight}{-\\headheight}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\addtolength{\\textheight}{-\\headsep}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\addtolength{\\textheight}{-\\footskip}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\addtolength{\\textheight}{-3cm}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\setlength{\\topmargin}{1.5cm}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\addtolength{\\topmargin}{-2.54cm}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; \\usepackage{arev}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; &#34;)</span>
</span></span></code></pre></div><p>Since we can, instead of making the background color match the <code>default</code> face,
let&rsquo;s make it transparent.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-format-latex-options
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">plist-put</span> org-format-latex-options :background <span style="color:#e6db74">&#34;Transparent&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Can be dvipng, dvisvgm, imagemagick</span>
</span></span><span style="display:flex;"><span>(setq org-preview-latex-default-process <span style="color:#e6db74">&#39;dvisvgm</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Define a function to set the format latex scale (to be reused in hooks)</span>
</span></span><span style="display:flex;"><span>(defun ab/set-org-latex-scale (scale)
</span></span><span style="display:flex;"><span>  (setq org-format-latex-options
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">plist-put</span> org-format-latex-options :scale scale)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Set the default scale</span>
</span></span><span style="display:flex;"><span>(ab/set-org-latex-scale <span style="color:#ae81ff">1.4</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Change scale in Zen mode</span>
</span></span><span style="display:flex;"><span>(when (featurep! :ui zen)
</span></span><span style="display:flex;"><span>  (add-hook! <span style="color:#e6db74">&#39;writeroom-mode-enable-hook</span> (ab/set-org-latex-scale <span style="color:#ae81ff">2.0</span>))
</span></span><span style="display:flex;"><span>  (add-hook! <span style="color:#e6db74">&#39;writeroom-mode-disable-hook</span> (ab/set-org-latex-scale <span style="color:#ae81ff">1.4</span>)))
</span></span></code></pre></div><h6 id="better-equation-numbering">Better equation numbering</h6>
<p>Numbered equations all have (1) as the number for fragments with vanilla
org-mode. This code (from <a href="https://github.com/jkitchin/scimax">scimax</a>) injects the correct numbers into the previews so they look
good. <strong>Not working right now!</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(defun scimax-org-renumber-environment (orig-func <span style="color:#66d9ef">&amp;rest</span> args)
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;A function to inject numbers in LaTeX fragment previews.&#34;</span>
</span></span><span style="display:flex;"><span>  (let ((results <span style="color:#f92672">&#39;</span>())
</span></span><span style="display:flex;"><span>        (counter <span style="color:#ae81ff">-1</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">numberp</span>))
</span></span><span style="display:flex;"><span>    (setq results (cl-loop for (begin <span style="color:#f92672">.</span>  env) in
</span></span><span style="display:flex;"><span>                           (org-element-map (org-element-parse-buffer) <span style="color:#e6db74">&#39;latex-environment</span>
</span></span><span style="display:flex;"><span>                             (lambda (env)
</span></span><span style="display:flex;"><span>                               (<span style="color:#a6e22e">cons</span>
</span></span><span style="display:flex;"><span>                                (org-element-property :begin env)
</span></span><span style="display:flex;"><span>                                (org-element-property :value env))))
</span></span><span style="display:flex;"><span>                           collect
</span></span><span style="display:flex;"><span>                           (cond
</span></span><span style="display:flex;"><span>                            ((and (<span style="color:#a6e22e">string-match</span> <span style="color:#e6db74">&#34;\\\\begin{equation}&#34;</span> env)
</span></span><span style="display:flex;"><span>                                  (not (<span style="color:#a6e22e">string-match</span> <span style="color:#e6db74">&#34;\\\\tag{&#34;</span> env)))
</span></span><span style="display:flex;"><span>                             (cl-incf counter)
</span></span><span style="display:flex;"><span>                             (<span style="color:#a6e22e">cons</span> begin counter))
</span></span><span style="display:flex;"><span>                            ((<span style="color:#a6e22e">string-match</span> <span style="color:#e6db74">&#34;\\\\begin{align}&#34;</span> env)
</span></span><span style="display:flex;"><span>                             (prog2
</span></span><span style="display:flex;"><span>                                 (cl-incf counter)
</span></span><span style="display:flex;"><span>                                 (<span style="color:#a6e22e">cons</span> begin counter)
</span></span><span style="display:flex;"><span>                               (with-temp-buffer
</span></span><span style="display:flex;"><span>                                 (<span style="color:#a6e22e">insert</span> env)
</span></span><span style="display:flex;"><span>                                 (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-min</span>))
</span></span><span style="display:flex;"><span>                                 <span style="color:#75715e">;; \\ is used for a new line. Each one leads to a number</span>
</span></span><span style="display:flex;"><span>                                 (cl-incf counter (count-matches <span style="color:#e6db74">&#34;\\\\$&#34;</span>))
</span></span><span style="display:flex;"><span>                                 <span style="color:#75715e">;; unless there are nonumbers.</span>
</span></span><span style="display:flex;"><span>                                 (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-min</span>))
</span></span><span style="display:flex;"><span>                                 (cl-decf counter (count-matches <span style="color:#e6db74">&#34;\\nonumber&#34;</span>)))))
</span></span><span style="display:flex;"><span>                            (<span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>                             (<span style="color:#a6e22e">cons</span> begin <span style="color:#66d9ef">nil</span>)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (when (setq <span style="color:#a6e22e">numberp</span> (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> (<span style="color:#a6e22e">point</span>) results)))
</span></span><span style="display:flex;"><span>      (setf (<span style="color:#a6e22e">car</span> args)
</span></span><span style="display:flex;"><span>            (<span style="color:#a6e22e">concat</span>
</span></span><span style="display:flex;"><span>             (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;\\setcounter{equation}{%s}\n&#34;</span> <span style="color:#a6e22e">numberp</span>)
</span></span><span style="display:flex;"><span>             (<span style="color:#a6e22e">car</span> args)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">apply</span> orig-func args))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(defun scimax-toggle-latex-equation-numbering ()
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Toggle whether LaTeX fragments are numbered.&#34;</span>
</span></span><span style="display:flex;"><span>  (interactive)
</span></span><span style="display:flex;"><span>  (if (not (<span style="color:#a6e22e">get</span> <span style="color:#e6db74">&#39;scimax-org-renumber-environment</span> <span style="color:#e6db74">&#39;enabled</span>))
</span></span><span style="display:flex;"><span>      (progn
</span></span><span style="display:flex;"><span>        (advice-add <span style="color:#e6db74">&#39;org-create-formula-image</span> :around <span style="color:#a6e22e">#&#39;</span>scimax-org-renumber-environment)
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">put</span> <span style="color:#e6db74">&#39;scimax-org-renumber-environment</span> <span style="color:#e6db74">&#39;enabled</span> <span style="color:#66d9ef">t</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Latex numbering enabled&#34;</span>))
</span></span><span style="display:flex;"><span>    (advice-remove <span style="color:#e6db74">&#39;org-create-formula-image</span> <span style="color:#a6e22e">#&#39;</span>scimax-org-renumber-environment)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">put</span> <span style="color:#e6db74">&#39;scimax-org-renumber-environment</span> <span style="color:#e6db74">&#39;enabled</span> <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">message</span> <span style="color:#e6db74">&#34;Latex numbering disabled.&#34;</span>)))
</span></span></code></pre></div><h5 id="org-plot">Org Plot</h5>
<p>We can use some variables in <code>org-plot</code> to use the current doom theme
colors.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! org-plot
</span></span><span style="display:flex;"><span>  (defun org-plot/generate-theme (_type)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Use the current Doom theme colours to generate a GnuPlot preamble.&#34;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">fgt = \&#34;textcolor rgb &#39;%s&#39;\&#34; # foreground text
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">fgat = \&#34;textcolor rgb &#39;%s&#39;\&#34; # foreground alt text
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">fgl = \&#34;linecolor rgb &#39;%s&#39;\&#34; # foreground line
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">fgal = \&#34;linecolor rgb &#39;%s&#39;\&#34; # foreground alt line
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># foreground colors
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set border lc rgb &#39;%s&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># change text colors of  tics
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set xtics @fgt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set ytics @fgt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># change text colors of labels
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set title @fgt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set xlabel @fgt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set ylabel @fgt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># change a text color of key
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set key @fgt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># line styles
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set linetype 1 lw 2 lc rgb &#39;%s&#39; # red
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set linetype 2 lw 2 lc rgb &#39;%s&#39; # blue
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set linetype 3 lw 2 lc rgb &#39;%s&#39; # green
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set linetype 4 lw 2 lc rgb &#39;%s&#39; # magenta
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set linetype 5 lw 2 lc rgb &#39;%s&#39; # orange
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set linetype 6 lw 2 lc rgb &#39;%s&#39; # yellow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set linetype 7 lw 2 lc rgb &#39;%s&#39; # teal
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set linetype 8 lw 2 lc rgb &#39;%s&#39; # violet
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># palette
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set palette maxcolors 8
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set palette defined ( 0 &#39;%s&#39;,\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 &#39;%s&#39;,\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2 &#39;%s&#39;,\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">3 &#39;%s&#39;,\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">4 &#39;%s&#39;,\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">5 &#39;%s&#39;,\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">6 &#39;%s&#39;,\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">7 &#39;%s&#39; )
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;fg</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;fg-alt</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;fg</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;fg-alt</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;fg</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">;; colours</span>
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;red</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;blue</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;green</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;magenta</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;orange</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;yellow</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;teal</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;violet</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">;; duplicated</span>
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;red</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;blue</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;green</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;magenta</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;orange</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;yellow</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;teal</span>)
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;violet</span>)
</span></span><span style="display:flex;"><span>            ))
</span></span><span style="display:flex;"><span>  (defun org-plot/gnuplot-term-properties (_type)
</span></span><span style="display:flex;"><span>    (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;background rgb &#39;%s&#39; size 1050,650&#34;</span>
</span></span><span style="display:flex;"><span>            (doom-color <span style="color:#e6db74">&#39;bg</span>)))
</span></span><span style="display:flex;"><span>  (setq org-plot/gnuplot-script-preamble <span style="color:#a6e22e">#&#39;</span>org-plot/generate-theme)
</span></span><span style="display:flex;"><span>  (setq org-plot/gnuplot-term-extra <span style="color:#a6e22e">#&#39;</span>org-plot/gnuplot-term-properties))
</span></span></code></pre></div><h4 id="bibliography">Bibliography</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-cite-csl-styles-dir <span style="color:#e6db74">&#34;~/Zotero/styles&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq! bibtex-completion-bibliography <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;~/Zotero/library.bib&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq! citar-bibliography <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;~/Zotero/library.bib&#34;</span>))
</span></span></code></pre></div><p>You may also set the respective note and library path variables as well for
enhanced functionality:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; (setq! bibtex-completion-library-path &#39;(&#34;~/Zotero/storage&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;        bibtex-completion-notes-path &#34;/path/to/your/notes/&#34;)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; (setq! citar-library-paths &#39;(&#34;/path/to/library/files/&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;;        citar-notes-paths &#39;(&#34;/path/to/your/notes/&#34;))</span>
</span></span></code></pre></div><h4 id="exporting">Exporting</h4>
<h5 id="general-settings">General settings</h5>
<p>By default Org only exports the first three levels of headings as &hellip; headings.
This is rather unfortunate as my documents frequently stray far beyond three
levels of depth. The two main formats I care about exporting to are LaTeX and
HTML. When using an <code>article</code> class, LaTeX headlines go from <code>\section</code>,
<code>\subsection</code>, <code>\subsubsection</code>, and <code>\paragraph</code> to <code>\subgraph</code> &mdash; <em>five</em> levels.
HTML5 has six levels of headings (<code>&lt;h1&gt;</code> to <code>&lt;h6&gt;</code>), but first level Org headings
get exported as <code>&lt;h2&gt;</code> elements &mdash; leaving <em>five</em> usable levels.</p>
<p>As such, it would seem to make sense to recognize the first <em>five</em> levels of Org
headings when exporting.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-export-headline-levels <span style="color:#ae81ff">5</span>) <span style="color:#75715e">; I like nesting</span>
</span></span></code></pre></div><p>I&rsquo;m also going to make use of an item in <code>ox-extra</code> so that I can add an <code>:ignore:</code>
tag to headings for the content to be kept, but the heading itself ignored
(unlike <code>:noexport:</code> which ignored both heading and content). This is useful when
I want to use headings to provide a structure for writing that doesn&rsquo;t appear in
the final documents.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(require <span style="color:#e6db74">&#39;ox-extra</span>)
</span></span><span style="display:flex;"><span>(ox-extras-activate <span style="color:#f92672">&#39;</span>(ignore-headlines))
</span></span></code></pre></div><p>Since I (roughly) track Org <code>HEAD</code>, it makes sense to include the git version in
the creator string.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq org-export-creator-string
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;Emacs %s (Org mode %s %s)&#34;</span> emacs-version (org-release) (org-git-version)))
</span></span></code></pre></div><h5 id="latex-export">LaTeX Export</h5>
<h6 id="compiling">Compiling</h6>
<p>By default Org uses <code>pdflatex</code>  3 + <code>bibtex</code>. This simply won&rsquo;t do in our
modern world. <code>latexmk</code> + <code>biber</code> (which is used automatically with <code>latexmk</code>) is a
simply superior combination.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; `org-latex-compilers&#39; contains a list of possible values (&#34;pdflatex&#34; &#34;xelatex&#34; &#34;lualatex&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; for the `%latex&#39; argument.</span>
</span></span><span style="display:flex;"><span>(setq org-latex-pdf-process <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;latexmk -f -pdf -%latex -shell-escape -interaction=nonstopmode -output-directory=%o %f&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#75715e">;; NOTE: Not tangled; old school</span>
</span></span><span style="display:flex;"><span>(setq org-latex-pdf-process
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;pdflatex -interaction nonstopmode -output-directory %o %f&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;bibtex %b&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;pdflatex -interaction nonstopmode -output-directory %o %f&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;pdflatex -interaction nonstopmode -output-directory %o %f&#34;</span>))
</span></span></code></pre></div><p>While <code>org-latex-pdf-process</code> does support a function, and we could use that
instead, this would no longer use the log buffer &mdash; it&rsquo;s a bit blind, you give
it the file name and expect it to do its thing.</p>
<p>The default values of <code>org-latex-compilers</code> is given in commented form to see how
<code>org-latex-pdf-process</code> works with them.</p>
<p>While the <code>-%latex</code> above is slightly hacky (<code>-pdflatex</code> expects to be given a
value) it allows us to leave <code>org-latex-compilers</code> unmodified.
This is nice in case I open an org file that uses <code>#+LATEX_COMPILER</code> for example,
it should still work.</p>
<h6 id="class-templates">Class templates</h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(after! ox-latex
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;org-latex-classes</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;scr-article&#34;</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#e6db74">&#34;\\documentclass{scrartcl}&#34;</span>
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\section{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\section*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsubsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\paragraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subparagraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;org-latex-classes</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;blank&#34;</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#e6db74">&#34;[NO-DEFAULT-PACKAGES]\n[NO-PACKAGES]\n[EXTRA]&#34;</span>
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\section{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\section*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsubsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\paragraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subparagraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;org-latex-classes</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;bmc-article&#34;</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#e6db74">&#34;\\documentclass[article,code,maths]{bmc}\n[NO-DEFAULT-PACKAGES]\n[NO-PACKAGES]\n[EXTRA]&#34;</span>
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\section{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\section*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsubsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\paragraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subparagraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;org-latex-classes</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;bmc&#34;</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#e6db74">&#34;\\documentclass[code,maths]{bmc}\n[NO-DEFAULT-PACKAGES]\n[NO-PACKAGES]\n[EXTRA]&#34;</span>
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\chapter{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\chapter*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\section{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\section*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsubsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\paragraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subparagraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;org-latex-classes</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;IEEEtran&#34;</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#e6db74">&#34;\\documentclass{IEEEtran}&#34;</span>
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\section{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\section*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsubsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\paragraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\paragraph*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subparagraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subparagraph*{%s}&#34;</span>)))
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;org-latex-classes</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;thesis&#34;</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#e6db74">&#34;\\documentclass[11pt]{book}&#34;</span>
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\chapter{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\chapter*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\section{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\section*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsubsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\paragraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\paragraph*{%s}&#34;</span>)))
</span></span><span style="display:flex;"><span>  (add-to-list <span style="color:#e6db74">&#39;org-latex-classes</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;thesis-fr&#34;</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#e6db74">&#34;\\documentclass[french,12pt,a4paper]{book}&#34;</span>
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\chapter{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\chapter*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\section{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\section*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\subsubsection{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\subsubsection*{%s}&#34;</span>)
</span></span><span style="display:flex;"><span>                 (<span style="color:#e6db74">&#34;\\paragraph{%s}&#34;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;\\paragraph*{%s}&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(setq org-latex-default-class <span style="color:#e6db74">&#34;article&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; org-latex-tables-booktabs t</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; org-latex-reference-command &#34;\\cref{%s}&#34;)</span>
</span></span></code></pre></div><h5 id="hugo">Hugo</h5>
<p>Update files with last modified date, when <code>#+lastmod:</code> is available</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(setq time-stamp-active <span style="color:#66d9ef">t</span>
</span></span><span style="display:flex;"><span>      time-stamp-start <span style="color:#e6db74">&#34;#\\+lastmod:[ \t]*&#34;</span>
</span></span><span style="display:flex;"><span>      time-stamp-end <span style="color:#e6db74">&#34;$&#34;</span>
</span></span><span style="display:flex;"><span>      time-stamp-format <span style="color:#e6db74">&#34;%04Y-%02m-%02d&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(add-hook <span style="color:#e6db74">&#39;before-save-hook</span> <span style="color:#e6db74">&#39;time-stamp</span> <span style="color:#66d9ef">nil</span>)
</span></span></code></pre></div><h2 id="system-configuration">System configuration</h2>
<h3 id="mime-types">Mime types</h3>
<h4 id="org-mode-files">Org Mode files</h4>
<p>Org mode isn&rsquo;t recognized as its own mime type by default, but that can easily
be changed with the following file. For system-wide changes try
<code>/usr/share/mime/packages/org.xml</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;mime-info</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#39;http://www.freedesktop.org/standards/shared-mime-info&#39;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;mime-type</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;text/org&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;comment&gt;</span>Emacs Org-mode File<span style="color:#f92672">&lt;/comment&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;glob</span> <span style="color:#a6e22e">pattern=</span><span style="color:#e6db74">&#34;*.org&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;alias</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;text/org&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/mime-type&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/mime-info&gt;</span>
</span></span></code></pre></div><p>What&rsquo;s nice is that Papirus <a href="https://github.com/PapirusDevelopmentTeam/papirus-icon-theme/commit/a10fb7f2423d5e30b9c4477416ccdc93c4f3849d">now</a> has an icon for <code>text/org</code>.
One simply needs to refresh their mime database</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>update-mime-database ~/.local/share/mime
</span></span></code></pre></div><p>Then set Emacs as the default editor:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>xdg-mime default emacs-client.desktop text/org
</span></span></code></pre></div><h4 id="registering-org-protocol">Registering <code>org-protocol://</code></h4>
<p>The recommended method of registering a protocol is by registering a desktop
application, which seems reasonable.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cfg" data-lang="cfg"><span style="display:flex;"><span><span style="color:#66d9ef">[Desktop Entry]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Name</span><span style="color:#f92672">=</span><span style="color:#e6db74">Emacs Org-Protocol</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Exec</span><span style="color:#f92672">=</span><span style="color:#e6db74">emacsclient %u</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">/home/hacko/.doom.d/assets/org-mode.svg</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Type</span><span style="color:#f92672">=</span><span style="color:#e6db74">Application</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Terminal</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MimeType</span><span style="color:#f92672">=</span><span style="color:#e6db74">x-scheme-handler/org-protocol</span>
</span></span></code></pre></div><p>To associate <code>org-protocol://</code> links with the desktop file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>xdg-mime default org-protocol.desktop x-scheme-handler/org-protocol
</span></span></code></pre></div><h4 id="configuring-chrome-brave">Configuring Chrome/Brave</h4>
<p>As specified in the <a href="https://www.orgroam.com/manual.html#Org_002droam-Protocol">official documentation</a>, we would like to invoke the
<code>org-protocol://</code> without confirmation. To do this, we need to add this system-wide configuration.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>read -p <span style="color:#e6db74">&#34;Do you want to set Chrome/Brave to show the &#39;Always open ...&#39; checkbox, to be used with the &#39;org-protocol://&#39; registration? [Y | N]: &#34;</span> INSTALL_CONFIRM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $INSTALL_CONFIRM <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Y&#34;</span> <span style="color:#f92672">]]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  sudo mkdir -p /etc/opt/chrome/policies/managed/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  sudo tee /etc/opt/chrome/policies/managed/external_protocol_dialog.json &gt; /dev/null <span style="color:#e6db74">&lt;&lt;&#39;EOF&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;ExternalProtocolDialogShowAlwaysOpenCheckbox&#34;: true
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  sudo chmod <span style="color:#ae81ff">644</span> /etc/opt/chrome/policies/managed/external_protocol_dialog.json
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>Then add a bookmarklet in your browser with this code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">javascript</span><span style="color:#f92672">:</span><span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">href</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;org-protocol://roam-ref?template=r&amp;ref=&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> encodeURIComponent(<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">href</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&amp;title=&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> encodeURIComponent(document.<span style="color:#a6e22e">title</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;&amp;body=&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> encodeURIComponent(window.<span style="color:#a6e22e">getSelection</span>())
</span></span></code></pre></div><h3 id="git">Git</h3>
<h4 id="git-diffs">Git diffs</h4>
<p>Based on this <a href="https://gist.github.com/ruediger/5647207">gist</a> and <a href="https://protesilaos.com/codelog/2021-01-26-git-diff-hunk-elisp-org/">this article</a>.</p>
<pre tabindex="0"><code class="language-fundamental" data-lang="fundamental">*.tex                                       diff=tex
*.bib                                       diff=bibtex
*.{c,h,c++,h++,cc,hh,cpp,hpp}               diff=cpp
*.m                                         diff=matlab
*.py                                        diff=python
*.rb                                        diff=ruby
*.php                                       diff=php
*.pl                                        diff=perl
*.{html,xhtml}                              diff=html
*.f                                         diff=fortran
*.{el,lisp,scm}                             diff=lisp
*.r                                         diff=rstats
*.texi*                                     diff=texinfo
*.org                                       diff=org
*.rs                                        diff=rust

*.odt                                       diff=odt
*.odp                                       diff=libreoffice
*.ods                                       diff=libreoffice
*.doc                                       diff=doc
*.xls                                       diff=xls
*.ppt                                       diff=ppt
*.docx                                      diff=docx
*.xlsx                                      diff=xlsx
*.pptx                                      diff=pptx
*.rtf                                       diff=rtf

*.{png,jpg,jpeg,gif}                        diff=exif

*.pdf                                       diff=pdf
*.djvu                                      diff=djvu
*.epub                                      diff=pandoc
*.chm                                       diff=tika
*.mhtml?                                    diff=tika

*.{class,jar}                               diff=tika
*.{rar,7z,zip,apk}                          diff=tika
</code></pre><p>Then adding some regular expressions for it to <code>~/.config/git/config</code>, with some
tools to view diffs on binary files.</p>
<pre tabindex="0"><code class="language-gitconfig" data-lang="gitconfig"># ===== TEXT FORMATS =====
[diff &#34;org&#34;]
  xfuncname = &#34;^(\\*+ +.*)$&#34;

[diff &#34;lisp&#34;]
  xfuncname = &#34;^(\\(.*)$&#34;

[diff &#34;rstats&#34;]
  xfuncname = &#34;^([a-zA-z.]+ &lt;- function.*)$&#34;

[diff &#34;texinfo&#34;]
# from http://git.savannah.gnu.org/gitweb/?p=coreutils.git;a=blob;f=.gitattributes;h=c3b2926c78c939d94358cc63d051a70d38cfea5d;hb=HEAD
  xfuncname = &#34;^@node[ \t][ \t]*\\([^,][^,]*\\)&#34;

[diff &#34;orgmode&#34;]
  xfuncname = &#34;^(\\*+.*)$&#34;

[diff &#34;rust&#34;]
  xfuncname = &#34;^[ \t]*(pub|)[ \t]*((fn|struct|enum|impl|trait|mod)[^;]*)$&#34;

# ===== BINARY FORMATS =====
[diff &#34;pdf&#34;]
  binary = true
# textconv = pdfinfo
# textconv = sh -c &#39;pdftotext &#34;$@&#34; -&#39; # sudo apt install pdftotext
  textconv = sh -c &#39;pdftotext -layout &#34;$0&#34; -enc UTF-8 -nopgbrk -q -&#39;
  cachetextconv = true

[diff &#34;djvu&#34;]
  binary = true
# textconv = pdfinfo
  textconv = djvutxt # yay -S djvulibre
  cachetextconv = true

[diff &#34;odt&#34;]
  textconv = odt2txt
# textconv = pandoc --standalone --from=odt --to=plain
  binary = true
  cachetextconv = true

[diff &#34;doc&#34;]
# textconv = wvText
  textconv = catdoc # yay -S catdoc
  binary = true
  cachetextconv = true

[diff &#34;xls&#34;]
# textconv = in2csv
# textconv = xlscat -a UTF-8
# textconv = soffice --headless --convert-to csv
  textconv = xls2csv # yay -S catdoc
  binary = true
  cachetextconv = true

[diff &#34;ppt&#34;]
  textconv = catppt # yay -S catdoc
  binary = true
  cachetextconv = true

[diff &#34;docx&#34;]
  textconv = pandoc --standalone --from=docx --to=plain
# textconv = sh -c &#39;docx2txt.pl &#34;$0&#34; -&#39;
  binary = true
  cachetextconv = true

[diff &#34;xlsx&#34;]
  textconv = xlsx2csv # pip install xlsx2csv
# textconv = in2csv
# textconv = soffice --headless --convert-to csv
  binary = true
  cachetextconv = true

[diff &#34;pptx&#34;]
# pip install --user pptx2md (currently not wotking with Python 3.10)
# textconv = sh -c &#39;pptx2md --disable_image --disable_wmf -i &#34;$0&#34; -o ~/.cache/git/presentation.md &gt;/dev/null &amp;&amp; cat ~/.cache/git/presentation.md&#39;
# Alternative hack, convert PPTX to PPT, then use the catppt tool
  textconv = sh -c &#39;soffice --headless --convert-to ppt --outdir /tmp &#34;$0&#34; &amp;&amp; TMP_FILENAME=$(basename -- &#34;$0&#34;) &amp;&amp; catppt &#34;/tmp/${TMP_FILENAME%.*}.ppt&#34;&#39;
  binary = true
  cachetextconv = true

[diff &#34;rtf&#34;]
  textconv = unrtf --text # yay -S unrtf
  binary = true
  cachetextconv = true

[diff &#34;epub&#34;]
  textconv = pandoc --standalone --from=epub --to=plain
  binary = true
  cachetextconv = true

[diff &#34;tika&#34;]
  textconv = tika --config=~/.local/share/tika/tika-conf.xml --text
  binary = true
  cachetextconv = true

[diff &#34;libreoffice&#34;]
  textconv = soffice --cat
  binary = true
  cachetextconv = true

[diff &#34;exif&#34;]
  binary = true
  textconv = exiftool # sudo apt install perl-image-exiftool
</code></pre><h4 id="apache-tika-app-wrapper">Apache Tika App wrapper</h4>
<p><strong>Apache Tika</strong> is a content detection and analysis framework. It detects and
extracts metadata and text from over a thousand different file types. We will be
using the Tika App in command-line mode to show some meaningful diff information
for some binary files.</p>
<p>First, let&rsquo;s add a custom script to run <code>tika-app</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>APACHE_TIKA_JAR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.local/share/tika/tika-app.jar&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f <span style="color:#e6db74">${</span>APACHE_TIKA_JAR<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  exec java -Dfile.encoding<span style="color:#f92672">=</span>UTF-8 -jar <span style="color:#e6db74">${</span>APACHE_TIKA_JAR<span style="color:#e6db74">}</span> <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span> 2&gt;/dev/null
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;JAR file not found at </span><span style="color:#e6db74">${</span>APACHE_TIKA_JAR<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>Add <code>tika</code>&rsquo;s installation instructions to the <code>setup.sh</code> file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>update_apache_tika <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  TIKA_JAR_PATH<span style="color:#f92672">=</span>$HOME/.local/share/tika
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -d <span style="color:#e6db74">${</span>TIKA_JAR_PATH<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    mkdir -p <span style="color:#e6db74">${</span>TIKA_JAR_PATH<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  TIKA_BASE_URL<span style="color:#f92672">=</span>https://archive.apache.org/dist/tika/
</span></span><span style="display:flex;"><span>  TIKA_JAR_LINK<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TIKA_JAR_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/tika-app.jar&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  echo -n <span style="color:#e6db74">&#34;Checking for new Apache Tika App version... &#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Get the lastest version</span>
</span></span><span style="display:flex;"><span>  TIKA_VERSION<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>
</span></span><span style="display:flex;"><span>    curl -s <span style="color:#e6db74">${</span>TIKA_BASE_URL<span style="color:#e6db74">}</span> | <span style="color:#75715e"># Get the page</span>
</span></span><span style="display:flex;"><span>    pandoc -f html -t plain | <span style="color:#75715e"># Convert HTML page to plain text.</span>
</span></span><span style="display:flex;"><span>    awk <span style="color:#e6db74">&#39;/([0-9]+\.)+[0-1]\// {print substr($1, 0, length($1)-1)}&#39;</span> | <span style="color:#75715e"># Get the versions directories (pattern: X.X.X/)</span>
</span></span><span style="display:flex;"><span>    sort -rV | <span style="color:#75715e"># Sort versions, the newest first</span>
</span></span><span style="display:flex;"><span>    head -n <span style="color:#ae81ff">1</span> <span style="color:#75715e"># Get the first (newest) version</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">${</span>TIKA_VERSION<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Failed, check your internet connection.&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;Lastest version is </span><span style="color:#e6db74">${</span>TIKA_VERSION<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  TIKA_JAR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TIKA_JAR_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/tika-app-</span><span style="color:#e6db74">${</span>TIKA_VERSION<span style="color:#e6db74">}</span><span style="color:#e6db74">.jar&#34;</span>
</span></span><span style="display:flex;"><span>  TIKA_JAR_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TIKA_BASE_URL<span style="color:#e6db74">}${</span>TIKA_VERSION<span style="color:#e6db74">}</span><span style="color:#e6db74">/tika-app-</span><span style="color:#e6db74">${</span>TIKA_VERSION<span style="color:#e6db74">}</span><span style="color:#e6db74">.jar&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -f <span style="color:#e6db74">${</span>TIKA_JAR<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;New version available!&#34;</span>
</span></span><span style="display:flex;"><span>    read -p <span style="color:#e6db74">&#34;Do you want to download Apache Tika App v</span><span style="color:#e6db74">${</span>TIKA_VERSION<span style="color:#e6db74">}</span><span style="color:#e6db74">? [Y | N]: &#34;</span> INSTALL_CONFIRM
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $INSTALL_CONFIRM <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Y&#34;</span> <span style="color:#f92672">]]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      curl -o <span style="color:#e6db74">${</span>TIKA_JAR<span style="color:#e6db74">}</span> <span style="color:#e6db74">${</span>TIKA_JAR_URL<span style="color:#e6db74">}</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Apache Tika App v</span><span style="color:#e6db74">${</span>TIKA_VERSION<span style="color:#e6db74">}</span><span style="color:#e6db74"> downloaded successfully&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Apache Tika App is up-to-date, version </span><span style="color:#e6db74">${</span>TIKA_VERSION<span style="color:#e6db74">}</span><span style="color:#e6db74"> already downloaded to &#39;</span><span style="color:#e6db74">${</span>TIKA_JAR<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Check the existance of the symbolic link</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -L <span style="color:#e6db74">${</span>TIKA_JAR_LINK<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    unlink <span style="color:#e6db74">${</span>TIKA_JAR_LINK<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Create a symbolic link to the installed version</span>
</span></span><span style="display:flex;"><span>  ln -s <span style="color:#e6db74">${</span>TIKA_JAR<span style="color:#e6db74">}</span> <span style="color:#e6db74">${</span>TIKA_JAR_LINK<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>update_apache_tika;
</span></span></code></pre></div><p>When it detects that Tesseract is installed, Tika App will try to extract text
from some file types. For some reason, it tries to use Tesseract with some
compressed files like <code>*.bz2</code>, <code>*.apk</code>&hellip; etc. I would like to disable this feature
by exporting an XML config file which will be used when launching the Tika App
(using <code>--config=&lt;tika-config.xml&gt;</code>).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;properties&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;parsers&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;parser</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;org.apache.tika.parser.DefaultParser&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;parser-exclude</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;org.apache.tika.parser.ocr.TesseractOCRParser&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/parser&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/parsers&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/properties&gt;</span>
</span></span></code></pre></div><h3 id="emacs-systemd-daemon">Emacs&rsquo; Systemd Daemon</h3>
<p>Let&rsquo;s define a Systemd service to launch Emacs server automatically.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-systemd" data-lang="systemd"><span style="display:flex;"><span><span style="color:#66d9ef">[Unit]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Description</span><span style="color:#f92672">=</span><span style="color:#e6db74">Emacs server daemon</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Documentation</span><span style="color:#f92672">=</span><span style="color:#e6db74">info:emacs man:emacs(1) https://gnu.org/software/emacs/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[Service]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Type</span><span style="color:#f92672">=</span><span style="color:#e6db74">forking</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ExecStart</span><span style="color:#f92672">=</span><span style="color:#e6db74">sh -c &#39;emacs --daemon &amp;&amp; emacsclient -c --eval &#34;(delete-frame)&#34;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ExecStop</span><span style="color:#f92672">=</span><span style="color:#e6db74">/usr/bin/emacsclient --no-wait --eval &#34;(progn (setq kill-emacs-hook nil) (kill-emacs))&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Restart</span><span style="color:#f92672">=</span><span style="color:#e6db74">on-failure</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[Install]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">WantedBy</span><span style="color:#f92672">=</span><span style="color:#e6db74">default.target</span>
</span></span></code></pre></div><p>Which is then enabled by:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>systemctl --user enable emacs.service
</span></span></code></pre></div><p>For some reason if a frame isn&rsquo;t opened early in the initialization process, the
daemon doesn&rsquo;t seem to like opening frames later &mdash; hence the <code>&amp;&amp; emacsclient</code>
part of the <code>ExecStart</code> value.</p>
<h3 id="emacs-client">Emacs Client</h3>
<h4 id="desktop-integration">Desktop Integration</h4>
<p>It can now be nice to use this as a &lsquo;default app&rsquo; for opening files. If we add
an appropriate desktop entry, and enable it in the desktop environment.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cfg" data-lang="cfg"><span style="display:flex;"><span><span style="color:#66d9ef">[Desktop Entry]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Name</span><span style="color:#f92672">=</span><span style="color:#e6db74">Emacs (Client)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">GenericName</span><span style="color:#f92672">=</span><span style="color:#e6db74">Text Editor</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Comment</span><span style="color:#f92672">=</span><span style="color:#e6db74">A flexible platform for end-user applications</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MimeType</span><span style="color:#f92672">=</span><span style="color:#e6db74">text/english;text/plain;text/org;text/x-makefile;text/x-c++hdr;text/x-c++src;text/x-chdr;text/x-csrc;text/x-java;text/x-moc;text/x-pascal;text/x-tcl;text/x-tex;application/x-shellscript;text/x-c;text/x-c++;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Exec</span><span style="color:#f92672">=</span><span style="color:#e6db74">emacsclient -create-frame --frame-parameters=&#34;&#39;(fullscreen . maximized)&#34; --alternate-editor=&#34;/usr/bin/emacs&#34; --no-wait %F</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">emacs</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Type</span><span style="color:#f92672">=</span><span style="color:#e6db74">Application</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Terminal</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Categories</span><span style="color:#f92672">=</span><span style="color:#e6db74">TextEditor;Utility;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">StartupWMClass</span><span style="color:#f92672">=</span><span style="color:#e6db74">Emacs</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Keywords</span><span style="color:#f92672">=</span><span style="color:#e6db74">Text;Editor;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">X-KDE-StartupNotify</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span>
</span></span></code></pre></div><h4 id="command-line-wrapper">Command-line Wrapper</h4>
<p>A wrapper around <code>emacsclient</code>:</p>
<ul>
<li>Accepting <code>stdin</code> by putting it in a temporary file and immediately opening it.</li>
<li>Guessing that the <code>tty</code> is a good idea when <code>$DISPLAY</code> is unset (relevant with SSH
sessions, among other things).</li>
<li>With a whiff of 24-bit color support, sets <code>TERM</code> variable to a <code>terminfo</code> that
(probably) announces 24-bit color support.</li>
<li>Changes GUI <code>emacsclient</code> instances to be non-blocking by default (<code>--no-wait</code>),
and instead take a flag to suppress this behavior (<code>-w</code>).</li>
</ul>
<p>I would use <code>sh</code>, but using arrays for argument manipulation is just too
convenient, so I&rsquo;ll raise the requirement to <code>bash</code>. Since arrays are the only
&rsquo;extra&rsquo; compared to <code>sh</code>, other shells like <code>ksh</code> etc. should work too.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>force_tty<span style="color:#f92672">=</span>false
</span></span><span style="display:flex;"><span>force_wait<span style="color:#f92672">=</span>false
</span></span><span style="display:flex;"><span>stdin_mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>args<span style="color:#f92672">=()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>usage <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  echo -e <span style="color:#e6db74">&#34;Usage: e [-t] [-m MODE] [OPTIONS] FILE [-]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Emacs client convenience wrapper.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Options:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-h, --help            Show this message
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-t, -nw, --tty        Force terminal mode
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-w, --wait            Don&#39;t supply --no-wait to graphical emacsclient
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-                     Take stdin (when last argument)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-m MODE, --mode MODE  Mode to open stdin with
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">-mm, --maximized      Start Emacs client in maximized window
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Run emacsclient --help to see help for the emacsclient.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> :
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>    -t | -nw | --tty<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      force_tty<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>      shift ;;
</span></span><span style="display:flex;"><span>    -w | --wait<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      force_wait<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>      shift ;;
</span></span><span style="display:flex;"><span>    -m | --mode<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      stdin_mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34; (</span>$2<span style="color:#e6db74">-mode)&#34;</span>
</span></span><span style="display:flex;"><span>      shift <span style="color:#ae81ff">2</span> ;;
</span></span><span style="display:flex;"><span>    -mm | --maximized<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        args<span style="color:#f92672">+=(</span><span style="color:#e6db74">&#34;--frame-parameters=&#39;(fullscreen . maximized)&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        shift ;;
</span></span><span style="display:flex;"><span>    -h | --help<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      usage
</span></span><span style="display:flex;"><span>      exit <span style="color:#ae81ff">0</span> ;;
</span></span><span style="display:flex;"><span>    --*<span style="color:#f92672">=</span>*<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      set -- <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>1%%=*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>1#*=<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>      shift ;;
</span></span><span style="display:flex;"><span>    *<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$#<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> break
</span></span><span style="display:flex;"><span>      args<span style="color:#f92672">+=(</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      shift ;;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${#</span>args[*]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>args[-1]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  unset <span style="color:#e6db74">&#39;args[-1]&#39;</span>
</span></span><span style="display:flex;"><span>  TMP<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>mktemp /tmp/emacsstdin-XXX<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  cat &gt; <span style="color:#e6db74">&#34;</span>$TMP<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  args<span style="color:#f92672">+=(</span>--eval <span style="color:#e6db74">&#34;(let ((b (generate-new-buffer \&#34;*stdin*\&#34;))) (switch-to-buffer b) (insert-file-contents \&#34;</span>$TMP<span style="color:#e6db74">\&#34;) (delete-file \&#34;</span>$TMP<span style="color:#e6db74">\&#34;)</span><span style="color:#e6db74">${</span>stdin_mode<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$DISPLAY<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> $force_tty
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># detect terminals with sneaky 24-bit support</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">{</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$COLORTERM<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> truecolor <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$COLORTERM<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> 24bit <span style="color:#f92672">]</span>; <span style="color:#f92672">}</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>tput colors 2&gt;/dev/null<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> -lt <span style="color:#ae81ff">257</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> echo <span style="color:#e6db74">&#34;</span>$TERM<span style="color:#e6db74">&#34;</span> | grep -q <span style="color:#e6db74">&#34;^\w\+-[0-9]&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      termstub<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TERM%%-*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      termstub<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TERM#*-<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> infocmp <span style="color:#e6db74">&#34;</span>$termstub<span style="color:#e6db74">-direct&#34;</span> &gt;/dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      TERM<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$termstub<span style="color:#e6db74">-direct&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      TERM<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;xterm-direct&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span> <span style="color:#75715e"># should be fairly safe</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  emacsclient --tty -create-frame --alternate-editor<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/usr/bin/emacs&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>args[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ! $force_wait
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    args<span style="color:#f92672">+=(</span>--no-wait<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  emacsclient -create-frame --alternate-editor<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/usr/bin/emacs&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>args[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h5 id="useful-aliases">Useful aliases</h5>
<p>Now, to set an alias to use <code>e</code> with <code>magit</code>, and then for maximum laziness we can
set aliases for the terminal-forced variants.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># Aliases to run emacs+magit</span>
</span></span><span style="display:flex;"><span>alias magit<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;e --eval &#34;(progn (magit-status) (delete-other-windows))&#34;&#39;</span>
</span></span><span style="display:flex;"><span>alias magitt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;e -t --eval &#34;(progn (magit-status) (delete-other-windows))&#34;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Aliases to run emacs+mu4e</span>
</span></span><span style="display:flex;"><span>alias emu<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;e --eval &#34;(progn (=mu4e) (delete-other-windows))&#34;&#39;</span>
</span></span><span style="display:flex;"><span>alias emut<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;e -t --eval &#34;(progn (=mu4e) (delete-other-windows))&#34;&#39;</span>
</span></span></code></pre></div><p>And this to launch Emacs in terminal mode <code>et</code>, I use this as a default <code>$EDITOR</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>e -t <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>And <code>ev</code> for use with <code>$VISUAL</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>e -w <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>export EDITOR<span style="color:#f92672">=</span>$HOME/.local/bin/et
</span></span><span style="display:flex;"><span><span style="color:#75715e"># export VISUAL=$HOME/.local/bin/ev</span>
</span></span></code></pre></div><h3 id="tmux"><!-- raw HTML omitted -->TODO<!-- raw HTML omitted --> tmux</h3>
<p>Configure remote/local mixed <code>tmux</code> configuration, an example in <a href="https://github.com/samoshkin/tmux-config/">this repo</a> and
<a href="https://www.freecodecamp.org/news/tmux-in-practice-local-and-nested-remote-tmux-sessions-4f7ba5db8795/">this article</a>.</p>
<h3 id="appimage">AppImage</h3>
<p>Install/update the <code>appimageupdatetool.AppImage</code> tool:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>update_appimageupdatetool <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  TOOL_NAME<span style="color:#f92672">=</span>appimageupdatetool
</span></span><span style="display:flex;"><span>  MACHINE_ARCH<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>uname -m<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>  APPIMAGE_UPDATE_TOOL_PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.local/bin/</span><span style="color:#e6db74">${</span>TOOL_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  APPIMAGE_UPDATE_TOOL_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://github.com/AppImage/AppImageUpdate/releases/download/continuous/</span><span style="color:#e6db74">${</span>TOOL_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">${</span>MACHINE_ARCH<span style="color:#e6db74">}</span><span style="color:#e6db74">.AppImage&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f <span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> $APPIMAGE_UPDATE_TOOL_PATH -j <span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span> 2&amp;&gt;/dev/null
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TOOL_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74"> already up to date&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f <span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      echo <span style="color:#e6db74">&#34;Update available, downloading latest </span><span style="color:#e6db74">${</span>MACHINE_ARCH<span style="color:#e6db74">}</span><span style="color:#e6db74"> version to </span><span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>      mv <span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">.backup&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      echo <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TOOL_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74"> not found, downloading latest </span><span style="color:#e6db74">${</span>MACHINE_ARCH<span style="color:#e6db74">}</span><span style="color:#e6db74"> version to </span><span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    wget -O <span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span> <span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_URL<span style="color:#e6db74">}</span> 2&amp;&gt;/dev/null <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Downloaded </span><span style="color:#e6db74">${</span>TOOL_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">${</span>MACHINE_ARCH<span style="color:#e6db74">}</span><span style="color:#e6db74">.AppImage&#34;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">[</span> -f <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">.backup&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>        rm <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">.backup&#34;</span>
</span></span><span style="display:flex;"><span>    chmod a+x <span style="color:#e6db74">${</span>APPIMAGE_UPDATE_TOOL_PATH<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>update_appimageupdatetool;
</span></span></code></pre></div><h3 id="custom-environment">Custom environment</h3>
<p>I would like to customize my Linux environment in a separate file, which I
source from my <code>~/.zshrc</code> file.</p>
<p>I like to define MacOS-like commands (<code>pbcopy</code> and <code>pbpaste</code>) to copy and paste in
terminal (from <code>stdin</code>, to <code>stdout</code>). The <code>pbcopy</code> and <code>pbpaste</code> are defined using
either <code>xclip</code> or <code>xsel</code>, you would need to install these tools, otherwise we wouldn&rsquo;t
define the aliases.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># Define aliases to &#39;pbcopy&#39; and &#39;pbpaste&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> command -v xclip &amp;&gt; /dev/null
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Define aliases using xclip</span>
</span></span><span style="display:flex;"><span>  alias pbcopy<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xclip -selection clipboard&#39;</span>
</span></span><span style="display:flex;"><span>  alias pbpaste<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xclip -selection clipboard -o&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> command -v xsel &amp;&gt; /dev/null
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Define aliases using xsel</span>
</span></span><span style="display:flex;"><span>  alias pbcopy<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xsel --clipboard --input&#39;</span>
</span></span><span style="display:flex;"><span>  alias pbpaste<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xsel --clipboard --output&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>And then define <code>gsuon</code> and <code>gsuoff</code> aliases to run graphical apps from terminal
with root permissions, this requires <code>xhost</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># To run GUI apps from terminal with root permissions</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> command -v xhost &amp;&gt; /dev/null
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  alias gsuon<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xhost si:localuser:root&#39;</span>
</span></span><span style="display:flex;"><span>  alias gsuoff<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;xhost -si:localuser:root&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>Define a <code>netpaste</code> command to paste to <a href="https://ptpb.pw">https://ptpb.pw</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># To copy the output of a command to ptpb.pw</span>
</span></span><span style="display:flex;"><span>alias netpaste<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;curl -F c=@- https://ptpb.pw&#39;</span>
</span></span></code></pre></div><p>Use NeoVIM instead of VIM to provide <code>vi</code> and <code>vim</code> commands.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># NeoVim</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> command -v nvim &amp;&gt; /dev/null
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  alias vim<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;nvim&#34;</span>
</span></span><span style="display:flex;"><span>  alias vi<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;nvim&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>Add some aliases to work with the <a href="https://github.com/espressif/esp-idf.git">ESP-IDF</a> framework.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -d $HOME/Softwares/src/esp-idf/ <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  alias esp-prepare-env<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;source $HOME/Softwares/src/esp-idf/export.sh&#39;</span>
</span></span><span style="display:flex;"><span>  alias esp-update<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;echo &#34;Updating ESP-IDF framework...&#34; &amp;&amp; cd $HOME/src/esp-idf &amp;&amp; git pull --all &amp;&amp; echo &#34;Updated successfully&#34;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  alias esp-prepare-env<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;echo &#34;esp-idf repo not found. You can clone the esp-idf repo using git clone https://github.com/espressif/esp-idf.git&#34;&#39;</span>
</span></span><span style="display:flex;"><span>  alias esp-update<span style="color:#f92672">=</span>esp-prepare-env
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>For the moment, I&rsquo;m not using a particular tool to manage my dotfiles, instead,
I use a bare Git repository to manage files, when the workspace is set to the
home directory. To be able to add/commit files to the dotfiles repository, I
define an alias to <code>git</code> which takes the bare repository as <code>--git-dir</code>, and my home
directory as <code>--work-tree</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>alias dotfiles<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;git --git-dir=$HOME/Projects/dotfiles.git --work-tree=$HOME&#39;</span>
</span></span></code></pre></div><p>Define an alias to get weather information for my city:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>export WTTRIN_CITY<span style="color:#f92672">=</span>Orsay
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>alias wttrin<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;curl wttr.in/$WTTRIN_CITY&#39;</span>
</span></span><span style="display:flex;"><span>alias wttrin2<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;curl v2.wttr.in/$WTTRIN_CITY&#39;</span>
</span></span></code></pre></div><p>Enable Meta key and colors in <code>minicom</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>export MINICOM<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;-m -c on&#39;</span>
</span></span></code></pre></div><p>Define Rust sources path, and add packages installed from <code>cargo</code> to the <code>PATH</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>export RUST_SRC_PATH<span style="color:#f92672">=</span>$HOME/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/src/
</span></span><span style="display:flex;"><span>export PATH<span style="color:#f92672">=</span>$PATH:$HOME/.cargo/bin
</span></span></code></pre></div><p>I&rsquo;m using the AUR package <code>clang-format-static-bin</code>, which provide multiple
versions of Clang-format, I use it with some work projects requiring a specific
version of Clang-format.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>export PATH<span style="color:#f92672">=</span>/opt/clang-format-static:$PATH
</span></span></code></pre></div><p>Add my manually installed libraries to CMake and <code>PATH</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>export CMAKE_PREFIX_PATH<span style="color:#f92672">=</span>$HOME/Softwares/src/install
</span></span><span style="display:flex;"><span>export PATH<span style="color:#f92672">=</span>$PATH:$HOME/.cargo/bin:$HOME/Softwares/src/install/bin
</span></span></code></pre></div><p>Set NPM installation path to local:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>NPM_PACKAGES<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>HOME<span style="color:#e6db74">}</span><span style="color:#e6db74">/.npm-packages&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Export NPM bin path</span>
</span></span><span style="display:flex;"><span>export PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$PATH<span style="color:#e6db74">:</span>$NPM_PACKAGES<span style="color:#e6db74">/bin&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Preserve MANPATH if you already defined it somewhere in your config.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Otherwise, fall back to `manpath` so we can inherit from `/etc/manpath`.</span>
</span></span><span style="display:flex;"><span>export MANPATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>MANPATH-<span style="color:#66d9ef">$(</span>manpath<span style="color:#66d9ef">)</span><span style="color:#e6db74">}</span><span style="color:#e6db74">:</span>$NPM_PACKAGES<span style="color:#e6db74">/share/man&#34;</span>
</span></span></code></pre></div><p>Some useful stuff (<code>fzf</code>, <code>opam</code>, Doom Emacs&hellip;)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># FZF</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> -f ~/.fzf.zsh <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> source ~/.fzf.zsh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># opam configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[[</span> ! -r $HOME/.opam/opam-init/init.zsh <span style="color:#f92672">]]</span> <span style="color:#f92672">||</span> source $HOME/.opam/opam-init/init.zsh  &gt; /dev/null 2&gt; /dev/null
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Add ~/.config/emacs.doom/bin to path (for DOOM Emacs stuff)</span>
</span></span><span style="display:flex;"><span>export PATH<span style="color:#f92672">=</span>$PATH:$HOME/.config/emacs.doom/bin
</span></span></code></pre></div><p>I like to use <code>tmux</code> by default, even on my local sessions, I like to start a <code>tmux</code>
in a <code>default</code> session on the first time I launch a terminal, and then, attach any
other terminal to this default session:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> command -v tmux &amp;&gt; /dev/null <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$TMUX<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  tmux attach -t default <span style="color:#f92672">||</span> tmux new -s default
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>export DS_DIR<span style="color:#f92672">=</span>~/PhD/datasets-no/experiment_images/
</span></span></code></pre></div><h3 id="system-dark-theme-trick">System dark theme trick</h3>
<p>Zotero does not support dark mode (ATM), when using a system-wide dark
theme (at least on KDE), Zotero UI gets messed up, to fix this, we can force
Zotero to use its default GTK theme by defining the <code>GTK_THEME=Default</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cfg" data-lang="cfg"><span style="display:flex;"><span><span style="color:#66d9ef">[Desktop Entry]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Type</span><span style="color:#f92672">=</span><span style="color:#e6db74">Application</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Name</span><span style="color:#f92672">=</span><span style="color:#e6db74">Zotero</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">GenericName</span><span style="color:#f92672">=</span><span style="color:#e6db74">A free, easy-to-use tool to help you collect, organize, cite, and share your research sources.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">zotero</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Exec</span><span style="color:#f92672">=</span><span style="color:#e6db74">GTK_THEME=Default /usr/bin/zotero --url %u</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Categories</span><span style="color:#f92672">=</span><span style="color:#e6db74">Office</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Terminal</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MimeType</span><span style="color:#f92672">=</span><span style="color:#e6db74">x-scheme-handler/zotero</span>
</span></span></code></pre></div><p>Same thing for Scilab</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cfg" data-lang="cfg"><span style="display:flex;"><span><span style="color:#66d9ef">[Desktop Entry]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Comment</span><span style="color:#f92672">=</span><span style="color:#e6db74">Scientific software package for numerical computations</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Exec</span><span style="color:#f92672">=</span><span style="color:#e6db74">GTK_THEME=Default scilab -f %f</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">GenericName</span><span style="color:#f92672">=</span><span style="color:#e6db74">Scientific Software Package</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">scilab</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Name</span><span style="color:#f92672">=</span><span style="color:#e6db74">Scilab</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">StartupNotify</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Terminal</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Type</span><span style="color:#f92672">=</span><span style="color:#e6db74">Application</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Categories</span><span style="color:#f92672">=</span><span style="color:#e6db74">Science;Math;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Keywords</span><span style="color:#f92672">=</span><span style="color:#e6db74">Science;Math;Numerical;Simulation</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MimeType</span><span style="color:#f92672">=</span><span style="color:#e6db74">application/x-scilab-sci;application/x-scilab-sce;application/x-scilab-tst;application/x-scilab-dem;application/x-scilab-sod;application/x-scilab-xcos;application/x-scilab-zcos;application/x-scilab-bin;application/x-scilab-cosf;application/x-scilab-cos;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cfg" data-lang="cfg"><span style="display:flex;"><span><span style="color:#66d9ef">[Desktop Entry]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Comment</span><span style="color:#f92672">=</span><span style="color:#e6db74">Hybrid simulator</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Exec</span><span style="color:#f92672">=</span><span style="color:#e6db74">GTK_THEME=Default xcos</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">GenericName</span><span style="color:#f92672">=</span><span style="color:#e6db74">Scientific Software Package</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">xcos</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Name</span><span style="color:#f92672">=</span><span style="color:#e6db74">Xcos</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">StartupNotify</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Terminal</span><span style="color:#f92672">=</span><span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Type</span><span style="color:#f92672">=</span><span style="color:#e6db74">Application</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Categories</span><span style="color:#f92672">=</span><span style="color:#e6db74">Science;Physics;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Keywords</span><span style="color:#f92672">=</span><span style="color:#e6db74">Science;Physics;Simulation</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MimeType</span><span style="color:#f92672">=</span><span style="color:#e6db74">application/x-scilab-xcos;application/x-scilab-zcos;application/x-scilab-cosf;application/x-scilab-cos;</span>
</span></span></code></pre></div><h3 id="rust-format">Rust format</h3>
<p>For Rust code base, the file <code>$HOME/.rustfmt.toml</code> contains the global format
settings, I like to set it to:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span><span style="color:#75715e"># Rust edition 2018</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">edition</span> = <span style="color:#e6db74">&#34;2018&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Use Unix style newlines, with 2 spaces tabulation.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">newline_style</span> = <span style="color:#e6db74">&#34;Unix&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tab_spaces</span> = <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">hard_tabs</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Make one line functions in a single line</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fn_single_line</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Format strings</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">format_strings</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Increase the max line width</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_width</span> = <span style="color:#ae81ff">120</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Merge nested imports</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">merge_imports</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enum and Struct alignement</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">enum_discrim_align_threshold</span> = <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">struct_field_align_threshold</span> = <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Reorder impl items: type &gt; const &gt; macros &gt; methods.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">reorder_impl_items</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Comments and documentation formating</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">wrap_comments</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">normalize_comments</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">normalize_doc_attributes</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">format_code_in_doc_comments</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">report_fixme</span> = <span style="color:#e6db74">&#34;Always&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">todo</span> = <span style="color:#e6db74">&#34;Always&#34;</span>
</span></span></code></pre></div><h3 id="ecryptfs">Ecryptfs</h3>
<h4 id="unlock-and-mount-script">Unlock and mount script</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh -e
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># This script mounts a user&#39;s confidential private folder</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Original by Michael Halcrow, IBM</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Extracted to a stand-alone script by Dustin Kirkland &lt;kirkland@ubuntu.com&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Modified by: Abdelhak Bougouffa &lt;abougouffa@fedoraproject.org&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This script:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  * interactively prompts for a user&#39;s wrapping passphrase (defaults to their</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#    login passphrase)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  * checks it for validity</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  * unwraps a users mount passphrase with their supplied wrapping passphrase</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  * inserts the mount passphrase into the keyring</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  * and mounts a user&#39;s encrypted private folder</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PRIVATE_DIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Private&#34;</span>
</span></span><span style="display:flex;"><span>PW_ATTEMPTS<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>MESSAGE<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>gettext <span style="color:#e6db74">&#34;Enter your login passphrase:&#34;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f $HOME/.ecryptfs/wrapping-independent <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># use a wrapping passphrase different from the login passphrase</span>
</span></span><span style="display:flex;"><span>  MESSAGE<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>gettext <span style="color:#e6db74">&#34;Enter your wrapping passphrase:&#34;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>WRAPPED_PASSPHRASE_FILE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.ecryptfs/wrapped-passphrase&#34;</span>
</span></span><span style="display:flex;"><span>MOUNT_PASSPHRASE_SIG_FILE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.ecryptfs/</span>$PRIVATE_DIR<span style="color:#e6db74">.sig&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># First, silently try to perform the mount, which would succeed if the appropriate</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># key is available in the keyring</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> /sbin/mount.ecryptfs_private &gt;/dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  exit <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Otherwise, interactively prompt for the user&#39;s password</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f <span style="color:#e6db74">&#34;</span>$WRAPPED_PASSPHRASE_FILE<span style="color:#e6db74">&#34;</span> -a -f <span style="color:#e6db74">&#34;</span>$MOUNT_PASSPHRASE_SIG_FILE<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  tries<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> <span style="color:#f92672">[</span> $tries -lt $PW_ATTEMPTS <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    LOGINPASS<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>zenity --password --title <span style="color:#e6db74">&#34;eCryptFS: </span>$MESSAGE<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#66d9ef">$(</span>wc -l &lt; <span style="color:#e6db74">&#34;</span>$MOUNT_PASSPHRASE_SIG_FILE<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># No filename encryption; only insert fek</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> printf <span style="color:#e6db74">&#34;%s\0&#34;</span> <span style="color:#e6db74">&#34;</span>$LOGINPASS<span style="color:#e6db74">&#34;</span> | ecryptfs-unwrap-passphrase <span style="color:#e6db74">&#34;</span>$WRAPPED_PASSPHRASE_FILE<span style="color:#e6db74">&#34;</span> - | ecryptfs-add-passphrase -
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        break
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        zenity --error --title <span style="color:#e6db74">&#34;eCryptfs&#34;</span> --text <span style="color:#e6db74">&#34;Error: Your passphrase is incorrect&#34;</span>
</span></span><span style="display:flex;"><span>        tries<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>$tries <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> printf <span style="color:#e6db74">&#34;%s\0&#34;</span> <span style="color:#e6db74">&#34;</span>$LOGINPASS<span style="color:#e6db74">&#34;</span> | ecryptfs-insert-wrapped-passphrase-into-keyring <span style="color:#e6db74">&#34;</span>$WRAPPED_PASSPHRASE_FILE<span style="color:#e6db74">&#34;</span> -
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        break
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        zenity --error --title <span style="color:#e6db74">&#34;eCryptfs&#34;</span> --text <span style="color:#e6db74">&#34;Error: Your passphrase is incorrect&#34;</span>
</span></span><span style="display:flex;"><span>        tries<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>$tries <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $tries -ge $PW_ATTEMPTS <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    zenity --error --title <span style="color:#e6db74">&#34;eCryptfs&#34;</span> --text <span style="color:#e6db74">&#34;Too many incorrect password attempts, exiting&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  /sbin/mount.ecryptfs_private
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  zenity --error --title <span style="color:#e6db74">&#34;eCryptfs&#34;</span> --text <span style="color:#e6db74">&#34;Encrypted private directory is not setup properly&#34;</span>
</span></span><span style="display:flex;"><span>  exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> grep -qs <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.Private </span>$PWD<span style="color:#e6db74"> ecryptfs &#34;</span> /proc/mounts 2&gt;/dev/null; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  zenity --info --title <span style="color:#e6db74">&#34;eCryptfs&#34;</span> --text <span style="color:#e6db74">&#34;Your private directory has been mounted.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dolphin <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/Private&#34;</span>
</span></span><span style="display:flex;"><span>exit <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h4 id="desktop-integration">Desktop integration</h4>
<pre tabindex="0"><code class="language-conf-unix" data-lang="conf-unix">[Desktop Entry]
Type=Application
Version=1.0
Name=eCryptfs Unlock Private Directory
Icon=unlock
Exec=/home/hacko/.ecryptfs/ecryptfs-mount-private-gui
Terminal=False
</code></pre><h3 id="gdb">GDB</h3>
<h4 id="early-init">Early init</h4>
<p>I like to disable the initial message (containing copyright info and other
stuff), the right way to do this is either by starting <code>gdb</code> with <code>-q</code> option, or
(since GDB v11 I think), by setting in
<code>~/.gdbearlyinit</code>.</p>
<pre tabindex="0"><code class="language-gdb-script" data-lang="gdb-script"># GDB early init file
# Abdelhak Bougouffa (c) 2022

# Disable showing the initial message
set startup-quietly
</code></pre><h4 id="init">Init</h4>
<p>GDB loads <code>$HOME/.gdbinit</code> at startup, I like to define some default options in
this file, this is a WIP, but won&rsquo;t evolve too much, as <a href="https://youtu.be/-n9Fkq1e6sg?t=3377">it is recommended to keep
the <code>.gdbinit</code> simple</a>. For the moment, it does just enable pretty printing,
and defines <code>c</code> and <code>n</code> commands to wrap <code>continue</code> and <code>next</code> with a post <code>refresh</code>, this
is just to avoid the annoying TUI when the program outputs to the stdout.</p>
<pre tabindex="0"><code class="language-gdb-script" data-lang="gdb-script"># GDB init file
# Abdelhak Bougouffa (c) 2022

# Save history
set history save on
set history filename ~/.gdb_history
set history remove-duplicates 2048

# Set pretty print
set print pretty on

# This fixes the annoying ncurses TUI gliches and saves typing C-l each time to refresh the screen
define cc
  continue
  refresh
end

define nn
  next
  refresh
end

guile
&lt;&lt;guile-check-for-script&gt;&gt;
end
</code></pre><h5 id="wip-guile-scheme-per-program-project-script">WIP: Guile Scheme per program/project script</h5>
<p>I often debug programs with a lot of arguments, I like to be able to set the
arguments and the binary file to be launched in a per project script (currently
using Guile Scheme). This bit of code checks if the <code>gdb.scm</code> file exists in
the working directory, and if so, loads it.</p>
<p>A more flexible way is to provide a per program config files (to debug a program
named <code>fft</code>, I like to create a script named <code>fft.scm</code> which gets loaded after the
file). The following is a WIP, for the moment, I need to call my custom command
<code>dbg-guile</code> when GDB done loading symbols from the file, otherwise, the used
<code>(current-progspace)</code> returns an object with no filename. I need a mechanism to
hook the <code>(dbg-find-and-load)</code> to GDB&rsquo;s load file functionality.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span>(<span style="color:#a6e22e">use-modules</span> (<span style="color:#a6e22e">gdb</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">dbg-check-and-load</span> filename)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">if </span>(<span style="color:#a6e22e">file-exists?</span> filename)
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">begin </span>(display (string-append <span style="color:#e6db74">&#34;Found a Guile Scheme script, loading file &#34;</span> filename <span style="color:#e6db74">&#34;\n&#34;</span>))
</span></span><span style="display:flex;"><span>           (load filename)
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">#t</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">#f</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">dbg-find-and-load</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; Get the program name from the current progspace</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; For a program named &#34;prog&#34;, the priorities goes like this:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; 1. a script with the same program name (prog.scm) exists in the current directory</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; 2. a script with the same program name (prog.scm) exists in the program directory</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;; 3. a script with the name (gdb.scm) exists in the current directory</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">let </span>((<span style="color:#a6e22e">dbg-prg-filename</span> (<span style="color:#a6e22e">progspace-filename</span> (<span style="color:#a6e22e">current-progspace</span>))))
</span></span><span style="display:flex;"><span>    (<span style="color:#66d9ef">if </span>dbg-prg-filename
</span></span><span style="display:flex;"><span>      (<span style="color:#66d9ef">or </span>(<span style="color:#a6e22e">dbg-check-and-load</span> (string-append (<span style="color:#a6e22e">basename</span> dbg-prg-filename) <span style="color:#e6db74">&#34;.scm&#34;</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">dbg-check-and-load</span> (string-append dbg-prg-filename <span style="color:#e6db74">&#34;.scm&#34;</span>)))
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">dbg-check-and-load</span> <span style="color:#e6db74">&#34;gdb.scm&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Run by default</span>
</span></span><span style="display:flex;"><span>(<span style="color:#a6e22e">dbg-find-and-load</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Define a command to load binary specific config</span>
</span></span><span style="display:flex;"><span>(<span style="color:#a6e22e">register-command!</span> (<span style="color:#a6e22e">make-command</span> <span style="color:#e6db74">&#34;dbg-guile&#34;</span> <span style="color:#f92672">#</span>:invoke (<span style="color:#66d9ef">lambda </span>(<span style="color:#a6e22e">self</span> arg from-tty) (<span style="color:#a6e22e">dbg-find-and-load</span>))))
</span></span></code></pre></div><p>In my project, I create a <code>gdb.scm</code> (or <code>&lt;program-name&gt;.scm</code>) with something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#75715e">;; Load program executable</span>
</span></span><span style="display:flex;"><span>(<span style="color:#a6e22e">execute</span> <span style="color:#e6db74">&#34;file ./build/bin/my_program&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Load program arguments</span>
</span></span><span style="display:flex;"><span>(<span style="color:#a6e22e">execute</span> (<span style="color:#a6e22e">string-join</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;set args &#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;arg1&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;--param=arg2&#34;</span>)))
</span></span></code></pre></div><h3 id="gnupg">GnuPG</h3>
<p>I add this to my <code>~/.gnupg/gpg-agent.conf</code>, to set the time-to-live to one day.</p>
<pre tabindex="0"><code class="language-conf-unix" data-lang="conf-unix"># Do not ask me about entered passwords for 24h (during the same session)
default-cache-ttl 86400
max-cache-ttl 86400
</code></pre><h3 id="packages">Packages</h3>
<p>I like to use the BMC class, however, I do not like to manually install stuff in
system directories, so I made an Arch Linux AUR package <a href="https://aur.archlinux.org/packages/bmc-git"><code>bmc-git</code></a> for it.</p>
<p>I do use the <code>metropolis</code> theme for Beamer presentations, so I&rsquo;m maintaining a
package of it in the AUR too.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>check_and_install_pkg <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  PKG_NAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ! pacman -Qiq <span style="color:#e6db74">${</span>PKG_NAME<span style="color:#e6db74">}</span> &amp;&gt; /dev/null
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Package </span><span style="color:#e6db74">${</span>PKG_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74"> is missing, installing it using yay&#34;</span>
</span></span><span style="display:flex;"><span>    yay -S <span style="color:#e6db74">${</span>PKG_NAME<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>check_and_install_pkg bmc-git
</span></span><span style="display:flex;"><span>check_and_install_pkg beamer-theme-metropolis
</span></span></code></pre></div><h3 id="kde-plasma">KDE Plasma</h3>
<p>On KDE, there is a good support for HiDPI displays, however, an annoying thing
is the small icons in some contexts (for example, a right click on desktop).
<a href="https://www.reddit.com/r/kde/comments/o8bb4s/comment/h33z7bp/?utm_source=share&amp;utm_medium=web2x&amp;context=3">This can be fixed</a> by setting <code>PLASMA_USE_QT_SCALING=1</code>. KDE sources the files
with <code>.sh</code> extension found on <code>~/.config/plasma-workspace/env</code>, so lets create
our&rsquo;s.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># export PLASMA_USE_QT_SCALING=1</span>
</span></span></code></pre></div>
        </div>

        
        <div class="row pl-3 pr-3">
        
        <div class="col-md-6 share-buttons">
        
          </div>

        
        
        </div>



      
      <hr />
        












<div class="row next-prev-navigator">
  
  
</div>

      <hr />

      
      

      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn"><i class="fas fa-chevron-circle-up"></i></a>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
    <div class="toc-holder">
      <h5 class="text-center pl-3">Table of Contents</h5>
      <hr>
      <div class="toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#intro">Intro</a>
      <ul>
        <li><a href="#this-file">This file</a></li>
      </ul>
    </li>
    <li><a href="#general-settings">General Settings</a>
      <ul>
        <li><a href="#user-information">User information</a></li>
        <li><a href="#secrets">Secrets</a></li>
        <li><a href="#better-defaults">Better defaults</a>
          <ul>
            <li><a href="#file-deletion">File deletion</a></li>
            <li><a href="#window">Window</a>
              <ul>
                <li><a href="#split-defaults">Split defaults</a></li>
              </ul>
            </li>
            <li><a href="#undo-and-auto-save">Undo and auto-save</a></li>
            <li><a href="#editing">Editing</a></li>
            <li><a href="#frame">Frame</a>
              <ul>
                <li><a href="#maximizing">Maximizing</a></li>
                <li><a href="#focus-created-frame">Focus created frame</a></li>
                <li><a href="#margins">Margins</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#chemacs2">Chemacs2</a></li>
      </ul>
    </li>
    <li><a href="#modules--init-dot-el">Modules (<code>init.el</code>)</a>
      <ul>
        <li><a href="#file-skeleton">File skeleton</a></li>
        <li><a href="#input--input">Input (<code>:input</code>)</a></li>
        <li><a href="#general--config">General (<code>:config</code>)</a></li>
        <li><a href="#completion--completion">Completion (<code>:completion</code>)</a></li>
        <li><a href="#user-interface--ui">User interface (<code>:ui</code>)</a></li>
        <li><a href="#editor--editor">Editor (<code>:editor</code>)</a></li>
        <li><a href="#emacs-builtin--emacs">Emacs&rsquo; builtin (<code>:emacs</code>)</a></li>
        <li><a href="#terminals--term">Terminals (<code>:term</code>)</a></li>
        <li><a href="#checkers--checkers">Checkers (<code>:checkers</code>)</a></li>
        <li><a href="#tools--tools">Tools (<code>:tools</code>)</a></li>
        <li><a href="#operating-system--os">Operating system (<code>:os</code>)</a></li>
        <li><a href="#language-support--lang">Language support (<code>:lang</code>)</a></li>
        <li><a href="#email--email">Email (<code>:email</code>)</a></li>
        <li><a href="#apps--app">Apps (<code>:app</code>)</a></li>
      </ul>
    </li>
    <li><a href="#doom-configuration">Doom Configuration</a>
      <ul>
        <li><a href="#user-interface">User Interface</a>
          <ul>
            <li><a href="#font-face">Font Face</a></li>
            <li><a href="#theme">Theme</a></li>
            <li><a href="#mode-line">Mode line</a>
              <ul>
                <li><a href="#clock">Clock</a></li>
                <li><a href="#battery">Battery</a></li>
              </ul>
            </li>
            <li><a href="#set-transparency">Set transparency</a></li>
            <li><a href="#splash-screen">Splash Screen</a>
              <ul>
                <li><a href="#custom-splash-image">Custom Splash Image</a></li>
                <li><a href="#clean-screen">Clean Screen</a></li>
                <li><a href="#the-ascii-banner">The ASCII Banner</a></li>
              </ul>
            </li>
            <li><a href="#which-key">Which key</a></li>
            <li><a href="#window-title">Window title</a></li>
            <li><a href="#vertico">Vertico</a></li>
          </ul>
        </li>
        <li><a href="#editor">Editor</a>
          <ul>
            <li><a href="#scratch-buffer">Scratch buffer</a></li>
            <li><a href="#mouse-buttons">Mouse Buttons</a></li>
            <li><a href="#binary-files">Binary files</a></li>
          </ul>
        </li>
        <li><a href="#allow-babel-execution-in-doom-cli-actions">Allow babel execution in <code>doom</code> CLI actions</a></li>
        <li><a href="#asynchronous-config-tangling">Asynchronous config tangling</a></li>
      </ul>
    </li>
    <li><a href="#additional-packages--packages-dot-el">Additional Packages (<code>packages.el</code>)</a>
      <ul>
        <li><a href="#general-packages">General Packages</a>
          <ul>
            <li><a href="#weather">Weather</a></li>
            <li><a href="#caldav"><!-- raw HTML omitted -->TODO<!-- raw HTML omitted --> CalDAV</a></li>
            <li><a href="#xkcd"><code>xkcd</code></a></li>
          </ul>
        </li>
        <li><a href="#themes-and-ui">Themes and UI</a>
          <ul>
            <li><a href="#svg-tag-mode">SVG Tag Mode</a></li>
            <li><a href="#n--n-o">N  N O</a></li>
            <li><a href="#bespoke-themes">Bespoke themes</a></li>
            <li><a href="#focus">Focus</a></li>
            <li><a href="#goggles">Goggles</a></li>
            <li><a href="#smooth-scrolling">Smooth scrolling</a></li>
          </ul>
        </li>
        <li><a href="#features">Features</a>
          <ul>
            <li><a href="#ess">ESS</a></li>
            <li><a href="#very-large-files">Very large files</a></li>
            <li><a href="#e-book-reading">e-Book reading</a></li>
            <li><a href="#org-related">Org related</a>
              <ul>
                <li><a href="#org-ref-cite"><code>org-ref-cite</code></a></li>
                <li><a href="#fragtog">Fragtog</a></li>
                <li><a href="#pretty-table">Pretty table</a></li>
                <li><a href="#org-roam">Org Roam</a></li>
              </ul>
            </li>
            <li><a href="#info-colors">Info colors</a></li>
            <li><a href="#grammarly">Grammarly</a></li>
            <li><a href="#grammalecte">Grammalecte</a></li>
            <li><a href="#zotero-zotxt">Zotero Zotxt</a></li>
            <li><a href="#crdt">CRDT</a></li>
          </ul>
        </li>
        <li><a href="#programming">Programming</a>
          <ul>
            <li><a href="#repo">Repo</a></li>
            <li><a href="#devdocs">Devdocs</a></li>
            <li><a href="#emacs-gdb">Emacs GDB</a></li>
            <li><a href="#disaster">Disaster</a></li>
            <li><a href="#magit-delta">Magit Delta</a></li>
            <li><a href="#blamer">Blamer</a></li>
            <li><a href="#systemd">Systemd</a></li>
            <li><a href="#bitbake--yocto">Bitbake (Yocto)</a></li>
            <li><a href="#latex">LaTeX</a></li>
            <li><a href="#project-cmake"><code>project-cmake</code></a></li>
            <li><a href="#franca-idl">Franca IDL</a></li>
            <li><a href="#flycheck-plus-projectile">Flycheck + projectile</a></li>
            <li><a href="#graphviz">Graphviz</a></li>
            <li><a href="#maxima">Maxima</a></li>
            <li><a href="#ros">ROS</a>
              <ul>
                <li><a href="#ros-emacs-utils">ROS Emacs utils</a></li>
                <li><a href="#ros-dot-el"><code>ros.el</code></a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#emacs-daemon">Emacs Daemon</a>
      <ul>
        <li><a href="#initialization">Initialization</a></li>
        <li><a href="#tweaks">Tweaks</a>
          <ul>
            <li><a href="#save-recent-files">Save recent files</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#package-configuration">Package configuration</a>
      <ul>
        <li><a href="#all-the-icons">All the icons</a></li>
        <li><a href="#centaur-tabs">Centaur tabs</a></li>
        <li><a href="#better-pdfs-in-mode-line">Better PDFs in mode line</a></li>
        <li><a href="#emojify">Emojify</a></li>
        <li><a href="#eros-eval">Eros-eval</a></li>
        <li><a href="#checkers--spell-and-grammar">Checkers (spell &amp; grammar)</a>
          <ul>
            <li><a href="#install-back-end">Install back-end</a></li>
            <li><a href="#spell-fu">Spell Fu</a></li>
            <li><a href="#flyspell">Flyspell</a>
              <ul>
                <li><a href="#lazy-flyspell">Lazy flyspell</a></li>
              </ul>
            </li>
            <li><a href="#shortcuts-to-change-dictionary">Shortcuts to change dictionary</a></li>
            <li><a href="#shortcuts-to-check-grammar">Shortcuts to check grammar</a></li>
          </ul>
        </li>
        <li><a href="#projectile">Projectile</a></li>
        <li><a href="#tramp">Tramp</a></li>
        <li><a href="#yasnippet">YASnippet</a></li>
        <li><a href="#ligatures">Ligatures</a></li>
      </ul>
    </li>
    <li><a href="#applications">Applications</a>
      <ul>
        <li><a href="#e-books-nov">e-Books <code>nov</code></a></li>
        <li><a href="#news-feed-elfeed">News feed <code>elfeed</code></a></li>
        <li><a href="#vpn-config">VPN Config</a>
          <ul>
            <li><a href="#netextender-wrapper">NetExtender wrapper</a></li>
            <li><a href="#launch-netextender-session-from-emacs">Launch NetExtender session from Emacs</a></li>
          </ul>
        </li>
        <li><a href="#email-mu4e">Email <code>mu4e</code></a></li>
      </ul>
    </li>
    <li><a href="#programming">Programming</a>
      <ul>
        <li><a href="#file-templates">File Templates</a></li>
        <li><a href="#gnu-octave">GNU Octave</a></li>
        <li><a href="#ros">ROS</a></li>
        <li><a href="#lsp">LSP</a>
          <ul>
            <li><a href="#enable-some-useful-ui-stuff">Enable some useful UI stuff</a></li>
            <li><a href="#fringe">Fringe</a></li>
            <li><a href="#eglot">Eglot</a></li>
            <li><a href="#lsp-mode-with-clangd">LSP mode with <code>clangd</code></a></li>
            <li><a href="#lsp-mode-with-ccls">LSP mode with <code>ccls</code></a></li>
            <li><a href="#enable-lsp-over-tramp">Enable <code>lsp</code> over <code>tramp</code></a>
              <ul>
                <li><a href="#for-python">For Python</a></li>
                <li><a href="#for-c-c-plus-plus-with-ccls">For C/C++ with <code>ccls</code></a></li>
                <li><a href="#for-c-c-plus-plus-with-clangd">For C/C++ with <code>clangd</code></a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#dap">DAP</a>
          <ul>
            <li><a href="#doom-store">Doom store</a></li>
          </ul>
        </li>
        <li><a href="#the-grand-cathedral-debugger">The Grand &ldquo;Cathedral&rdquo; Debugger</a>
          <ul>
            <li><a href="#additional-commands">Additional commands</a></li>
            <li><a href="#realgud-dot-dir-locals-dot-el-support--only-for-gdb">RealGUD <code>.dir-locals.el</code> support (Only for GDB)</a></li>
            <li><a href="#record-and-replay-rr">Record and replay <code>rr</code></a></li>
          </ul>
        </li>
        <li><a href="#gdb">GDB</a>
          <ul>
            <li><a href="#custom-layout-for-gdb-many-windows">Custom layout for <code>gdb-many-windows</code></a></li>
            <li><a href="#highlight-current-line">Highlight current line</a></li>
            <li><a href="#history">History</a></li>
          </ul>
        </li>
        <li><a href="#cppcheck">Cppcheck</a></li>
        <li><a href="#plain-text">Plain text</a></li>
        <li><a href="#org">Org</a>
          <ul>
            <li><a href="#intro">Intro</a></li>
            <li><a href="#behavior">Behavior</a>
              <ul>
                <li><a href="#tweaking-defaults">Tweaking defaults</a></li>
                <li><a href="#extra-functionality">Extra functionality</a>
                  <ul>
                    <li><a href="#list-bullet-sequence">List bullet sequence</a></li>
                    <li><a href="#citations">Citations</a></li>
                    <li><a href="#spellcheck">Spellcheck</a></li>
                  </ul>
                </li>
                <li><a href="#todos">TODOs</a></li>
                <li><a href="#super-agenda">Super agenda</a></li>
                <li><a href="#google-calendar--org-gcal">Google calendar (<code>org-gcal</code>)</a></li>
                <li><a href="#capture">Capture</a></li>
                <li><a href="#roam">Roam</a>
                  <ul>
                    <li><a href="#basic-settings">Basic settings</a></li>
                    <li><a href="#mode-line-file-name">Mode line file name</a></li>
                    <li><a href="#org-roam-capture-template">Org Roam Capture template</a></li>
                  </ul>
                </li>
                <li><a href="#snippet-helpers">Snippet Helpers</a></li>
                <li><a href="#translate-capital-keywords--old--to-lower-case--new">Translate capital keywords (old) to lower case (new)</a></li>
                <li><a href="#fix-problematic-hooks">Fix problematic hooks</a></li>
              </ul>
            </li>
            <li><a href="#custom-links">Custom links</a>
              <ul>
                <li><a href="#subfig">Subfig</a></li>
              </ul>
            </li>
            <li><a href="#visuals">Visuals</a>
              <ul>
                <li><a href="#font-display">Font Display</a>
                  <ul>
                    <li><a href="#headings">Headings</a></li>
                    <li><a href="#deadlines">Deadlines</a></li>
                    <li><a href="#org-pretty-mode">Org Pretty Mode</a></li>
                    <li><a href="#font-styling">Font styling</a></li>
                  </ul>
                </li>
                <li><a href="#fontifying-inline-src-blocks">Fontifying inline src blocks</a></li>
                <li><a href="#symbols">Symbols</a></li>
                <li><a href="#latex-fragments">LaTeX Fragments</a>
                  <ul>
                    <li><a href="#prettier-highlighting">Prettier highlighting</a></li>
                    <li><a href="#prettier-rendering">Prettier rendering</a></li>
                    <li><a href="#better-equation-numbering">Better equation numbering</a></li>
                  </ul>
                </li>
                <li><a href="#org-plot">Org Plot</a></li>
              </ul>
            </li>
            <li><a href="#bibliography">Bibliography</a></li>
            <li><a href="#exporting">Exporting</a>
              <ul>
                <li><a href="#general-settings">General settings</a></li>
                <li><a href="#latex-export">LaTeX Export</a>
                  <ul>
                    <li><a href="#compiling">Compiling</a></li>
                    <li><a href="#class-templates">Class templates</a></li>
                  </ul>
                </li>
                <li><a href="#hugo">Hugo</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#system-configuration">System configuration</a>
      <ul>
        <li><a href="#mime-types">Mime types</a>
          <ul>
            <li><a href="#org-mode-files">Org Mode files</a></li>
            <li><a href="#registering-org-protocol">Registering <code>org-protocol://</code></a></li>
            <li><a href="#configuring-chrome-brave">Configuring Chrome/Brave</a></li>
          </ul>
        </li>
        <li><a href="#git">Git</a>
          <ul>
            <li><a href="#git-diffs">Git diffs</a></li>
            <li><a href="#apache-tika-app-wrapper">Apache Tika App wrapper</a></li>
          </ul>
        </li>
        <li><a href="#emacs-systemd-daemon">Emacs&rsquo; Systemd Daemon</a></li>
        <li><a href="#emacs-client">Emacs Client</a>
          <ul>
            <li><a href="#desktop-integration">Desktop Integration</a></li>
            <li><a href="#command-line-wrapper">Command-line Wrapper</a>
              <ul>
                <li><a href="#useful-aliases">Useful aliases</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#tmux"><!-- raw HTML omitted -->TODO<!-- raw HTML omitted --> tmux</a></li>
        <li><a href="#appimage">AppImage</a></li>
        <li><a href="#custom-environment">Custom environment</a></li>
        <li><a href="#system-dark-theme-trick">System dark theme trick</a></li>
        <li><a href="#rust-format">Rust format</a></li>
        <li><a href="#ecryptfs">Ecryptfs</a>
          <ul>
            <li><a href="#unlock-and-mount-script">Unlock and mount script</a></li>
            <li><a href="#desktop-integration">Desktop integration</a></li>
          </ul>
        </li>
        <li><a href="#gdb">GDB</a>
          <ul>
            <li><a href="#early-init">Early init</a></li>
            <li><a href="#init">Init</a>
              <ul>
                <li><a href="#wip-guile-scheme-per-program-project-script">WIP: Guile Scheme per program/project script</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#gnupg">GnuPG</a></li>
        <li><a href="#packages">Packages</a></li>
        <li><a href="#kde-plasma">KDE Plasma</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    </div>
    
  </section>

    </div>

    
    










  
      
  



  
  
    
  

  
  
    
  

  
  

  
  
    
    
      
    
  


  
  
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-left">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://abdelhakbougouffa.pro#about">About</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://abdelhakbougouffa.pro#skills">Skills</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://abdelhakbougouffa.pro#experiences">Experiences</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://abdelhakbougouffa.pro#publications">Publications</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://abdelhakbougouffa.pro#education">Education</a>
                </li>
              
            
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:firstname%20%28dot%29%20lastname@universite-paris-saclay.fr target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>firstname (dot) lastname@universite-paris-saclay.fr</span>
                </a></li>
              
            
          </ul>
        </div>
        
        
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-left">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hossainemruz/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png" alt="Toha Theme Logo">
            Toha
          </a>
        </div>
        <div class="col-md-4 text-center"> 2022 Copyright</div>
        <div class="col-md-4 text-right">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/navbar.js"></script>
<script type="text/javascript" src="/js/plyr.js"></script>
<script type="text/javascript" src="/js/main.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>









    
</body>
</html>
